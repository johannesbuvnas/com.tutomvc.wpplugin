/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(70);


/***/ },

/***/ 70:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	__webpack_require__(71);
	__webpack_require__(78);
	__webpack_require__(81);
	__webpack_require__(83);
	__webpack_require__(85);
	(function ($) {
	    $(document).ready(function () {
	        // Select2FormInput
	        $(".form-input-element.select2").each(function () {
	            $(this).select2($(this).data());
	        });
	    });
	})(jQuery);


/***/ },

/***/ 71:
/***/ function(module, exports) {

	// removed by extract-text-webpack-plugin

/***/ },

/***/ 78:
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(79)(__webpack_require__(80)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/source-map-loader/index.js!/Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/select2/dist/js/select2.js")

/***/ },

/***/ 79:
/***/ function(module, exports) {

	/*
		MIT License http://www.opensource.org/licenses/mit-license.php
		Author Tobias Koppers @sokra
	*/
	module.exports = function(src) {
		if (typeof execScript !== "undefined")
			execScript(src);
		else
			eval.call(null, src);
	}


/***/ },

/***/ 80:
/***/ function(module, exports) {

	module.exports = "/*!\r\n * Select2 4.0.3\r\n * https://select2.github.io\r\n *\r\n * Released under the MIT license\r\n * https://github.com/select2/select2/blob/master/LICENSE.md\r\n */\r\n(function (factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    // AMD. Register as an anonymous module.\r\n    define(['jquery'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    // Node/CommonJS\r\n    factory(require('jquery'));\r\n  } else {\r\n    // Browser globals\r\n    factory(jQuery);\r\n  }\r\n}(function (jQuery) {\r\n  // This is needed so we can catch the AMD loader configuration and use it\r\n  // The inner file should be wrapped (by `banner.start.js`) in a function that\r\n  // returns the AMD loader references.\r\n  var S2 =\r\n(function () {\r\n  // Restore the Select2 AMD loader so it can be used\r\n  // Needed mostly in the language files, where the loader is not inserted\r\n  if (jQuery && jQuery.fn && jQuery.fn.select2 && jQuery.fn.select2.amd) {\r\n    var S2 = jQuery.fn.select2.amd;\r\n  }\r\nvar S2;(function () { if (!S2 || !S2.requirejs) {\nif (!S2) { S2 = {}; } else { require = S2; }\n/**\n * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.\n * Available via the MIT or new BSD license.\n * see: http://github.com/jrburke/almond for details\n */\n//Going sloppy to avoid 'use strict' string cost, but strict practices should\n//be followed.\n/*jslint sloppy: true */\n/*global setTimeout: false */\n\nvar requirejs, require, define;\n(function (undef) {\n    var main, req, makeMap, handlers,\n        defined = {},\n        waiting = {},\n        config = {},\n        defining = {},\n        hasOwn = Object.prototype.hasOwnProperty,\n        aps = [].slice,\n        jsSuffixRegExp = /\\.js$/;\n\n    function hasProp(obj, prop) {\n        return hasOwn.call(obj, prop);\n    }\n\n    /**\n     * Given a relative module name, like ./something, normalize it to\n     * a real name that can be mapped to a path.\n     * @param {String} name the relative name\n     * @param {String} baseName a real name that the name arg is relative\n     * to.\n     * @returns {String} normalized name\n     */\n    function normalize(name, baseName) {\n        var nameParts, nameSegment, mapValue, foundMap, lastIndex,\n            foundI, foundStarMap, starI, i, j, part,\n            baseParts = baseName && baseName.split(\"/\"),\n            map = config.map,\n            starMap = (map && map['*']) || {};\n\n        //Adjust any relative paths.\n        if (name && name.charAt(0) === \".\") {\n            //If have a base name, try to normalize against it,\n            //otherwise, assume it is a top-level require that will\n            //be relative to baseUrl in the end.\n            if (baseName) {\n                name = name.split('/');\n                lastIndex = name.length - 1;\n\n                // Node .js allowance:\n                if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {\n                    name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, '');\n                }\n\n                //Lop off the last part of baseParts, so that . matches the\n                //\"directory\" and not name of the baseName's module. For instance,\n                //baseName of \"one/two/three\", maps to \"one/two/three.js\", but we\n                //want the directory, \"one/two\" for this normalization.\n                name = baseParts.slice(0, baseParts.length - 1).concat(name);\n\n                //start trimDots\n                for (i = 0; i < name.length; i += 1) {\n                    part = name[i];\n                    if (part === \".\") {\n                        name.splice(i, 1);\n                        i -= 1;\n                    } else if (part === \"..\") {\n                        if (i === 1 && (name[2] === '..' || name[0] === '..')) {\n                            //End of the line. Keep at least one non-dot\n                            //path segment at the front so it can be mapped\n                            //correctly to disk. Otherwise, there is likely\n                            //no path mapping for a path starting with '..'.\n                            //This can still fail, but catches the most reasonable\n                            //uses of ..\n                            break;\n                        } else if (i > 0) {\n                            name.splice(i - 1, 2);\n                            i -= 2;\n                        }\n                    }\n                }\n                //end trimDots\n\n                name = name.join(\"/\");\n            } else if (name.indexOf('./') === 0) {\n                // No baseName, so this is ID is resolved relative\n                // to baseUrl, pull off the leading dot.\n                name = name.substring(2);\n            }\n        }\n\n        //Apply map config if available.\n        if ((baseParts || starMap) && map) {\n            nameParts = name.split('/');\n\n            for (i = nameParts.length; i > 0; i -= 1) {\n                nameSegment = nameParts.slice(0, i).join(\"/\");\n\n                if (baseParts) {\n                    //Find the longest baseName segment match in the config.\n                    //So, do joins on the biggest to smallest lengths of baseParts.\n                    for (j = baseParts.length; j > 0; j -= 1) {\n                        mapValue = map[baseParts.slice(0, j).join('/')];\n\n                        //baseName segment has  config, find if it has one for\n                        //this name.\n                        if (mapValue) {\n                            mapValue = mapValue[nameSegment];\n                            if (mapValue) {\n                                //Match, update name to the new value.\n                                foundMap = mapValue;\n                                foundI = i;\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if (foundMap) {\n                    break;\n                }\n\n                //Check for a star map match, but just hold on to it,\n                //if there is a shorter segment match later in a matching\n                //config, then favor over this star map.\n                if (!foundStarMap && starMap && starMap[nameSegment]) {\n                    foundStarMap = starMap[nameSegment];\n                    starI = i;\n                }\n            }\n\n            if (!foundMap && foundStarMap) {\n                foundMap = foundStarMap;\n                foundI = starI;\n            }\n\n            if (foundMap) {\n                nameParts.splice(0, foundI, foundMap);\n                name = nameParts.join('/');\n            }\n        }\n\n        return name;\n    }\n\n    function makeRequire(relName, forceSync) {\n        return function () {\n            //A version of a require function that passes a moduleName\n            //value for items that may need to\n            //look up paths relative to the moduleName\n            var args = aps.call(arguments, 0);\n\n            //If first arg is not require('string'), and there is only\n            //one arg, it is the array form without a callback. Insert\n            //a null so that the following concat is correct.\n            if (typeof args[0] !== 'string' && args.length === 1) {\n                args.push(null);\n            }\n            return req.apply(undef, args.concat([relName, forceSync]));\n        };\n    }\n\n    function makeNormalize(relName) {\n        return function (name) {\n            return normalize(name, relName);\n        };\n    }\n\n    function makeLoad(depName) {\n        return function (value) {\n            defined[depName] = value;\n        };\n    }\n\n    function callDep(name) {\n        if (hasProp(waiting, name)) {\n            var args = waiting[name];\n            delete waiting[name];\n            defining[name] = true;\n            main.apply(undef, args);\n        }\n\n        if (!hasProp(defined, name) && !hasProp(defining, name)) {\n            throw new Error('No ' + name);\n        }\n        return defined[name];\n    }\n\n    //Turns a plugin!resource to [plugin, resource]\n    //with the plugin being undefined if the name\n    //did not have a plugin prefix.\n    function splitPrefix(name) {\n        var prefix,\n            index = name ? name.indexOf('!') : -1;\n        if (index > -1) {\n            prefix = name.substring(0, index);\n            name = name.substring(index + 1, name.length);\n        }\n        return [prefix, name];\n    }\n\n    /**\n     * Makes a name map, normalizing the name, and using a plugin\n     * for normalization if necessary. Grabs a ref to plugin\n     * too, as an optimization.\n     */\n    makeMap = function (name, relName) {\n        var plugin,\n            parts = splitPrefix(name),\n            prefix = parts[0];\n\n        name = parts[1];\n\n        if (prefix) {\n            prefix = normalize(prefix, relName);\n            plugin = callDep(prefix);\n        }\n\n        //Normalize according\n        if (prefix) {\n            if (plugin && plugin.normalize) {\n                name = plugin.normalize(name, makeNormalize(relName));\n            } else {\n                name = normalize(name, relName);\n            }\n        } else {\n            name = normalize(name, relName);\n            parts = splitPrefix(name);\n            prefix = parts[0];\n            name = parts[1];\n            if (prefix) {\n                plugin = callDep(prefix);\n            }\n        }\n\n        //Using ridiculous property names for space reasons\n        return {\n            f: prefix ? prefix + '!' + name : name, //fullName\n            n: name,\n            pr: prefix,\n            p: plugin\n        };\n    };\n\n    function makeConfig(name) {\n        return function () {\n            return (config && config.config && config.config[name]) || {};\n        };\n    }\n\n    handlers = {\n        require: function (name) {\n            return makeRequire(name);\n        },\n        exports: function (name) {\n            var e = defined[name];\n            if (typeof e !== 'undefined') {\n                return e;\n            } else {\n                return (defined[name] = {});\n            }\n        },\n        module: function (name) {\n            return {\n                id: name,\n                uri: '',\n                exports: defined[name],\n                config: makeConfig(name)\n            };\n        }\n    };\n\n    main = function (name, deps, callback, relName) {\n        var cjsModule, depName, ret, map, i,\n            args = [],\n            callbackType = typeof callback,\n            usingExports;\n\n        //Use name if no relName\n        relName = relName || name;\n\n        //Call the callback to define the module, if necessary.\n        if (callbackType === 'undefined' || callbackType === 'function') {\n            //Pull out the defined dependencies and pass the ordered\n            //values to the callback.\n            //Default to [require, exports, module] if no deps\n            deps = !deps.length && callback.length ? ['require', 'exports', 'module'] : deps;\n            for (i = 0; i < deps.length; i += 1) {\n                map = makeMap(deps[i], relName);\n                depName = map.f;\n\n                //Fast path CommonJS standard dependencies.\n                if (depName === \"require\") {\n                    args[i] = handlers.require(name);\n                } else if (depName === \"exports\") {\n                    //CommonJS module spec 1.1\n                    args[i] = handlers.exports(name);\n                    usingExports = true;\n                } else if (depName === \"module\") {\n                    //CommonJS module spec 1.1\n                    cjsModule = args[i] = handlers.module(name);\n                } else if (hasProp(defined, depName) ||\n                           hasProp(waiting, depName) ||\n                           hasProp(defining, depName)) {\n                    args[i] = callDep(depName);\n                } else if (map.p) {\n                    map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});\n                    args[i] = defined[depName];\n                } else {\n                    throw new Error(name + ' missing ' + depName);\n                }\n            }\n\n            ret = callback ? callback.apply(defined[name], args) : undefined;\n\n            if (name) {\n                //If setting exports via \"module\" is in play,\n                //favor that over return value and exports. After that,\n                //favor a non-undefined return value over exports use.\n                if (cjsModule && cjsModule.exports !== undef &&\n                        cjsModule.exports !== defined[name]) {\n                    defined[name] = cjsModule.exports;\n                } else if (ret !== undef || !usingExports) {\n                    //Use the return value from the function.\n                    defined[name] = ret;\n                }\n            }\n        } else if (name) {\n            //May just be an object definition for the module. Only\n            //worry about defining if have a module name.\n            defined[name] = callback;\n        }\n    };\n\n    requirejs = require = req = function (deps, callback, relName, forceSync, alt) {\n        if (typeof deps === \"string\") {\n            if (handlers[deps]) {\n                //callback in this case is really relName\n                return handlers[deps](callback);\n            }\n            //Just return the module wanted. In this scenario, the\n            //deps arg is the module name, and second arg (if passed)\n            //is just the relName.\n            //Normalize module name, if it contains . or ..\n            return callDep(makeMap(deps, callback).f);\n        } else if (!deps.splice) {\n            //deps is a config object, not an array.\n            config = deps;\n            if (config.deps) {\n                req(config.deps, config.callback);\n            }\n            if (!callback) {\n                return;\n            }\n\n            if (callback.splice) {\n                //callback is an array, which means it is a dependency list.\n                //Adjust args if there are dependencies\n                deps = callback;\n                callback = relName;\n                relName = null;\n            } else {\n                deps = undef;\n            }\n        }\n\n        //Support require(['a'])\n        callback = callback || function () {};\n\n        //If relName is a function, it is an errback handler,\n        //so remove it.\n        if (typeof relName === 'function') {\n            relName = forceSync;\n            forceSync = alt;\n        }\n\n        //Simulate async callback;\n        if (forceSync) {\n            main(undef, deps, callback, relName);\n        } else {\n            //Using a non-zero value because of concern for what old browsers\n            //do, and latest browsers \"upgrade\" to 4 if lower value is used:\n            //http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#dom-windowtimers-settimeout:\n            //If want a value immediately, use require('id') instead -- something\n            //that works in almond on the global level, but not guaranteed and\n            //unlikely to work in other AMD implementations.\n            setTimeout(function () {\n                main(undef, deps, callback, relName);\n            }, 4);\n        }\n\n        return req;\n    };\n\n    /**\n     * Just drops the config on the floor, but returns req in case\n     * the config return value is used.\n     */\n    req.config = function (cfg) {\n        return req(cfg);\n    };\n\n    /**\n     * Expose module registry for debugging and tooling\n     */\n    requirejs._defined = defined;\n\n    define = function (name, deps, callback) {\n        if (typeof name !== 'string') {\n            throw new Error('See almond README: incorrect module build, no module name');\n        }\n\n        //This module may not have dependencies\n        if (!deps.splice) {\n            //deps is not an array, so probably means\n            //an object literal or factory function for\n            //the value. Adjust args.\n            callback = deps;\n            deps = [];\n        }\n\n        if (!hasProp(defined, name) && !hasProp(waiting, name)) {\n            waiting[name] = [name, deps, callback];\n        }\n    };\n\n    define.amd = {\n        jQuery: true\n    };\n}());\n\nS2.requirejs = requirejs;S2.require = require;S2.define = define;\n}\n}());\nS2.define(\"almond\", function(){});\n\n/* global jQuery:false, $:false */\r\nS2.define('jquery',[],function () {\r\n  var _$ = jQuery || $;\r\n\r\n  if (_$ == null && console && console.error) {\r\n    console.error(\r\n      'Select2: An instance of jQuery or a jQuery-compatible library was not ' +\r\n      'found. Make sure that you are including jQuery before Select2 on your ' +\r\n      'web page.'\r\n    );\r\n  }\r\n\r\n  return _$;\r\n});\r\n\nS2.define('select2/utils',[\r\n  'jquery'\r\n], function ($) {\r\n  var Utils = {};\r\n\r\n  Utils.Extend = function (ChildClass, SuperClass) {\r\n    var __hasProp = {}.hasOwnProperty;\r\n\r\n    function BaseConstructor () {\r\n      this.constructor = ChildClass;\r\n    }\r\n\r\n    for (var key in SuperClass) {\r\n      if (__hasProp.call(SuperClass, key)) {\r\n        ChildClass[key] = SuperClass[key];\r\n      }\r\n    }\r\n\r\n    BaseConstructor.prototype = SuperClass.prototype;\r\n    ChildClass.prototype = new BaseConstructor();\r\n    ChildClass.__super__ = SuperClass.prototype;\r\n\r\n    return ChildClass;\r\n  };\r\n\r\n  function getMethods (theClass) {\r\n    var proto = theClass.prototype;\r\n\r\n    var methods = [];\r\n\r\n    for (var methodName in proto) {\r\n      var m = proto[methodName];\r\n\r\n      if (typeof m !== 'function') {\r\n        continue;\r\n      }\r\n\r\n      if (methodName === 'constructor') {\r\n        continue;\r\n      }\r\n\r\n      methods.push(methodName);\r\n    }\r\n\r\n    return methods;\r\n  }\r\n\r\n  Utils.Decorate = function (SuperClass, DecoratorClass) {\r\n    var decoratedMethods = getMethods(DecoratorClass);\r\n    var superMethods = getMethods(SuperClass);\r\n\r\n    function DecoratedClass () {\r\n      var unshift = Array.prototype.unshift;\r\n\r\n      var argCount = DecoratorClass.prototype.constructor.length;\r\n\r\n      var calledConstructor = SuperClass.prototype.constructor;\r\n\r\n      if (argCount > 0) {\r\n        unshift.call(arguments, SuperClass.prototype.constructor);\r\n\r\n        calledConstructor = DecoratorClass.prototype.constructor;\r\n      }\r\n\r\n      calledConstructor.apply(this, arguments);\r\n    }\r\n\r\n    DecoratorClass.displayName = SuperClass.displayName;\r\n\r\n    function ctr () {\r\n      this.constructor = DecoratedClass;\r\n    }\r\n\r\n    DecoratedClass.prototype = new ctr();\r\n\r\n    for (var m = 0; m < superMethods.length; m++) {\r\n        var superMethod = superMethods[m];\r\n\r\n        DecoratedClass.prototype[superMethod] =\r\n          SuperClass.prototype[superMethod];\r\n    }\r\n\r\n    var calledMethod = function (methodName) {\r\n      // Stub out the original method if it's not decorating an actual method\r\n      var originalMethod = function () {};\r\n\r\n      if (methodName in DecoratedClass.prototype) {\r\n        originalMethod = DecoratedClass.prototype[methodName];\r\n      }\r\n\r\n      var decoratedMethod = DecoratorClass.prototype[methodName];\r\n\r\n      return function () {\r\n        var unshift = Array.prototype.unshift;\r\n\r\n        unshift.call(arguments, originalMethod);\r\n\r\n        return decoratedMethod.apply(this, arguments);\r\n      };\r\n    };\r\n\r\n    for (var d = 0; d < decoratedMethods.length; d++) {\r\n      var decoratedMethod = decoratedMethods[d];\r\n\r\n      DecoratedClass.prototype[decoratedMethod] = calledMethod(decoratedMethod);\r\n    }\r\n\r\n    return DecoratedClass;\r\n  };\r\n\r\n  var Observable = function () {\r\n    this.listeners = {};\r\n  };\r\n\r\n  Observable.prototype.on = function (event, callback) {\r\n    this.listeners = this.listeners || {};\r\n\r\n    if (event in this.listeners) {\r\n      this.listeners[event].push(callback);\r\n    } else {\r\n      this.listeners[event] = [callback];\r\n    }\r\n  };\r\n\r\n  Observable.prototype.trigger = function (event) {\r\n    var slice = Array.prototype.slice;\r\n    var params = slice.call(arguments, 1);\r\n\r\n    this.listeners = this.listeners || {};\r\n\r\n    // Params should always come in as an array\r\n    if (params == null) {\r\n      params = [];\r\n    }\r\n\r\n    // If there are no arguments to the event, use a temporary object\r\n    if (params.length === 0) {\r\n      params.push({});\r\n    }\r\n\r\n    // Set the `_type` of the first object to the event\r\n    params[0]._type = event;\r\n\r\n    if (event in this.listeners) {\r\n      this.invoke(this.listeners[event], slice.call(arguments, 1));\r\n    }\r\n\r\n    if ('*' in this.listeners) {\r\n      this.invoke(this.listeners['*'], arguments);\r\n    }\r\n  };\r\n\r\n  Observable.prototype.invoke = function (listeners, params) {\r\n    for (var i = 0, len = listeners.length; i < len; i++) {\r\n      listeners[i].apply(this, params);\r\n    }\r\n  };\r\n\r\n  Utils.Observable = Observable;\r\n\r\n  Utils.generateChars = function (length) {\r\n    var chars = '';\r\n\r\n    for (var i = 0; i < length; i++) {\r\n      var randomChar = Math.floor(Math.random() * 36);\r\n      chars += randomChar.toString(36);\r\n    }\r\n\r\n    return chars;\r\n  };\r\n\r\n  Utils.bind = function (func, context) {\r\n    return function () {\r\n      func.apply(context, arguments);\r\n    };\r\n  };\r\n\r\n  Utils._convertData = function (data) {\r\n    for (var originalKey in data) {\r\n      var keys = originalKey.split('-');\r\n\r\n      var dataLevel = data;\r\n\r\n      if (keys.length === 1) {\r\n        continue;\r\n      }\r\n\r\n      for (var k = 0; k < keys.length; k++) {\r\n        var key = keys[k];\r\n\r\n        // Lowercase the first letter\r\n        // By default, dash-separated becomes camelCase\r\n        key = key.substring(0, 1).toLowerCase() + key.substring(1);\r\n\r\n        if (!(key in dataLevel)) {\r\n          dataLevel[key] = {};\r\n        }\r\n\r\n        if (k == keys.length - 1) {\r\n          dataLevel[key] = data[originalKey];\r\n        }\r\n\r\n        dataLevel = dataLevel[key];\r\n      }\r\n\r\n      delete data[originalKey];\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  Utils.hasScroll = function (index, el) {\r\n    // Adapted from the function created by @ShadowScripter\r\n    // and adapted by @BillBarry on the Stack Exchange Code Review website.\r\n    // The original code can be found at\r\n    // http://codereview.stackexchange.com/q/13338\r\n    // and was designed to be used with the Sizzle selector engine.\r\n\r\n    var $el = $(el);\r\n    var overflowX = el.style.overflowX;\r\n    var overflowY = el.style.overflowY;\r\n\r\n    //Check both x and y declarations\r\n    if (overflowX === overflowY &&\r\n        (overflowY === 'hidden' || overflowY === 'visible')) {\r\n      return false;\r\n    }\r\n\r\n    if (overflowX === 'scroll' || overflowY === 'scroll') {\r\n      return true;\r\n    }\r\n\r\n    return ($el.innerHeight() < el.scrollHeight ||\r\n      $el.innerWidth() < el.scrollWidth);\r\n  };\r\n\r\n  Utils.escapeMarkup = function (markup) {\r\n    var replaceMap = {\r\n      '\\\\': '&#92;',\r\n      '&': '&amp;',\r\n      '<': '&lt;',\r\n      '>': '&gt;',\r\n      '\"': '&quot;',\r\n      '\\'': '&#39;',\r\n      '/': '&#47;'\r\n    };\r\n\r\n    // Do not try to escape the markup if it's not a string\r\n    if (typeof markup !== 'string') {\r\n      return markup;\r\n    }\r\n\r\n    return String(markup).replace(/[&<>\"'\\/\\\\]/g, function (match) {\r\n      return replaceMap[match];\r\n    });\r\n  };\r\n\r\n  // Append an array of jQuery nodes to a given element.\r\n  Utils.appendMany = function ($element, $nodes) {\r\n    // jQuery 1.7.x does not support $.fn.append() with an array\r\n    // Fall back to a jQuery object collection using $.fn.add()\r\n    if ($.fn.jquery.substr(0, 3) === '1.7') {\r\n      var $jqNodes = $();\r\n\r\n      $.map($nodes, function (node) {\r\n        $jqNodes = $jqNodes.add(node);\r\n      });\r\n\r\n      $nodes = $jqNodes;\r\n    }\r\n\r\n    $element.append($nodes);\r\n  };\r\n\r\n  return Utils;\r\n});\r\n\nS2.define('select2/results',[\r\n  'jquery',\r\n  './utils'\r\n], function ($, Utils) {\r\n  function Results ($element, options, dataAdapter) {\r\n    this.$element = $element;\r\n    this.data = dataAdapter;\r\n    this.options = options;\r\n\r\n    Results.__super__.constructor.call(this);\r\n  }\r\n\r\n  Utils.Extend(Results, Utils.Observable);\r\n\r\n  Results.prototype.render = function () {\r\n    var $results = $(\r\n      '<ul class=\"select2-results__options\" role=\"tree\"></ul>'\r\n    );\r\n\r\n    if (this.options.get('multiple')) {\r\n      $results.attr('aria-multiselectable', 'true');\r\n    }\r\n\r\n    this.$results = $results;\r\n\r\n    return $results;\r\n  };\r\n\r\n  Results.prototype.clear = function () {\r\n    this.$results.empty();\r\n  };\r\n\r\n  Results.prototype.displayMessage = function (params) {\r\n    var escapeMarkup = this.options.get('escapeMarkup');\r\n\r\n    this.clear();\r\n    this.hideLoading();\r\n\r\n    var $message = $(\r\n      '<li role=\"treeitem\" aria-live=\"assertive\"' +\r\n      ' class=\"select2-results__option\"></li>'\r\n    );\r\n\r\n    var message = this.options.get('translations').get(params.message);\r\n\r\n    $message.append(\r\n      escapeMarkup(\r\n        message(params.args)\r\n      )\r\n    );\r\n\r\n    $message[0].className += ' select2-results__message';\r\n\r\n    this.$results.append($message);\r\n  };\r\n\r\n  Results.prototype.hideMessages = function () {\r\n    this.$results.find('.select2-results__message').remove();\r\n  };\r\n\r\n  Results.prototype.append = function (data) {\r\n    this.hideLoading();\r\n\r\n    var $options = [];\r\n\r\n    if (data.results == null || data.results.length === 0) {\r\n      if (this.$results.children().length === 0) {\r\n        this.trigger('results:message', {\r\n          message: 'noResults'\r\n        });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    data.results = this.sort(data.results);\r\n\r\n    for (var d = 0; d < data.results.length; d++) {\r\n      var item = data.results[d];\r\n\r\n      var $option = this.option(item);\r\n\r\n      $options.push($option);\r\n    }\r\n\r\n    this.$results.append($options);\r\n  };\r\n\r\n  Results.prototype.position = function ($results, $dropdown) {\r\n    var $resultsContainer = $dropdown.find('.select2-results');\r\n    $resultsContainer.append($results);\r\n  };\r\n\r\n  Results.prototype.sort = function (data) {\r\n    var sorter = this.options.get('sorter');\r\n\r\n    return sorter(data);\r\n  };\r\n\r\n  Results.prototype.highlightFirstItem = function () {\r\n    var $options = this.$results\r\n      .find('.select2-results__option[aria-selected]');\r\n\r\n    var $selected = $options.filter('[aria-selected=true]');\r\n\r\n    // Check if there are any selected options\r\n    if ($selected.length > 0) {\r\n      // If there are selected options, highlight the first\r\n      $selected.first().trigger('mouseenter');\r\n    } else {\r\n      // If there are no selected options, highlight the first option\r\n      // in the dropdown\r\n      $options.first().trigger('mouseenter');\r\n    }\r\n\r\n    this.ensureHighlightVisible();\r\n  };\r\n\r\n  Results.prototype.setClasses = function () {\r\n    var self = this;\r\n\r\n    this.data.current(function (selected) {\r\n      var selectedIds = $.map(selected, function (s) {\r\n        return s.id.toString();\r\n      });\r\n\r\n      var $options = self.$results\r\n        .find('.select2-results__option[aria-selected]');\r\n\r\n      $options.each(function () {\r\n        var $option = $(this);\r\n\r\n        var item = $.data(this, 'data');\r\n\r\n        // id needs to be converted to a string when comparing\r\n        var id = '' + item.id;\r\n\r\n        if ((item.element != null && item.element.selected) ||\r\n            (item.element == null && $.inArray(id, selectedIds) > -1)) {\r\n          $option.attr('aria-selected', 'true');\r\n        } else {\r\n          $option.attr('aria-selected', 'false');\r\n        }\r\n      });\r\n\r\n    });\r\n  };\r\n\r\n  Results.prototype.showLoading = function (params) {\r\n    this.hideLoading();\r\n\r\n    var loadingMore = this.options.get('translations').get('searching');\r\n\r\n    var loading = {\r\n      disabled: true,\r\n      loading: true,\r\n      text: loadingMore(params)\r\n    };\r\n    var $loading = this.option(loading);\r\n    $loading.className += ' loading-results';\r\n\r\n    this.$results.prepend($loading);\r\n  };\r\n\r\n  Results.prototype.hideLoading = function () {\r\n    this.$results.find('.loading-results').remove();\r\n  };\r\n\r\n  Results.prototype.option = function (data) {\r\n    var option = document.createElement('li');\r\n    option.className = 'select2-results__option';\r\n\r\n    var attrs = {\r\n      'role': 'treeitem',\r\n      'aria-selected': 'false'\r\n    };\r\n\r\n    if (data.disabled) {\r\n      delete attrs['aria-selected'];\r\n      attrs['aria-disabled'] = 'true';\r\n    }\r\n\r\n    if (data.id == null) {\r\n      delete attrs['aria-selected'];\r\n    }\r\n\r\n    if (data._resultId != null) {\r\n      option.id = data._resultId;\r\n    }\r\n\r\n    if (data.title) {\r\n      option.title = data.title;\r\n    }\r\n\r\n    if (data.children) {\r\n      attrs.role = 'group';\r\n      attrs['aria-label'] = data.text;\r\n      delete attrs['aria-selected'];\r\n    }\r\n\r\n    for (var attr in attrs) {\r\n      var val = attrs[attr];\r\n\r\n      option.setAttribute(attr, val);\r\n    }\r\n\r\n    if (data.children) {\r\n      var $option = $(option);\r\n\r\n      var label = document.createElement('strong');\r\n      label.className = 'select2-results__group';\r\n\r\n      var $label = $(label);\r\n      this.template(data, label);\r\n\r\n      var $children = [];\r\n\r\n      for (var c = 0; c < data.children.length; c++) {\r\n        var child = data.children[c];\r\n\r\n        var $child = this.option(child);\r\n\r\n        $children.push($child);\r\n      }\r\n\r\n      var $childrenContainer = $('<ul></ul>', {\r\n        'class': 'select2-results__options select2-results__options--nested'\r\n      });\r\n\r\n      $childrenContainer.append($children);\r\n\r\n      $option.append(label);\r\n      $option.append($childrenContainer);\r\n    } else {\r\n      this.template(data, option);\r\n    }\r\n\r\n    $.data(option, 'data', data);\r\n\r\n    return option;\r\n  };\r\n\r\n  Results.prototype.bind = function (container, $container) {\r\n    var self = this;\r\n\r\n    var id = container.id + '-results';\r\n\r\n    this.$results.attr('id', id);\r\n\r\n    container.on('results:all', function (params) {\r\n      self.clear();\r\n      self.append(params.data);\r\n\r\n      if (container.isOpen()) {\r\n        self.setClasses();\r\n        self.highlightFirstItem();\r\n      }\r\n    });\r\n\r\n    container.on('results:append', function (params) {\r\n      self.append(params.data);\r\n\r\n      if (container.isOpen()) {\r\n        self.setClasses();\r\n      }\r\n    });\r\n\r\n    container.on('query', function (params) {\r\n      self.hideMessages();\r\n      self.showLoading(params);\r\n    });\r\n\r\n    container.on('select', function () {\r\n      if (!container.isOpen()) {\r\n        return;\r\n      }\r\n\r\n      self.setClasses();\r\n      self.highlightFirstItem();\r\n    });\r\n\r\n    container.on('unselect', function () {\r\n      if (!container.isOpen()) {\r\n        return;\r\n      }\r\n\r\n      self.setClasses();\r\n      self.highlightFirstItem();\r\n    });\r\n\r\n    container.on('open', function () {\r\n      // When the dropdown is open, aria-expended=\"true\"\r\n      self.$results.attr('aria-expanded', 'true');\r\n      self.$results.attr('aria-hidden', 'false');\r\n\r\n      self.setClasses();\r\n      self.ensureHighlightVisible();\r\n    });\r\n\r\n    container.on('close', function () {\r\n      // When the dropdown is closed, aria-expended=\"false\"\r\n      self.$results.attr('aria-expanded', 'false');\r\n      self.$results.attr('aria-hidden', 'true');\r\n      self.$results.removeAttr('aria-activedescendant');\r\n    });\r\n\r\n    container.on('results:toggle', function () {\r\n      var $highlighted = self.getHighlightedResults();\r\n\r\n      if ($highlighted.length === 0) {\r\n        return;\r\n      }\r\n\r\n      $highlighted.trigger('mouseup');\r\n    });\r\n\r\n    container.on('results:select', function () {\r\n      var $highlighted = self.getHighlightedResults();\r\n\r\n      if ($highlighted.length === 0) {\r\n        return;\r\n      }\r\n\r\n      var data = $highlighted.data('data');\r\n\r\n      if ($highlighted.attr('aria-selected') == 'true') {\r\n        self.trigger('close', {});\r\n      } else {\r\n        self.trigger('select', {\r\n          data: data\r\n        });\r\n      }\r\n    });\r\n\r\n    container.on('results:previous', function () {\r\n      var $highlighted = self.getHighlightedResults();\r\n\r\n      var $options = self.$results.find('[aria-selected]');\r\n\r\n      var currentIndex = $options.index($highlighted);\r\n\r\n      // If we are already at te top, don't move further\r\n      if (currentIndex === 0) {\r\n        return;\r\n      }\r\n\r\n      var nextIndex = currentIndex - 1;\r\n\r\n      // If none are highlighted, highlight the first\r\n      if ($highlighted.length === 0) {\r\n        nextIndex = 0;\r\n      }\r\n\r\n      var $next = $options.eq(nextIndex);\r\n\r\n      $next.trigger('mouseenter');\r\n\r\n      var currentOffset = self.$results.offset().top;\r\n      var nextTop = $next.offset().top;\r\n      var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);\r\n\r\n      if (nextIndex === 0) {\r\n        self.$results.scrollTop(0);\r\n      } else if (nextTop - currentOffset < 0) {\r\n        self.$results.scrollTop(nextOffset);\r\n      }\r\n    });\r\n\r\n    container.on('results:next', function () {\r\n      var $highlighted = self.getHighlightedResults();\r\n\r\n      var $options = self.$results.find('[aria-selected]');\r\n\r\n      var currentIndex = $options.index($highlighted);\r\n\r\n      var nextIndex = currentIndex + 1;\r\n\r\n      // If we are at the last option, stay there\r\n      if (nextIndex >= $options.length) {\r\n        return;\r\n      }\r\n\r\n      var $next = $options.eq(nextIndex);\r\n\r\n      $next.trigger('mouseenter');\r\n\r\n      var currentOffset = self.$results.offset().top +\r\n        self.$results.outerHeight(false);\r\n      var nextBottom = $next.offset().top + $next.outerHeight(false);\r\n      var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;\r\n\r\n      if (nextIndex === 0) {\r\n        self.$results.scrollTop(0);\r\n      } else if (nextBottom > currentOffset) {\r\n        self.$results.scrollTop(nextOffset);\r\n      }\r\n    });\r\n\r\n    container.on('results:focus', function (params) {\r\n      params.element.addClass('select2-results__option--highlighted');\r\n    });\r\n\r\n    container.on('results:message', function (params) {\r\n      self.displayMessage(params);\r\n    });\r\n\r\n    if ($.fn.mousewheel) {\r\n      this.$results.on('mousewheel', function (e) {\r\n        var top = self.$results.scrollTop();\r\n\r\n        var bottom = self.$results.get(0).scrollHeight - top + e.deltaY;\r\n\r\n        var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;\r\n        var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();\r\n\r\n        if (isAtTop) {\r\n          self.$results.scrollTop(0);\r\n\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        } else if (isAtBottom) {\r\n          self.$results.scrollTop(\r\n            self.$results.get(0).scrollHeight - self.$results.height()\r\n          );\r\n\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        }\r\n      });\r\n    }\r\n\r\n    this.$results.on('mouseup', '.select2-results__option[aria-selected]',\r\n      function (evt) {\r\n      var $this = $(this);\r\n\r\n      var data = $this.data('data');\r\n\r\n      if ($this.attr('aria-selected') === 'true') {\r\n        if (self.options.get('multiple')) {\r\n          self.trigger('unselect', {\r\n            originalEvent: evt,\r\n            data: data\r\n          });\r\n        } else {\r\n          self.trigger('close', {});\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      self.trigger('select', {\r\n        originalEvent: evt,\r\n        data: data\r\n      });\r\n    });\r\n\r\n    this.$results.on('mouseenter', '.select2-results__option[aria-selected]',\r\n      function (evt) {\r\n      var data = $(this).data('data');\r\n\r\n      self.getHighlightedResults()\r\n          .removeClass('select2-results__option--highlighted');\r\n\r\n      self.trigger('results:focus', {\r\n        data: data,\r\n        element: $(this)\r\n      });\r\n    });\r\n  };\r\n\r\n  Results.prototype.getHighlightedResults = function () {\r\n    var $highlighted = this.$results\r\n    .find('.select2-results__option--highlighted');\r\n\r\n    return $highlighted;\r\n  };\r\n\r\n  Results.prototype.destroy = function () {\r\n    this.$results.remove();\r\n  };\r\n\r\n  Results.prototype.ensureHighlightVisible = function () {\r\n    var $highlighted = this.getHighlightedResults();\r\n\r\n    if ($highlighted.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var $options = this.$results.find('[aria-selected]');\r\n\r\n    var currentIndex = $options.index($highlighted);\r\n\r\n    var currentOffset = this.$results.offset().top;\r\n    var nextTop = $highlighted.offset().top;\r\n    var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);\r\n\r\n    var offsetDelta = nextTop - currentOffset;\r\n    nextOffset -= $highlighted.outerHeight(false) * 2;\r\n\r\n    if (currentIndex <= 2) {\r\n      this.$results.scrollTop(0);\r\n    } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {\r\n      this.$results.scrollTop(nextOffset);\r\n    }\r\n  };\r\n\r\n  Results.prototype.template = function (result, container) {\r\n    var template = this.options.get('templateResult');\r\n    var escapeMarkup = this.options.get('escapeMarkup');\r\n\r\n    var content = template(result, container);\r\n\r\n    if (content == null) {\r\n      container.style.display = 'none';\r\n    } else if (typeof content === 'string') {\r\n      container.innerHTML = escapeMarkup(content);\r\n    } else {\r\n      $(container).append(content);\r\n    }\r\n  };\r\n\r\n  return Results;\r\n});\r\n\nS2.define('select2/keys',[\r\n\r\n], function () {\r\n  var KEYS = {\r\n    BACKSPACE: 8,\r\n    TAB: 9,\r\n    ENTER: 13,\r\n    SHIFT: 16,\r\n    CTRL: 17,\r\n    ALT: 18,\r\n    ESC: 27,\r\n    SPACE: 32,\r\n    PAGE_UP: 33,\r\n    PAGE_DOWN: 34,\r\n    END: 35,\r\n    HOME: 36,\r\n    LEFT: 37,\r\n    UP: 38,\r\n    RIGHT: 39,\r\n    DOWN: 40,\r\n    DELETE: 46\r\n  };\r\n\r\n  return KEYS;\r\n});\r\n\nS2.define('select2/selection/base',[\r\n  'jquery',\r\n  '../utils',\r\n  '../keys'\r\n], function ($, Utils, KEYS) {\r\n  function BaseSelection ($element, options) {\r\n    this.$element = $element;\r\n    this.options = options;\r\n\r\n    BaseSelection.__super__.constructor.call(this);\r\n  }\r\n\r\n  Utils.Extend(BaseSelection, Utils.Observable);\r\n\r\n  BaseSelection.prototype.render = function () {\r\n    var $selection = $(\r\n      '<span class=\"select2-selection\" role=\"combobox\" ' +\r\n      ' aria-haspopup=\"true\" aria-expanded=\"false\">' +\r\n      '</span>'\r\n    );\r\n\r\n    this._tabindex = 0;\r\n\r\n    if (this.$element.data('old-tabindex') != null) {\r\n      this._tabindex = this.$element.data('old-tabindex');\r\n    } else if (this.$element.attr('tabindex') != null) {\r\n      this._tabindex = this.$element.attr('tabindex');\r\n    }\r\n\r\n    $selection.attr('title', this.$element.attr('title'));\r\n    $selection.attr('tabindex', this._tabindex);\r\n\r\n    this.$selection = $selection;\r\n\r\n    return $selection;\r\n  };\r\n\r\n  BaseSelection.prototype.bind = function (container, $container) {\r\n    var self = this;\r\n\r\n    var id = container.id + '-container';\r\n    var resultsId = container.id + '-results';\r\n\r\n    this.container = container;\r\n\r\n    this.$selection.on('focus', function (evt) {\r\n      self.trigger('focus', evt);\r\n    });\r\n\r\n    this.$selection.on('blur', function (evt) {\r\n      self._handleBlur(evt);\r\n    });\r\n\r\n    this.$selection.on('keydown', function (evt) {\r\n      self.trigger('keypress', evt);\r\n\r\n      if (evt.which === KEYS.SPACE) {\r\n        evt.preventDefault();\r\n      }\r\n    });\r\n\r\n    container.on('results:focus', function (params) {\r\n      self.$selection.attr('aria-activedescendant', params.data._resultId);\r\n    });\r\n\r\n    container.on('selection:update', function (params) {\r\n      self.update(params.data);\r\n    });\r\n\r\n    container.on('open', function () {\r\n      // When the dropdown is open, aria-expanded=\"true\"\r\n      self.$selection.attr('aria-expanded', 'true');\r\n      self.$selection.attr('aria-owns', resultsId);\r\n\r\n      self._attachCloseHandler(container);\r\n    });\r\n\r\n    container.on('close', function () {\r\n      // When the dropdown is closed, aria-expanded=\"false\"\r\n      self.$selection.attr('aria-expanded', 'false');\r\n      self.$selection.removeAttr('aria-activedescendant');\r\n      self.$selection.removeAttr('aria-owns');\r\n\r\n      self.$selection.focus();\r\n\r\n      self._detachCloseHandler(container);\r\n    });\r\n\r\n    container.on('enable', function () {\r\n      self.$selection.attr('tabindex', self._tabindex);\r\n    });\r\n\r\n    container.on('disable', function () {\r\n      self.$selection.attr('tabindex', '-1');\r\n    });\r\n  };\r\n\r\n  BaseSelection.prototype._handleBlur = function (evt) {\r\n    var self = this;\r\n\r\n    // This needs to be delayed as the active element is the body when the tab\r\n    // key is pressed, possibly along with others.\r\n    window.setTimeout(function () {\r\n      // Don't trigger `blur` if the focus is still in the selection\r\n      if (\r\n        (document.activeElement == self.$selection[0]) ||\r\n        ($.contains(self.$selection[0], document.activeElement))\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      self.trigger('blur', evt);\r\n    }, 1);\r\n  };\r\n\r\n  BaseSelection.prototype._attachCloseHandler = function (container) {\r\n    var self = this;\r\n\r\n    $(document.body).on('mousedown.select2.' + container.id, function (e) {\r\n      var $target = $(e.target);\r\n\r\n      var $select = $target.closest('.select2');\r\n\r\n      var $all = $('.select2.select2-container--open');\r\n\r\n      $all.each(function () {\r\n        var $this = $(this);\r\n\r\n        if (this == $select[0]) {\r\n          return;\r\n        }\r\n\r\n        var $element = $this.data('element');\r\n\r\n        $element.select2('close');\r\n      });\r\n    });\r\n  };\r\n\r\n  BaseSelection.prototype._detachCloseHandler = function (container) {\r\n    $(document.body).off('mousedown.select2.' + container.id);\r\n  };\r\n\r\n  BaseSelection.prototype.position = function ($selection, $container) {\r\n    var $selectionContainer = $container.find('.selection');\r\n    $selectionContainer.append($selection);\r\n  };\r\n\r\n  BaseSelection.prototype.destroy = function () {\r\n    this._detachCloseHandler(this.container);\r\n  };\r\n\r\n  BaseSelection.prototype.update = function (data) {\r\n    throw new Error('The `update` method must be defined in child classes.');\r\n  };\r\n\r\n  return BaseSelection;\r\n});\r\n\nS2.define('select2/selection/single',[\r\n  'jquery',\r\n  './base',\r\n  '../utils',\r\n  '../keys'\r\n], function ($, BaseSelection, Utils, KEYS) {\r\n  function SingleSelection () {\r\n    SingleSelection.__super__.constructor.apply(this, arguments);\r\n  }\r\n\r\n  Utils.Extend(SingleSelection, BaseSelection);\r\n\r\n  SingleSelection.prototype.render = function () {\r\n    var $selection = SingleSelection.__super__.render.call(this);\r\n\r\n    $selection.addClass('select2-selection--single');\r\n\r\n    $selection.html(\r\n      '<span class=\"select2-selection__rendered\"></span>' +\r\n      '<span class=\"select2-selection__arrow\" role=\"presentation\">' +\r\n        '<b role=\"presentation\"></b>' +\r\n      '</span>'\r\n    );\r\n\r\n    return $selection;\r\n  };\r\n\r\n  SingleSelection.prototype.bind = function (container, $container) {\r\n    var self = this;\r\n\r\n    SingleSelection.__super__.bind.apply(this, arguments);\r\n\r\n    var id = container.id + '-container';\r\n\r\n    this.$selection.find('.select2-selection__rendered').attr('id', id);\r\n    this.$selection.attr('aria-labelledby', id);\r\n\r\n    this.$selection.on('mousedown', function (evt) {\r\n      // Only respond to left clicks\r\n      if (evt.which !== 1) {\r\n        return;\r\n      }\r\n\r\n      self.trigger('toggle', {\r\n        originalEvent: evt\r\n      });\r\n    });\r\n\r\n    this.$selection.on('focus', function (evt) {\r\n      // User focuses on the container\r\n    });\r\n\r\n    this.$selection.on('blur', function (evt) {\r\n      // User exits the container\r\n    });\r\n\r\n    container.on('focus', function (evt) {\r\n      if (!container.isOpen()) {\r\n        self.$selection.focus();\r\n      }\r\n    });\r\n\r\n    container.on('selection:update', function (params) {\r\n      self.update(params.data);\r\n    });\r\n  };\r\n\r\n  SingleSelection.prototype.clear = function () {\r\n    this.$selection.find('.select2-selection__rendered').empty();\r\n  };\r\n\r\n  SingleSelection.prototype.display = function (data, container) {\r\n    var template = this.options.get('templateSelection');\r\n    var escapeMarkup = this.options.get('escapeMarkup');\r\n\r\n    return escapeMarkup(template(data, container));\r\n  };\r\n\r\n  SingleSelection.prototype.selectionContainer = function () {\r\n    return $('<span></span>');\r\n  };\r\n\r\n  SingleSelection.prototype.update = function (data) {\r\n    if (data.length === 0) {\r\n      this.clear();\r\n      return;\r\n    }\r\n\r\n    var selection = data[0];\r\n\r\n    var $rendered = this.$selection.find('.select2-selection__rendered');\r\n    var formatted = this.display(selection, $rendered);\r\n\r\n    $rendered.empty().append(formatted);\r\n    $rendered.prop('title', selection.title || selection.text);\r\n  };\r\n\r\n  return SingleSelection;\r\n});\r\n\nS2.define('select2/selection/multiple',[\r\n  'jquery',\r\n  './base',\r\n  '../utils'\r\n], function ($, BaseSelection, Utils) {\r\n  function MultipleSelection ($element, options) {\r\n    MultipleSelection.__super__.constructor.apply(this, arguments);\r\n  }\r\n\r\n  Utils.Extend(MultipleSelection, BaseSelection);\r\n\r\n  MultipleSelection.prototype.render = function () {\r\n    var $selection = MultipleSelection.__super__.render.call(this);\r\n\r\n    $selection.addClass('select2-selection--multiple');\r\n\r\n    $selection.html(\r\n      '<ul class=\"select2-selection__rendered\"></ul>'\r\n    );\r\n\r\n    return $selection;\r\n  };\r\n\r\n  MultipleSelection.prototype.bind = function (container, $container) {\r\n    var self = this;\r\n\r\n    MultipleSelection.__super__.bind.apply(this, arguments);\r\n\r\n    this.$selection.on('click', function (evt) {\r\n      self.trigger('toggle', {\r\n        originalEvent: evt\r\n      });\r\n    });\r\n\r\n    this.$selection.on(\r\n      'click',\r\n      '.select2-selection__choice__remove',\r\n      function (evt) {\r\n        // Ignore the event if it is disabled\r\n        if (self.options.get('disabled')) {\r\n          return;\r\n        }\r\n\r\n        var $remove = $(this);\r\n        var $selection = $remove.parent();\r\n\r\n        var data = $selection.data('data');\r\n\r\n        self.trigger('unselect', {\r\n          originalEvent: evt,\r\n          data: data\r\n        });\r\n      }\r\n    );\r\n  };\r\n\r\n  MultipleSelection.prototype.clear = function () {\r\n    this.$selection.find('.select2-selection__rendered').empty();\r\n  };\r\n\r\n  MultipleSelection.prototype.display = function (data, container) {\r\n    var template = this.options.get('templateSelection');\r\n    var escapeMarkup = this.options.get('escapeMarkup');\r\n\r\n    return escapeMarkup(template(data, container));\r\n  };\r\n\r\n  MultipleSelection.prototype.selectionContainer = function () {\r\n    var $container = $(\r\n      '<li class=\"select2-selection__choice\">' +\r\n        '<span class=\"select2-selection__choice__remove\" role=\"presentation\">' +\r\n          '&times;' +\r\n        '</span>' +\r\n      '</li>'\r\n    );\r\n\r\n    return $container;\r\n  };\r\n\r\n  MultipleSelection.prototype.update = function (data) {\r\n    this.clear();\r\n\r\n    if (data.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var $selections = [];\r\n\r\n    for (var d = 0; d < data.length; d++) {\r\n      var selection = data[d];\r\n\r\n      var $selection = this.selectionContainer();\r\n      var formatted = this.display(selection, $selection);\r\n\r\n      $selection.append(formatted);\r\n      $selection.prop('title', selection.title || selection.text);\r\n\r\n      $selection.data('data', selection);\r\n\r\n      $selections.push($selection);\r\n    }\r\n\r\n    var $rendered = this.$selection.find('.select2-selection__rendered');\r\n\r\n    Utils.appendMany($rendered, $selections);\r\n  };\r\n\r\n  return MultipleSelection;\r\n});\r\n\nS2.define('select2/selection/placeholder',[\r\n  '../utils'\r\n], function (Utils) {\r\n  function Placeholder (decorated, $element, options) {\r\n    this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\r\n\r\n    decorated.call(this, $element, options);\r\n  }\r\n\r\n  Placeholder.prototype.normalizePlaceholder = function (_, placeholder) {\r\n    if (typeof placeholder === 'string') {\r\n      placeholder = {\r\n        id: '',\r\n        text: placeholder\r\n      };\r\n    }\r\n\r\n    return placeholder;\r\n  };\r\n\r\n  Placeholder.prototype.createPlaceholder = function (decorated, placeholder) {\r\n    var $placeholder = this.selectionContainer();\r\n\r\n    $placeholder.html(this.display(placeholder));\r\n    $placeholder.addClass('select2-selection__placeholder')\r\n                .removeClass('select2-selection__choice');\r\n\r\n    return $placeholder;\r\n  };\r\n\r\n  Placeholder.prototype.update = function (decorated, data) {\r\n    var singlePlaceholder = (\r\n      data.length == 1 && data[0].id != this.placeholder.id\r\n    );\r\n    var multipleSelections = data.length > 1;\r\n\r\n    if (multipleSelections || singlePlaceholder) {\r\n      return decorated.call(this, data);\r\n    }\r\n\r\n    this.clear();\r\n\r\n    var $placeholder = this.createPlaceholder(this.placeholder);\r\n\r\n    this.$selection.find('.select2-selection__rendered').append($placeholder);\r\n  };\r\n\r\n  return Placeholder;\r\n});\r\n\nS2.define('select2/selection/allowClear',[\r\n  'jquery',\r\n  '../keys'\r\n], function ($, KEYS) {\r\n  function AllowClear () { }\r\n\r\n  AllowClear.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    if (this.placeholder == null) {\r\n      if (this.options.get('debug') && window.console && console.error) {\r\n        console.error(\r\n          'Select2: The `allowClear` option should be used in combination ' +\r\n          'with the `placeholder` option.'\r\n        );\r\n      }\r\n    }\r\n\r\n    this.$selection.on('mousedown', '.select2-selection__clear',\r\n      function (evt) {\r\n        self._handleClear(evt);\r\n    });\r\n\r\n    container.on('keypress', function (evt) {\r\n      self._handleKeyboardClear(evt, container);\r\n    });\r\n  };\r\n\r\n  AllowClear.prototype._handleClear = function (_, evt) {\r\n    // Ignore the event if it is disabled\r\n    if (this.options.get('disabled')) {\r\n      return;\r\n    }\r\n\r\n    var $clear = this.$selection.find('.select2-selection__clear');\r\n\r\n    // Ignore the event if nothing has been selected\r\n    if ($clear.length === 0) {\r\n      return;\r\n    }\r\n\r\n    evt.stopPropagation();\r\n\r\n    var data = $clear.data('data');\r\n\r\n    for (var d = 0; d < data.length; d++) {\r\n      var unselectData = {\r\n        data: data[d]\r\n      };\r\n\r\n      // Trigger the `unselect` event, so people can prevent it from being\r\n      // cleared.\r\n      this.trigger('unselect', unselectData);\r\n\r\n      // If the event was prevented, don't clear it out.\r\n      if (unselectData.prevented) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.$element.val(this.placeholder.id).trigger('change');\r\n\r\n    this.trigger('toggle', {});\r\n  };\r\n\r\n  AllowClear.prototype._handleKeyboardClear = function (_, evt, container) {\r\n    if (container.isOpen()) {\r\n      return;\r\n    }\r\n\r\n    if (evt.which == KEYS.DELETE || evt.which == KEYS.BACKSPACE) {\r\n      this._handleClear(evt);\r\n    }\r\n  };\r\n\r\n  AllowClear.prototype.update = function (decorated, data) {\r\n    decorated.call(this, data);\r\n\r\n    if (this.$selection.find('.select2-selection__placeholder').length > 0 ||\r\n        data.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var $remove = $(\r\n      '<span class=\"select2-selection__clear\">' +\r\n        '&times;' +\r\n      '</span>'\r\n    );\r\n    $remove.data('data', data);\r\n\r\n    this.$selection.find('.select2-selection__rendered').prepend($remove);\r\n  };\r\n\r\n  return AllowClear;\r\n});\r\n\nS2.define('select2/selection/search',[\r\n  'jquery',\r\n  '../utils',\r\n  '../keys'\r\n], function ($, Utils, KEYS) {\r\n  function Search (decorated, $element, options) {\r\n    decorated.call(this, $element, options);\r\n  }\r\n\r\n  Search.prototype.render = function (decorated) {\r\n    var $search = $(\r\n      '<li class=\"select2-search select2-search--inline\">' +\r\n        '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\r\n        ' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\"' +\r\n        ' spellcheck=\"false\" role=\"textbox\" aria-autocomplete=\"list\" />' +\r\n      '</li>'\r\n    );\r\n\r\n    this.$searchContainer = $search;\r\n    this.$search = $search.find('input');\r\n\r\n    var $rendered = decorated.call(this);\r\n\r\n    this._transferTabIndex();\r\n\r\n    return $rendered;\r\n  };\r\n\r\n  Search.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('open', function () {\r\n      self.$search.trigger('focus');\r\n    });\r\n\r\n    container.on('close', function () {\r\n      self.$search.val('');\r\n      self.$search.removeAttr('aria-activedescendant');\r\n      self.$search.trigger('focus');\r\n    });\r\n\r\n    container.on('enable', function () {\r\n      self.$search.prop('disabled', false);\r\n\r\n      self._transferTabIndex();\r\n    });\r\n\r\n    container.on('disable', function () {\r\n      self.$search.prop('disabled', true);\r\n    });\r\n\r\n    container.on('focus', function (evt) {\r\n      self.$search.trigger('focus');\r\n    });\r\n\r\n    container.on('results:focus', function (params) {\r\n      self.$search.attr('aria-activedescendant', params.id);\r\n    });\r\n\r\n    this.$selection.on('focusin', '.select2-search--inline', function (evt) {\r\n      self.trigger('focus', evt);\r\n    });\r\n\r\n    this.$selection.on('focusout', '.select2-search--inline', function (evt) {\r\n      self._handleBlur(evt);\r\n    });\r\n\r\n    this.$selection.on('keydown', '.select2-search--inline', function (evt) {\r\n      evt.stopPropagation();\r\n\r\n      self.trigger('keypress', evt);\r\n\r\n      self._keyUpPrevented = evt.isDefaultPrevented();\r\n\r\n      var key = evt.which;\r\n\r\n      if (key === KEYS.BACKSPACE && self.$search.val() === '') {\r\n        var $previousChoice = self.$searchContainer\r\n          .prev('.select2-selection__choice');\r\n\r\n        if ($previousChoice.length > 0) {\r\n          var item = $previousChoice.data('data');\r\n\r\n          self.searchRemoveChoice(item);\r\n\r\n          evt.preventDefault();\r\n        }\r\n      }\r\n    });\r\n\r\n    // Try to detect the IE version should the `documentMode` property that\r\n    // is stored on the document. This is only implemented in IE and is\r\n    // slightly cleaner than doing a user agent check.\r\n    // This property is not available in Edge, but Edge also doesn't have\r\n    // this bug.\r\n    var msie = document.documentMode;\r\n    var disableInputEvents = msie && msie <= 11;\r\n\r\n    // Workaround for browsers which do not support the `input` event\r\n    // This will prevent double-triggering of events for browsers which support\r\n    // both the `keyup` and `input` events.\r\n    this.$selection.on(\r\n      'input.searchcheck',\r\n      '.select2-search--inline',\r\n      function (evt) {\r\n        // IE will trigger the `input` event when a placeholder is used on a\r\n        // search box. To get around this issue, we are forced to ignore all\r\n        // `input` events in IE and keep using `keyup`.\r\n        if (disableInputEvents) {\r\n          self.$selection.off('input.search input.searchcheck');\r\n          return;\r\n        }\r\n\r\n        // Unbind the duplicated `keyup` event\r\n        self.$selection.off('keyup.search');\r\n      }\r\n    );\r\n\r\n    this.$selection.on(\r\n      'keyup.search input.search',\r\n      '.select2-search--inline',\r\n      function (evt) {\r\n        // IE will trigger the `input` event when a placeholder is used on a\r\n        // search box. To get around this issue, we are forced to ignore all\r\n        // `input` events in IE and keep using `keyup`.\r\n        if (disableInputEvents && evt.type === 'input') {\r\n          self.$selection.off('input.search input.searchcheck');\r\n          return;\r\n        }\r\n\r\n        var key = evt.which;\r\n\r\n        // We can freely ignore events from modifier keys\r\n        if (key == KEYS.SHIFT || key == KEYS.CTRL || key == KEYS.ALT) {\r\n          return;\r\n        }\r\n\r\n        // Tabbing will be handled during the `keydown` phase\r\n        if (key == KEYS.TAB) {\r\n          return;\r\n        }\r\n\r\n        self.handleSearch(evt);\r\n      }\r\n    );\r\n  };\r\n\r\n  /**\r\n   * This method will transfer the tabindex attribute from the rendered\r\n   * selection to the search box. This allows for the search box to be used as\r\n   * the primary focus instead of the selection container.\r\n   *\r\n   * @private\r\n   */\r\n  Search.prototype._transferTabIndex = function (decorated) {\r\n    this.$search.attr('tabindex', this.$selection.attr('tabindex'));\r\n    this.$selection.attr('tabindex', '-1');\r\n  };\r\n\r\n  Search.prototype.createPlaceholder = function (decorated, placeholder) {\r\n    this.$search.attr('placeholder', placeholder.text);\r\n  };\r\n\r\n  Search.prototype.update = function (decorated, data) {\r\n    var searchHadFocus = this.$search[0] == document.activeElement;\r\n\r\n    this.$search.attr('placeholder', '');\r\n\r\n    decorated.call(this, data);\r\n\r\n    this.$selection.find('.select2-selection__rendered')\r\n                   .append(this.$searchContainer);\r\n\r\n    this.resizeSearch();\r\n    if (searchHadFocus) {\r\n      this.$search.focus();\r\n    }\r\n  };\r\n\r\n  Search.prototype.handleSearch = function () {\r\n    this.resizeSearch();\r\n\r\n    if (!this._keyUpPrevented) {\r\n      var input = this.$search.val();\r\n\r\n      this.trigger('query', {\r\n        term: input\r\n      });\r\n    }\r\n\r\n    this._keyUpPrevented = false;\r\n  };\r\n\r\n  Search.prototype.searchRemoveChoice = function (decorated, item) {\r\n    this.trigger('unselect', {\r\n      data: item\r\n    });\r\n\r\n    this.$search.val(item.text);\r\n    this.handleSearch();\r\n  };\r\n\r\n  Search.prototype.resizeSearch = function () {\r\n    this.$search.css('width', '25px');\r\n\r\n    var width = '';\r\n\r\n    if (this.$search.attr('placeholder') !== '') {\r\n      width = this.$selection.find('.select2-selection__rendered').innerWidth();\r\n    } else {\r\n      var minimumWidth = this.$search.val().length + 1;\r\n\r\n      width = (minimumWidth * 0.75) + 'em';\r\n    }\r\n\r\n    this.$search.css('width', width);\r\n  };\r\n\r\n  return Search;\r\n});\r\n\nS2.define('select2/selection/eventRelay',[\r\n  'jquery'\r\n], function ($) {\r\n  function EventRelay () { }\r\n\r\n  EventRelay.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n    var relayEvents = [\r\n      'open', 'opening',\r\n      'close', 'closing',\r\n      'select', 'selecting',\r\n      'unselect', 'unselecting'\r\n    ];\r\n\r\n    var preventableEvents = ['opening', 'closing', 'selecting', 'unselecting'];\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('*', function (name, params) {\r\n      // Ignore events that should not be relayed\r\n      if ($.inArray(name, relayEvents) === -1) {\r\n        return;\r\n      }\r\n\r\n      // The parameters should always be an object\r\n      params = params || {};\r\n\r\n      // Generate the jQuery event for the Select2 event\r\n      var evt = $.Event('select2:' + name, {\r\n        params: params\r\n      });\r\n\r\n      self.$element.trigger(evt);\r\n\r\n      // Only handle preventable events if it was one\r\n      if ($.inArray(name, preventableEvents) === -1) {\r\n        return;\r\n      }\r\n\r\n      params.prevented = evt.isDefaultPrevented();\r\n    });\r\n  };\r\n\r\n  return EventRelay;\r\n});\r\n\nS2.define('select2/translation',[\r\n  'jquery',\r\n  'require'\r\n], function ($, require) {\r\n  function Translation (dict) {\r\n    this.dict = dict || {};\r\n  }\r\n\r\n  Translation.prototype.all = function () {\r\n    return this.dict;\r\n  };\r\n\r\n  Translation.prototype.get = function (key) {\r\n    return this.dict[key];\r\n  };\r\n\r\n  Translation.prototype.extend = function (translation) {\r\n    this.dict = $.extend({}, translation.all(), this.dict);\r\n  };\r\n\r\n  // Static functions\r\n\r\n  Translation._cache = {};\r\n\r\n  Translation.loadPath = function (path) {\r\n    if (!(path in Translation._cache)) {\r\n      var translations = require(path);\r\n\r\n      Translation._cache[path] = translations;\r\n    }\r\n\r\n    return new Translation(Translation._cache[path]);\r\n  };\r\n\r\n  return Translation;\r\n});\r\n\nS2.define('select2/diacritics',[\r\n\r\n], function () {\r\n  var diacritics = {\r\n    '\\u24B6': 'A',\r\n    '\\uFF21': 'A',\r\n    '\\u00C0': 'A',\r\n    '\\u00C1': 'A',\r\n    '\\u00C2': 'A',\r\n    '\\u1EA6': 'A',\r\n    '\\u1EA4': 'A',\r\n    '\\u1EAA': 'A',\r\n    '\\u1EA8': 'A',\r\n    '\\u00C3': 'A',\r\n    '\\u0100': 'A',\r\n    '\\u0102': 'A',\r\n    '\\u1EB0': 'A',\r\n    '\\u1EAE': 'A',\r\n    '\\u1EB4': 'A',\r\n    '\\u1EB2': 'A',\r\n    '\\u0226': 'A',\r\n    '\\u01E0': 'A',\r\n    '\\u00C4': 'A',\r\n    '\\u01DE': 'A',\r\n    '\\u1EA2': 'A',\r\n    '\\u00C5': 'A',\r\n    '\\u01FA': 'A',\r\n    '\\u01CD': 'A',\r\n    '\\u0200': 'A',\r\n    '\\u0202': 'A',\r\n    '\\u1EA0': 'A',\r\n    '\\u1EAC': 'A',\r\n    '\\u1EB6': 'A',\r\n    '\\u1E00': 'A',\r\n    '\\u0104': 'A',\r\n    '\\u023A': 'A',\r\n    '\\u2C6F': 'A',\r\n    '\\uA732': 'AA',\r\n    '\\u00C6': 'AE',\r\n    '\\u01FC': 'AE',\r\n    '\\u01E2': 'AE',\r\n    '\\uA734': 'AO',\r\n    '\\uA736': 'AU',\r\n    '\\uA738': 'AV',\r\n    '\\uA73A': 'AV',\r\n    '\\uA73C': 'AY',\r\n    '\\u24B7': 'B',\r\n    '\\uFF22': 'B',\r\n    '\\u1E02': 'B',\r\n    '\\u1E04': 'B',\r\n    '\\u1E06': 'B',\r\n    '\\u0243': 'B',\r\n    '\\u0182': 'B',\r\n    '\\u0181': 'B',\r\n    '\\u24B8': 'C',\r\n    '\\uFF23': 'C',\r\n    '\\u0106': 'C',\r\n    '\\u0108': 'C',\r\n    '\\u010A': 'C',\r\n    '\\u010C': 'C',\r\n    '\\u00C7': 'C',\r\n    '\\u1E08': 'C',\r\n    '\\u0187': 'C',\r\n    '\\u023B': 'C',\r\n    '\\uA73E': 'C',\r\n    '\\u24B9': 'D',\r\n    '\\uFF24': 'D',\r\n    '\\u1E0A': 'D',\r\n    '\\u010E': 'D',\r\n    '\\u1E0C': 'D',\r\n    '\\u1E10': 'D',\r\n    '\\u1E12': 'D',\r\n    '\\u1E0E': 'D',\r\n    '\\u0110': 'D',\r\n    '\\u018B': 'D',\r\n    '\\u018A': 'D',\r\n    '\\u0189': 'D',\r\n    '\\uA779': 'D',\r\n    '\\u01F1': 'DZ',\r\n    '\\u01C4': 'DZ',\r\n    '\\u01F2': 'Dz',\r\n    '\\u01C5': 'Dz',\r\n    '\\u24BA': 'E',\r\n    '\\uFF25': 'E',\r\n    '\\u00C8': 'E',\r\n    '\\u00C9': 'E',\r\n    '\\u00CA': 'E',\r\n    '\\u1EC0': 'E',\r\n    '\\u1EBE': 'E',\r\n    '\\u1EC4': 'E',\r\n    '\\u1EC2': 'E',\r\n    '\\u1EBC': 'E',\r\n    '\\u0112': 'E',\r\n    '\\u1E14': 'E',\r\n    '\\u1E16': 'E',\r\n    '\\u0114': 'E',\r\n    '\\u0116': 'E',\r\n    '\\u00CB': 'E',\r\n    '\\u1EBA': 'E',\r\n    '\\u011A': 'E',\r\n    '\\u0204': 'E',\r\n    '\\u0206': 'E',\r\n    '\\u1EB8': 'E',\r\n    '\\u1EC6': 'E',\r\n    '\\u0228': 'E',\r\n    '\\u1E1C': 'E',\r\n    '\\u0118': 'E',\r\n    '\\u1E18': 'E',\r\n    '\\u1E1A': 'E',\r\n    '\\u0190': 'E',\r\n    '\\u018E': 'E',\r\n    '\\u24BB': 'F',\r\n    '\\uFF26': 'F',\r\n    '\\u1E1E': 'F',\r\n    '\\u0191': 'F',\r\n    '\\uA77B': 'F',\r\n    '\\u24BC': 'G',\r\n    '\\uFF27': 'G',\r\n    '\\u01F4': 'G',\r\n    '\\u011C': 'G',\r\n    '\\u1E20': 'G',\r\n    '\\u011E': 'G',\r\n    '\\u0120': 'G',\r\n    '\\u01E6': 'G',\r\n    '\\u0122': 'G',\r\n    '\\u01E4': 'G',\r\n    '\\u0193': 'G',\r\n    '\\uA7A0': 'G',\r\n    '\\uA77D': 'G',\r\n    '\\uA77E': 'G',\r\n    '\\u24BD': 'H',\r\n    '\\uFF28': 'H',\r\n    '\\u0124': 'H',\r\n    '\\u1E22': 'H',\r\n    '\\u1E26': 'H',\r\n    '\\u021E': 'H',\r\n    '\\u1E24': 'H',\r\n    '\\u1E28': 'H',\r\n    '\\u1E2A': 'H',\r\n    '\\u0126': 'H',\r\n    '\\u2C67': 'H',\r\n    '\\u2C75': 'H',\r\n    '\\uA78D': 'H',\r\n    '\\u24BE': 'I',\r\n    '\\uFF29': 'I',\r\n    '\\u00CC': 'I',\r\n    '\\u00CD': 'I',\r\n    '\\u00CE': 'I',\r\n    '\\u0128': 'I',\r\n    '\\u012A': 'I',\r\n    '\\u012C': 'I',\r\n    '\\u0130': 'I',\r\n    '\\u00CF': 'I',\r\n    '\\u1E2E': 'I',\r\n    '\\u1EC8': 'I',\r\n    '\\u01CF': 'I',\r\n    '\\u0208': 'I',\r\n    '\\u020A': 'I',\r\n    '\\u1ECA': 'I',\r\n    '\\u012E': 'I',\r\n    '\\u1E2C': 'I',\r\n    '\\u0197': 'I',\r\n    '\\u24BF': 'J',\r\n    '\\uFF2A': 'J',\r\n    '\\u0134': 'J',\r\n    '\\u0248': 'J',\r\n    '\\u24C0': 'K',\r\n    '\\uFF2B': 'K',\r\n    '\\u1E30': 'K',\r\n    '\\u01E8': 'K',\r\n    '\\u1E32': 'K',\r\n    '\\u0136': 'K',\r\n    '\\u1E34': 'K',\r\n    '\\u0198': 'K',\r\n    '\\u2C69': 'K',\r\n    '\\uA740': 'K',\r\n    '\\uA742': 'K',\r\n    '\\uA744': 'K',\r\n    '\\uA7A2': 'K',\r\n    '\\u24C1': 'L',\r\n    '\\uFF2C': 'L',\r\n    '\\u013F': 'L',\r\n    '\\u0139': 'L',\r\n    '\\u013D': 'L',\r\n    '\\u1E36': 'L',\r\n    '\\u1E38': 'L',\r\n    '\\u013B': 'L',\r\n    '\\u1E3C': 'L',\r\n    '\\u1E3A': 'L',\r\n    '\\u0141': 'L',\r\n    '\\u023D': 'L',\r\n    '\\u2C62': 'L',\r\n    '\\u2C60': 'L',\r\n    '\\uA748': 'L',\r\n    '\\uA746': 'L',\r\n    '\\uA780': 'L',\r\n    '\\u01C7': 'LJ',\r\n    '\\u01C8': 'Lj',\r\n    '\\u24C2': 'M',\r\n    '\\uFF2D': 'M',\r\n    '\\u1E3E': 'M',\r\n    '\\u1E40': 'M',\r\n    '\\u1E42': 'M',\r\n    '\\u2C6E': 'M',\r\n    '\\u019C': 'M',\r\n    '\\u24C3': 'N',\r\n    '\\uFF2E': 'N',\r\n    '\\u01F8': 'N',\r\n    '\\u0143': 'N',\r\n    '\\u00D1': 'N',\r\n    '\\u1E44': 'N',\r\n    '\\u0147': 'N',\r\n    '\\u1E46': 'N',\r\n    '\\u0145': 'N',\r\n    '\\u1E4A': 'N',\r\n    '\\u1E48': 'N',\r\n    '\\u0220': 'N',\r\n    '\\u019D': 'N',\r\n    '\\uA790': 'N',\r\n    '\\uA7A4': 'N',\r\n    '\\u01CA': 'NJ',\r\n    '\\u01CB': 'Nj',\r\n    '\\u24C4': 'O',\r\n    '\\uFF2F': 'O',\r\n    '\\u00D2': 'O',\r\n    '\\u00D3': 'O',\r\n    '\\u00D4': 'O',\r\n    '\\u1ED2': 'O',\r\n    '\\u1ED0': 'O',\r\n    '\\u1ED6': 'O',\r\n    '\\u1ED4': 'O',\r\n    '\\u00D5': 'O',\r\n    '\\u1E4C': 'O',\r\n    '\\u022C': 'O',\r\n    '\\u1E4E': 'O',\r\n    '\\u014C': 'O',\r\n    '\\u1E50': 'O',\r\n    '\\u1E52': 'O',\r\n    '\\u014E': 'O',\r\n    '\\u022E': 'O',\r\n    '\\u0230': 'O',\r\n    '\\u00D6': 'O',\r\n    '\\u022A': 'O',\r\n    '\\u1ECE': 'O',\r\n    '\\u0150': 'O',\r\n    '\\u01D1': 'O',\r\n    '\\u020C': 'O',\r\n    '\\u020E': 'O',\r\n    '\\u01A0': 'O',\r\n    '\\u1EDC': 'O',\r\n    '\\u1EDA': 'O',\r\n    '\\u1EE0': 'O',\r\n    '\\u1EDE': 'O',\r\n    '\\u1EE2': 'O',\r\n    '\\u1ECC': 'O',\r\n    '\\u1ED8': 'O',\r\n    '\\u01EA': 'O',\r\n    '\\u01EC': 'O',\r\n    '\\u00D8': 'O',\r\n    '\\u01FE': 'O',\r\n    '\\u0186': 'O',\r\n    '\\u019F': 'O',\r\n    '\\uA74A': 'O',\r\n    '\\uA74C': 'O',\r\n    '\\u01A2': 'OI',\r\n    '\\uA74E': 'OO',\r\n    '\\u0222': 'OU',\r\n    '\\u24C5': 'P',\r\n    '\\uFF30': 'P',\r\n    '\\u1E54': 'P',\r\n    '\\u1E56': 'P',\r\n    '\\u01A4': 'P',\r\n    '\\u2C63': 'P',\r\n    '\\uA750': 'P',\r\n    '\\uA752': 'P',\r\n    '\\uA754': 'P',\r\n    '\\u24C6': 'Q',\r\n    '\\uFF31': 'Q',\r\n    '\\uA756': 'Q',\r\n    '\\uA758': 'Q',\r\n    '\\u024A': 'Q',\r\n    '\\u24C7': 'R',\r\n    '\\uFF32': 'R',\r\n    '\\u0154': 'R',\r\n    '\\u1E58': 'R',\r\n    '\\u0158': 'R',\r\n    '\\u0210': 'R',\r\n    '\\u0212': 'R',\r\n    '\\u1E5A': 'R',\r\n    '\\u1E5C': 'R',\r\n    '\\u0156': 'R',\r\n    '\\u1E5E': 'R',\r\n    '\\u024C': 'R',\r\n    '\\u2C64': 'R',\r\n    '\\uA75A': 'R',\r\n    '\\uA7A6': 'R',\r\n    '\\uA782': 'R',\r\n    '\\u24C8': 'S',\r\n    '\\uFF33': 'S',\r\n    '\\u1E9E': 'S',\r\n    '\\u015A': 'S',\r\n    '\\u1E64': 'S',\r\n    '\\u015C': 'S',\r\n    '\\u1E60': 'S',\r\n    '\\u0160': 'S',\r\n    '\\u1E66': 'S',\r\n    '\\u1E62': 'S',\r\n    '\\u1E68': 'S',\r\n    '\\u0218': 'S',\r\n    '\\u015E': 'S',\r\n    '\\u2C7E': 'S',\r\n    '\\uA7A8': 'S',\r\n    '\\uA784': 'S',\r\n    '\\u24C9': 'T',\r\n    '\\uFF34': 'T',\r\n    '\\u1E6A': 'T',\r\n    '\\u0164': 'T',\r\n    '\\u1E6C': 'T',\r\n    '\\u021A': 'T',\r\n    '\\u0162': 'T',\r\n    '\\u1E70': 'T',\r\n    '\\u1E6E': 'T',\r\n    '\\u0166': 'T',\r\n    '\\u01AC': 'T',\r\n    '\\u01AE': 'T',\r\n    '\\u023E': 'T',\r\n    '\\uA786': 'T',\r\n    '\\uA728': 'TZ',\r\n    '\\u24CA': 'U',\r\n    '\\uFF35': 'U',\r\n    '\\u00D9': 'U',\r\n    '\\u00DA': 'U',\r\n    '\\u00DB': 'U',\r\n    '\\u0168': 'U',\r\n    '\\u1E78': 'U',\r\n    '\\u016A': 'U',\r\n    '\\u1E7A': 'U',\r\n    '\\u016C': 'U',\r\n    '\\u00DC': 'U',\r\n    '\\u01DB': 'U',\r\n    '\\u01D7': 'U',\r\n    '\\u01D5': 'U',\r\n    '\\u01D9': 'U',\r\n    '\\u1EE6': 'U',\r\n    '\\u016E': 'U',\r\n    '\\u0170': 'U',\r\n    '\\u01D3': 'U',\r\n    '\\u0214': 'U',\r\n    '\\u0216': 'U',\r\n    '\\u01AF': 'U',\r\n    '\\u1EEA': 'U',\r\n    '\\u1EE8': 'U',\r\n    '\\u1EEE': 'U',\r\n    '\\u1EEC': 'U',\r\n    '\\u1EF0': 'U',\r\n    '\\u1EE4': 'U',\r\n    '\\u1E72': 'U',\r\n    '\\u0172': 'U',\r\n    '\\u1E76': 'U',\r\n    '\\u1E74': 'U',\r\n    '\\u0244': 'U',\r\n    '\\u24CB': 'V',\r\n    '\\uFF36': 'V',\r\n    '\\u1E7C': 'V',\r\n    '\\u1E7E': 'V',\r\n    '\\u01B2': 'V',\r\n    '\\uA75E': 'V',\r\n    '\\u0245': 'V',\r\n    '\\uA760': 'VY',\r\n    '\\u24CC': 'W',\r\n    '\\uFF37': 'W',\r\n    '\\u1E80': 'W',\r\n    '\\u1E82': 'W',\r\n    '\\u0174': 'W',\r\n    '\\u1E86': 'W',\r\n    '\\u1E84': 'W',\r\n    '\\u1E88': 'W',\r\n    '\\u2C72': 'W',\r\n    '\\u24CD': 'X',\r\n    '\\uFF38': 'X',\r\n    '\\u1E8A': 'X',\r\n    '\\u1E8C': 'X',\r\n    '\\u24CE': 'Y',\r\n    '\\uFF39': 'Y',\r\n    '\\u1EF2': 'Y',\r\n    '\\u00DD': 'Y',\r\n    '\\u0176': 'Y',\r\n    '\\u1EF8': 'Y',\r\n    '\\u0232': 'Y',\r\n    '\\u1E8E': 'Y',\r\n    '\\u0178': 'Y',\r\n    '\\u1EF6': 'Y',\r\n    '\\u1EF4': 'Y',\r\n    '\\u01B3': 'Y',\r\n    '\\u024E': 'Y',\r\n    '\\u1EFE': 'Y',\r\n    '\\u24CF': 'Z',\r\n    '\\uFF3A': 'Z',\r\n    '\\u0179': 'Z',\r\n    '\\u1E90': 'Z',\r\n    '\\u017B': 'Z',\r\n    '\\u017D': 'Z',\r\n    '\\u1E92': 'Z',\r\n    '\\u1E94': 'Z',\r\n    '\\u01B5': 'Z',\r\n    '\\u0224': 'Z',\r\n    '\\u2C7F': 'Z',\r\n    '\\u2C6B': 'Z',\r\n    '\\uA762': 'Z',\r\n    '\\u24D0': 'a',\r\n    '\\uFF41': 'a',\r\n    '\\u1E9A': 'a',\r\n    '\\u00E0': 'a',\r\n    '\\u00E1': 'a',\r\n    '\\u00E2': 'a',\r\n    '\\u1EA7': 'a',\r\n    '\\u1EA5': 'a',\r\n    '\\u1EAB': 'a',\r\n    '\\u1EA9': 'a',\r\n    '\\u00E3': 'a',\r\n    '\\u0101': 'a',\r\n    '\\u0103': 'a',\r\n    '\\u1EB1': 'a',\r\n    '\\u1EAF': 'a',\r\n    '\\u1EB5': 'a',\r\n    '\\u1EB3': 'a',\r\n    '\\u0227': 'a',\r\n    '\\u01E1': 'a',\r\n    '\\u00E4': 'a',\r\n    '\\u01DF': 'a',\r\n    '\\u1EA3': 'a',\r\n    '\\u00E5': 'a',\r\n    '\\u01FB': 'a',\r\n    '\\u01CE': 'a',\r\n    '\\u0201': 'a',\r\n    '\\u0203': 'a',\r\n    '\\u1EA1': 'a',\r\n    '\\u1EAD': 'a',\r\n    '\\u1EB7': 'a',\r\n    '\\u1E01': 'a',\r\n    '\\u0105': 'a',\r\n    '\\u2C65': 'a',\r\n    '\\u0250': 'a',\r\n    '\\uA733': 'aa',\r\n    '\\u00E6': 'ae',\r\n    '\\u01FD': 'ae',\r\n    '\\u01E3': 'ae',\r\n    '\\uA735': 'ao',\r\n    '\\uA737': 'au',\r\n    '\\uA739': 'av',\r\n    '\\uA73B': 'av',\r\n    '\\uA73D': 'ay',\r\n    '\\u24D1': 'b',\r\n    '\\uFF42': 'b',\r\n    '\\u1E03': 'b',\r\n    '\\u1E05': 'b',\r\n    '\\u1E07': 'b',\r\n    '\\u0180': 'b',\r\n    '\\u0183': 'b',\r\n    '\\u0253': 'b',\r\n    '\\u24D2': 'c',\r\n    '\\uFF43': 'c',\r\n    '\\u0107': 'c',\r\n    '\\u0109': 'c',\r\n    '\\u010B': 'c',\r\n    '\\u010D': 'c',\r\n    '\\u00E7': 'c',\r\n    '\\u1E09': 'c',\r\n    '\\u0188': 'c',\r\n    '\\u023C': 'c',\r\n    '\\uA73F': 'c',\r\n    '\\u2184': 'c',\r\n    '\\u24D3': 'd',\r\n    '\\uFF44': 'd',\r\n    '\\u1E0B': 'd',\r\n    '\\u010F': 'd',\r\n    '\\u1E0D': 'd',\r\n    '\\u1E11': 'd',\r\n    '\\u1E13': 'd',\r\n    '\\u1E0F': 'd',\r\n    '\\u0111': 'd',\r\n    '\\u018C': 'd',\r\n    '\\u0256': 'd',\r\n    '\\u0257': 'd',\r\n    '\\uA77A': 'd',\r\n    '\\u01F3': 'dz',\r\n    '\\u01C6': 'dz',\r\n    '\\u24D4': 'e',\r\n    '\\uFF45': 'e',\r\n    '\\u00E8': 'e',\r\n    '\\u00E9': 'e',\r\n    '\\u00EA': 'e',\r\n    '\\u1EC1': 'e',\r\n    '\\u1EBF': 'e',\r\n    '\\u1EC5': 'e',\r\n    '\\u1EC3': 'e',\r\n    '\\u1EBD': 'e',\r\n    '\\u0113': 'e',\r\n    '\\u1E15': 'e',\r\n    '\\u1E17': 'e',\r\n    '\\u0115': 'e',\r\n    '\\u0117': 'e',\r\n    '\\u00EB': 'e',\r\n    '\\u1EBB': 'e',\r\n    '\\u011B': 'e',\r\n    '\\u0205': 'e',\r\n    '\\u0207': 'e',\r\n    '\\u1EB9': 'e',\r\n    '\\u1EC7': 'e',\r\n    '\\u0229': 'e',\r\n    '\\u1E1D': 'e',\r\n    '\\u0119': 'e',\r\n    '\\u1E19': 'e',\r\n    '\\u1E1B': 'e',\r\n    '\\u0247': 'e',\r\n    '\\u025B': 'e',\r\n    '\\u01DD': 'e',\r\n    '\\u24D5': 'f',\r\n    '\\uFF46': 'f',\r\n    '\\u1E1F': 'f',\r\n    '\\u0192': 'f',\r\n    '\\uA77C': 'f',\r\n    '\\u24D6': 'g',\r\n    '\\uFF47': 'g',\r\n    '\\u01F5': 'g',\r\n    '\\u011D': 'g',\r\n    '\\u1E21': 'g',\r\n    '\\u011F': 'g',\r\n    '\\u0121': 'g',\r\n    '\\u01E7': 'g',\r\n    '\\u0123': 'g',\r\n    '\\u01E5': 'g',\r\n    '\\u0260': 'g',\r\n    '\\uA7A1': 'g',\r\n    '\\u1D79': 'g',\r\n    '\\uA77F': 'g',\r\n    '\\u24D7': 'h',\r\n    '\\uFF48': 'h',\r\n    '\\u0125': 'h',\r\n    '\\u1E23': 'h',\r\n    '\\u1E27': 'h',\r\n    '\\u021F': 'h',\r\n    '\\u1E25': 'h',\r\n    '\\u1E29': 'h',\r\n    '\\u1E2B': 'h',\r\n    '\\u1E96': 'h',\r\n    '\\u0127': 'h',\r\n    '\\u2C68': 'h',\r\n    '\\u2C76': 'h',\r\n    '\\u0265': 'h',\r\n    '\\u0195': 'hv',\r\n    '\\u24D8': 'i',\r\n    '\\uFF49': 'i',\r\n    '\\u00EC': 'i',\r\n    '\\u00ED': 'i',\r\n    '\\u00EE': 'i',\r\n    '\\u0129': 'i',\r\n    '\\u012B': 'i',\r\n    '\\u012D': 'i',\r\n    '\\u00EF': 'i',\r\n    '\\u1E2F': 'i',\r\n    '\\u1EC9': 'i',\r\n    '\\u01D0': 'i',\r\n    '\\u0209': 'i',\r\n    '\\u020B': 'i',\r\n    '\\u1ECB': 'i',\r\n    '\\u012F': 'i',\r\n    '\\u1E2D': 'i',\r\n    '\\u0268': 'i',\r\n    '\\u0131': 'i',\r\n    '\\u24D9': 'j',\r\n    '\\uFF4A': 'j',\r\n    '\\u0135': 'j',\r\n    '\\u01F0': 'j',\r\n    '\\u0249': 'j',\r\n    '\\u24DA': 'k',\r\n    '\\uFF4B': 'k',\r\n    '\\u1E31': 'k',\r\n    '\\u01E9': 'k',\r\n    '\\u1E33': 'k',\r\n    '\\u0137': 'k',\r\n    '\\u1E35': 'k',\r\n    '\\u0199': 'k',\r\n    '\\u2C6A': 'k',\r\n    '\\uA741': 'k',\r\n    '\\uA743': 'k',\r\n    '\\uA745': 'k',\r\n    '\\uA7A3': 'k',\r\n    '\\u24DB': 'l',\r\n    '\\uFF4C': 'l',\r\n    '\\u0140': 'l',\r\n    '\\u013A': 'l',\r\n    '\\u013E': 'l',\r\n    '\\u1E37': 'l',\r\n    '\\u1E39': 'l',\r\n    '\\u013C': 'l',\r\n    '\\u1E3D': 'l',\r\n    '\\u1E3B': 'l',\r\n    '\\u017F': 'l',\r\n    '\\u0142': 'l',\r\n    '\\u019A': 'l',\r\n    '\\u026B': 'l',\r\n    '\\u2C61': 'l',\r\n    '\\uA749': 'l',\r\n    '\\uA781': 'l',\r\n    '\\uA747': 'l',\r\n    '\\u01C9': 'lj',\r\n    '\\u24DC': 'm',\r\n    '\\uFF4D': 'm',\r\n    '\\u1E3F': 'm',\r\n    '\\u1E41': 'm',\r\n    '\\u1E43': 'm',\r\n    '\\u0271': 'm',\r\n    '\\u026F': 'm',\r\n    '\\u24DD': 'n',\r\n    '\\uFF4E': 'n',\r\n    '\\u01F9': 'n',\r\n    '\\u0144': 'n',\r\n    '\\u00F1': 'n',\r\n    '\\u1E45': 'n',\r\n    '\\u0148': 'n',\r\n    '\\u1E47': 'n',\r\n    '\\u0146': 'n',\r\n    '\\u1E4B': 'n',\r\n    '\\u1E49': 'n',\r\n    '\\u019E': 'n',\r\n    '\\u0272': 'n',\r\n    '\\u0149': 'n',\r\n    '\\uA791': 'n',\r\n    '\\uA7A5': 'n',\r\n    '\\u01CC': 'nj',\r\n    '\\u24DE': 'o',\r\n    '\\uFF4F': 'o',\r\n    '\\u00F2': 'o',\r\n    '\\u00F3': 'o',\r\n    '\\u00F4': 'o',\r\n    '\\u1ED3': 'o',\r\n    '\\u1ED1': 'o',\r\n    '\\u1ED7': 'o',\r\n    '\\u1ED5': 'o',\r\n    '\\u00F5': 'o',\r\n    '\\u1E4D': 'o',\r\n    '\\u022D': 'o',\r\n    '\\u1E4F': 'o',\r\n    '\\u014D': 'o',\r\n    '\\u1E51': 'o',\r\n    '\\u1E53': 'o',\r\n    '\\u014F': 'o',\r\n    '\\u022F': 'o',\r\n    '\\u0231': 'o',\r\n    '\\u00F6': 'o',\r\n    '\\u022B': 'o',\r\n    '\\u1ECF': 'o',\r\n    '\\u0151': 'o',\r\n    '\\u01D2': 'o',\r\n    '\\u020D': 'o',\r\n    '\\u020F': 'o',\r\n    '\\u01A1': 'o',\r\n    '\\u1EDD': 'o',\r\n    '\\u1EDB': 'o',\r\n    '\\u1EE1': 'o',\r\n    '\\u1EDF': 'o',\r\n    '\\u1EE3': 'o',\r\n    '\\u1ECD': 'o',\r\n    '\\u1ED9': 'o',\r\n    '\\u01EB': 'o',\r\n    '\\u01ED': 'o',\r\n    '\\u00F8': 'o',\r\n    '\\u01FF': 'o',\r\n    '\\u0254': 'o',\r\n    '\\uA74B': 'o',\r\n    '\\uA74D': 'o',\r\n    '\\u0275': 'o',\r\n    '\\u01A3': 'oi',\r\n    '\\u0223': 'ou',\r\n    '\\uA74F': 'oo',\r\n    '\\u24DF': 'p',\r\n    '\\uFF50': 'p',\r\n    '\\u1E55': 'p',\r\n    '\\u1E57': 'p',\r\n    '\\u01A5': 'p',\r\n    '\\u1D7D': 'p',\r\n    '\\uA751': 'p',\r\n    '\\uA753': 'p',\r\n    '\\uA755': 'p',\r\n    '\\u24E0': 'q',\r\n    '\\uFF51': 'q',\r\n    '\\u024B': 'q',\r\n    '\\uA757': 'q',\r\n    '\\uA759': 'q',\r\n    '\\u24E1': 'r',\r\n    '\\uFF52': 'r',\r\n    '\\u0155': 'r',\r\n    '\\u1E59': 'r',\r\n    '\\u0159': 'r',\r\n    '\\u0211': 'r',\r\n    '\\u0213': 'r',\r\n    '\\u1E5B': 'r',\r\n    '\\u1E5D': 'r',\r\n    '\\u0157': 'r',\r\n    '\\u1E5F': 'r',\r\n    '\\u024D': 'r',\r\n    '\\u027D': 'r',\r\n    '\\uA75B': 'r',\r\n    '\\uA7A7': 'r',\r\n    '\\uA783': 'r',\r\n    '\\u24E2': 's',\r\n    '\\uFF53': 's',\r\n    '\\u00DF': 's',\r\n    '\\u015B': 's',\r\n    '\\u1E65': 's',\r\n    '\\u015D': 's',\r\n    '\\u1E61': 's',\r\n    '\\u0161': 's',\r\n    '\\u1E67': 's',\r\n    '\\u1E63': 's',\r\n    '\\u1E69': 's',\r\n    '\\u0219': 's',\r\n    '\\u015F': 's',\r\n    '\\u023F': 's',\r\n    '\\uA7A9': 's',\r\n    '\\uA785': 's',\r\n    '\\u1E9B': 's',\r\n    '\\u24E3': 't',\r\n    '\\uFF54': 't',\r\n    '\\u1E6B': 't',\r\n    '\\u1E97': 't',\r\n    '\\u0165': 't',\r\n    '\\u1E6D': 't',\r\n    '\\u021B': 't',\r\n    '\\u0163': 't',\r\n    '\\u1E71': 't',\r\n    '\\u1E6F': 't',\r\n    '\\u0167': 't',\r\n    '\\u01AD': 't',\r\n    '\\u0288': 't',\r\n    '\\u2C66': 't',\r\n    '\\uA787': 't',\r\n    '\\uA729': 'tz',\r\n    '\\u24E4': 'u',\r\n    '\\uFF55': 'u',\r\n    '\\u00F9': 'u',\r\n    '\\u00FA': 'u',\r\n    '\\u00FB': 'u',\r\n    '\\u0169': 'u',\r\n    '\\u1E79': 'u',\r\n    '\\u016B': 'u',\r\n    '\\u1E7B': 'u',\r\n    '\\u016D': 'u',\r\n    '\\u00FC': 'u',\r\n    '\\u01DC': 'u',\r\n    '\\u01D8': 'u',\r\n    '\\u01D6': 'u',\r\n    '\\u01DA': 'u',\r\n    '\\u1EE7': 'u',\r\n    '\\u016F': 'u',\r\n    '\\u0171': 'u',\r\n    '\\u01D4': 'u',\r\n    '\\u0215': 'u',\r\n    '\\u0217': 'u',\r\n    '\\u01B0': 'u',\r\n    '\\u1EEB': 'u',\r\n    '\\u1EE9': 'u',\r\n    '\\u1EEF': 'u',\r\n    '\\u1EED': 'u',\r\n    '\\u1EF1': 'u',\r\n    '\\u1EE5': 'u',\r\n    '\\u1E73': 'u',\r\n    '\\u0173': 'u',\r\n    '\\u1E77': 'u',\r\n    '\\u1E75': 'u',\r\n    '\\u0289': 'u',\r\n    '\\u24E5': 'v',\r\n    '\\uFF56': 'v',\r\n    '\\u1E7D': 'v',\r\n    '\\u1E7F': 'v',\r\n    '\\u028B': 'v',\r\n    '\\uA75F': 'v',\r\n    '\\u028C': 'v',\r\n    '\\uA761': 'vy',\r\n    '\\u24E6': 'w',\r\n    '\\uFF57': 'w',\r\n    '\\u1E81': 'w',\r\n    '\\u1E83': 'w',\r\n    '\\u0175': 'w',\r\n    '\\u1E87': 'w',\r\n    '\\u1E85': 'w',\r\n    '\\u1E98': 'w',\r\n    '\\u1E89': 'w',\r\n    '\\u2C73': 'w',\r\n    '\\u24E7': 'x',\r\n    '\\uFF58': 'x',\r\n    '\\u1E8B': 'x',\r\n    '\\u1E8D': 'x',\r\n    '\\u24E8': 'y',\r\n    '\\uFF59': 'y',\r\n    '\\u1EF3': 'y',\r\n    '\\u00FD': 'y',\r\n    '\\u0177': 'y',\r\n    '\\u1EF9': 'y',\r\n    '\\u0233': 'y',\r\n    '\\u1E8F': 'y',\r\n    '\\u00FF': 'y',\r\n    '\\u1EF7': 'y',\r\n    '\\u1E99': 'y',\r\n    '\\u1EF5': 'y',\r\n    '\\u01B4': 'y',\r\n    '\\u024F': 'y',\r\n    '\\u1EFF': 'y',\r\n    '\\u24E9': 'z',\r\n    '\\uFF5A': 'z',\r\n    '\\u017A': 'z',\r\n    '\\u1E91': 'z',\r\n    '\\u017C': 'z',\r\n    '\\u017E': 'z',\r\n    '\\u1E93': 'z',\r\n    '\\u1E95': 'z',\r\n    '\\u01B6': 'z',\r\n    '\\u0225': 'z',\r\n    '\\u0240': 'z',\r\n    '\\u2C6C': 'z',\r\n    '\\uA763': 'z',\r\n    '\\u0386': '\\u0391',\r\n    '\\u0388': '\\u0395',\r\n    '\\u0389': '\\u0397',\r\n    '\\u038A': '\\u0399',\r\n    '\\u03AA': '\\u0399',\r\n    '\\u038C': '\\u039F',\r\n    '\\u038E': '\\u03A5',\r\n    '\\u03AB': '\\u03A5',\r\n    '\\u038F': '\\u03A9',\r\n    '\\u03AC': '\\u03B1',\r\n    '\\u03AD': '\\u03B5',\r\n    '\\u03AE': '\\u03B7',\r\n    '\\u03AF': '\\u03B9',\r\n    '\\u03CA': '\\u03B9',\r\n    '\\u0390': '\\u03B9',\r\n    '\\u03CC': '\\u03BF',\r\n    '\\u03CD': '\\u03C5',\r\n    '\\u03CB': '\\u03C5',\r\n    '\\u03B0': '\\u03C5',\r\n    '\\u03C9': '\\u03C9',\r\n    '\\u03C2': '\\u03C3'\r\n  };\r\n\r\n  return diacritics;\r\n});\r\n\nS2.define('select2/data/base',[\r\n  '../utils'\r\n], function (Utils) {\r\n  function BaseAdapter ($element, options) {\r\n    BaseAdapter.__super__.constructor.call(this);\r\n  }\r\n\r\n  Utils.Extend(BaseAdapter, Utils.Observable);\r\n\r\n  BaseAdapter.prototype.current = function (callback) {\r\n    throw new Error('The `current` method must be defined in child classes.');\r\n  };\r\n\r\n  BaseAdapter.prototype.query = function (params, callback) {\r\n    throw new Error('The `query` method must be defined in child classes.');\r\n  };\r\n\r\n  BaseAdapter.prototype.bind = function (container, $container) {\r\n    // Can be implemented in subclasses\r\n  };\r\n\r\n  BaseAdapter.prototype.destroy = function () {\r\n    // Can be implemented in subclasses\r\n  };\r\n\r\n  BaseAdapter.prototype.generateResultId = function (container, data) {\r\n    var id = container.id + '-result-';\r\n\r\n    id += Utils.generateChars(4);\r\n\r\n    if (data.id != null) {\r\n      id += '-' + data.id.toString();\r\n    } else {\r\n      id += '-' + Utils.generateChars(4);\r\n    }\r\n    return id;\r\n  };\r\n\r\n  return BaseAdapter;\r\n});\r\n\nS2.define('select2/data/select',[\r\n  './base',\r\n  '../utils',\r\n  'jquery'\r\n], function (BaseAdapter, Utils, $) {\r\n  function SelectAdapter ($element, options) {\r\n    this.$element = $element;\r\n    this.options = options;\r\n\r\n    SelectAdapter.__super__.constructor.call(this);\r\n  }\r\n\r\n  Utils.Extend(SelectAdapter, BaseAdapter);\r\n\r\n  SelectAdapter.prototype.current = function (callback) {\r\n    var data = [];\r\n    var self = this;\r\n\r\n    this.$element.find(':selected').each(function () {\r\n      var $option = $(this);\r\n\r\n      var option = self.item($option);\r\n\r\n      data.push(option);\r\n    });\r\n\r\n    callback(data);\r\n  };\r\n\r\n  SelectAdapter.prototype.select = function (data) {\r\n    var self = this;\r\n\r\n    data.selected = true;\r\n\r\n    // If data.element is a DOM node, use it instead\r\n    if ($(data.element).is('option')) {\r\n      data.element.selected = true;\r\n\r\n      this.$element.trigger('change');\r\n\r\n      return;\r\n    }\r\n\r\n    if (this.$element.prop('multiple')) {\r\n      this.current(function (currentData) {\r\n        var val = [];\r\n\r\n        data = [data];\r\n        data.push.apply(data, currentData);\r\n\r\n        for (var d = 0; d < data.length; d++) {\r\n          var id = data[d].id;\r\n\r\n          if ($.inArray(id, val) === -1) {\r\n            val.push(id);\r\n          }\r\n        }\r\n\r\n        self.$element.val(val);\r\n        self.$element.trigger('change');\r\n      });\r\n    } else {\r\n      var val = data.id;\r\n\r\n      this.$element.val(val);\r\n      this.$element.trigger('change');\r\n    }\r\n  };\r\n\r\n  SelectAdapter.prototype.unselect = function (data) {\r\n    var self = this;\r\n\r\n    if (!this.$element.prop('multiple')) {\r\n      return;\r\n    }\r\n\r\n    data.selected = false;\r\n\r\n    if ($(data.element).is('option')) {\r\n      data.element.selected = false;\r\n\r\n      this.$element.trigger('change');\r\n\r\n      return;\r\n    }\r\n\r\n    this.current(function (currentData) {\r\n      var val = [];\r\n\r\n      for (var d = 0; d < currentData.length; d++) {\r\n        var id = currentData[d].id;\r\n\r\n        if (id !== data.id && $.inArray(id, val) === -1) {\r\n          val.push(id);\r\n        }\r\n      }\r\n\r\n      self.$element.val(val);\r\n\r\n      self.$element.trigger('change');\r\n    });\r\n  };\r\n\r\n  SelectAdapter.prototype.bind = function (container, $container) {\r\n    var self = this;\r\n\r\n    this.container = container;\r\n\r\n    container.on('select', function (params) {\r\n      self.select(params.data);\r\n    });\r\n\r\n    container.on('unselect', function (params) {\r\n      self.unselect(params.data);\r\n    });\r\n  };\r\n\r\n  SelectAdapter.prototype.destroy = function () {\r\n    // Remove anything added to child elements\r\n    this.$element.find('*').each(function () {\r\n      // Remove any custom data set by Select2\r\n      $.removeData(this, 'data');\r\n    });\r\n  };\r\n\r\n  SelectAdapter.prototype.query = function (params, callback) {\r\n    var data = [];\r\n    var self = this;\r\n\r\n    var $options = this.$element.children();\r\n\r\n    $options.each(function () {\r\n      var $option = $(this);\r\n\r\n      if (!$option.is('option') && !$option.is('optgroup')) {\r\n        return;\r\n      }\r\n\r\n      var option = self.item($option);\r\n\r\n      var matches = self.matches(params, option);\r\n\r\n      if (matches !== null) {\r\n        data.push(matches);\r\n      }\r\n    });\r\n\r\n    callback({\r\n      results: data\r\n    });\r\n  };\r\n\r\n  SelectAdapter.prototype.addOptions = function ($options) {\r\n    Utils.appendMany(this.$element, $options);\r\n  };\r\n\r\n  SelectAdapter.prototype.option = function (data) {\r\n    var option;\r\n\r\n    if (data.children) {\r\n      option = document.createElement('optgroup');\r\n      option.label = data.text;\r\n    } else {\r\n      option = document.createElement('option');\r\n\r\n      if (option.textContent !== undefined) {\r\n        option.textContent = data.text;\r\n      } else {\r\n        option.innerText = data.text;\r\n      }\r\n    }\r\n\r\n    if (data.id) {\r\n      option.value = data.id;\r\n    }\r\n\r\n    if (data.disabled) {\r\n      option.disabled = true;\r\n    }\r\n\r\n    if (data.selected) {\r\n      option.selected = true;\r\n    }\r\n\r\n    if (data.title) {\r\n      option.title = data.title;\r\n    }\r\n\r\n    var $option = $(option);\r\n\r\n    var normalizedData = this._normalizeItem(data);\r\n    normalizedData.element = option;\r\n\r\n    // Override the option's data with the combined data\r\n    $.data(option, 'data', normalizedData);\r\n\r\n    return $option;\r\n  };\r\n\r\n  SelectAdapter.prototype.item = function ($option) {\r\n    var data = {};\r\n\r\n    data = $.data($option[0], 'data');\r\n\r\n    if (data != null) {\r\n      return data;\r\n    }\r\n\r\n    if ($option.is('option')) {\r\n      data = {\r\n        id: $option.val(),\r\n        text: $option.text(),\r\n        disabled: $option.prop('disabled'),\r\n        selected: $option.prop('selected'),\r\n        title: $option.prop('title')\r\n      };\r\n    } else if ($option.is('optgroup')) {\r\n      data = {\r\n        text: $option.prop('label'),\r\n        children: [],\r\n        title: $option.prop('title')\r\n      };\r\n\r\n      var $children = $option.children('option');\r\n      var children = [];\r\n\r\n      for (var c = 0; c < $children.length; c++) {\r\n        var $child = $($children[c]);\r\n\r\n        var child = this.item($child);\r\n\r\n        children.push(child);\r\n      }\r\n\r\n      data.children = children;\r\n    }\r\n\r\n    data = this._normalizeItem(data);\r\n    data.element = $option[0];\r\n\r\n    $.data($option[0], 'data', data);\r\n\r\n    return data;\r\n  };\r\n\r\n  SelectAdapter.prototype._normalizeItem = function (item) {\r\n    if (!$.isPlainObject(item)) {\r\n      item = {\r\n        id: item,\r\n        text: item\r\n      };\r\n    }\r\n\r\n    item = $.extend({}, {\r\n      text: ''\r\n    }, item);\r\n\r\n    var defaults = {\r\n      selected: false,\r\n      disabled: false\r\n    };\r\n\r\n    if (item.id != null) {\r\n      item.id = item.id.toString();\r\n    }\r\n\r\n    if (item.text != null) {\r\n      item.text = item.text.toString();\r\n    }\r\n\r\n    if (item._resultId == null && item.id && this.container != null) {\r\n      item._resultId = this.generateResultId(this.container, item);\r\n    }\r\n\r\n    return $.extend({}, defaults, item);\r\n  };\r\n\r\n  SelectAdapter.prototype.matches = function (params, data) {\r\n    var matcher = this.options.get('matcher');\r\n\r\n    return matcher(params, data);\r\n  };\r\n\r\n  return SelectAdapter;\r\n});\r\n\nS2.define('select2/data/array',[\r\n  './select',\r\n  '../utils',\r\n  'jquery'\r\n], function (SelectAdapter, Utils, $) {\r\n  function ArrayAdapter ($element, options) {\r\n    var data = options.get('data') || [];\r\n\r\n    ArrayAdapter.__super__.constructor.call(this, $element, options);\r\n\r\n    this.addOptions(this.convertToOptions(data));\r\n  }\r\n\r\n  Utils.Extend(ArrayAdapter, SelectAdapter);\r\n\r\n  ArrayAdapter.prototype.select = function (data) {\r\n    var $option = this.$element.find('option').filter(function (i, elm) {\r\n      return elm.value == data.id.toString();\r\n    });\r\n\r\n    if ($option.length === 0) {\r\n      $option = this.option(data);\r\n\r\n      this.addOptions($option);\r\n    }\r\n\r\n    ArrayAdapter.__super__.select.call(this, data);\r\n  };\r\n\r\n  ArrayAdapter.prototype.convertToOptions = function (data) {\r\n    var self = this;\r\n\r\n    var $existing = this.$element.find('option');\r\n    var existingIds = $existing.map(function () {\r\n      return self.item($(this)).id;\r\n    }).get();\r\n\r\n    var $options = [];\r\n\r\n    // Filter out all items except for the one passed in the argument\r\n    function onlyItem (item) {\r\n      return function () {\r\n        return $(this).val() == item.id;\r\n      };\r\n    }\r\n\r\n    for (var d = 0; d < data.length; d++) {\r\n      var item = this._normalizeItem(data[d]);\r\n\r\n      // Skip items which were pre-loaded, only merge the data\r\n      if ($.inArray(item.id, existingIds) >= 0) {\r\n        var $existingOption = $existing.filter(onlyItem(item));\r\n\r\n        var existingData = this.item($existingOption);\r\n        var newData = $.extend(true, {}, item, existingData);\r\n\r\n        var $newOption = this.option(newData);\r\n\r\n        $existingOption.replaceWith($newOption);\r\n\r\n        continue;\r\n      }\r\n\r\n      var $option = this.option(item);\r\n\r\n      if (item.children) {\r\n        var $children = this.convertToOptions(item.children);\r\n\r\n        Utils.appendMany($option, $children);\r\n      }\r\n\r\n      $options.push($option);\r\n    }\r\n\r\n    return $options;\r\n  };\r\n\r\n  return ArrayAdapter;\r\n});\r\n\nS2.define('select2/data/ajax',[\r\n  './array',\r\n  '../utils',\r\n  'jquery'\r\n], function (ArrayAdapter, Utils, $) {\r\n  function AjaxAdapter ($element, options) {\r\n    this.ajaxOptions = this._applyDefaults(options.get('ajax'));\r\n\r\n    if (this.ajaxOptions.processResults != null) {\r\n      this.processResults = this.ajaxOptions.processResults;\r\n    }\r\n\r\n    AjaxAdapter.__super__.constructor.call(this, $element, options);\r\n  }\r\n\r\n  Utils.Extend(AjaxAdapter, ArrayAdapter);\r\n\r\n  AjaxAdapter.prototype._applyDefaults = function (options) {\r\n    var defaults = {\r\n      data: function (params) {\r\n        return $.extend({}, params, {\r\n          q: params.term\r\n        });\r\n      },\r\n      transport: function (params, success, failure) {\r\n        var $request = $.ajax(params);\r\n\r\n        $request.then(success);\r\n        $request.fail(failure);\r\n\r\n        return $request;\r\n      }\r\n    };\r\n\r\n    return $.extend({}, defaults, options, true);\r\n  };\r\n\r\n  AjaxAdapter.prototype.processResults = function (results) {\r\n    return results;\r\n  };\r\n\r\n  AjaxAdapter.prototype.query = function (params, callback) {\r\n    var matches = [];\r\n    var self = this;\r\n\r\n    if (this._request != null) {\r\n      // JSONP requests cannot always be aborted\r\n      if ($.isFunction(this._request.abort)) {\r\n        this._request.abort();\r\n      }\r\n\r\n      this._request = null;\r\n    }\r\n\r\n    var options = $.extend({\r\n      type: 'GET'\r\n    }, this.ajaxOptions);\r\n\r\n    if (typeof options.url === 'function') {\r\n      options.url = options.url.call(this.$element, params);\r\n    }\r\n\r\n    if (typeof options.data === 'function') {\r\n      options.data = options.data.call(this.$element, params);\r\n    }\r\n\r\n    function request () {\r\n      var $request = options.transport(options, function (data) {\r\n        var results = self.processResults(data, params);\r\n\r\n        if (self.options.get('debug') && window.console && console.error) {\r\n          // Check to make sure that the response included a `results` key.\r\n          if (!results || !results.results || !$.isArray(results.results)) {\r\n            console.error(\r\n              'Select2: The AJAX results did not return an array in the ' +\r\n              '`results` key of the response.'\r\n            );\r\n          }\r\n        }\r\n\r\n        callback(results);\r\n      }, function () {\r\n        // Attempt to detect if a request was aborted\r\n        // Only works if the transport exposes a status property\r\n        if ($request.status && $request.status === '0') {\r\n          return;\r\n        }\r\n\r\n        self.trigger('results:message', {\r\n          message: 'errorLoading'\r\n        });\r\n      });\r\n\r\n      self._request = $request;\r\n    }\r\n\r\n    if (this.ajaxOptions.delay && params.term != null) {\r\n      if (this._queryTimeout) {\r\n        window.clearTimeout(this._queryTimeout);\r\n      }\r\n\r\n      this._queryTimeout = window.setTimeout(request, this.ajaxOptions.delay);\r\n    } else {\r\n      request();\r\n    }\r\n  };\r\n\r\n  return AjaxAdapter;\r\n});\r\n\nS2.define('select2/data/tags',[\r\n  'jquery'\r\n], function ($) {\r\n  function Tags (decorated, $element, options) {\r\n    var tags = options.get('tags');\r\n\r\n    var createTag = options.get('createTag');\r\n\r\n    if (createTag !== undefined) {\r\n      this.createTag = createTag;\r\n    }\r\n\r\n    var insertTag = options.get('insertTag');\r\n\r\n    if (insertTag !== undefined) {\r\n        this.insertTag = insertTag;\r\n    }\r\n\r\n    decorated.call(this, $element, options);\r\n\r\n    if ($.isArray(tags)) {\r\n      for (var t = 0; t < tags.length; t++) {\r\n        var tag = tags[t];\r\n        var item = this._normalizeItem(tag);\r\n\r\n        var $option = this.option(item);\r\n\r\n        this.$element.append($option);\r\n      }\r\n    }\r\n  }\r\n\r\n  Tags.prototype.query = function (decorated, params, callback) {\r\n    var self = this;\r\n\r\n    this._removeOldTags();\r\n\r\n    if (params.term == null || params.page != null) {\r\n      decorated.call(this, params, callback);\r\n      return;\r\n    }\r\n\r\n    function wrapper (obj, child) {\r\n      var data = obj.results;\r\n\r\n      for (var i = 0; i < data.length; i++) {\r\n        var option = data[i];\r\n\r\n        var checkChildren = (\r\n          option.children != null &&\r\n          !wrapper({\r\n            results: option.children\r\n          }, true)\r\n        );\r\n\r\n        var checkText = option.text === params.term;\r\n\r\n        if (checkText || checkChildren) {\r\n          if (child) {\r\n            return false;\r\n          }\r\n\r\n          obj.data = data;\r\n          callback(obj);\r\n\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (child) {\r\n        return true;\r\n      }\r\n\r\n      var tag = self.createTag(params);\r\n\r\n      if (tag != null) {\r\n        var $option = self.option(tag);\r\n        $option.attr('data-select2-tag', true);\r\n\r\n        self.addOptions([$option]);\r\n\r\n        self.insertTag(data, tag);\r\n      }\r\n\r\n      obj.results = data;\r\n\r\n      callback(obj);\r\n    }\r\n\r\n    decorated.call(this, params, wrapper);\r\n  };\r\n\r\n  Tags.prototype.createTag = function (decorated, params) {\r\n    var term = $.trim(params.term);\r\n\r\n    if (term === '') {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      id: term,\r\n      text: term\r\n    };\r\n  };\r\n\r\n  Tags.prototype.insertTag = function (_, data, tag) {\r\n    data.unshift(tag);\r\n  };\r\n\r\n  Tags.prototype._removeOldTags = function (_) {\r\n    var tag = this._lastTag;\r\n\r\n    var $options = this.$element.find('option[data-select2-tag]');\r\n\r\n    $options.each(function () {\r\n      if (this.selected) {\r\n        return;\r\n      }\r\n\r\n      $(this).remove();\r\n    });\r\n  };\r\n\r\n  return Tags;\r\n});\r\n\nS2.define('select2/data/tokenizer',[\r\n  'jquery'\r\n], function ($) {\r\n  function Tokenizer (decorated, $element, options) {\r\n    var tokenizer = options.get('tokenizer');\r\n\r\n    if (tokenizer !== undefined) {\r\n      this.tokenizer = tokenizer;\r\n    }\r\n\r\n    decorated.call(this, $element, options);\r\n  }\r\n\r\n  Tokenizer.prototype.bind = function (decorated, container, $container) {\r\n    decorated.call(this, container, $container);\r\n\r\n    this.$search =  container.dropdown.$search || container.selection.$search ||\r\n      $container.find('.select2-search__field');\r\n  };\r\n\r\n  Tokenizer.prototype.query = function (decorated, params, callback) {\r\n    var self = this;\r\n\r\n    function createAndSelect (data) {\r\n      // Normalize the data object so we can use it for checks\r\n      var item = self._normalizeItem(data);\r\n\r\n      // Check if the data object already exists as a tag\r\n      // Select it if it doesn't\r\n      var $existingOptions = self.$element.find('option').filter(function () {\r\n        return $(this).val() === item.id;\r\n      });\r\n\r\n      // If an existing option wasn't found for it, create the option\r\n      if (!$existingOptions.length) {\r\n        var $option = self.option(item);\r\n        $option.attr('data-select2-tag', true);\r\n\r\n        self._removeOldTags();\r\n        self.addOptions([$option]);\r\n      }\r\n\r\n      // Select the item, now that we know there is an option for it\r\n      select(item);\r\n    }\r\n\r\n    function select (data) {\r\n      self.trigger('select', {\r\n        data: data\r\n      });\r\n    }\r\n\r\n    params.term = params.term || '';\r\n\r\n    var tokenData = this.tokenizer(params, this.options, createAndSelect);\r\n\r\n    if (tokenData.term !== params.term) {\r\n      // Replace the search term if we have the search box\r\n      if (this.$search.length) {\r\n        this.$search.val(tokenData.term);\r\n        this.$search.focus();\r\n      }\r\n\r\n      params.term = tokenData.term;\r\n    }\r\n\r\n    decorated.call(this, params, callback);\r\n  };\r\n\r\n  Tokenizer.prototype.tokenizer = function (_, params, options, callback) {\r\n    var separators = options.get('tokenSeparators') || [];\r\n    var term = params.term;\r\n    var i = 0;\r\n\r\n    var createTag = this.createTag || function (params) {\r\n      return {\r\n        id: params.term,\r\n        text: params.term\r\n      };\r\n    };\r\n\r\n    while (i < term.length) {\r\n      var termChar = term[i];\r\n\r\n      if ($.inArray(termChar, separators) === -1) {\r\n        i++;\r\n\r\n        continue;\r\n      }\r\n\r\n      var part = term.substr(0, i);\r\n      var partParams = $.extend({}, params, {\r\n        term: part\r\n      });\r\n\r\n      var data = createTag(partParams);\r\n\r\n      if (data == null) {\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      callback(data);\r\n\r\n      // Reset the term to not include the tokenized portion\r\n      term = term.substr(i + 1) || '';\r\n      i = 0;\r\n    }\r\n\r\n    return {\r\n      term: term\r\n    };\r\n  };\r\n\r\n  return Tokenizer;\r\n});\r\n\nS2.define('select2/data/minimumInputLength',[\r\n\r\n], function () {\r\n  function MinimumInputLength (decorated, $e, options) {\r\n    this.minimumInputLength = options.get('minimumInputLength');\r\n\r\n    decorated.call(this, $e, options);\r\n  }\r\n\r\n  MinimumInputLength.prototype.query = function (decorated, params, callback) {\r\n    params.term = params.term || '';\r\n\r\n    if (params.term.length < this.minimumInputLength) {\r\n      this.trigger('results:message', {\r\n        message: 'inputTooShort',\r\n        args: {\r\n          minimum: this.minimumInputLength,\r\n          input: params.term,\r\n          params: params\r\n        }\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    decorated.call(this, params, callback);\r\n  };\r\n\r\n  return MinimumInputLength;\r\n});\r\n\nS2.define('select2/data/maximumInputLength',[\r\n\r\n], function () {\r\n  function MaximumInputLength (decorated, $e, options) {\r\n    this.maximumInputLength = options.get('maximumInputLength');\r\n\r\n    decorated.call(this, $e, options);\r\n  }\r\n\r\n  MaximumInputLength.prototype.query = function (decorated, params, callback) {\r\n    params.term = params.term || '';\r\n\r\n    if (this.maximumInputLength > 0 &&\r\n        params.term.length > this.maximumInputLength) {\r\n      this.trigger('results:message', {\r\n        message: 'inputTooLong',\r\n        args: {\r\n          maximum: this.maximumInputLength,\r\n          input: params.term,\r\n          params: params\r\n        }\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    decorated.call(this, params, callback);\r\n  };\r\n\r\n  return MaximumInputLength;\r\n});\r\n\nS2.define('select2/data/maximumSelectionLength',[\r\n\r\n], function (){\r\n  function MaximumSelectionLength (decorated, $e, options) {\r\n    this.maximumSelectionLength = options.get('maximumSelectionLength');\r\n\r\n    decorated.call(this, $e, options);\r\n  }\r\n\r\n  MaximumSelectionLength.prototype.query =\r\n    function (decorated, params, callback) {\r\n      var self = this;\r\n\r\n      this.current(function (currentData) {\r\n        var count = currentData != null ? currentData.length : 0;\r\n        if (self.maximumSelectionLength > 0 &&\r\n          count >= self.maximumSelectionLength) {\r\n          self.trigger('results:message', {\r\n            message: 'maximumSelected',\r\n            args: {\r\n              maximum: self.maximumSelectionLength\r\n            }\r\n          });\r\n          return;\r\n        }\r\n        decorated.call(self, params, callback);\r\n      });\r\n  };\r\n\r\n  return MaximumSelectionLength;\r\n});\r\n\nS2.define('select2/dropdown',[\r\n  'jquery',\r\n  './utils'\r\n], function ($, Utils) {\r\n  function Dropdown ($element, options) {\r\n    this.$element = $element;\r\n    this.options = options;\r\n\r\n    Dropdown.__super__.constructor.call(this);\r\n  }\r\n\r\n  Utils.Extend(Dropdown, Utils.Observable);\r\n\r\n  Dropdown.prototype.render = function () {\r\n    var $dropdown = $(\r\n      '<span class=\"select2-dropdown\">' +\r\n        '<span class=\"select2-results\"></span>' +\r\n      '</span>'\r\n    );\r\n\r\n    $dropdown.attr('dir', this.options.get('dir'));\r\n\r\n    this.$dropdown = $dropdown;\r\n\r\n    return $dropdown;\r\n  };\r\n\r\n  Dropdown.prototype.bind = function () {\r\n    // Should be implemented in subclasses\r\n  };\r\n\r\n  Dropdown.prototype.position = function ($dropdown, $container) {\r\n    // Should be implmented in subclasses\r\n  };\r\n\r\n  Dropdown.prototype.destroy = function () {\r\n    // Remove the dropdown from the DOM\r\n    this.$dropdown.remove();\r\n  };\r\n\r\n  return Dropdown;\r\n});\r\n\nS2.define('select2/dropdown/search',[\r\n  'jquery',\r\n  '../utils'\r\n], function ($, Utils) {\r\n  function Search () { }\r\n\r\n  Search.prototype.render = function (decorated) {\r\n    var $rendered = decorated.call(this);\r\n\r\n    var $search = $(\r\n      '<span class=\"select2-search select2-search--dropdown\">' +\r\n        '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\r\n        ' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\"' +\r\n        ' spellcheck=\"false\" role=\"textbox\" />' +\r\n      '</span>'\r\n    );\r\n\r\n    this.$searchContainer = $search;\r\n    this.$search = $search.find('input');\r\n\r\n    $rendered.prepend($search);\r\n\r\n    return $rendered;\r\n  };\r\n\r\n  Search.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    this.$search.on('keydown', function (evt) {\r\n      self.trigger('keypress', evt);\r\n\r\n      self._keyUpPrevented = evt.isDefaultPrevented();\r\n    });\r\n\r\n    // Workaround for browsers which do not support the `input` event\r\n    // This will prevent double-triggering of events for browsers which support\r\n    // both the `keyup` and `input` events.\r\n    this.$search.on('input', function (evt) {\r\n      // Unbind the duplicated `keyup` event\r\n      $(this).off('keyup');\r\n    });\r\n\r\n    this.$search.on('keyup input', function (evt) {\r\n      self.handleSearch(evt);\r\n    });\r\n\r\n    container.on('open', function () {\r\n      self.$search.attr('tabindex', 0);\r\n\r\n      self.$search.focus();\r\n\r\n      window.setTimeout(function () {\r\n        self.$search.focus();\r\n      }, 0);\r\n    });\r\n\r\n    container.on('close', function () {\r\n      self.$search.attr('tabindex', -1);\r\n\r\n      self.$search.val('');\r\n    });\r\n\r\n    container.on('focus', function () {\r\n      if (container.isOpen()) {\r\n        self.$search.focus();\r\n      }\r\n    });\r\n\r\n    container.on('results:all', function (params) {\r\n      if (params.query.term == null || params.query.term === '') {\r\n        var showSearch = self.showSearch(params);\r\n\r\n        if (showSearch) {\r\n          self.$searchContainer.removeClass('select2-search--hide');\r\n        } else {\r\n          self.$searchContainer.addClass('select2-search--hide');\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  Search.prototype.handleSearch = function (evt) {\r\n    if (!this._keyUpPrevented) {\r\n      var input = this.$search.val();\r\n\r\n      this.trigger('query', {\r\n        term: input\r\n      });\r\n    }\r\n\r\n    this._keyUpPrevented = false;\r\n  };\r\n\r\n  Search.prototype.showSearch = function (_, params) {\r\n    return true;\r\n  };\r\n\r\n  return Search;\r\n});\r\n\nS2.define('select2/dropdown/hidePlaceholder',[\r\n\r\n], function () {\r\n  function HidePlaceholder (decorated, $element, options, dataAdapter) {\r\n    this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\r\n\r\n    decorated.call(this, $element, options, dataAdapter);\r\n  }\r\n\r\n  HidePlaceholder.prototype.append = function (decorated, data) {\r\n    data.results = this.removePlaceholder(data.results);\r\n\r\n    decorated.call(this, data);\r\n  };\r\n\r\n  HidePlaceholder.prototype.normalizePlaceholder = function (_, placeholder) {\r\n    if (typeof placeholder === 'string') {\r\n      placeholder = {\r\n        id: '',\r\n        text: placeholder\r\n      };\r\n    }\r\n\r\n    return placeholder;\r\n  };\r\n\r\n  HidePlaceholder.prototype.removePlaceholder = function (_, data) {\r\n    var modifiedData = data.slice(0);\r\n\r\n    for (var d = data.length - 1; d >= 0; d--) {\r\n      var item = data[d];\r\n\r\n      if (this.placeholder.id === item.id) {\r\n        modifiedData.splice(d, 1);\r\n      }\r\n    }\r\n\r\n    return modifiedData;\r\n  };\r\n\r\n  return HidePlaceholder;\r\n});\r\n\nS2.define('select2/dropdown/infiniteScroll',[\r\n  'jquery'\r\n], function ($) {\r\n  function InfiniteScroll (decorated, $element, options, dataAdapter) {\r\n    this.lastParams = {};\r\n\r\n    decorated.call(this, $element, options, dataAdapter);\r\n\r\n    this.$loadingMore = this.createLoadingMore();\r\n    this.loading = false;\r\n  }\r\n\r\n  InfiniteScroll.prototype.append = function (decorated, data) {\r\n    this.$loadingMore.remove();\r\n    this.loading = false;\r\n\r\n    decorated.call(this, data);\r\n\r\n    if (this.showLoadingMore(data)) {\r\n      this.$results.append(this.$loadingMore);\r\n    }\r\n  };\r\n\r\n  InfiniteScroll.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('query', function (params) {\r\n      self.lastParams = params;\r\n      self.loading = true;\r\n    });\r\n\r\n    container.on('query:append', function (params) {\r\n      self.lastParams = params;\r\n      self.loading = true;\r\n    });\r\n\r\n    this.$results.on('scroll', function () {\r\n      var isLoadMoreVisible = $.contains(\r\n        document.documentElement,\r\n        self.$loadingMore[0]\r\n      );\r\n\r\n      if (self.loading || !isLoadMoreVisible) {\r\n        return;\r\n      }\r\n\r\n      var currentOffset = self.$results.offset().top +\r\n        self.$results.outerHeight(false);\r\n      var loadingMoreOffset = self.$loadingMore.offset().top +\r\n        self.$loadingMore.outerHeight(false);\r\n\r\n      if (currentOffset + 50 >= loadingMoreOffset) {\r\n        self.loadMore();\r\n      }\r\n    });\r\n  };\r\n\r\n  InfiniteScroll.prototype.loadMore = function () {\r\n    this.loading = true;\r\n\r\n    var params = $.extend({}, {page: 1}, this.lastParams);\r\n\r\n    params.page++;\r\n\r\n    this.trigger('query:append', params);\r\n  };\r\n\r\n  InfiniteScroll.prototype.showLoadingMore = function (_, data) {\r\n    return data.pagination && data.pagination.more;\r\n  };\r\n\r\n  InfiniteScroll.prototype.createLoadingMore = function () {\r\n    var $option = $(\r\n      '<li ' +\r\n      'class=\"select2-results__option select2-results__option--load-more\"' +\r\n      'role=\"treeitem\" aria-disabled=\"true\"></li>'\r\n    );\r\n\r\n    var message = this.options.get('translations').get('loadingMore');\r\n\r\n    $option.html(message(this.lastParams));\r\n\r\n    return $option;\r\n  };\r\n\r\n  return InfiniteScroll;\r\n});\r\n\nS2.define('select2/dropdown/attachBody',[\r\n  'jquery',\r\n  '../utils'\r\n], function ($, Utils) {\r\n  function AttachBody (decorated, $element, options) {\r\n    this.$dropdownParent = options.get('dropdownParent') || $(document.body);\r\n\r\n    decorated.call(this, $element, options);\r\n  }\r\n\r\n  AttachBody.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    var setupResultsEvents = false;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('open', function () {\r\n      self._showDropdown();\r\n      self._attachPositioningHandler(container);\r\n\r\n      if (!setupResultsEvents) {\r\n        setupResultsEvents = true;\r\n\r\n        container.on('results:all', function () {\r\n          self._positionDropdown();\r\n          self._resizeDropdown();\r\n        });\r\n\r\n        container.on('results:append', function () {\r\n          self._positionDropdown();\r\n          self._resizeDropdown();\r\n        });\r\n      }\r\n    });\r\n\r\n    container.on('close', function () {\r\n      self._hideDropdown();\r\n      self._detachPositioningHandler(container);\r\n    });\r\n\r\n    this.$dropdownContainer.on('mousedown', function (evt) {\r\n      evt.stopPropagation();\r\n    });\r\n  };\r\n\r\n  AttachBody.prototype.destroy = function (decorated) {\r\n    decorated.call(this);\r\n\r\n    this.$dropdownContainer.remove();\r\n  };\r\n\r\n  AttachBody.prototype.position = function (decorated, $dropdown, $container) {\r\n    // Clone all of the container classes\r\n    $dropdown.attr('class', $container.attr('class'));\r\n\r\n    $dropdown.removeClass('select2');\r\n    $dropdown.addClass('select2-container--open');\r\n\r\n    $dropdown.css({\r\n      position: 'absolute',\r\n      top: -999999\r\n    });\r\n\r\n    this.$container = $container;\r\n  };\r\n\r\n  AttachBody.prototype.render = function (decorated) {\r\n    var $container = $('<span></span>');\r\n\r\n    var $dropdown = decorated.call(this);\r\n    $container.append($dropdown);\r\n\r\n    this.$dropdownContainer = $container;\r\n\r\n    return $container;\r\n  };\r\n\r\n  AttachBody.prototype._hideDropdown = function (decorated) {\r\n    this.$dropdownContainer.detach();\r\n  };\r\n\r\n  AttachBody.prototype._attachPositioningHandler =\r\n      function (decorated, container) {\r\n    var self = this;\r\n\r\n    var scrollEvent = 'scroll.select2.' + container.id;\r\n    var resizeEvent = 'resize.select2.' + container.id;\r\n    var orientationEvent = 'orientationchange.select2.' + container.id;\r\n\r\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\r\n    $watchers.each(function () {\r\n      $(this).data('select2-scroll-position', {\r\n        x: $(this).scrollLeft(),\r\n        y: $(this).scrollTop()\r\n      });\r\n    });\r\n\r\n    $watchers.on(scrollEvent, function (ev) {\r\n      var position = $(this).data('select2-scroll-position');\r\n      $(this).scrollTop(position.y);\r\n    });\r\n\r\n    $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent,\r\n      function (e) {\r\n      self._positionDropdown();\r\n      self._resizeDropdown();\r\n    });\r\n  };\r\n\r\n  AttachBody.prototype._detachPositioningHandler =\r\n      function (decorated, container) {\r\n    var scrollEvent = 'scroll.select2.' + container.id;\r\n    var resizeEvent = 'resize.select2.' + container.id;\r\n    var orientationEvent = 'orientationchange.select2.' + container.id;\r\n\r\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\r\n    $watchers.off(scrollEvent);\r\n\r\n    $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\r\n  };\r\n\r\n  AttachBody.prototype._positionDropdown = function () {\r\n    var $window = $(window);\r\n\r\n    var isCurrentlyAbove = this.$dropdown.hasClass('select2-dropdown--above');\r\n    var isCurrentlyBelow = this.$dropdown.hasClass('select2-dropdown--below');\r\n\r\n    var newDirection = null;\r\n\r\n    var offset = this.$container.offset();\r\n\r\n    offset.bottom = offset.top + this.$container.outerHeight(false);\r\n\r\n    var container = {\r\n      height: this.$container.outerHeight(false)\r\n    };\r\n\r\n    container.top = offset.top;\r\n    container.bottom = offset.top + container.height;\r\n\r\n    var dropdown = {\r\n      height: this.$dropdown.outerHeight(false)\r\n    };\r\n\r\n    var viewport = {\r\n      top: $window.scrollTop(),\r\n      bottom: $window.scrollTop() + $window.height()\r\n    };\r\n\r\n    var enoughRoomAbove = viewport.top < (offset.top - dropdown.height);\r\n    var enoughRoomBelow = viewport.bottom > (offset.bottom + dropdown.height);\r\n\r\n    var css = {\r\n      left: offset.left,\r\n      top: container.bottom\r\n    };\r\n\r\n    // Determine what the parent element is to use for calciulating the offset\r\n    var $offsetParent = this.$dropdownParent;\r\n\r\n    // For statically positoned elements, we need to get the element\r\n    // that is determining the offset\r\n    if ($offsetParent.css('position') === 'static') {\r\n      $offsetParent = $offsetParent.offsetParent();\r\n    }\r\n\r\n    var parentOffset = $offsetParent.offset();\r\n\r\n    css.top -= parentOffset.top;\r\n    css.left -= parentOffset.left;\r\n\r\n    if (!isCurrentlyAbove && !isCurrentlyBelow) {\r\n      newDirection = 'below';\r\n    }\r\n\r\n    if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\r\n      newDirection = 'above';\r\n    } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\r\n      newDirection = 'below';\r\n    }\r\n\r\n    if (newDirection == 'above' ||\r\n      (isCurrentlyAbove && newDirection !== 'below')) {\r\n      css.top = container.top - parentOffset.top - dropdown.height;\r\n    }\r\n\r\n    if (newDirection != null) {\r\n      this.$dropdown\r\n        .removeClass('select2-dropdown--below select2-dropdown--above')\r\n        .addClass('select2-dropdown--' + newDirection);\r\n      this.$container\r\n        .removeClass('select2-container--below select2-container--above')\r\n        .addClass('select2-container--' + newDirection);\r\n    }\r\n\r\n    this.$dropdownContainer.css(css);\r\n  };\r\n\r\n  AttachBody.prototype._resizeDropdown = function () {\r\n    var css = {\r\n      width: this.$container.outerWidth(false) + 'px'\r\n    };\r\n\r\n    if (this.options.get('dropdownAutoWidth')) {\r\n      css.minWidth = css.width;\r\n      css.position = 'relative';\r\n      css.width = 'auto';\r\n    }\r\n\r\n    this.$dropdown.css(css);\r\n  };\r\n\r\n  AttachBody.prototype._showDropdown = function (decorated) {\r\n    this.$dropdownContainer.appendTo(this.$dropdownParent);\r\n\r\n    this._positionDropdown();\r\n    this._resizeDropdown();\r\n  };\r\n\r\n  return AttachBody;\r\n});\r\n\nS2.define('select2/dropdown/minimumResultsForSearch',[\r\n\r\n], function () {\r\n  function countResults (data) {\r\n    var count = 0;\r\n\r\n    for (var d = 0; d < data.length; d++) {\r\n      var item = data[d];\r\n\r\n      if (item.children) {\r\n        count += countResults(item.children);\r\n      } else {\r\n        count++;\r\n      }\r\n    }\r\n\r\n    return count;\r\n  }\r\n\r\n  function MinimumResultsForSearch (decorated, $element, options, dataAdapter) {\r\n    this.minimumResultsForSearch = options.get('minimumResultsForSearch');\r\n\r\n    if (this.minimumResultsForSearch < 0) {\r\n      this.minimumResultsForSearch = Infinity;\r\n    }\r\n\r\n    decorated.call(this, $element, options, dataAdapter);\r\n  }\r\n\r\n  MinimumResultsForSearch.prototype.showSearch = function (decorated, params) {\r\n    if (countResults(params.data.results) < this.minimumResultsForSearch) {\r\n      return false;\r\n    }\r\n\r\n    return decorated.call(this, params);\r\n  };\r\n\r\n  return MinimumResultsForSearch;\r\n});\r\n\nS2.define('select2/dropdown/selectOnClose',[\r\n\r\n], function () {\r\n  function SelectOnClose () { }\r\n\r\n  SelectOnClose.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('close', function (params) {\r\n      self._handleSelectOnClose(params);\r\n    });\r\n  };\r\n\r\n  SelectOnClose.prototype._handleSelectOnClose = function (_, params) {\r\n    if (params && params.originalSelect2Event != null) {\r\n      var event = params.originalSelect2Event;\r\n\r\n      // Don't select an item if the close event was triggered from a select or\r\n      // unselect event\r\n      if (event._type === 'select' || event._type === 'unselect') {\r\n        return;\r\n      }\r\n    }\r\n\r\n    var $highlightedResults = this.getHighlightedResults();\r\n\r\n    // Only select highlighted results\r\n    if ($highlightedResults.length < 1) {\r\n      return;\r\n    }\r\n\r\n    var data = $highlightedResults.data('data');\r\n\r\n    // Don't re-select already selected resulte\r\n    if (\r\n      (data.element != null && data.element.selected) ||\r\n      (data.element == null && data.selected)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.trigger('select', {\r\n        data: data\r\n    });\r\n  };\r\n\r\n  return SelectOnClose;\r\n});\r\n\nS2.define('select2/dropdown/closeOnSelect',[\r\n\r\n], function () {\r\n  function CloseOnSelect () { }\r\n\r\n  CloseOnSelect.prototype.bind = function (decorated, container, $container) {\r\n    var self = this;\r\n\r\n    decorated.call(this, container, $container);\r\n\r\n    container.on('select', function (evt) {\r\n      self._selectTriggered(evt);\r\n    });\r\n\r\n    container.on('unselect', function (evt) {\r\n      self._selectTriggered(evt);\r\n    });\r\n  };\r\n\r\n  CloseOnSelect.prototype._selectTriggered = function (_, evt) {\r\n    var originalEvent = evt.originalEvent;\r\n\r\n    // Don't close if the control key is being held\r\n    if (originalEvent && originalEvent.ctrlKey) {\r\n      return;\r\n    }\r\n\r\n    this.trigger('close', {\r\n      originalEvent: originalEvent,\r\n      originalSelect2Event: evt\r\n    });\r\n  };\r\n\r\n  return CloseOnSelect;\r\n});\r\n\nS2.define('select2/i18n/en',[],function () {\r\n  // English\r\n  return {\r\n    errorLoading: function () {\r\n      return 'The results could not be loaded.';\r\n    },\r\n    inputTooLong: function (args) {\r\n      var overChars = args.input.length - args.maximum;\r\n\r\n      var message = 'Please delete ' + overChars + ' character';\r\n\r\n      if (overChars != 1) {\r\n        message += 's';\r\n      }\r\n\r\n      return message;\r\n    },\r\n    inputTooShort: function (args) {\r\n      var remainingChars = args.minimum - args.input.length;\r\n\r\n      var message = 'Please enter ' + remainingChars + ' or more characters';\r\n\r\n      return message;\r\n    },\r\n    loadingMore: function () {\r\n      return 'Loading more results…';\r\n    },\r\n    maximumSelected: function (args) {\r\n      var message = 'You can only select ' + args.maximum + ' item';\r\n\r\n      if (args.maximum != 1) {\r\n        message += 's';\r\n      }\r\n\r\n      return message;\r\n    },\r\n    noResults: function () {\r\n      return 'No results found';\r\n    },\r\n    searching: function () {\r\n      return 'Searching…';\r\n    }\r\n  };\r\n});\r\n\nS2.define('select2/defaults',[\r\n  'jquery',\r\n  'require',\r\n\r\n  './results',\r\n\r\n  './selection/single',\r\n  './selection/multiple',\r\n  './selection/placeholder',\r\n  './selection/allowClear',\r\n  './selection/search',\r\n  './selection/eventRelay',\r\n\r\n  './utils',\r\n  './translation',\r\n  './diacritics',\r\n\r\n  './data/select',\r\n  './data/array',\r\n  './data/ajax',\r\n  './data/tags',\r\n  './data/tokenizer',\r\n  './data/minimumInputLength',\r\n  './data/maximumInputLength',\r\n  './data/maximumSelectionLength',\r\n\r\n  './dropdown',\r\n  './dropdown/search',\r\n  './dropdown/hidePlaceholder',\r\n  './dropdown/infiniteScroll',\r\n  './dropdown/attachBody',\r\n  './dropdown/minimumResultsForSearch',\r\n  './dropdown/selectOnClose',\r\n  './dropdown/closeOnSelect',\r\n\r\n  './i18n/en'\r\n], function ($, require,\r\n\r\n             ResultsList,\r\n\r\n             SingleSelection, MultipleSelection, Placeholder, AllowClear,\r\n             SelectionSearch, EventRelay,\r\n\r\n             Utils, Translation, DIACRITICS,\r\n\r\n             SelectData, ArrayData, AjaxData, Tags, Tokenizer,\r\n             MinimumInputLength, MaximumInputLength, MaximumSelectionLength,\r\n\r\n             Dropdown, DropdownSearch, HidePlaceholder, InfiniteScroll,\r\n             AttachBody, MinimumResultsForSearch, SelectOnClose, CloseOnSelect,\r\n\r\n             EnglishTranslation) {\r\n  function Defaults () {\r\n    this.reset();\r\n  }\r\n\r\n  Defaults.prototype.apply = function (options) {\r\n    options = $.extend(true, {}, this.defaults, options);\r\n\r\n    if (options.dataAdapter == null) {\r\n      if (options.ajax != null) {\r\n        options.dataAdapter = AjaxData;\r\n      } else if (options.data != null) {\r\n        options.dataAdapter = ArrayData;\r\n      } else {\r\n        options.dataAdapter = SelectData;\r\n      }\r\n\r\n      if (options.minimumInputLength > 0) {\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          MinimumInputLength\r\n        );\r\n      }\r\n\r\n      if (options.maximumInputLength > 0) {\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          MaximumInputLength\r\n        );\r\n      }\r\n\r\n      if (options.maximumSelectionLength > 0) {\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          MaximumSelectionLength\r\n        );\r\n      }\r\n\r\n      if (options.tags) {\r\n        options.dataAdapter = Utils.Decorate(options.dataAdapter, Tags);\r\n      }\r\n\r\n      if (options.tokenSeparators != null || options.tokenizer != null) {\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          Tokenizer\r\n        );\r\n      }\r\n\r\n      if (options.query != null) {\r\n        var Query = require(options.amdBase + 'compat/query');\r\n\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          Query\r\n        );\r\n      }\r\n\r\n      if (options.initSelection != null) {\r\n        var InitSelection = require(options.amdBase + 'compat/initSelection');\r\n\r\n        options.dataAdapter = Utils.Decorate(\r\n          options.dataAdapter,\r\n          InitSelection\r\n        );\r\n      }\r\n    }\r\n\r\n    if (options.resultsAdapter == null) {\r\n      options.resultsAdapter = ResultsList;\r\n\r\n      if (options.ajax != null) {\r\n        options.resultsAdapter = Utils.Decorate(\r\n          options.resultsAdapter,\r\n          InfiniteScroll\r\n        );\r\n      }\r\n\r\n      if (options.placeholder != null) {\r\n        options.resultsAdapter = Utils.Decorate(\r\n          options.resultsAdapter,\r\n          HidePlaceholder\r\n        );\r\n      }\r\n\r\n      if (options.selectOnClose) {\r\n        options.resultsAdapter = Utils.Decorate(\r\n          options.resultsAdapter,\r\n          SelectOnClose\r\n        );\r\n      }\r\n    }\r\n\r\n    if (options.dropdownAdapter == null) {\r\n      if (options.multiple) {\r\n        options.dropdownAdapter = Dropdown;\r\n      } else {\r\n        var SearchableDropdown = Utils.Decorate(Dropdown, DropdownSearch);\r\n\r\n        options.dropdownAdapter = SearchableDropdown;\r\n      }\r\n\r\n      if (options.minimumResultsForSearch !== 0) {\r\n        options.dropdownAdapter = Utils.Decorate(\r\n          options.dropdownAdapter,\r\n          MinimumResultsForSearch\r\n        );\r\n      }\r\n\r\n      if (options.closeOnSelect) {\r\n        options.dropdownAdapter = Utils.Decorate(\r\n          options.dropdownAdapter,\r\n          CloseOnSelect\r\n        );\r\n      }\r\n\r\n      if (\r\n        options.dropdownCssClass != null ||\r\n        options.dropdownCss != null ||\r\n        options.adaptDropdownCssClass != null\r\n      ) {\r\n        var DropdownCSS = require(options.amdBase + 'compat/dropdownCss');\r\n\r\n        options.dropdownAdapter = Utils.Decorate(\r\n          options.dropdownAdapter,\r\n          DropdownCSS\r\n        );\r\n      }\r\n\r\n      options.dropdownAdapter = Utils.Decorate(\r\n        options.dropdownAdapter,\r\n        AttachBody\r\n      );\r\n    }\r\n\r\n    if (options.selectionAdapter == null) {\r\n      if (options.multiple) {\r\n        options.selectionAdapter = MultipleSelection;\r\n      } else {\r\n        options.selectionAdapter = SingleSelection;\r\n      }\r\n\r\n      // Add the placeholder mixin if a placeholder was specified\r\n      if (options.placeholder != null) {\r\n        options.selectionAdapter = Utils.Decorate(\r\n          options.selectionAdapter,\r\n          Placeholder\r\n        );\r\n      }\r\n\r\n      if (options.allowClear) {\r\n        options.selectionAdapter = Utils.Decorate(\r\n          options.selectionAdapter,\r\n          AllowClear\r\n        );\r\n      }\r\n\r\n      if (options.multiple) {\r\n        options.selectionAdapter = Utils.Decorate(\r\n          options.selectionAdapter,\r\n          SelectionSearch\r\n        );\r\n      }\r\n\r\n      if (\r\n        options.containerCssClass != null ||\r\n        options.containerCss != null ||\r\n        options.adaptContainerCssClass != null\r\n      ) {\r\n        var ContainerCSS = require(options.amdBase + 'compat/containerCss');\r\n\r\n        options.selectionAdapter = Utils.Decorate(\r\n          options.selectionAdapter,\r\n          ContainerCSS\r\n        );\r\n      }\r\n\r\n      options.selectionAdapter = Utils.Decorate(\r\n        options.selectionAdapter,\r\n        EventRelay\r\n      );\r\n    }\r\n\r\n    if (typeof options.language === 'string') {\r\n      // Check if the language is specified with a region\r\n      if (options.language.indexOf('-') > 0) {\r\n        // Extract the region information if it is included\r\n        var languageParts = options.language.split('-');\r\n        var baseLanguage = languageParts[0];\r\n\r\n        options.language = [options.language, baseLanguage];\r\n      } else {\r\n        options.language = [options.language];\r\n      }\r\n    }\r\n\r\n    if ($.isArray(options.language)) {\r\n      var languages = new Translation();\r\n      options.language.push('en');\r\n\r\n      var languageNames = options.language;\r\n\r\n      for (var l = 0; l < languageNames.length; l++) {\r\n        var name = languageNames[l];\r\n        var language = {};\r\n\r\n        try {\r\n          // Try to load it with the original name\r\n          language = Translation.loadPath(name);\r\n        } catch (e) {\r\n          try {\r\n            // If we couldn't load it, check if it wasn't the full path\r\n            name = this.defaults.amdLanguageBase + name;\r\n            language = Translation.loadPath(name);\r\n          } catch (ex) {\r\n            // The translation could not be loaded at all. Sometimes this is\r\n            // because of a configuration problem, other times this can be\r\n            // because of how Select2 helps load all possible translation files.\r\n            if (options.debug && window.console && console.warn) {\r\n              console.warn(\r\n                'Select2: The language file for \"' + name + '\" could not be ' +\r\n                'automatically loaded. A fallback will be used instead.'\r\n              );\r\n            }\r\n\r\n            continue;\r\n          }\r\n        }\r\n\r\n        languages.extend(language);\r\n      }\r\n\r\n      options.translations = languages;\r\n    } else {\r\n      var baseTranslation = Translation.loadPath(\r\n        this.defaults.amdLanguageBase + 'en'\r\n      );\r\n      var customTranslation = new Translation(options.language);\r\n\r\n      customTranslation.extend(baseTranslation);\r\n\r\n      options.translations = customTranslation;\r\n    }\r\n\r\n    return options;\r\n  };\r\n\r\n  Defaults.prototype.reset = function () {\r\n    function stripDiacritics (text) {\r\n      // Used 'uni range + named function' from http://jsperf.com/diacritics/18\r\n      function match(a) {\r\n        return DIACRITICS[a] || a;\r\n      }\r\n\r\n      return text.replace(/[^\\u0000-\\u007E]/g, match);\r\n    }\r\n\r\n    function matcher (params, data) {\r\n      // Always return the object if there is nothing to compare\r\n      if ($.trim(params.term) === '') {\r\n        return data;\r\n      }\r\n\r\n      // Do a recursive check for options with children\r\n      if (data.children && data.children.length > 0) {\r\n        // Clone the data object if there are children\r\n        // This is required as we modify the object to remove any non-matches\r\n        var match = $.extend(true, {}, data);\r\n\r\n        // Check each child of the option\r\n        for (var c = data.children.length - 1; c >= 0; c--) {\r\n          var child = data.children[c];\r\n\r\n          var matches = matcher(params, child);\r\n\r\n          // If there wasn't a match, remove the object in the array\r\n          if (matches == null) {\r\n            match.children.splice(c, 1);\r\n          }\r\n        }\r\n\r\n        // If any children matched, return the new object\r\n        if (match.children.length > 0) {\r\n          return match;\r\n        }\r\n\r\n        // If there were no matching children, check just the plain object\r\n        return matcher(params, match);\r\n      }\r\n\r\n      var original = stripDiacritics(data.text).toUpperCase();\r\n      var term = stripDiacritics(params.term).toUpperCase();\r\n\r\n      // Check if the text contains the term\r\n      if (original.indexOf(term) > -1) {\r\n        return data;\r\n      }\r\n\r\n      // If it doesn't contain the term, don't return anything\r\n      return null;\r\n    }\r\n\r\n    this.defaults = {\r\n      amdBase: './',\r\n      amdLanguageBase: './i18n/',\r\n      closeOnSelect: true,\r\n      debug: false,\r\n      dropdownAutoWidth: false,\r\n      escapeMarkup: Utils.escapeMarkup,\r\n      language: EnglishTranslation,\r\n      matcher: matcher,\r\n      minimumInputLength: 0,\r\n      maximumInputLength: 0,\r\n      maximumSelectionLength: 0,\r\n      minimumResultsForSearch: 0,\r\n      selectOnClose: false,\r\n      sorter: function (data) {\r\n        return data;\r\n      },\r\n      templateResult: function (result) {\r\n        return result.text;\r\n      },\r\n      templateSelection: function (selection) {\r\n        return selection.text;\r\n      },\r\n      theme: 'default',\r\n      width: 'resolve'\r\n    };\r\n  };\r\n\r\n  Defaults.prototype.set = function (key, value) {\r\n    var camelKey = $.camelCase(key);\r\n\r\n    var data = {};\r\n    data[camelKey] = value;\r\n\r\n    var convertedData = Utils._convertData(data);\r\n\r\n    $.extend(this.defaults, convertedData);\r\n  };\r\n\r\n  var defaults = new Defaults();\r\n\r\n  return defaults;\r\n});\r\n\nS2.define('select2/options',[\r\n  'require',\r\n  'jquery',\r\n  './defaults',\r\n  './utils'\r\n], function (require, $, Defaults, Utils) {\r\n  function Options (options, $element) {\r\n    this.options = options;\r\n\r\n    if ($element != null) {\r\n      this.fromElement($element);\r\n    }\r\n\r\n    this.options = Defaults.apply(this.options);\r\n\r\n    if ($element && $element.is('input')) {\r\n      var InputCompat = require(this.get('amdBase') + 'compat/inputData');\r\n\r\n      this.options.dataAdapter = Utils.Decorate(\r\n        this.options.dataAdapter,\r\n        InputCompat\r\n      );\r\n    }\r\n  }\r\n\r\n  Options.prototype.fromElement = function ($e) {\r\n    var excludedData = ['select2'];\r\n\r\n    if (this.options.multiple == null) {\r\n      this.options.multiple = $e.prop('multiple');\r\n    }\r\n\r\n    if (this.options.disabled == null) {\r\n      this.options.disabled = $e.prop('disabled');\r\n    }\r\n\r\n    if (this.options.language == null) {\r\n      if ($e.prop('lang')) {\r\n        this.options.language = $e.prop('lang').toLowerCase();\r\n      } else if ($e.closest('[lang]').prop('lang')) {\r\n        this.options.language = $e.closest('[lang]').prop('lang');\r\n      }\r\n    }\r\n\r\n    if (this.options.dir == null) {\r\n      if ($e.prop('dir')) {\r\n        this.options.dir = $e.prop('dir');\r\n      } else if ($e.closest('[dir]').prop('dir')) {\r\n        this.options.dir = $e.closest('[dir]').prop('dir');\r\n      } else {\r\n        this.options.dir = 'ltr';\r\n      }\r\n    }\r\n\r\n    $e.prop('disabled', this.options.disabled);\r\n    $e.prop('multiple', this.options.multiple);\r\n\r\n    if ($e.data('select2Tags')) {\r\n      if (this.options.debug && window.console && console.warn) {\r\n        console.warn(\r\n          'Select2: The `data-select2-tags` attribute has been changed to ' +\r\n          'use the `data-data` and `data-tags=\"true\"` attributes and will be ' +\r\n          'removed in future versions of Select2.'\r\n        );\r\n      }\r\n\r\n      $e.data('data', $e.data('select2Tags'));\r\n      $e.data('tags', true);\r\n    }\r\n\r\n    if ($e.data('ajaxUrl')) {\r\n      if (this.options.debug && window.console && console.warn) {\r\n        console.warn(\r\n          'Select2: The `data-ajax-url` attribute has been changed to ' +\r\n          '`data-ajax--url` and support for the old attribute will be removed' +\r\n          ' in future versions of Select2.'\r\n        );\r\n      }\r\n\r\n      $e.attr('ajax--url', $e.data('ajaxUrl'));\r\n      $e.data('ajax--url', $e.data('ajaxUrl'));\r\n    }\r\n\r\n    var dataset = {};\r\n\r\n    // Prefer the element's `dataset` attribute if it exists\r\n    // jQuery 1.x does not correctly handle data attributes with multiple dashes\r\n    if ($.fn.jquery && $.fn.jquery.substr(0, 2) == '1.' && $e[0].dataset) {\r\n      dataset = $.extend(true, {}, $e[0].dataset, $e.data());\r\n    } else {\r\n      dataset = $e.data();\r\n    }\r\n\r\n    var data = $.extend(true, {}, dataset);\r\n\r\n    data = Utils._convertData(data);\r\n\r\n    for (var key in data) {\r\n      if ($.inArray(key, excludedData) > -1) {\r\n        continue;\r\n      }\r\n\r\n      if ($.isPlainObject(this.options[key])) {\r\n        $.extend(this.options[key], data[key]);\r\n      } else {\r\n        this.options[key] = data[key];\r\n      }\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  Options.prototype.get = function (key) {\r\n    return this.options[key];\r\n  };\r\n\r\n  Options.prototype.set = function (key, val) {\r\n    this.options[key] = val;\r\n  };\r\n\r\n  return Options;\r\n});\r\n\nS2.define('select2/core',[\r\n  'jquery',\r\n  './options',\r\n  './utils',\r\n  './keys'\r\n], function ($, Options, Utils, KEYS) {\r\n  var Select2 = function ($element, options) {\r\n    if ($element.data('select2') != null) {\r\n      $element.data('select2').destroy();\r\n    }\r\n\r\n    this.$element = $element;\r\n\r\n    this.id = this._generateId($element);\r\n\r\n    options = options || {};\r\n\r\n    this.options = new Options(options, $element);\r\n\r\n    Select2.__super__.constructor.call(this);\r\n\r\n    // Set up the tabindex\r\n\r\n    var tabindex = $element.attr('tabindex') || 0;\r\n    $element.data('old-tabindex', tabindex);\r\n    $element.attr('tabindex', '-1');\r\n\r\n    // Set up containers and adapters\r\n\r\n    var DataAdapter = this.options.get('dataAdapter');\r\n    this.dataAdapter = new DataAdapter($element, this.options);\r\n\r\n    var $container = this.render();\r\n\r\n    this._placeContainer($container);\r\n\r\n    var SelectionAdapter = this.options.get('selectionAdapter');\r\n    this.selection = new SelectionAdapter($element, this.options);\r\n    this.$selection = this.selection.render();\r\n\r\n    this.selection.position(this.$selection, $container);\r\n\r\n    var DropdownAdapter = this.options.get('dropdownAdapter');\r\n    this.dropdown = new DropdownAdapter($element, this.options);\r\n    this.$dropdown = this.dropdown.render();\r\n\r\n    this.dropdown.position(this.$dropdown, $container);\r\n\r\n    var ResultsAdapter = this.options.get('resultsAdapter');\r\n    this.results = new ResultsAdapter($element, this.options, this.dataAdapter);\r\n    this.$results = this.results.render();\r\n\r\n    this.results.position(this.$results, this.$dropdown);\r\n\r\n    // Bind events\r\n\r\n    var self = this;\r\n\r\n    // Bind the container to all of the adapters\r\n    this._bindAdapters();\r\n\r\n    // Register any DOM event handlers\r\n    this._registerDomEvents();\r\n\r\n    // Register any internal event handlers\r\n    this._registerDataEvents();\r\n    this._registerSelectionEvents();\r\n    this._registerDropdownEvents();\r\n    this._registerResultsEvents();\r\n    this._registerEvents();\r\n\r\n    // Set the initial state\r\n    this.dataAdapter.current(function (initialData) {\r\n      self.trigger('selection:update', {\r\n        data: initialData\r\n      });\r\n    });\r\n\r\n    // Hide the original select\r\n    $element.addClass('select2-hidden-accessible');\r\n    $element.attr('aria-hidden', 'true');\r\n\r\n    // Synchronize any monitored attributes\r\n    this._syncAttributes();\r\n\r\n    $element.data('select2', this);\r\n  };\r\n\r\n  Utils.Extend(Select2, Utils.Observable);\r\n\r\n  Select2.prototype._generateId = function ($element) {\r\n    var id = '';\r\n\r\n    if ($element.attr('id') != null) {\r\n      id = $element.attr('id');\r\n    } else if ($element.attr('name') != null) {\r\n      id = $element.attr('name') + '-' + Utils.generateChars(2);\r\n    } else {\r\n      id = Utils.generateChars(4);\r\n    }\r\n\r\n    id = id.replace(/(:|\\.|\\[|\\]|,)/g, '');\r\n    id = 'select2-' + id;\r\n\r\n    return id;\r\n  };\r\n\r\n  Select2.prototype._placeContainer = function ($container) {\r\n    $container.insertAfter(this.$element);\r\n\r\n    var width = this._resolveWidth(this.$element, this.options.get('width'));\r\n\r\n    if (width != null) {\r\n      $container.css('width', width);\r\n    }\r\n  };\r\n\r\n  Select2.prototype._resolveWidth = function ($element, method) {\r\n    var WIDTH = /^width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;\r\n\r\n    if (method == 'resolve') {\r\n      var styleWidth = this._resolveWidth($element, 'style');\r\n\r\n      if (styleWidth != null) {\r\n        return styleWidth;\r\n      }\r\n\r\n      return this._resolveWidth($element, 'element');\r\n    }\r\n\r\n    if (method == 'element') {\r\n      var elementWidth = $element.outerWidth(false);\r\n\r\n      if (elementWidth <= 0) {\r\n        return 'auto';\r\n      }\r\n\r\n      return elementWidth + 'px';\r\n    }\r\n\r\n    if (method == 'style') {\r\n      var style = $element.attr('style');\r\n\r\n      if (typeof(style) !== 'string') {\r\n        return null;\r\n      }\r\n\r\n      var attrs = style.split(';');\r\n\r\n      for (var i = 0, l = attrs.length; i < l; i = i + 1) {\r\n        var attr = attrs[i].replace(/\\s/g, '');\r\n        var matches = attr.match(WIDTH);\r\n\r\n        if (matches !== null && matches.length >= 1) {\r\n          return matches[1];\r\n        }\r\n      }\r\n\r\n      return null;\r\n    }\r\n\r\n    return method;\r\n  };\r\n\r\n  Select2.prototype._bindAdapters = function () {\r\n    this.dataAdapter.bind(this, this.$container);\r\n    this.selection.bind(this, this.$container);\r\n\r\n    this.dropdown.bind(this, this.$container);\r\n    this.results.bind(this, this.$container);\r\n  };\r\n\r\n  Select2.prototype._registerDomEvents = function () {\r\n    var self = this;\r\n\r\n    this.$element.on('change.select2', function () {\r\n      self.dataAdapter.current(function (data) {\r\n        self.trigger('selection:update', {\r\n          data: data\r\n        });\r\n      });\r\n    });\r\n\r\n    this.$element.on('focus.select2', function (evt) {\r\n      self.trigger('focus', evt);\r\n    });\r\n\r\n    this._syncA = Utils.bind(this._syncAttributes, this);\r\n    this._syncS = Utils.bind(this._syncSubtree, this);\r\n\r\n    if (this.$element[0].attachEvent) {\r\n      this.$element[0].attachEvent('onpropertychange', this._syncA);\r\n    }\r\n\r\n    var observer = window.MutationObserver ||\r\n      window.WebKitMutationObserver ||\r\n      window.MozMutationObserver\r\n    ;\r\n\r\n    if (observer != null) {\r\n      this._observer = new observer(function (mutations) {\r\n        $.each(mutations, self._syncA);\r\n        $.each(mutations, self._syncS);\r\n      });\r\n      this._observer.observe(this.$element[0], {\r\n        attributes: true,\r\n        childList: true,\r\n        subtree: false\r\n      });\r\n    } else if (this.$element[0].addEventListener) {\r\n      this.$element[0].addEventListener(\r\n        'DOMAttrModified',\r\n        self._syncA,\r\n        false\r\n      );\r\n      this.$element[0].addEventListener(\r\n        'DOMNodeInserted',\r\n        self._syncS,\r\n        false\r\n      );\r\n      this.$element[0].addEventListener(\r\n        'DOMNodeRemoved',\r\n        self._syncS,\r\n        false\r\n      );\r\n    }\r\n  };\r\n\r\n  Select2.prototype._registerDataEvents = function () {\r\n    var self = this;\r\n\r\n    this.dataAdapter.on('*', function (name, params) {\r\n      self.trigger(name, params);\r\n    });\r\n  };\r\n\r\n  Select2.prototype._registerSelectionEvents = function () {\r\n    var self = this;\r\n    var nonRelayEvents = ['toggle', 'focus'];\r\n\r\n    this.selection.on('toggle', function () {\r\n      self.toggleDropdown();\r\n    });\r\n\r\n    this.selection.on('focus', function (params) {\r\n      self.focus(params);\r\n    });\r\n\r\n    this.selection.on('*', function (name, params) {\r\n      if ($.inArray(name, nonRelayEvents) !== -1) {\r\n        return;\r\n      }\r\n\r\n      self.trigger(name, params);\r\n    });\r\n  };\r\n\r\n  Select2.prototype._registerDropdownEvents = function () {\r\n    var self = this;\r\n\r\n    this.dropdown.on('*', function (name, params) {\r\n      self.trigger(name, params);\r\n    });\r\n  };\r\n\r\n  Select2.prototype._registerResultsEvents = function () {\r\n    var self = this;\r\n\r\n    this.results.on('*', function (name, params) {\r\n      self.trigger(name, params);\r\n    });\r\n  };\r\n\r\n  Select2.prototype._registerEvents = function () {\r\n    var self = this;\r\n\r\n    this.on('open', function () {\r\n      self.$container.addClass('select2-container--open');\r\n    });\r\n\r\n    this.on('close', function () {\r\n      self.$container.removeClass('select2-container--open');\r\n    });\r\n\r\n    this.on('enable', function () {\r\n      self.$container.removeClass('select2-container--disabled');\r\n    });\r\n\r\n    this.on('disable', function () {\r\n      self.$container.addClass('select2-container--disabled');\r\n    });\r\n\r\n    this.on('blur', function () {\r\n      self.$container.removeClass('select2-container--focus');\r\n    });\r\n\r\n    this.on('query', function (params) {\r\n      if (!self.isOpen()) {\r\n        self.trigger('open', {});\r\n      }\r\n\r\n      this.dataAdapter.query(params, function (data) {\r\n        self.trigger('results:all', {\r\n          data: data,\r\n          query: params\r\n        });\r\n      });\r\n    });\r\n\r\n    this.on('query:append', function (params) {\r\n      this.dataAdapter.query(params, function (data) {\r\n        self.trigger('results:append', {\r\n          data: data,\r\n          query: params\r\n        });\r\n      });\r\n    });\r\n\r\n    this.on('keypress', function (evt) {\r\n      var key = evt.which;\r\n\r\n      if (self.isOpen()) {\r\n        if (key === KEYS.ESC || key === KEYS.TAB ||\r\n            (key === KEYS.UP && evt.altKey)) {\r\n          self.close();\r\n\r\n          evt.preventDefault();\r\n        } else if (key === KEYS.ENTER) {\r\n          self.trigger('results:select', {});\r\n\r\n          evt.preventDefault();\r\n        } else if ((key === KEYS.SPACE && evt.ctrlKey)) {\r\n          self.trigger('results:toggle', {});\r\n\r\n          evt.preventDefault();\r\n        } else if (key === KEYS.UP) {\r\n          self.trigger('results:previous', {});\r\n\r\n          evt.preventDefault();\r\n        } else if (key === KEYS.DOWN) {\r\n          self.trigger('results:next', {});\r\n\r\n          evt.preventDefault();\r\n        }\r\n      } else {\r\n        if (key === KEYS.ENTER || key === KEYS.SPACE ||\r\n            (key === KEYS.DOWN && evt.altKey)) {\r\n          self.open();\r\n\r\n          evt.preventDefault();\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  Select2.prototype._syncAttributes = function () {\r\n    this.options.set('disabled', this.$element.prop('disabled'));\r\n\r\n    if (this.options.get('disabled')) {\r\n      if (this.isOpen()) {\r\n        this.close();\r\n      }\r\n\r\n      this.trigger('disable', {});\r\n    } else {\r\n      this.trigger('enable', {});\r\n    }\r\n  };\r\n\r\n  Select2.prototype._syncSubtree = function (evt, mutations) {\r\n    var changed = false;\r\n    var self = this;\r\n\r\n    // Ignore any mutation events raised for elements that aren't options or\r\n    // optgroups. This handles the case when the select element is destroyed\r\n    if (\r\n      evt && evt.target && (\r\n        evt.target.nodeName !== 'OPTION' && evt.target.nodeName !== 'OPTGROUP'\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (!mutations) {\r\n      // If mutation events aren't supported, then we can only assume that the\r\n      // change affected the selections\r\n      changed = true;\r\n    } else if (mutations.addedNodes && mutations.addedNodes.length > 0) {\r\n      for (var n = 0; n < mutations.addedNodes.length; n++) {\r\n        var node = mutations.addedNodes[n];\r\n\r\n        if (node.selected) {\r\n          changed = true;\r\n        }\r\n      }\r\n    } else if (mutations.removedNodes && mutations.removedNodes.length > 0) {\r\n      changed = true;\r\n    }\r\n\r\n    // Only re-pull the data if we think there is a change\r\n    if (changed) {\r\n      this.dataAdapter.current(function (currentData) {\r\n        self.trigger('selection:update', {\r\n          data: currentData\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Override the trigger method to automatically trigger pre-events when\r\n   * there are events that can be prevented.\r\n   */\r\n  Select2.prototype.trigger = function (name, args) {\r\n    var actualTrigger = Select2.__super__.trigger;\r\n    var preTriggerMap = {\r\n      'open': 'opening',\r\n      'close': 'closing',\r\n      'select': 'selecting',\r\n      'unselect': 'unselecting'\r\n    };\r\n\r\n    if (args === undefined) {\r\n      args = {};\r\n    }\r\n\r\n    if (name in preTriggerMap) {\r\n      var preTriggerName = preTriggerMap[name];\r\n      var preTriggerArgs = {\r\n        prevented: false,\r\n        name: name,\r\n        args: args\r\n      };\r\n\r\n      actualTrigger.call(this, preTriggerName, preTriggerArgs);\r\n\r\n      if (preTriggerArgs.prevented) {\r\n        args.prevented = true;\r\n\r\n        return;\r\n      }\r\n    }\r\n\r\n    actualTrigger.call(this, name, args);\r\n  };\r\n\r\n  Select2.prototype.toggleDropdown = function () {\r\n    if (this.options.get('disabled')) {\r\n      return;\r\n    }\r\n\r\n    if (this.isOpen()) {\r\n      this.close();\r\n    } else {\r\n      this.open();\r\n    }\r\n  };\r\n\r\n  Select2.prototype.open = function () {\r\n    if (this.isOpen()) {\r\n      return;\r\n    }\r\n\r\n    this.trigger('query', {});\r\n  };\r\n\r\n  Select2.prototype.close = function () {\r\n    if (!this.isOpen()) {\r\n      return;\r\n    }\r\n\r\n    this.trigger('close', {});\r\n  };\r\n\r\n  Select2.prototype.isOpen = function () {\r\n    return this.$container.hasClass('select2-container--open');\r\n  };\r\n\r\n  Select2.prototype.hasFocus = function () {\r\n    return this.$container.hasClass('select2-container--focus');\r\n  };\r\n\r\n  Select2.prototype.focus = function (data) {\r\n    // No need to re-trigger focus events if we are already focused\r\n    if (this.hasFocus()) {\r\n      return;\r\n    }\r\n\r\n    this.$container.addClass('select2-container--focus');\r\n    this.trigger('focus', {});\r\n  };\r\n\r\n  Select2.prototype.enable = function (args) {\r\n    if (this.options.get('debug') && window.console && console.warn) {\r\n      console.warn(\r\n        'Select2: The `select2(\"enable\")` method has been deprecated and will' +\r\n        ' be removed in later Select2 versions. Use $element.prop(\"disabled\")' +\r\n        ' instead.'\r\n      );\r\n    }\r\n\r\n    if (args == null || args.length === 0) {\r\n      args = [true];\r\n    }\r\n\r\n    var disabled = !args[0];\r\n\r\n    this.$element.prop('disabled', disabled);\r\n  };\r\n\r\n  Select2.prototype.data = function () {\r\n    if (this.options.get('debug') &&\r\n        arguments.length > 0 && window.console && console.warn) {\r\n      console.warn(\r\n        'Select2: Data can no longer be set using `select2(\"data\")`. You ' +\r\n        'should consider setting the value instead using `$element.val()`.'\r\n      );\r\n    }\r\n\r\n    var data = [];\r\n\r\n    this.dataAdapter.current(function (currentData) {\r\n      data = currentData;\r\n    });\r\n\r\n    return data;\r\n  };\r\n\r\n  Select2.prototype.val = function (args) {\r\n    if (this.options.get('debug') && window.console && console.warn) {\r\n      console.warn(\r\n        'Select2: The `select2(\"val\")` method has been deprecated and will be' +\r\n        ' removed in later Select2 versions. Use $element.val() instead.'\r\n      );\r\n    }\r\n\r\n    if (args == null || args.length === 0) {\r\n      return this.$element.val();\r\n    }\r\n\r\n    var newVal = args[0];\r\n\r\n    if ($.isArray(newVal)) {\r\n      newVal = $.map(newVal, function (obj) {\r\n        return obj.toString();\r\n      });\r\n    }\r\n\r\n    this.$element.val(newVal).trigger('change');\r\n  };\r\n\r\n  Select2.prototype.destroy = function () {\r\n    this.$container.remove();\r\n\r\n    if (this.$element[0].detachEvent) {\r\n      this.$element[0].detachEvent('onpropertychange', this._syncA);\r\n    }\r\n\r\n    if (this._observer != null) {\r\n      this._observer.disconnect();\r\n      this._observer = null;\r\n    } else if (this.$element[0].removeEventListener) {\r\n      this.$element[0]\r\n        .removeEventListener('DOMAttrModified', this._syncA, false);\r\n      this.$element[0]\r\n        .removeEventListener('DOMNodeInserted', this._syncS, false);\r\n      this.$element[0]\r\n        .removeEventListener('DOMNodeRemoved', this._syncS, false);\r\n    }\r\n\r\n    this._syncA = null;\r\n    this._syncS = null;\r\n\r\n    this.$element.off('.select2');\r\n    this.$element.attr('tabindex', this.$element.data('old-tabindex'));\r\n\r\n    this.$element.removeClass('select2-hidden-accessible');\r\n    this.$element.attr('aria-hidden', 'false');\r\n    this.$element.removeData('select2');\r\n\r\n    this.dataAdapter.destroy();\r\n    this.selection.destroy();\r\n    this.dropdown.destroy();\r\n    this.results.destroy();\r\n\r\n    this.dataAdapter = null;\r\n    this.selection = null;\r\n    this.dropdown = null;\r\n    this.results = null;\r\n  };\r\n\r\n  Select2.prototype.render = function () {\r\n    var $container = $(\r\n      '<span class=\"select2 select2-container\">' +\r\n        '<span class=\"selection\"></span>' +\r\n        '<span class=\"dropdown-wrapper\" aria-hidden=\"true\"></span>' +\r\n      '</span>'\r\n    );\r\n\r\n    $container.attr('dir', this.options.get('dir'));\r\n\r\n    this.$container = $container;\r\n\r\n    this.$container.addClass('select2-container--' + this.options.get('theme'));\r\n\r\n    $container.data('element', this.$element);\r\n\r\n    return $container;\r\n  };\r\n\r\n  return Select2;\r\n});\r\n\nS2.define('jquery-mousewheel',[\r\n  'jquery'\r\n], function ($) {\r\n  // Used to shim jQuery.mousewheel for non-full builds.\r\n  return $;\r\n});\r\n\nS2.define('jquery.select2',[\r\n  'jquery',\r\n  'jquery-mousewheel',\r\n\r\n  './select2/core',\r\n  './select2/defaults'\r\n], function ($, _, Select2, Defaults) {\r\n  if ($.fn.select2 == null) {\r\n    // All methods that should return the element\r\n    var thisMethods = ['open', 'close', 'destroy'];\r\n\r\n    $.fn.select2 = function (options) {\r\n      options = options || {};\r\n\r\n      if (typeof options === 'object') {\r\n        this.each(function () {\r\n          var instanceOptions = $.extend(true, {}, options);\r\n\r\n          var instance = new Select2($(this), instanceOptions);\r\n        });\r\n\r\n        return this;\r\n      } else if (typeof options === 'string') {\r\n        var ret;\r\n        var args = Array.prototype.slice.call(arguments, 1);\r\n\r\n        this.each(function () {\r\n          var instance = $(this).data('select2');\r\n\r\n          if (instance == null && window.console && console.error) {\r\n            console.error(\r\n              'The select2(\\'' + options + '\\') method was called on an ' +\r\n              'element that is not using Select2.'\r\n            );\r\n          }\r\n\r\n          ret = instance[options].apply(instance, args);\r\n        });\r\n\r\n        // Check if we should be returning `this`\r\n        if ($.inArray(options, thisMethods) > -1) {\r\n          return this;\r\n        }\r\n\r\n        return ret;\r\n      } else {\r\n        throw new Error('Invalid arguments for Select2: ' + options);\r\n      }\r\n    };\r\n  }\r\n\r\n  if ($.fn.select2.defaults == null) {\r\n    $.fn.select2.defaults = Defaults;\r\n  }\r\n\r\n  return Select2;\r\n});\r\n\n  // Return the AMD loader configuration so it can be used outside of this file\r\n  return {\r\n    define: S2.define,\r\n    require: S2.require\r\n  };\r\n}());\r\n\r\n  // Autoload the jQuery bindings\r\n  // We know that all of the modules exist above this, so we're safe\r\n  var select2 = S2.require('jquery.select2');\r\n\r\n  // Hold the AMD module references on the jQuery function that was just loaded\r\n  // This allows Select2 to use the internal loader outside of this file, such\r\n  // as in the language files.\r\n  jQuery.fn.select2.amd = S2;\r\n\r\n  // Return the Select2 instance for anyone who is importing it.\r\n  return select2;\r\n}));\r\n"

/***/ },

/***/ 81:
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(79)(__webpack_require__(82)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/source-map-loader/index.js!/Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/bootstrap/dist/js/bootstrap.js")

/***/ },

/***/ 82:
/***/ function(module, exports) {

	module.exports = "/*!\n * Bootstrap v3.3.7 (http://getbootstrap.com)\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under the MIT license\n */\n\nif (typeof jQuery === 'undefined') {\n  throw new Error('Bootstrap\\'s JavaScript requires jQuery')\n}\n\n+function ($) {\n  'use strict';\n  var version = $.fn.jquery.split(' ')[0].split('.')\n  if ((version[0] < 2 && version[1] < 9) || (version[0] == 1 && version[1] == 9 && version[2] < 1) || (version[0] > 3)) {\n    throw new Error('Bootstrap\\'s JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4')\n  }\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: transition.js v3.3.7\n * http://getbootstrap.com/javascript/#transitions\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)\n  // ============================================================\n\n  function transitionEnd() {\n    var el = document.createElement('bootstrap')\n\n    var transEndEventNames = {\n      WebkitTransition : 'webkitTransitionEnd',\n      MozTransition    : 'transitionend',\n      OTransition      : 'oTransitionEnd otransitionend',\n      transition       : 'transitionend'\n    }\n\n    for (var name in transEndEventNames) {\n      if (el.style[name] !== undefined) {\n        return { end: transEndEventNames[name] }\n      }\n    }\n\n    return false // explicit for ie8 (  ._.)\n  }\n\n  // http://blog.alexmaccaw.com/css-transitions\n  $.fn.emulateTransitionEnd = function (duration) {\n    var called = false\n    var $el = this\n    $(this).one('bsTransitionEnd', function () { called = true })\n    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }\n    setTimeout(callback, duration)\n    return this\n  }\n\n  $(function () {\n    $.support.transition = transitionEnd()\n\n    if (!$.support.transition) return\n\n    $.event.special.bsTransitionEnd = {\n      bindType: $.support.transition.end,\n      delegateType: $.support.transition.end,\n      handle: function (e) {\n        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)\n      }\n    }\n  })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: alert.js v3.3.7\n * http://getbootstrap.com/javascript/#alerts\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // ALERT CLASS DEFINITION\n  // ======================\n\n  var dismiss = '[data-dismiss=\"alert\"]'\n  var Alert   = function (el) {\n    $(el).on('click', dismiss, this.close)\n  }\n\n  Alert.VERSION = '3.3.7'\n\n  Alert.TRANSITION_DURATION = 150\n\n  Alert.prototype.close = function (e) {\n    var $this    = $(this)\n    var selector = $this.attr('data-target')\n\n    if (!selector) {\n      selector = $this.attr('href')\n      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\n    }\n\n    var $parent = $(selector === '#' ? [] : selector)\n\n    if (e) e.preventDefault()\n\n    if (!$parent.length) {\n      $parent = $this.closest('.alert')\n    }\n\n    $parent.trigger(e = $.Event('close.bs.alert'))\n\n    if (e.isDefaultPrevented()) return\n\n    $parent.removeClass('in')\n\n    function removeElement() {\n      // detach from parent, fire event then clean up data\n      $parent.detach().trigger('closed.bs.alert').remove()\n    }\n\n    $.support.transition && $parent.hasClass('fade') ?\n      $parent\n        .one('bsTransitionEnd', removeElement)\n        .emulateTransitionEnd(Alert.TRANSITION_DURATION) :\n      removeElement()\n  }\n\n\n  // ALERT PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var data  = $this.data('bs.alert')\n\n      if (!data) $this.data('bs.alert', (data = new Alert(this)))\n      if (typeof option == 'string') data[option].call($this)\n    })\n  }\n\n  var old = $.fn.alert\n\n  $.fn.alert             = Plugin\n  $.fn.alert.Constructor = Alert\n\n\n  // ALERT NO CONFLICT\n  // =================\n\n  $.fn.alert.noConflict = function () {\n    $.fn.alert = old\n    return this\n  }\n\n\n  // ALERT DATA-API\n  // ==============\n\n  $(document).on('click.bs.alert.data-api', dismiss, Alert.prototype.close)\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: button.js v3.3.7\n * http://getbootstrap.com/javascript/#buttons\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // BUTTON PUBLIC CLASS DEFINITION\n  // ==============================\n\n  var Button = function (element, options) {\n    this.$element  = $(element)\n    this.options   = $.extend({}, Button.DEFAULTS, options)\n    this.isLoading = false\n  }\n\n  Button.VERSION  = '3.3.7'\n\n  Button.DEFAULTS = {\n    loadingText: 'loading...'\n  }\n\n  Button.prototype.setState = function (state) {\n    var d    = 'disabled'\n    var $el  = this.$element\n    var val  = $el.is('input') ? 'val' : 'html'\n    var data = $el.data()\n\n    state += 'Text'\n\n    if (data.resetText == null) $el.data('resetText', $el[val]())\n\n    // push to event loop to allow forms to submit\n    setTimeout($.proxy(function () {\n      $el[val](data[state] == null ? this.options[state] : data[state])\n\n      if (state == 'loadingText') {\n        this.isLoading = true\n        $el.addClass(d).attr(d, d).prop(d, true)\n      } else if (this.isLoading) {\n        this.isLoading = false\n        $el.removeClass(d).removeAttr(d).prop(d, false)\n      }\n    }, this), 0)\n  }\n\n  Button.prototype.toggle = function () {\n    var changed = true\n    var $parent = this.$element.closest('[data-toggle=\"buttons\"]')\n\n    if ($parent.length) {\n      var $input = this.$element.find('input')\n      if ($input.prop('type') == 'radio') {\n        if ($input.prop('checked')) changed = false\n        $parent.find('.active').removeClass('active')\n        this.$element.addClass('active')\n      } else if ($input.prop('type') == 'checkbox') {\n        if (($input.prop('checked')) !== this.$element.hasClass('active')) changed = false\n        this.$element.toggleClass('active')\n      }\n      $input.prop('checked', this.$element.hasClass('active'))\n      if (changed) $input.trigger('change')\n    } else {\n      this.$element.attr('aria-pressed', !this.$element.hasClass('active'))\n      this.$element.toggleClass('active')\n    }\n  }\n\n\n  // BUTTON PLUGIN DEFINITION\n  // ========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.button')\n      var options = typeof option == 'object' && option\n\n      if (!data) $this.data('bs.button', (data = new Button(this, options)))\n\n      if (option == 'toggle') data.toggle()\n      else if (option) data.setState(option)\n    })\n  }\n\n  var old = $.fn.button\n\n  $.fn.button             = Plugin\n  $.fn.button.Constructor = Button\n\n\n  // BUTTON NO CONFLICT\n  // ==================\n\n  $.fn.button.noConflict = function () {\n    $.fn.button = old\n    return this\n  }\n\n\n  // BUTTON DATA-API\n  // ===============\n\n  $(document)\n    .on('click.bs.button.data-api', '[data-toggle^=\"button\"]', function (e) {\n      var $btn = $(e.target).closest('.btn')\n      Plugin.call($btn, 'toggle')\n      if (!($(e.target).is('input[type=\"radio\"], input[type=\"checkbox\"]'))) {\n        // Prevent double click on radios, and the double selections (so cancellation) on checkboxes\n        e.preventDefault()\n        // The target component still receive the focus\n        if ($btn.is('input,button')) $btn.trigger('focus')\n        else $btn.find('input:visible,button:visible').first().trigger('focus')\n      }\n    })\n    .on('focus.bs.button.data-api blur.bs.button.data-api', '[data-toggle^=\"button\"]', function (e) {\n      $(e.target).closest('.btn').toggleClass('focus', /^focus(in)?$/.test(e.type))\n    })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: carousel.js v3.3.7\n * http://getbootstrap.com/javascript/#carousel\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // CAROUSEL CLASS DEFINITION\n  // =========================\n\n  var Carousel = function (element, options) {\n    this.$element    = $(element)\n    this.$indicators = this.$element.find('.carousel-indicators')\n    this.options     = options\n    this.paused      = null\n    this.sliding     = null\n    this.interval    = null\n    this.$active     = null\n    this.$items      = null\n\n    this.options.keyboard && this.$element.on('keydown.bs.carousel', $.proxy(this.keydown, this))\n\n    this.options.pause == 'hover' && !('ontouchstart' in document.documentElement) && this.$element\n      .on('mouseenter.bs.carousel', $.proxy(this.pause, this))\n      .on('mouseleave.bs.carousel', $.proxy(this.cycle, this))\n  }\n\n  Carousel.VERSION  = '3.3.7'\n\n  Carousel.TRANSITION_DURATION = 600\n\n  Carousel.DEFAULTS = {\n    interval: 5000,\n    pause: 'hover',\n    wrap: true,\n    keyboard: true\n  }\n\n  Carousel.prototype.keydown = function (e) {\n    if (/input|textarea/i.test(e.target.tagName)) return\n    switch (e.which) {\n      case 37: this.prev(); break\n      case 39: this.next(); break\n      default: return\n    }\n\n    e.preventDefault()\n  }\n\n  Carousel.prototype.cycle = function (e) {\n    e || (this.paused = false)\n\n    this.interval && clearInterval(this.interval)\n\n    this.options.interval\n      && !this.paused\n      && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))\n\n    return this\n  }\n\n  Carousel.prototype.getItemIndex = function (item) {\n    this.$items = item.parent().children('.item')\n    return this.$items.index(item || this.$active)\n  }\n\n  Carousel.prototype.getItemForDirection = function (direction, active) {\n    var activeIndex = this.getItemIndex(active)\n    var willWrap = (direction == 'prev' && activeIndex === 0)\n                || (direction == 'next' && activeIndex == (this.$items.length - 1))\n    if (willWrap && !this.options.wrap) return active\n    var delta = direction == 'prev' ? -1 : 1\n    var itemIndex = (activeIndex + delta) % this.$items.length\n    return this.$items.eq(itemIndex)\n  }\n\n  Carousel.prototype.to = function (pos) {\n    var that        = this\n    var activeIndex = this.getItemIndex(this.$active = this.$element.find('.item.active'))\n\n    if (pos > (this.$items.length - 1) || pos < 0) return\n\n    if (this.sliding)       return this.$element.one('slid.bs.carousel', function () { that.to(pos) }) // yes, \"slid\"\n    if (activeIndex == pos) return this.pause().cycle()\n\n    return this.slide(pos > activeIndex ? 'next' : 'prev', this.$items.eq(pos))\n  }\n\n  Carousel.prototype.pause = function (e) {\n    e || (this.paused = true)\n\n    if (this.$element.find('.next, .prev').length && $.support.transition) {\n      this.$element.trigger($.support.transition.end)\n      this.cycle(true)\n    }\n\n    this.interval = clearInterval(this.interval)\n\n    return this\n  }\n\n  Carousel.prototype.next = function () {\n    if (this.sliding) return\n    return this.slide('next')\n  }\n\n  Carousel.prototype.prev = function () {\n    if (this.sliding) return\n    return this.slide('prev')\n  }\n\n  Carousel.prototype.slide = function (type, next) {\n    var $active   = this.$element.find('.item.active')\n    var $next     = next || this.getItemForDirection(type, $active)\n    var isCycling = this.interval\n    var direction = type == 'next' ? 'left' : 'right'\n    var that      = this\n\n    if ($next.hasClass('active')) return (this.sliding = false)\n\n    var relatedTarget = $next[0]\n    var slideEvent = $.Event('slide.bs.carousel', {\n      relatedTarget: relatedTarget,\n      direction: direction\n    })\n    this.$element.trigger(slideEvent)\n    if (slideEvent.isDefaultPrevented()) return\n\n    this.sliding = true\n\n    isCycling && this.pause()\n\n    if (this.$indicators.length) {\n      this.$indicators.find('.active').removeClass('active')\n      var $nextIndicator = $(this.$indicators.children()[this.getItemIndex($next)])\n      $nextIndicator && $nextIndicator.addClass('active')\n    }\n\n    var slidEvent = $.Event('slid.bs.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, \"slid\"\n    if ($.support.transition && this.$element.hasClass('slide')) {\n      $next.addClass(type)\n      $next[0].offsetWidth // force reflow\n      $active.addClass(direction)\n      $next.addClass(direction)\n      $active\n        .one('bsTransitionEnd', function () {\n          $next.removeClass([type, direction].join(' ')).addClass('active')\n          $active.removeClass(['active', direction].join(' '))\n          that.sliding = false\n          setTimeout(function () {\n            that.$element.trigger(slidEvent)\n          }, 0)\n        })\n        .emulateTransitionEnd(Carousel.TRANSITION_DURATION)\n    } else {\n      $active.removeClass('active')\n      $next.addClass('active')\n      this.sliding = false\n      this.$element.trigger(slidEvent)\n    }\n\n    isCycling && this.cycle()\n\n    return this\n  }\n\n\n  // CAROUSEL PLUGIN DEFINITION\n  // ==========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.carousel')\n      var options = $.extend({}, Carousel.DEFAULTS, $this.data(), typeof option == 'object' && option)\n      var action  = typeof option == 'string' ? option : options.slide\n\n      if (!data) $this.data('bs.carousel', (data = new Carousel(this, options)))\n      if (typeof option == 'number') data.to(option)\n      else if (action) data[action]()\n      else if (options.interval) data.pause().cycle()\n    })\n  }\n\n  var old = $.fn.carousel\n\n  $.fn.carousel             = Plugin\n  $.fn.carousel.Constructor = Carousel\n\n\n  // CAROUSEL NO CONFLICT\n  // ====================\n\n  $.fn.carousel.noConflict = function () {\n    $.fn.carousel = old\n    return this\n  }\n\n\n  // CAROUSEL DATA-API\n  // =================\n\n  var clickHandler = function (e) {\n    var href\n    var $this   = $(this)\n    var $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '')) // strip for ie7\n    if (!$target.hasClass('carousel')) return\n    var options = $.extend({}, $target.data(), $this.data())\n    var slideIndex = $this.attr('data-slide-to')\n    if (slideIndex) options.interval = false\n\n    Plugin.call($target, options)\n\n    if (slideIndex) {\n      $target.data('bs.carousel').to(slideIndex)\n    }\n\n    e.preventDefault()\n  }\n\n  $(document)\n    .on('click.bs.carousel.data-api', '[data-slide]', clickHandler)\n    .on('click.bs.carousel.data-api', '[data-slide-to]', clickHandler)\n\n  $(window).on('load', function () {\n    $('[data-ride=\"carousel\"]').each(function () {\n      var $carousel = $(this)\n      Plugin.call($carousel, $carousel.data())\n    })\n  })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: collapse.js v3.3.7\n * http://getbootstrap.com/javascript/#collapse\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n/* jshint latedef: false */\n\n+function ($) {\n  'use strict';\n\n  // COLLAPSE PUBLIC CLASS DEFINITION\n  // ================================\n\n  var Collapse = function (element, options) {\n    this.$element      = $(element)\n    this.options       = $.extend({}, Collapse.DEFAULTS, options)\n    this.$trigger      = $('[data-toggle=\"collapse\"][href=\"#' + element.id + '\"],' +\n                           '[data-toggle=\"collapse\"][data-target=\"#' + element.id + '\"]')\n    this.transitioning = null\n\n    if (this.options.parent) {\n      this.$parent = this.getParent()\n    } else {\n      this.addAriaAndCollapsedClass(this.$element, this.$trigger)\n    }\n\n    if (this.options.toggle) this.toggle()\n  }\n\n  Collapse.VERSION  = '3.3.7'\n\n  Collapse.TRANSITION_DURATION = 350\n\n  Collapse.DEFAULTS = {\n    toggle: true\n  }\n\n  Collapse.prototype.dimension = function () {\n    var hasWidth = this.$element.hasClass('width')\n    return hasWidth ? 'width' : 'height'\n  }\n\n  Collapse.prototype.show = function () {\n    if (this.transitioning || this.$element.hasClass('in')) return\n\n    var activesData\n    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')\n\n    if (actives && actives.length) {\n      activesData = actives.data('bs.collapse')\n      if (activesData && activesData.transitioning) return\n    }\n\n    var startEvent = $.Event('show.bs.collapse')\n    this.$element.trigger(startEvent)\n    if (startEvent.isDefaultPrevented()) return\n\n    if (actives && actives.length) {\n      Plugin.call(actives, 'hide')\n      activesData || actives.data('bs.collapse', null)\n    }\n\n    var dimension = this.dimension()\n\n    this.$element\n      .removeClass('collapse')\n      .addClass('collapsing')[dimension](0)\n      .attr('aria-expanded', true)\n\n    this.$trigger\n      .removeClass('collapsed')\n      .attr('aria-expanded', true)\n\n    this.transitioning = 1\n\n    var complete = function () {\n      this.$element\n        .removeClass('collapsing')\n        .addClass('collapse in')[dimension]('')\n      this.transitioning = 0\n      this.$element\n        .trigger('shown.bs.collapse')\n    }\n\n    if (!$.support.transition) return complete.call(this)\n\n    var scrollSize = $.camelCase(['scroll', dimension].join('-'))\n\n    this.$element\n      .one('bsTransitionEnd', $.proxy(complete, this))\n      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])\n  }\n\n  Collapse.prototype.hide = function () {\n    if (this.transitioning || !this.$element.hasClass('in')) return\n\n    var startEvent = $.Event('hide.bs.collapse')\n    this.$element.trigger(startEvent)\n    if (startEvent.isDefaultPrevented()) return\n\n    var dimension = this.dimension()\n\n    this.$element[dimension](this.$element[dimension]())[0].offsetHeight\n\n    this.$element\n      .addClass('collapsing')\n      .removeClass('collapse in')\n      .attr('aria-expanded', false)\n\n    this.$trigger\n      .addClass('collapsed')\n      .attr('aria-expanded', false)\n\n    this.transitioning = 1\n\n    var complete = function () {\n      this.transitioning = 0\n      this.$element\n        .removeClass('collapsing')\n        .addClass('collapse')\n        .trigger('hidden.bs.collapse')\n    }\n\n    if (!$.support.transition) return complete.call(this)\n\n    this.$element\n      [dimension](0)\n      .one('bsTransitionEnd', $.proxy(complete, this))\n      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)\n  }\n\n  Collapse.prototype.toggle = function () {\n    this[this.$element.hasClass('in') ? 'hide' : 'show']()\n  }\n\n  Collapse.prototype.getParent = function () {\n    return $(this.options.parent)\n      .find('[data-toggle=\"collapse\"][data-parent=\"' + this.options.parent + '\"]')\n      .each($.proxy(function (i, element) {\n        var $element = $(element)\n        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)\n      }, this))\n      .end()\n  }\n\n  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {\n    var isOpen = $element.hasClass('in')\n\n    $element.attr('aria-expanded', isOpen)\n    $trigger\n      .toggleClass('collapsed', !isOpen)\n      .attr('aria-expanded', isOpen)\n  }\n\n  function getTargetFromTrigger($trigger) {\n    var href\n    var target = $trigger.attr('data-target')\n      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') // strip for ie7\n\n    return $(target)\n  }\n\n\n  // COLLAPSE PLUGIN DEFINITION\n  // ==========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.collapse')\n      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false\n      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.collapse\n\n  $.fn.collapse             = Plugin\n  $.fn.collapse.Constructor = Collapse\n\n\n  // COLLAPSE NO CONFLICT\n  // ====================\n\n  $.fn.collapse.noConflict = function () {\n    $.fn.collapse = old\n    return this\n  }\n\n\n  // COLLAPSE DATA-API\n  // =================\n\n  $(document).on('click.bs.collapse.data-api', '[data-toggle=\"collapse\"]', function (e) {\n    var $this   = $(this)\n\n    if (!$this.attr('data-target')) e.preventDefault()\n\n    var $target = getTargetFromTrigger($this)\n    var data    = $target.data('bs.collapse')\n    var option  = data ? 'toggle' : $this.data()\n\n    Plugin.call($target, option)\n  })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: dropdown.js v3.3.7\n * http://getbootstrap.com/javascript/#dropdowns\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // DROPDOWN CLASS DEFINITION\n  // =========================\n\n  var backdrop = '.dropdown-backdrop'\n  var toggle   = '[data-toggle=\"dropdown\"]'\n  var Dropdown = function (element) {\n    $(element).on('click.bs.dropdown', this.toggle)\n  }\n\n  Dropdown.VERSION = '3.3.7'\n\n  function getParent($this) {\n    var selector = $this.attr('data-target')\n\n    if (!selector) {\n      selector = $this.attr('href')\n      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\n    }\n\n    var $parent = selector && $(selector)\n\n    return $parent && $parent.length ? $parent : $this.parent()\n  }\n\n  function clearMenus(e) {\n    if (e && e.which === 3) return\n    $(backdrop).remove()\n    $(toggle).each(function () {\n      var $this         = $(this)\n      var $parent       = getParent($this)\n      var relatedTarget = { relatedTarget: this }\n\n      if (!$parent.hasClass('open')) return\n\n      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return\n\n      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))\n\n      if (e.isDefaultPrevented()) return\n\n      $this.attr('aria-expanded', 'false')\n      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))\n    })\n  }\n\n  Dropdown.prototype.toggle = function (e) {\n    var $this = $(this)\n\n    if ($this.is('.disabled, :disabled')) return\n\n    var $parent  = getParent($this)\n    var isActive = $parent.hasClass('open')\n\n    clearMenus()\n\n    if (!isActive) {\n      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {\n        // if mobile we use a backdrop because click events don't delegate\n        $(document.createElement('div'))\n          .addClass('dropdown-backdrop')\n          .insertAfter($(this))\n          .on('click', clearMenus)\n      }\n\n      var relatedTarget = { relatedTarget: this }\n      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))\n\n      if (e.isDefaultPrevented()) return\n\n      $this\n        .trigger('focus')\n        .attr('aria-expanded', 'true')\n\n      $parent\n        .toggleClass('open')\n        .trigger($.Event('shown.bs.dropdown', relatedTarget))\n    }\n\n    return false\n  }\n\n  Dropdown.prototype.keydown = function (e) {\n    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return\n\n    var $this = $(this)\n\n    e.preventDefault()\n    e.stopPropagation()\n\n    if ($this.is('.disabled, :disabled')) return\n\n    var $parent  = getParent($this)\n    var isActive = $parent.hasClass('open')\n\n    if (!isActive && e.which != 27 || isActive && e.which == 27) {\n      if (e.which == 27) $parent.find(toggle).trigger('focus')\n      return $this.trigger('click')\n    }\n\n    var desc = ' li:not(.disabled):visible a'\n    var $items = $parent.find('.dropdown-menu' + desc)\n\n    if (!$items.length) return\n\n    var index = $items.index(e.target)\n\n    if (e.which == 38 && index > 0)                 index--         // up\n    if (e.which == 40 && index < $items.length - 1) index++         // down\n    if (!~index)                                    index = 0\n\n    $items.eq(index).trigger('focus')\n  }\n\n\n  // DROPDOWN PLUGIN DEFINITION\n  // ==========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var data  = $this.data('bs.dropdown')\n\n      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))\n      if (typeof option == 'string') data[option].call($this)\n    })\n  }\n\n  var old = $.fn.dropdown\n\n  $.fn.dropdown             = Plugin\n  $.fn.dropdown.Constructor = Dropdown\n\n\n  // DROPDOWN NO CONFLICT\n  // ====================\n\n  $.fn.dropdown.noConflict = function () {\n    $.fn.dropdown = old\n    return this\n  }\n\n\n  // APPLY TO STANDARD DROPDOWN ELEMENTS\n  // ===================================\n\n  $(document)\n    .on('click.bs.dropdown.data-api', clearMenus)\n    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })\n    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)\n    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)\n    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: modal.js v3.3.7\n * http://getbootstrap.com/javascript/#modals\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // MODAL CLASS DEFINITION\n  // ======================\n\n  var Modal = function (element, options) {\n    this.options             = options\n    this.$body               = $(document.body)\n    this.$element            = $(element)\n    this.$dialog             = this.$element.find('.modal-dialog')\n    this.$backdrop           = null\n    this.isShown             = null\n    this.originalBodyPad     = null\n    this.scrollbarWidth      = 0\n    this.ignoreBackdropClick = false\n\n    if (this.options.remote) {\n      this.$element\n        .find('.modal-content')\n        .load(this.options.remote, $.proxy(function () {\n          this.$element.trigger('loaded.bs.modal')\n        }, this))\n    }\n  }\n\n  Modal.VERSION  = '3.3.7'\n\n  Modal.TRANSITION_DURATION = 300\n  Modal.BACKDROP_TRANSITION_DURATION = 150\n\n  Modal.DEFAULTS = {\n    backdrop: true,\n    keyboard: true,\n    show: true\n  }\n\n  Modal.prototype.toggle = function (_relatedTarget) {\n    return this.isShown ? this.hide() : this.show(_relatedTarget)\n  }\n\n  Modal.prototype.show = function (_relatedTarget) {\n    var that = this\n    var e    = $.Event('show.bs.modal', { relatedTarget: _relatedTarget })\n\n    this.$element.trigger(e)\n\n    if (this.isShown || e.isDefaultPrevented()) return\n\n    this.isShown = true\n\n    this.checkScrollbar()\n    this.setScrollbar()\n    this.$body.addClass('modal-open')\n\n    this.escape()\n    this.resize()\n\n    this.$element.on('click.dismiss.bs.modal', '[data-dismiss=\"modal\"]', $.proxy(this.hide, this))\n\n    this.$dialog.on('mousedown.dismiss.bs.modal', function () {\n      that.$element.one('mouseup.dismiss.bs.modal', function (e) {\n        if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true\n      })\n    })\n\n    this.backdrop(function () {\n      var transition = $.support.transition && that.$element.hasClass('fade')\n\n      if (!that.$element.parent().length) {\n        that.$element.appendTo(that.$body) // don't move modals dom position\n      }\n\n      that.$element\n        .show()\n        .scrollTop(0)\n\n      that.adjustDialog()\n\n      if (transition) {\n        that.$element[0].offsetWidth // force reflow\n      }\n\n      that.$element.addClass('in')\n\n      that.enforceFocus()\n\n      var e = $.Event('shown.bs.modal', { relatedTarget: _relatedTarget })\n\n      transition ?\n        that.$dialog // wait for modal to slide in\n          .one('bsTransitionEnd', function () {\n            that.$element.trigger('focus').trigger(e)\n          })\n          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n        that.$element.trigger('focus').trigger(e)\n    })\n  }\n\n  Modal.prototype.hide = function (e) {\n    if (e) e.preventDefault()\n\n    e = $.Event('hide.bs.modal')\n\n    this.$element.trigger(e)\n\n    if (!this.isShown || e.isDefaultPrevented()) return\n\n    this.isShown = false\n\n    this.escape()\n    this.resize()\n\n    $(document).off('focusin.bs.modal')\n\n    this.$element\n      .removeClass('in')\n      .off('click.dismiss.bs.modal')\n      .off('mouseup.dismiss.bs.modal')\n\n    this.$dialog.off('mousedown.dismiss.bs.modal')\n\n    $.support.transition && this.$element.hasClass('fade') ?\n      this.$element\n        .one('bsTransitionEnd', $.proxy(this.hideModal, this))\n        .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n      this.hideModal()\n  }\n\n  Modal.prototype.enforceFocus = function () {\n    $(document)\n      .off('focusin.bs.modal') // guard against infinite focus loop\n      .on('focusin.bs.modal', $.proxy(function (e) {\n        if (document !== e.target &&\n            this.$element[0] !== e.target &&\n            !this.$element.has(e.target).length) {\n          this.$element.trigger('focus')\n        }\n      }, this))\n  }\n\n  Modal.prototype.escape = function () {\n    if (this.isShown && this.options.keyboard) {\n      this.$element.on('keydown.dismiss.bs.modal', $.proxy(function (e) {\n        e.which == 27 && this.hide()\n      }, this))\n    } else if (!this.isShown) {\n      this.$element.off('keydown.dismiss.bs.modal')\n    }\n  }\n\n  Modal.prototype.resize = function () {\n    if (this.isShown) {\n      $(window).on('resize.bs.modal', $.proxy(this.handleUpdate, this))\n    } else {\n      $(window).off('resize.bs.modal')\n    }\n  }\n\n  Modal.prototype.hideModal = function () {\n    var that = this\n    this.$element.hide()\n    this.backdrop(function () {\n      that.$body.removeClass('modal-open')\n      that.resetAdjustments()\n      that.resetScrollbar()\n      that.$element.trigger('hidden.bs.modal')\n    })\n  }\n\n  Modal.prototype.removeBackdrop = function () {\n    this.$backdrop && this.$backdrop.remove()\n    this.$backdrop = null\n  }\n\n  Modal.prototype.backdrop = function (callback) {\n    var that = this\n    var animate = this.$element.hasClass('fade') ? 'fade' : ''\n\n    if (this.isShown && this.options.backdrop) {\n      var doAnimate = $.support.transition && animate\n\n      this.$backdrop = $(document.createElement('div'))\n        .addClass('modal-backdrop ' + animate)\n        .appendTo(this.$body)\n\n      this.$element.on('click.dismiss.bs.modal', $.proxy(function (e) {\n        if (this.ignoreBackdropClick) {\n          this.ignoreBackdropClick = false\n          return\n        }\n        if (e.target !== e.currentTarget) return\n        this.options.backdrop == 'static'\n          ? this.$element[0].focus()\n          : this.hide()\n      }, this))\n\n      if (doAnimate) this.$backdrop[0].offsetWidth // force reflow\n\n      this.$backdrop.addClass('in')\n\n      if (!callback) return\n\n      doAnimate ?\n        this.$backdrop\n          .one('bsTransitionEnd', callback)\n          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n        callback()\n\n    } else if (!this.isShown && this.$backdrop) {\n      this.$backdrop.removeClass('in')\n\n      var callbackRemove = function () {\n        that.removeBackdrop()\n        callback && callback()\n      }\n      $.support.transition && this.$element.hasClass('fade') ?\n        this.$backdrop\n          .one('bsTransitionEnd', callbackRemove)\n          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n        callbackRemove()\n\n    } else if (callback) {\n      callback()\n    }\n  }\n\n  // these following methods are used to handle overflowing modals\n\n  Modal.prototype.handleUpdate = function () {\n    this.adjustDialog()\n  }\n\n  Modal.prototype.adjustDialog = function () {\n    var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight\n\n    this.$element.css({\n      paddingLeft:  !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',\n      paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''\n    })\n  }\n\n  Modal.prototype.resetAdjustments = function () {\n    this.$element.css({\n      paddingLeft: '',\n      paddingRight: ''\n    })\n  }\n\n  Modal.prototype.checkScrollbar = function () {\n    var fullWindowWidth = window.innerWidth\n    if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8\n      var documentElementRect = document.documentElement.getBoundingClientRect()\n      fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)\n    }\n    this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth\n    this.scrollbarWidth = this.measureScrollbar()\n  }\n\n  Modal.prototype.setScrollbar = function () {\n    var bodyPad = parseInt((this.$body.css('padding-right') || 0), 10)\n    this.originalBodyPad = document.body.style.paddingRight || ''\n    if (this.bodyIsOverflowing) this.$body.css('padding-right', bodyPad + this.scrollbarWidth)\n  }\n\n  Modal.prototype.resetScrollbar = function () {\n    this.$body.css('padding-right', this.originalBodyPad)\n  }\n\n  Modal.prototype.measureScrollbar = function () { // thx walsh\n    var scrollDiv = document.createElement('div')\n    scrollDiv.className = 'modal-scrollbar-measure'\n    this.$body.append(scrollDiv)\n    var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth\n    this.$body[0].removeChild(scrollDiv)\n    return scrollbarWidth\n  }\n\n\n  // MODAL PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option, _relatedTarget) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.modal')\n      var options = $.extend({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))\n      if (typeof option == 'string') data[option](_relatedTarget)\n      else if (options.show) data.show(_relatedTarget)\n    })\n  }\n\n  var old = $.fn.modal\n\n  $.fn.modal             = Plugin\n  $.fn.modal.Constructor = Modal\n\n\n  // MODAL NO CONFLICT\n  // =================\n\n  $.fn.modal.noConflict = function () {\n    $.fn.modal = old\n    return this\n  }\n\n\n  // MODAL DATA-API\n  // ==============\n\n  $(document).on('click.bs.modal.data-api', '[data-toggle=\"modal\"]', function (e) {\n    var $this   = $(this)\n    var href    = $this.attr('href')\n    var $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\\s]+$)/, ''))) // strip for ie7\n    var option  = $target.data('bs.modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())\n\n    if ($this.is('a')) e.preventDefault()\n\n    $target.one('show.bs.modal', function (showEvent) {\n      if (showEvent.isDefaultPrevented()) return // only register focus restorer if modal will actually get shown\n      $target.one('hidden.bs.modal', function () {\n        $this.is(':visible') && $this.trigger('focus')\n      })\n    })\n    Plugin.call($target, option, this)\n  })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: tooltip.js v3.3.7\n * http://getbootstrap.com/javascript/#tooltip\n * Inspired by the original jQuery.tipsy by Jason Frame\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // TOOLTIP PUBLIC CLASS DEFINITION\n  // ===============================\n\n  var Tooltip = function (element, options) {\n    this.type       = null\n    this.options    = null\n    this.enabled    = null\n    this.timeout    = null\n    this.hoverState = null\n    this.$element   = null\n    this.inState    = null\n\n    this.init('tooltip', element, options)\n  }\n\n  Tooltip.VERSION  = '3.3.7'\n\n  Tooltip.TRANSITION_DURATION = 150\n\n  Tooltip.DEFAULTS = {\n    animation: true,\n    placement: 'top',\n    selector: false,\n    template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\n    trigger: 'hover focus',\n    title: '',\n    delay: 0,\n    html: false,\n    container: false,\n    viewport: {\n      selector: 'body',\n      padding: 0\n    }\n  }\n\n  Tooltip.prototype.init = function (type, element, options) {\n    this.enabled   = true\n    this.type      = type\n    this.$element  = $(element)\n    this.options   = this.getOptions(options)\n    this.$viewport = this.options.viewport && $($.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))\n    this.inState   = { click: false, hover: false, focus: false }\n\n    if (this.$element[0] instanceof document.constructor && !this.options.selector) {\n      throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')\n    }\n\n    var triggers = this.options.trigger.split(' ')\n\n    for (var i = triggers.length; i--;) {\n      var trigger = triggers[i]\n\n      if (trigger == 'click') {\n        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))\n      } else if (trigger != 'manual') {\n        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'\n        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'\n\n        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))\n        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))\n      }\n    }\n\n    this.options.selector ?\n      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :\n      this.fixTitle()\n  }\n\n  Tooltip.prototype.getDefaults = function () {\n    return Tooltip.DEFAULTS\n  }\n\n  Tooltip.prototype.getOptions = function (options) {\n    options = $.extend({}, this.getDefaults(), this.$element.data(), options)\n\n    if (options.delay && typeof options.delay == 'number') {\n      options.delay = {\n        show: options.delay,\n        hide: options.delay\n      }\n    }\n\n    return options\n  }\n\n  Tooltip.prototype.getDelegateOptions = function () {\n    var options  = {}\n    var defaults = this.getDefaults()\n\n    this._options && $.each(this._options, function (key, value) {\n      if (defaults[key] != value) options[key] = value\n    })\n\n    return options\n  }\n\n  Tooltip.prototype.enter = function (obj) {\n    var self = obj instanceof this.constructor ?\n      obj : $(obj.currentTarget).data('bs.' + this.type)\n\n    if (!self) {\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n      $(obj.currentTarget).data('bs.' + this.type, self)\n    }\n\n    if (obj instanceof $.Event) {\n      self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true\n    }\n\n    if (self.tip().hasClass('in') || self.hoverState == 'in') {\n      self.hoverState = 'in'\n      return\n    }\n\n    clearTimeout(self.timeout)\n\n    self.hoverState = 'in'\n\n    if (!self.options.delay || !self.options.delay.show) return self.show()\n\n    self.timeout = setTimeout(function () {\n      if (self.hoverState == 'in') self.show()\n    }, self.options.delay.show)\n  }\n\n  Tooltip.prototype.isInStateTrue = function () {\n    for (var key in this.inState) {\n      if (this.inState[key]) return true\n    }\n\n    return false\n  }\n\n  Tooltip.prototype.leave = function (obj) {\n    var self = obj instanceof this.constructor ?\n      obj : $(obj.currentTarget).data('bs.' + this.type)\n\n    if (!self) {\n      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n      $(obj.currentTarget).data('bs.' + this.type, self)\n    }\n\n    if (obj instanceof $.Event) {\n      self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false\n    }\n\n    if (self.isInStateTrue()) return\n\n    clearTimeout(self.timeout)\n\n    self.hoverState = 'out'\n\n    if (!self.options.delay || !self.options.delay.hide) return self.hide()\n\n    self.timeout = setTimeout(function () {\n      if (self.hoverState == 'out') self.hide()\n    }, self.options.delay.hide)\n  }\n\n  Tooltip.prototype.show = function () {\n    var e = $.Event('show.bs.' + this.type)\n\n    if (this.hasContent() && this.enabled) {\n      this.$element.trigger(e)\n\n      var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])\n      if (e.isDefaultPrevented() || !inDom) return\n      var that = this\n\n      var $tip = this.tip()\n\n      var tipId = this.getUID(this.type)\n\n      this.setContent()\n      $tip.attr('id', tipId)\n      this.$element.attr('aria-describedby', tipId)\n\n      if (this.options.animation) $tip.addClass('fade')\n\n      var placement = typeof this.options.placement == 'function' ?\n        this.options.placement.call(this, $tip[0], this.$element[0]) :\n        this.options.placement\n\n      var autoToken = /\\s?auto?\\s?/i\n      var autoPlace = autoToken.test(placement)\n      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'\n\n      $tip\n        .detach()\n        .css({ top: 0, left: 0, display: 'block' })\n        .addClass(placement)\n        .data('bs.' + this.type, this)\n\n      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\n      this.$element.trigger('inserted.bs.' + this.type)\n\n      var pos          = this.getPosition()\n      var actualWidth  = $tip[0].offsetWidth\n      var actualHeight = $tip[0].offsetHeight\n\n      if (autoPlace) {\n        var orgPlacement = placement\n        var viewportDim = this.getPosition(this.$viewport)\n\n        placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :\n                    placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :\n                    placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :\n                    placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :\n                    placement\n\n        $tip\n          .removeClass(orgPlacement)\n          .addClass(placement)\n      }\n\n      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\n\n      this.applyPlacement(calculatedOffset, placement)\n\n      var complete = function () {\n        var prevHoverState = that.hoverState\n        that.$element.trigger('shown.bs.' + that.type)\n        that.hoverState = null\n\n        if (prevHoverState == 'out') that.leave(that)\n      }\n\n      $.support.transition && this.$tip.hasClass('fade') ?\n        $tip\n          .one('bsTransitionEnd', complete)\n          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n        complete()\n    }\n  }\n\n  Tooltip.prototype.applyPlacement = function (offset, placement) {\n    var $tip   = this.tip()\n    var width  = $tip[0].offsetWidth\n    var height = $tip[0].offsetHeight\n\n    // manually read margins because getBoundingClientRect includes difference\n    var marginTop = parseInt($tip.css('margin-top'), 10)\n    var marginLeft = parseInt($tip.css('margin-left'), 10)\n\n    // we must check for NaN for ie 8/9\n    if (isNaN(marginTop))  marginTop  = 0\n    if (isNaN(marginLeft)) marginLeft = 0\n\n    offset.top  += marginTop\n    offset.left += marginLeft\n\n    // $.fn.offset doesn't round pixel values\n    // so we use setOffset directly with our own function B-0\n    $.offset.setOffset($tip[0], $.extend({\n      using: function (props) {\n        $tip.css({\n          top: Math.round(props.top),\n          left: Math.round(props.left)\n        })\n      }\n    }, offset), 0)\n\n    $tip.addClass('in')\n\n    // check to see if placing tip in new offset caused the tip to resize itself\n    var actualWidth  = $tip[0].offsetWidth\n    var actualHeight = $tip[0].offsetHeight\n\n    if (placement == 'top' && actualHeight != height) {\n      offset.top = offset.top + height - actualHeight\n    }\n\n    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)\n\n    if (delta.left) offset.left += delta.left\n    else offset.top += delta.top\n\n    var isVertical          = /top|bottom/.test(placement)\n    var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight\n    var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'\n\n    $tip.offset(offset)\n    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)\n  }\n\n  Tooltip.prototype.replaceArrow = function (delta, dimension, isVertical) {\n    this.arrow()\n      .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')\n      .css(isVertical ? 'top' : 'left', '')\n  }\n\n  Tooltip.prototype.setContent = function () {\n    var $tip  = this.tip()\n    var title = this.getTitle()\n\n    $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)\n    $tip.removeClass('fade in top bottom left right')\n  }\n\n  Tooltip.prototype.hide = function (callback) {\n    var that = this\n    var $tip = $(this.$tip)\n    var e    = $.Event('hide.bs.' + this.type)\n\n    function complete() {\n      if (that.hoverState != 'in') $tip.detach()\n      if (that.$element) { // TODO: Check whether guarding this code with this `if` is really necessary.\n        that.$element\n          .removeAttr('aria-describedby')\n          .trigger('hidden.bs.' + that.type)\n      }\n      callback && callback()\n    }\n\n    this.$element.trigger(e)\n\n    if (e.isDefaultPrevented()) return\n\n    $tip.removeClass('in')\n\n    $.support.transition && $tip.hasClass('fade') ?\n      $tip\n        .one('bsTransitionEnd', complete)\n        .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n      complete()\n\n    this.hoverState = null\n\n    return this\n  }\n\n  Tooltip.prototype.fixTitle = function () {\n    var $e = this.$element\n    if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {\n      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')\n    }\n  }\n\n  Tooltip.prototype.hasContent = function () {\n    return this.getTitle()\n  }\n\n  Tooltip.prototype.getPosition = function ($element) {\n    $element   = $element || this.$element\n\n    var el     = $element[0]\n    var isBody = el.tagName == 'BODY'\n\n    var elRect    = el.getBoundingClientRect()\n    if (elRect.width == null) {\n      // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093\n      elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })\n    }\n    var isSvg = window.SVGElement && el instanceof window.SVGElement\n    // Avoid using $.offset() on SVGs since it gives incorrect results in jQuery 3.\n    // See https://github.com/twbs/bootstrap/issues/20280\n    var elOffset  = isBody ? { top: 0, left: 0 } : (isSvg ? null : $element.offset())\n    var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }\n    var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null\n\n    return $.extend({}, elRect, scroll, outerDims, elOffset)\n  }\n\n  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {\n    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :\n           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :\n           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\n        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }\n\n  }\n\n  Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {\n    var delta = { top: 0, left: 0 }\n    if (!this.$viewport) return delta\n\n    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0\n    var viewportDimensions = this.getPosition(this.$viewport)\n\n    if (/right|left/.test(placement)) {\n      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll\n      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight\n      if (topEdgeOffset < viewportDimensions.top) { // top overflow\n        delta.top = viewportDimensions.top - topEdgeOffset\n      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow\n        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset\n      }\n    } else {\n      var leftEdgeOffset  = pos.left - viewportPadding\n      var rightEdgeOffset = pos.left + viewportPadding + actualWidth\n      if (leftEdgeOffset < viewportDimensions.left) { // left overflow\n        delta.left = viewportDimensions.left - leftEdgeOffset\n      } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow\n        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset\n      }\n    }\n\n    return delta\n  }\n\n  Tooltip.prototype.getTitle = function () {\n    var title\n    var $e = this.$element\n    var o  = this.options\n\n    title = $e.attr('data-original-title')\n      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)\n\n    return title\n  }\n\n  Tooltip.prototype.getUID = function (prefix) {\n    do prefix += ~~(Math.random() * 1000000)\n    while (document.getElementById(prefix))\n    return prefix\n  }\n\n  Tooltip.prototype.tip = function () {\n    if (!this.$tip) {\n      this.$tip = $(this.options.template)\n      if (this.$tip.length != 1) {\n        throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')\n      }\n    }\n    return this.$tip\n  }\n\n  Tooltip.prototype.arrow = function () {\n    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))\n  }\n\n  Tooltip.prototype.enable = function () {\n    this.enabled = true\n  }\n\n  Tooltip.prototype.disable = function () {\n    this.enabled = false\n  }\n\n  Tooltip.prototype.toggleEnabled = function () {\n    this.enabled = !this.enabled\n  }\n\n  Tooltip.prototype.toggle = function (e) {\n    var self = this\n    if (e) {\n      self = $(e.currentTarget).data('bs.' + this.type)\n      if (!self) {\n        self = new this.constructor(e.currentTarget, this.getDelegateOptions())\n        $(e.currentTarget).data('bs.' + this.type, self)\n      }\n    }\n\n    if (e) {\n      self.inState.click = !self.inState.click\n      if (self.isInStateTrue()) self.enter(self)\n      else self.leave(self)\n    } else {\n      self.tip().hasClass('in') ? self.leave(self) : self.enter(self)\n    }\n  }\n\n  Tooltip.prototype.destroy = function () {\n    var that = this\n    clearTimeout(this.timeout)\n    this.hide(function () {\n      that.$element.off('.' + that.type).removeData('bs.' + that.type)\n      if (that.$tip) {\n        that.$tip.detach()\n      }\n      that.$tip = null\n      that.$arrow = null\n      that.$viewport = null\n      that.$element = null\n    })\n  }\n\n\n  // TOOLTIP PLUGIN DEFINITION\n  // =========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.tooltip')\n      var options = typeof option == 'object' && option\n\n      if (!data && /destroy|hide/.test(option)) return\n      if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.tooltip\n\n  $.fn.tooltip             = Plugin\n  $.fn.tooltip.Constructor = Tooltip\n\n\n  // TOOLTIP NO CONFLICT\n  // ===================\n\n  $.fn.tooltip.noConflict = function () {\n    $.fn.tooltip = old\n    return this\n  }\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: popover.js v3.3.7\n * http://getbootstrap.com/javascript/#popovers\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // POPOVER PUBLIC CLASS DEFINITION\n  // ===============================\n\n  var Popover = function (element, options) {\n    this.init('popover', element, options)\n  }\n\n  if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')\n\n  Popover.VERSION  = '3.3.7'\n\n  Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {\n    placement: 'right',\n    trigger: 'click',\n    content: '',\n    template: '<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'\n  })\n\n\n  // NOTE: POPOVER EXTENDS tooltip.js\n  // ================================\n\n  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)\n\n  Popover.prototype.constructor = Popover\n\n  Popover.prototype.getDefaults = function () {\n    return Popover.DEFAULTS\n  }\n\n  Popover.prototype.setContent = function () {\n    var $tip    = this.tip()\n    var title   = this.getTitle()\n    var content = this.getContent()\n\n    $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)\n    $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events\n      this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'\n    ](content)\n\n    $tip.removeClass('fade top bottom left right in')\n\n    // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\n    // this manually by checking the contents.\n    if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()\n  }\n\n  Popover.prototype.hasContent = function () {\n    return this.getTitle() || this.getContent()\n  }\n\n  Popover.prototype.getContent = function () {\n    var $e = this.$element\n    var o  = this.options\n\n    return $e.attr('data-content')\n      || (typeof o.content == 'function' ?\n            o.content.call($e[0]) :\n            o.content)\n  }\n\n  Popover.prototype.arrow = function () {\n    return (this.$arrow = this.$arrow || this.tip().find('.arrow'))\n  }\n\n\n  // POPOVER PLUGIN DEFINITION\n  // =========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.popover')\n      var options = typeof option == 'object' && option\n\n      if (!data && /destroy|hide/.test(option)) return\n      if (!data) $this.data('bs.popover', (data = new Popover(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.popover\n\n  $.fn.popover             = Plugin\n  $.fn.popover.Constructor = Popover\n\n\n  // POPOVER NO CONFLICT\n  // ===================\n\n  $.fn.popover.noConflict = function () {\n    $.fn.popover = old\n    return this\n  }\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: scrollspy.js v3.3.7\n * http://getbootstrap.com/javascript/#scrollspy\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // SCROLLSPY CLASS DEFINITION\n  // ==========================\n\n  function ScrollSpy(element, options) {\n    this.$body          = $(document.body)\n    this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)\n    this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)\n    this.selector       = (this.options.target || '') + ' .nav li > a'\n    this.offsets        = []\n    this.targets        = []\n    this.activeTarget   = null\n    this.scrollHeight   = 0\n\n    this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))\n    this.refresh()\n    this.process()\n  }\n\n  ScrollSpy.VERSION  = '3.3.7'\n\n  ScrollSpy.DEFAULTS = {\n    offset: 10\n  }\n\n  ScrollSpy.prototype.getScrollHeight = function () {\n    return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)\n  }\n\n  ScrollSpy.prototype.refresh = function () {\n    var that          = this\n    var offsetMethod  = 'offset'\n    var offsetBase    = 0\n\n    this.offsets      = []\n    this.targets      = []\n    this.scrollHeight = this.getScrollHeight()\n\n    if (!$.isWindow(this.$scrollElement[0])) {\n      offsetMethod = 'position'\n      offsetBase   = this.$scrollElement.scrollTop()\n    }\n\n    this.$body\n      .find(this.selector)\n      .map(function () {\n        var $el   = $(this)\n        var href  = $el.data('target') || $el.attr('href')\n        var $href = /^#./.test(href) && $(href)\n\n        return ($href\n          && $href.length\n          && $href.is(':visible')\n          && [[$href[offsetMethod]().top + offsetBase, href]]) || null\n      })\n      .sort(function (a, b) { return a[0] - b[0] })\n      .each(function () {\n        that.offsets.push(this[0])\n        that.targets.push(this[1])\n      })\n  }\n\n  ScrollSpy.prototype.process = function () {\n    var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset\n    var scrollHeight = this.getScrollHeight()\n    var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()\n    var offsets      = this.offsets\n    var targets      = this.targets\n    var activeTarget = this.activeTarget\n    var i\n\n    if (this.scrollHeight != scrollHeight) {\n      this.refresh()\n    }\n\n    if (scrollTop >= maxScroll) {\n      return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)\n    }\n\n    if (activeTarget && scrollTop < offsets[0]) {\n      this.activeTarget = null\n      return this.clear()\n    }\n\n    for (i = offsets.length; i--;) {\n      activeTarget != targets[i]\n        && scrollTop >= offsets[i]\n        && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])\n        && this.activate(targets[i])\n    }\n  }\n\n  ScrollSpy.prototype.activate = function (target) {\n    this.activeTarget = target\n\n    this.clear()\n\n    var selector = this.selector +\n      '[data-target=\"' + target + '\"],' +\n      this.selector + '[href=\"' + target + '\"]'\n\n    var active = $(selector)\n      .parents('li')\n      .addClass('active')\n\n    if (active.parent('.dropdown-menu').length) {\n      active = active\n        .closest('li.dropdown')\n        .addClass('active')\n    }\n\n    active.trigger('activate.bs.scrollspy')\n  }\n\n  ScrollSpy.prototype.clear = function () {\n    $(this.selector)\n      .parentsUntil(this.options.target, '.active')\n      .removeClass('active')\n  }\n\n\n  // SCROLLSPY PLUGIN DEFINITION\n  // ===========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.scrollspy')\n      var options = typeof option == 'object' && option\n\n      if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.scrollspy\n\n  $.fn.scrollspy             = Plugin\n  $.fn.scrollspy.Constructor = ScrollSpy\n\n\n  // SCROLLSPY NO CONFLICT\n  // =====================\n\n  $.fn.scrollspy.noConflict = function () {\n    $.fn.scrollspy = old\n    return this\n  }\n\n\n  // SCROLLSPY DATA-API\n  // ==================\n\n  $(window).on('load.bs.scrollspy.data-api', function () {\n    $('[data-spy=\"scroll\"]').each(function () {\n      var $spy = $(this)\n      Plugin.call($spy, $spy.data())\n    })\n  })\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: tab.js v3.3.7\n * http://getbootstrap.com/javascript/#tabs\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // TAB CLASS DEFINITION\n  // ====================\n\n  var Tab = function (element) {\n    // jscs:disable requireDollarBeforejQueryAssignment\n    this.element = $(element)\n    // jscs:enable requireDollarBeforejQueryAssignment\n  }\n\n  Tab.VERSION = '3.3.7'\n\n  Tab.TRANSITION_DURATION = 150\n\n  Tab.prototype.show = function () {\n    var $this    = this.element\n    var $ul      = $this.closest('ul:not(.dropdown-menu)')\n    var selector = $this.data('target')\n\n    if (!selector) {\n      selector = $this.attr('href')\n      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\n    }\n\n    if ($this.parent('li').hasClass('active')) return\n\n    var $previous = $ul.find('.active:last a')\n    var hideEvent = $.Event('hide.bs.tab', {\n      relatedTarget: $this[0]\n    })\n    var showEvent = $.Event('show.bs.tab', {\n      relatedTarget: $previous[0]\n    })\n\n    $previous.trigger(hideEvent)\n    $this.trigger(showEvent)\n\n    if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) return\n\n    var $target = $(selector)\n\n    this.activate($this.closest('li'), $ul)\n    this.activate($target, $target.parent(), function () {\n      $previous.trigger({\n        type: 'hidden.bs.tab',\n        relatedTarget: $this[0]\n      })\n      $this.trigger({\n        type: 'shown.bs.tab',\n        relatedTarget: $previous[0]\n      })\n    })\n  }\n\n  Tab.prototype.activate = function (element, container, callback) {\n    var $active    = container.find('> .active')\n    var transition = callback\n      && $.support.transition\n      && ($active.length && $active.hasClass('fade') || !!container.find('> .fade').length)\n\n    function next() {\n      $active\n        .removeClass('active')\n        .find('> .dropdown-menu > .active')\n          .removeClass('active')\n        .end()\n        .find('[data-toggle=\"tab\"]')\n          .attr('aria-expanded', false)\n\n      element\n        .addClass('active')\n        .find('[data-toggle=\"tab\"]')\n          .attr('aria-expanded', true)\n\n      if (transition) {\n        element[0].offsetWidth // reflow for transition\n        element.addClass('in')\n      } else {\n        element.removeClass('fade')\n      }\n\n      if (element.parent('.dropdown-menu').length) {\n        element\n          .closest('li.dropdown')\n            .addClass('active')\n          .end()\n          .find('[data-toggle=\"tab\"]')\n            .attr('aria-expanded', true)\n      }\n\n      callback && callback()\n    }\n\n    $active.length && transition ?\n      $active\n        .one('bsTransitionEnd', next)\n        .emulateTransitionEnd(Tab.TRANSITION_DURATION) :\n      next()\n\n    $active.removeClass('in')\n  }\n\n\n  // TAB PLUGIN DEFINITION\n  // =====================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var data  = $this.data('bs.tab')\n\n      if (!data) $this.data('bs.tab', (data = new Tab(this)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.tab\n\n  $.fn.tab             = Plugin\n  $.fn.tab.Constructor = Tab\n\n\n  // TAB NO CONFLICT\n  // ===============\n\n  $.fn.tab.noConflict = function () {\n    $.fn.tab = old\n    return this\n  }\n\n\n  // TAB DATA-API\n  // ============\n\n  var clickHandler = function (e) {\n    e.preventDefault()\n    Plugin.call($(this), 'show')\n  }\n\n  $(document)\n    .on('click.bs.tab.data-api', '[data-toggle=\"tab\"]', clickHandler)\n    .on('click.bs.tab.data-api', '[data-toggle=\"pill\"]', clickHandler)\n\n}(jQuery);\n\n/* ========================================================================\n * Bootstrap: affix.js v3.3.7\n * http://getbootstrap.com/javascript/#affix\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n\n+function ($) {\n  'use strict';\n\n  // AFFIX CLASS DEFINITION\n  // ======================\n\n  var Affix = function (element, options) {\n    this.options = $.extend({}, Affix.DEFAULTS, options)\n\n    this.$target = $(this.options.target)\n      .on('scroll.bs.affix.data-api', $.proxy(this.checkPosition, this))\n      .on('click.bs.affix.data-api',  $.proxy(this.checkPositionWithEventLoop, this))\n\n    this.$element     = $(element)\n    this.affixed      = null\n    this.unpin        = null\n    this.pinnedOffset = null\n\n    this.checkPosition()\n  }\n\n  Affix.VERSION  = '3.3.7'\n\n  Affix.RESET    = 'affix affix-top affix-bottom'\n\n  Affix.DEFAULTS = {\n    offset: 0,\n    target: window\n  }\n\n  Affix.prototype.getState = function (scrollHeight, height, offsetTop, offsetBottom) {\n    var scrollTop    = this.$target.scrollTop()\n    var position     = this.$element.offset()\n    var targetHeight = this.$target.height()\n\n    if (offsetTop != null && this.affixed == 'top') return scrollTop < offsetTop ? 'top' : false\n\n    if (this.affixed == 'bottom') {\n      if (offsetTop != null) return (scrollTop + this.unpin <= position.top) ? false : 'bottom'\n      return (scrollTop + targetHeight <= scrollHeight - offsetBottom) ? false : 'bottom'\n    }\n\n    var initializing   = this.affixed == null\n    var colliderTop    = initializing ? scrollTop : position.top\n    var colliderHeight = initializing ? targetHeight : height\n\n    if (offsetTop != null && scrollTop <= offsetTop) return 'top'\n    if (offsetBottom != null && (colliderTop + colliderHeight >= scrollHeight - offsetBottom)) return 'bottom'\n\n    return false\n  }\n\n  Affix.prototype.getPinnedOffset = function () {\n    if (this.pinnedOffset) return this.pinnedOffset\n    this.$element.removeClass(Affix.RESET).addClass('affix')\n    var scrollTop = this.$target.scrollTop()\n    var position  = this.$element.offset()\n    return (this.pinnedOffset = position.top - scrollTop)\n  }\n\n  Affix.prototype.checkPositionWithEventLoop = function () {\n    setTimeout($.proxy(this.checkPosition, this), 1)\n  }\n\n  Affix.prototype.checkPosition = function () {\n    if (!this.$element.is(':visible')) return\n\n    var height       = this.$element.height()\n    var offset       = this.options.offset\n    var offsetTop    = offset.top\n    var offsetBottom = offset.bottom\n    var scrollHeight = Math.max($(document).height(), $(document.body).height())\n\n    if (typeof offset != 'object')         offsetBottom = offsetTop = offset\n    if (typeof offsetTop == 'function')    offsetTop    = offset.top(this.$element)\n    if (typeof offsetBottom == 'function') offsetBottom = offset.bottom(this.$element)\n\n    var affix = this.getState(scrollHeight, height, offsetTop, offsetBottom)\n\n    if (this.affixed != affix) {\n      if (this.unpin != null) this.$element.css('top', '')\n\n      var affixType = 'affix' + (affix ? '-' + affix : '')\n      var e         = $.Event(affixType + '.bs.affix')\n\n      this.$element.trigger(e)\n\n      if (e.isDefaultPrevented()) return\n\n      this.affixed = affix\n      this.unpin = affix == 'bottom' ? this.getPinnedOffset() : null\n\n      this.$element\n        .removeClass(Affix.RESET)\n        .addClass(affixType)\n        .trigger(affixType.replace('affix', 'affixed') + '.bs.affix')\n    }\n\n    if (affix == 'bottom') {\n      this.$element.offset({\n        top: scrollHeight - height - offsetBottom\n      })\n    }\n  }\n\n\n  // AFFIX PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.affix')\n      var options = typeof option == 'object' && option\n\n      if (!data) $this.data('bs.affix', (data = new Affix(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.affix\n\n  $.fn.affix             = Plugin\n  $.fn.affix.Constructor = Affix\n\n\n  // AFFIX NO CONFLICT\n  // =================\n\n  $.fn.affix.noConflict = function () {\n    $.fn.affix = old\n    return this\n  }\n\n\n  // AFFIX DATA-API\n  // ==============\n\n  $(window).on('load', function () {\n    $('[data-spy=\"affix\"]').each(function () {\n      var $spy = $(this)\n      var data = $spy.data()\n\n      data.offset = data.offset || {}\n\n      if (data.offsetBottom != null) data.offset.bottom = data.offsetBottom\n      if (data.offsetTop    != null) data.offset.top    = data.offsetTop\n\n      Plugin.call($spy, data)\n    })\n  })\n\n}(jQuery);\n"

/***/ },

/***/ 83:
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(79)(__webpack_require__(84)+"\n\n// SCRIPT-LOADER FOOTER\n//# sourceURL=script:///Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/source-map-loader/index.js!/Users/johannesbuvnas/Development/PHP/tutomvc/node_modules/bootstrap-select/dist/js/bootstrap-select.js")

/***/ },

/***/ 84:
/***/ function(module, exports) {

	module.exports = "/*!\r\n * Bootstrap-select v1.11.2 (http://silviomoreto.github.io/bootstrap-select)\r\n *\r\n * Copyright 2013-2016 bootstrap-select\r\n * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)\r\n */\r\n\r\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"jquery\"], function (a0) {\n      return (factory(a0));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"jquery\"));\n  } else {\n    factory(jQuery);\n  }\n}(this, function (jQuery) {\n\n(function ($) {\r\n  'use strict';\r\n\r\n  //<editor-fold desc=\"Shims\">\r\n  if (!String.prototype.includes) {\r\n    (function () {\r\n      'use strict'; // needed to support `apply`/`call` with `undefined`/`null`\r\n      var toString = {}.toString;\r\n      var defineProperty = (function () {\r\n        // IE 8 only supports `Object.defineProperty` on DOM elements\r\n        try {\r\n          var object = {};\r\n          var $defineProperty = Object.defineProperty;\r\n          var result = $defineProperty(object, object, object) && $defineProperty;\r\n        } catch (error) {\r\n        }\r\n        return result;\r\n      }());\r\n      var indexOf = ''.indexOf;\r\n      var includes = function (search) {\r\n        if (this == null) {\r\n          throw new TypeError();\r\n        }\r\n        var string = String(this);\r\n        if (search && toString.call(search) == '[object RegExp]') {\r\n          throw new TypeError();\r\n        }\r\n        var stringLength = string.length;\r\n        var searchString = String(search);\r\n        var searchLength = searchString.length;\r\n        var position = arguments.length > 1 ? arguments[1] : undefined;\r\n        // `ToInteger`\r\n        var pos = position ? Number(position) : 0;\r\n        if (pos != pos) { // better `isNaN`\r\n          pos = 0;\r\n        }\r\n        var start = Math.min(Math.max(pos, 0), stringLength);\r\n        // Avoid the `indexOf` call if no match is possible\r\n        if (searchLength + start > stringLength) {\r\n          return false;\r\n        }\r\n        return indexOf.call(string, searchString, pos) != -1;\r\n      };\r\n      if (defineProperty) {\r\n        defineProperty(String.prototype, 'includes', {\r\n          'value': includes,\r\n          'configurable': true,\r\n          'writable': true\r\n        });\r\n      } else {\r\n        String.prototype.includes = includes;\r\n      }\r\n    }());\r\n  }\r\n\r\n  if (!String.prototype.startsWith) {\r\n    (function () {\r\n      'use strict'; // needed to support `apply`/`call` with `undefined`/`null`\r\n      var defineProperty = (function () {\r\n        // IE 8 only supports `Object.defineProperty` on DOM elements\r\n        try {\r\n          var object = {};\r\n          var $defineProperty = Object.defineProperty;\r\n          var result = $defineProperty(object, object, object) && $defineProperty;\r\n        } catch (error) {\r\n        }\r\n        return result;\r\n      }());\r\n      var toString = {}.toString;\r\n      var startsWith = function (search) {\r\n        if (this == null) {\r\n          throw new TypeError();\r\n        }\r\n        var string = String(this);\r\n        if (search && toString.call(search) == '[object RegExp]') {\r\n          throw new TypeError();\r\n        }\r\n        var stringLength = string.length;\r\n        var searchString = String(search);\r\n        var searchLength = searchString.length;\r\n        var position = arguments.length > 1 ? arguments[1] : undefined;\r\n        // `ToInteger`\r\n        var pos = position ? Number(position) : 0;\r\n        if (pos != pos) { // better `isNaN`\r\n          pos = 0;\r\n        }\r\n        var start = Math.min(Math.max(pos, 0), stringLength);\r\n        // Avoid the `indexOf` call if no match is possible\r\n        if (searchLength + start > stringLength) {\r\n          return false;\r\n        }\r\n        var index = -1;\r\n        while (++index < searchLength) {\r\n          if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      };\r\n      if (defineProperty) {\r\n        defineProperty(String.prototype, 'startsWith', {\r\n          'value': startsWith,\r\n          'configurable': true,\r\n          'writable': true\r\n        });\r\n      } else {\r\n        String.prototype.startsWith = startsWith;\r\n      }\r\n    }());\r\n  }\r\n\r\n  if (!Object.keys) {\r\n    Object.keys = function (\r\n      o, // object\r\n      k, // key\r\n      r  // result array\r\n      ){\r\n      // initialize object and result\r\n      r=[];\r\n      // iterate over object keys\r\n      for (k in o)\r\n          // fill result array with non-prototypical keys\r\n        r.hasOwnProperty.call(o, k) && r.push(k);\r\n      // return result\r\n      return r;\r\n    };\r\n  }\r\n\r\n  // set data-selected on select element if the value has been programmatically selected\r\n  // prior to initialization of bootstrap-select\r\n  // * consider removing or replacing an alternative method *\r\n  var valHooks = {\r\n    useDefault: false,\r\n    _set: $.valHooks.select.set\r\n  };\r\n\r\n  $.valHooks.select.set = function(elem, value) {\r\n    if (value && !valHooks.useDefault) $(elem).data('selected', true);\r\n\r\n    return valHooks._set.apply(this, arguments);\r\n  };\r\n\r\n  var changed_arguments = null;\r\n  $.fn.triggerNative = function (eventName) {\r\n    var el = this[0],\r\n        event;\r\n\r\n    if (el.dispatchEvent) { // for modern browsers & IE9+\r\n      if (typeof Event === 'function') {\r\n        // For modern browsers\r\n        event = new Event(eventName, {\r\n          bubbles: true\r\n        });\r\n      } else {\r\n        // For IE since it doesn't support Event constructor\r\n        event = document.createEvent('Event');\r\n        event.initEvent(eventName, true, false);\r\n      }\r\n\r\n      el.dispatchEvent(event);\r\n    } else if (el.fireEvent) { // for IE8\r\n      event = document.createEventObject();\r\n      event.eventType = eventName;\r\n      el.fireEvent('on' + eventName, event);\r\n    } else {\r\n      // fall back to jQuery.trigger\r\n      this.trigger(eventName);\r\n    }\r\n  };\r\n  //</editor-fold>\r\n\r\n  // Case insensitive contains search\r\n  $.expr.pseudos.icontains = function (obj, index, meta) {\r\n    var $obj = $(obj);\r\n    var haystack = ($obj.data('tokens') || $obj.text()).toString().toUpperCase();\r\n    return haystack.includes(meta[3].toUpperCase());\r\n  };\r\n\r\n  // Case insensitive begins search\r\n  $.expr.pseudos.ibegins = function (obj, index, meta) {\r\n    var $obj = $(obj);\r\n    var haystack = ($obj.data('tokens') || $obj.text()).toString().toUpperCase();\r\n    return haystack.startsWith(meta[3].toUpperCase());\r\n  };\r\n\r\n  // Case and accent insensitive contains search\r\n  $.expr.pseudos.aicontains = function (obj, index, meta) {\r\n    var $obj = $(obj);\r\n    var haystack = ($obj.data('tokens') || $obj.data('normalizedText') || $obj.text()).toString().toUpperCase();\r\n    return haystack.includes(meta[3].toUpperCase());\r\n  };\r\n\r\n  // Case and accent insensitive begins search\r\n  $.expr.pseudos.aibegins = function (obj, index, meta) {\r\n    var $obj = $(obj);\r\n    var haystack = ($obj.data('tokens') || $obj.data('normalizedText') || $obj.text()).toString().toUpperCase();\r\n    return haystack.startsWith(meta[3].toUpperCase());\r\n  };\r\n\r\n  /**\r\n   * Remove all diatrics from the given text.\r\n   * @access private\r\n   * @param {String} text\r\n   * @returns {String}\r\n   */\r\n  function normalizeToBase(text) {\r\n    var rExps = [\r\n      {re: /[\\xC0-\\xC6]/g, ch: \"A\"},\r\n      {re: /[\\xE0-\\xE6]/g, ch: \"a\"},\r\n      {re: /[\\xC8-\\xCB]/g, ch: \"E\"},\r\n      {re: /[\\xE8-\\xEB]/g, ch: \"e\"},\r\n      {re: /[\\xCC-\\xCF]/g, ch: \"I\"},\r\n      {re: /[\\xEC-\\xEF]/g, ch: \"i\"},\r\n      {re: /[\\xD2-\\xD6]/g, ch: \"O\"},\r\n      {re: /[\\xF2-\\xF6]/g, ch: \"o\"},\r\n      {re: /[\\xD9-\\xDC]/g, ch: \"U\"},\r\n      {re: /[\\xF9-\\xFC]/g, ch: \"u\"},\r\n      {re: /[\\xC7-\\xE7]/g, ch: \"c\"},\r\n      {re: /[\\xD1]/g, ch: \"N\"},\r\n      {re: /[\\xF1]/g, ch: \"n\"}\r\n    ];\r\n    $.each(rExps, function () {\r\n      text = text.replace(this.re, this.ch);\r\n    });\r\n    return text;\r\n  }\r\n\r\n\r\n  function htmlEscape(html) {\r\n    var escapeMap = {\r\n      '&': '&amp;',\r\n      '<': '&lt;',\r\n      '>': '&gt;',\r\n      '\"': '&quot;',\r\n      \"'\": '&#x27;',\r\n      '`': '&#x60;'\r\n    };\r\n    var source = '(?:' + Object.keys(escapeMap).join('|') + ')',\r\n        testRegexp = new RegExp(source),\r\n        replaceRegexp = new RegExp(source, 'g'),\r\n        string = html == null ? '' : '' + html;\r\n    return testRegexp.test(string) ? string.replace(replaceRegexp, function (match) {\r\n      return escapeMap[match];\r\n    }) : string;\r\n  }\r\n\r\n  var Selectpicker = function (element, options, e) {\r\n    // bootstrap-select has been initialized - revert valHooks.select.set back to its original function\r\n    if (!valHooks.useDefault) {\r\n      $.valHooks.select.set = valHooks._set;\r\n      valHooks.useDefault = true;\r\n    }\r\n\r\n    if (e) {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }\r\n\r\n    this.$element = $(element);\r\n    this.$newElement = null;\r\n    this.$button = null;\r\n    this.$menu = null;\r\n    this.$lis = null;\r\n    this.options = options;\r\n\r\n    // If we have no title yet, try to pull it from the html title attribute (jQuery doesnt' pick it up as it's not a\r\n    // data-attribute)\r\n    if (this.options.title === null) {\r\n      this.options.title = this.$element.attr('title');\r\n    }\r\n\r\n    //Expose public methods\r\n    this.val = Selectpicker.prototype.val;\r\n    this.render = Selectpicker.prototype.render;\r\n    this.refresh = Selectpicker.prototype.refresh;\r\n    this.setStyle = Selectpicker.prototype.setStyle;\r\n    this.selectAll = Selectpicker.prototype.selectAll;\r\n    this.deselectAll = Selectpicker.prototype.deselectAll;\r\n    this.destroy = Selectpicker.prototype.destroy;\r\n    this.remove = Selectpicker.prototype.remove;\r\n    this.show = Selectpicker.prototype.show;\r\n    this.hide = Selectpicker.prototype.hide;\r\n\r\n    this.init();\r\n  };\r\n\r\n  Selectpicker.VERSION = '1.11.2';\r\n\r\n  // part of this is duplicated in i18n/defaults-en_US.js. Make sure to update both.\r\n  Selectpicker.DEFAULTS = {\r\n    noneSelectedText: 'Nothing selected',\r\n    noneResultsText: 'No results matched {0}',\r\n    countSelectedText: function (numSelected, numTotal) {\r\n      return (numSelected == 1) ? \"{0} item selected\" : \"{0} items selected\";\r\n    },\r\n    maxOptionsText: function (numAll, numGroup) {\r\n      return [\r\n        (numAll == 1) ? 'Limit reached ({n} item max)' : 'Limit reached ({n} items max)',\r\n        (numGroup == 1) ? 'Group limit reached ({n} item max)' : 'Group limit reached ({n} items max)'\r\n      ];\r\n    },\r\n    selectAllText: 'Select All',\r\n    deselectAllText: 'Deselect All',\r\n    doneButton: false,\r\n    doneButtonText: 'Close',\r\n    multipleSeparator: ', ',\r\n    styleBase: 'btn',\r\n    style: 'btn-default',\r\n    size: 'auto',\r\n    title: null,\r\n    selectedTextFormat: 'values',\r\n    width: false,\r\n    container: false,\r\n    hideDisabled: false,\r\n    showSubtext: false,\r\n    showIcon: true,\r\n    showContent: true,\r\n    dropupAuto: true,\r\n    header: false,\r\n    liveSearch: false,\r\n    liveSearchPlaceholder: null,\r\n    liveSearchNormalize: false,\r\n    liveSearchStyle: 'contains',\r\n    actionsBox: false,\r\n    iconBase: 'glyphicon',\r\n    tickIcon: 'glyphicon-ok',\r\n    showTick: false,\r\n    template: {\r\n      caret: '<span class=\"caret\"></span>'\r\n    },\r\n    maxOptions: false,\r\n    mobile: false,\r\n    selectOnTab: false,\r\n    dropdownAlignRight: false\r\n  };\r\n\r\n  Selectpicker.prototype = {\r\n\r\n    constructor: Selectpicker,\r\n\r\n    init: function () {\r\n      var that = this,\r\n          id = this.$element.attr('id');\r\n\r\n      this.$element.addClass('bs-select-hidden');\r\n\r\n      // store originalIndex (key) and newIndex (value) in this.liObj for fast accessibility\r\n      // allows us to do this.$lis.eq(that.liObj[index]) instead of this.$lis.filter('[data-original-index=\"' + index + '\"]')\r\n      this.liObj = {};\r\n      this.multiple = this.$element.prop('multiple');\r\n      this.autofocus = this.$element.prop('autofocus');\r\n      this.$newElement = this.createView();\r\n      this.$element\r\n        .after(this.$newElement)\r\n        .appendTo(this.$newElement);\r\n      this.$button = this.$newElement.children('button');\r\n      this.$menu = this.$newElement.children('.dropdown-menu');\r\n      this.$menuInner = this.$menu.children('.inner');\r\n      this.$searchbox = this.$menu.find('input');\r\n\r\n      this.$element.removeClass('bs-select-hidden');\r\n\r\n      if (this.options.dropdownAlignRight === true) this.$menu.addClass('dropdown-menu-right');\r\n\r\n      if (typeof id !== 'undefined') {\r\n        this.$button.attr('data-id', id);\r\n        $('label[for=\"' + id + '\"]').click(function (e) {\r\n          e.preventDefault();\r\n          that.$button.focus();\r\n        });\r\n      }\r\n\r\n      this.checkDisabled();\r\n      this.clickListener();\r\n      if (this.options.liveSearch) this.liveSearchListener();\r\n      this.render();\r\n      this.setStyle();\r\n      this.setWidth();\r\n      if (this.options.container) this.selectPosition();\r\n      this.$menu.data('this', this);\r\n      this.$newElement.data('this', this);\r\n      if (this.options.mobile) this.mobile();\r\n\r\n      this.$newElement.on({\r\n        'hide.bs.dropdown': function (e) {\r\n          that.$menuInner.attr('aria-expanded', false);\r\n          that.$element.trigger('hide.bs.select', e);\r\n        },\r\n        'hidden.bs.dropdown': function (e) {\r\n          that.$element.trigger('hidden.bs.select', e);\r\n        },\r\n        'show.bs.dropdown': function (e) {\r\n          that.$menuInner.attr('aria-expanded', true);\r\n          that.$element.trigger('show.bs.select', e);\r\n        },\r\n        'shown.bs.dropdown': function (e) {\r\n          that.$element.trigger('shown.bs.select', e);\r\n        }\r\n      });\r\n\r\n      if (that.$element[0].hasAttribute('required')) {\r\n        this.$element.on('invalid', function () {\r\n          that.$button\r\n            .addClass('bs-invalid')\r\n            .focus();\r\n\r\n          that.$element.on({\r\n            'focus.bs.select': function () {\r\n              that.$button.focus();\r\n              that.$element.off('focus.bs.select');\r\n            },\r\n            'shown.bs.select': function () {\r\n              that.$element\r\n                .val(that.$element.val()) // set the value to hide the validation message in Chrome when menu is opened\r\n                .off('shown.bs.select');\r\n            },\r\n            'rendered.bs.select': function () {\r\n              // if select is no longer invalid, remove the bs-invalid class\r\n              if (this.validity.valid) that.$button.removeClass('bs-invalid');\r\n              that.$element.off('rendered.bs.select');\r\n            }\r\n          });\r\n        });\r\n      }\r\n\r\n      setTimeout(function () {\r\n        that.$element.trigger('loaded.bs.select');\r\n      });\r\n    },\r\n\r\n    createDropdown: function () {\r\n      // Options\r\n      // If we are multiple or showTick option is set, then add the show-tick class\r\n      var showTick = (this.multiple || this.options.showTick) ? ' show-tick' : '',\r\n          inputGroup = this.$element.parent().hasClass('input-group') ? ' input-group-btn' : '',\r\n          autofocus = this.autofocus ? ' autofocus' : '';\r\n      // Elements\r\n      var header = this.options.header ? '<div class=\"popover-title\"><button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>' + this.options.header + '</div>' : '';\r\n      var searchbox = this.options.liveSearch ?\r\n      '<div class=\"bs-searchbox\">' +\r\n      '<input type=\"text\" class=\"form-control\" autocomplete=\"off\"' +\r\n      (null === this.options.liveSearchPlaceholder ? '' : ' placeholder=\"' + htmlEscape(this.options.liveSearchPlaceholder) + '\"') + ' role=\"textbox\" aria-label=\"Search\">' +\r\n      '</div>'\r\n          : '';\r\n      var actionsbox = this.multiple && this.options.actionsBox ?\r\n      '<div class=\"bs-actionsbox\">' +\r\n      '<div class=\"btn-group btn-group-sm btn-block\">' +\r\n      '<button type=\"button\" class=\"actions-btn bs-select-all btn btn-default\">' +\r\n      this.options.selectAllText +\r\n      '</button>' +\r\n      '<button type=\"button\" class=\"actions-btn bs-deselect-all btn btn-default\">' +\r\n      this.options.deselectAllText +\r\n      '</button>' +\r\n      '</div>' +\r\n      '</div>'\r\n          : '';\r\n      var donebutton = this.multiple && this.options.doneButton ?\r\n      '<div class=\"bs-donebutton\">' +\r\n      '<div class=\"btn-group btn-block\">' +\r\n      '<button type=\"button\" class=\"btn btn-sm btn-default\">' +\r\n      this.options.doneButtonText +\r\n      '</button>' +\r\n      '</div>' +\r\n      '</div>'\r\n          : '';\r\n      var drop =\r\n          '<div class=\"btn-group bootstrap-select' + showTick + inputGroup + '\">' +\r\n          '<button type=\"button\" class=\"' + this.options.styleBase + ' dropdown-toggle\" data-toggle=\"dropdown\"' + autofocus + ' role=\"button\">' +\r\n          '<span class=\"filter-option pull-left\"></span>&nbsp;' +\r\n          '<span class=\"bs-caret\">' +\r\n          this.options.template.caret +\r\n          '</span>' +\r\n          '</button>' +\r\n          '<div class=\"dropdown-menu open\" role=\"combobox\">' +\r\n          header +\r\n          searchbox +\r\n          actionsbox +\r\n          '<ul class=\"dropdown-menu inner\" role=\"listbox\" aria-expanded=\"false\">' +\r\n          '</ul>' +\r\n          donebutton +\r\n          '</div>' +\r\n          '</div>';\r\n\r\n      return $(drop);\r\n    },\r\n\r\n    createView: function () {\r\n      var $drop = this.createDropdown(),\r\n          li = this.createLi();\r\n\r\n      $drop.find('ul')[0].innerHTML = li;\r\n      return $drop;\r\n    },\r\n\r\n    reloadLi: function () {\r\n      //Remove all children.\r\n      this.destroyLi();\r\n      //Re build\r\n      var li = this.createLi();\r\n      this.$menuInner[0].innerHTML = li;\r\n    },\r\n\r\n    destroyLi: function () {\r\n      this.$menu.find('li').remove();\r\n    },\r\n\r\n    createLi: function () {\r\n      var that = this,\r\n          _li = [],\r\n          optID = 0,\r\n          titleOption = document.createElement('option'),\r\n          liIndex = -1; // increment liIndex whenever a new <li> element is created to ensure liObj is correct\r\n\r\n      // Helper functions\r\n      /**\r\n       * @param content\r\n       * @param [index]\r\n       * @param [classes]\r\n       * @param [optgroup]\r\n       * @returns {string}\r\n       */\r\n      var generateLI = function (content, index, classes, optgroup) {\r\n        return '<li' +\r\n            ((typeof classes !== 'undefined' & '' !== classes) ? ' class=\"' + classes + '\"' : '') +\r\n            ((typeof index !== 'undefined' & null !== index) ? ' data-original-index=\"' + index + '\"' : '') +\r\n            ((typeof optgroup !== 'undefined' & null !== optgroup) ? 'data-optgroup=\"' + optgroup + '\"' : '') +\r\n            '>' + content + '</li>';\r\n      };\r\n\r\n      /**\r\n       * @param text\r\n       * @param [classes]\r\n       * @param [inline]\r\n       * @param [tokens]\r\n       * @returns {string}\r\n       */\r\n      var generateA = function (text, classes, inline, tokens) {\r\n        return '<a tabindex=\"0\"' +\r\n            (typeof classes !== 'undefined' ? ' class=\"' + classes + '\"' : '') +\r\n            (typeof inline !== 'undefined' ? ' style=\"' + inline + '\"' : '') +\r\n            (that.options.liveSearchNormalize ? ' data-normalized-text=\"' + normalizeToBase(htmlEscape(text)) + '\"' : '') +\r\n            (typeof tokens !== 'undefined' || tokens !== null ? ' data-tokens=\"' + tokens + '\"' : '') +\r\n            ' role=\"option\">' + text +\r\n            '<span class=\"' + that.options.iconBase + ' ' + that.options.tickIcon + ' check-mark\"></span>' +\r\n            '</a>';\r\n      };\r\n\r\n      if (this.options.title && !this.multiple) {\r\n        // this option doesn't create a new <li> element, but does add a new option, so liIndex is decreased\r\n        // since liObj is recalculated on every refresh, liIndex needs to be decreased even if the titleOption is already appended\r\n        liIndex--;\r\n\r\n        if (!this.$element.find('.bs-title-option').length) {\r\n          // Use native JS to prepend option (faster)\r\n          var element = this.$element[0];\r\n          titleOption.className = 'bs-title-option';\r\n          titleOption.appendChild(document.createTextNode(this.options.title));\r\n          titleOption.value = '';\r\n          element.insertBefore(titleOption, element.firstChild);\r\n          // Check if selected or data-selected attribute is already set on an option. If not, select the titleOption option.\r\n          // the selected item may have been changed by user or programmatically before the bootstrap select plugin runs,\r\n          // if so, the select will have the data-selected attribute\r\n          var $opt = $(element.options[element.selectedIndex]);\r\n          if ($opt.attr('selected') === undefined && this.$element.data('selected') === undefined) {\r\n            titleOption.selected = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.$element.find('option').each(function (index) {\r\n        var $this = $(this);\r\n\r\n        liIndex++;\r\n\r\n        if ($this.hasClass('bs-title-option')) return;\r\n\r\n        // Get the class and text for the option\r\n        var optionClass = this.className || '',\r\n            inline = this.style.cssText,\r\n            text = $this.data('content') ? $this.data('content') : $this.html(),\r\n            tokens = $this.data('tokens') ? $this.data('tokens') : null,\r\n            subtext = typeof $this.data('subtext') !== 'undefined' ? '<small class=\"text-muted\">' + $this.data('subtext') + '</small>' : '',\r\n            icon = typeof $this.data('icon') !== 'undefined' ? '<span class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></span> ' : '',\r\n            $parent = $this.parent(),\r\n            isOptgroup = $parent[0].tagName === 'OPTGROUP',\r\n            isOptgroupDisabled = isOptgroup && $parent[0].disabled,\r\n            isDisabled = this.disabled || isOptgroupDisabled;\r\n\r\n        if (icon !== '' && isDisabled) {\r\n          icon = '<span>' + icon + '</span>';\r\n        }\r\n\r\n        if (that.options.hideDisabled && (isDisabled && !isOptgroup || isOptgroupDisabled)) {\r\n          liIndex--;\r\n          return;\r\n        }\r\n\r\n        if (!$this.data('content')) {\r\n          // Prepend any icon and append any subtext to the main text.\r\n          text = icon + '<span class=\"text\">' + text + subtext + '</span>';\r\n        }\r\n\r\n        if (isOptgroup && $this.data('divider') !== true) {\r\n          if (that.options.hideDisabled && isDisabled) {\r\n            if ($parent.data('allOptionsDisabled') === undefined) {\r\n              var $options = $parent.children();\r\n              $parent.data('allOptionsDisabled', $options.filter(':disabled').length === $options.length);\r\n            }\r\n\r\n            if ($parent.data('allOptionsDisabled')) {\r\n              liIndex--;\r\n              return;\r\n            }\r\n          }\r\n\r\n          var optGroupClass = ' ' + $parent[0].className || '';\r\n\r\n          if ($this.index() === 0) { // Is it the first option of the optgroup?\r\n            optID += 1;\r\n\r\n            // Get the opt group label\r\n            var label = $parent[0].label,\r\n                labelSubtext = typeof $parent.data('subtext') !== 'undefined' ? '<small class=\"text-muted\">' + $parent.data('subtext') + '</small>' : '',\r\n                labelIcon = $parent.data('icon') ? '<span class=\"' + that.options.iconBase + ' ' + $parent.data('icon') + '\"></span> ' : '';\r\n\r\n            label = labelIcon + '<span class=\"text\">' + label + labelSubtext + '</span>';\r\n\r\n            if (index !== 0 && _li.length > 0) { // Is it NOT the first option of the select && are there elements in the dropdown?\r\n              liIndex++;\r\n              _li.push(generateLI('', null, 'divider', optID + 'div'));\r\n            }\r\n            liIndex++;\r\n            _li.push(generateLI(label, null, 'dropdown-header' + optGroupClass, optID));\r\n          }\r\n\r\n          if (that.options.hideDisabled && isDisabled) {\r\n            liIndex--;\r\n            return;\r\n          }\r\n\r\n          _li.push(generateLI(generateA(text, 'opt ' + optionClass + optGroupClass, inline, tokens), index, '', optID));\r\n        } else if ($this.data('divider') === true) {\r\n          _li.push(generateLI('', index, 'divider'));\r\n        } else if ($this.data('hidden') === true) {\r\n          _li.push(generateLI(generateA(text, optionClass, inline, tokens), index, 'hidden is-hidden'));\r\n        } else {\r\n          var showDivider = this.previousElementSibling && this.previousElementSibling.tagName === 'OPTGROUP';\r\n\r\n          // if previous element is not an optgroup and hideDisabled is true\r\n          if (!showDivider && that.options.hideDisabled) {\r\n            // get previous elements\r\n            var $prev = $(this).prevAll();\r\n\r\n            for (var i = 0; i < $prev.length; i++) {\r\n              // find the first element in the previous elements that is an optgroup\r\n              if ($prev[i].tagName === 'OPTGROUP') {\r\n                var optGroupDistance = 0;\r\n\r\n                // loop through the options in between the current option and the optgroup\r\n                // and check if they are hidden or disabled\r\n                for (var d = 0; d < i; d++) {\r\n                  var prevOption = $prev[d];\r\n                  if (prevOption.disabled || $(prevOption).data('hidden') === true) optGroupDistance++;\r\n                }\r\n\r\n                // if all of the options between the current option and the optgroup are hidden or disabled, show the divider\r\n                if (optGroupDistance === i) showDivider = true;\r\n\r\n                break;\r\n              }\r\n            }\r\n          }\r\n\r\n          if (showDivider) {\r\n            liIndex++;\r\n            _li.push(generateLI('', null, 'divider', optID + 'div'));\r\n          }\r\n          _li.push(generateLI(generateA(text, optionClass, inline, tokens), index));\r\n        }\r\n\r\n        that.liObj[index] = liIndex;\r\n      });\r\n\r\n      //If we are not multiple, we don't have a selected item, and we don't have a title, select the first element so something is set in the button\r\n      if (!this.multiple && this.$element.find('option:selected').length === 0 && !this.options.title) {\r\n        this.$element.find('option').eq(0).prop('selected', true).attr('selected', 'selected');\r\n      }\r\n\r\n      return _li.join('');\r\n    },\r\n\r\n    findLis: function () {\r\n      if (this.$lis == null) this.$lis = this.$menu.find('li');\r\n      return this.$lis;\r\n    },\r\n\r\n    /**\r\n     * @param [updateLi] defaults to true\r\n     */\r\n    render: function (updateLi) {\r\n      var that = this,\r\n          notDisabled;\r\n\r\n      //Update the LI to match the SELECT\r\n      if (updateLi !== false) {\r\n        this.$element.find('option').each(function (index) {\r\n          var $lis = that.findLis().eq(that.liObj[index]);\r\n\r\n          that.setDisabled(index, this.disabled || this.parentNode.tagName === 'OPTGROUP' && this.parentNode.disabled, $lis);\r\n          that.setSelected(index, this.selected, $lis);\r\n        });\r\n      }\r\n\r\n      this.togglePlaceholder();\r\n\r\n      this.tabIndex();\r\n\r\n      var selectedItems = this.$element.find('option').map(function () {\r\n        if (this.selected) {\r\n          if (that.options.hideDisabled && (this.disabled || this.parentNode.tagName === 'OPTGROUP' && this.parentNode.disabled)) return;\r\n\r\n          var $this = $(this),\r\n              icon = $this.data('icon') && that.options.showIcon ? '<i class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></i> ' : '',\r\n              subtext;\r\n\r\n          if (that.options.showSubtext && $this.data('subtext') && !that.multiple) {\r\n            subtext = ' <small class=\"text-muted\">' + $this.data('subtext') + '</small>';\r\n          } else {\r\n            subtext = '';\r\n          }\r\n          if (typeof $this.attr('title') !== 'undefined') {\r\n            return $this.attr('title');\r\n          } else if ($this.data('content') && that.options.showContent) {\r\n            return $this.data('content');\r\n          } else {\r\n            return icon + $this.html() + subtext;\r\n          }\r\n        }\r\n      }).toArray();\r\n\r\n      //Fixes issue in IE10 occurring when no default option is selected and at least one option is disabled\r\n      //Convert all the values into a comma delimited string\r\n      var title = !this.multiple ? selectedItems[0] : selectedItems.join(this.options.multipleSeparator);\r\n\r\n      //If this is multi select, and the selectText type is count, the show 1 of 2 selected etc..\r\n      if (this.multiple && this.options.selectedTextFormat.indexOf('count') > -1) {\r\n        var max = this.options.selectedTextFormat.split('>');\r\n        if ((max.length > 1 && selectedItems.length > max[1]) || (max.length == 1 && selectedItems.length >= 2)) {\r\n          notDisabled = this.options.hideDisabled ? ', [disabled]' : '';\r\n          var totalCount = this.$element.find('option').not('[data-divider=\"true\"], [data-hidden=\"true\"]' + notDisabled).length,\r\n              tr8nText = (typeof this.options.countSelectedText === 'function') ? this.options.countSelectedText(selectedItems.length, totalCount) : this.options.countSelectedText;\r\n          title = tr8nText.replace('{0}', selectedItems.length.toString()).replace('{1}', totalCount.toString());\r\n        }\r\n      }\r\n\r\n      if (this.options.title == undefined) {\r\n        this.options.title = this.$element.attr('title');\r\n      }\r\n\r\n      if (this.options.selectedTextFormat == 'static') {\r\n        title = this.options.title;\r\n      }\r\n\r\n      //If we dont have a title, then use the default, or if nothing is set at all, use the not selected text\r\n      if (!title) {\r\n        title = typeof this.options.title !== 'undefined' ? this.options.title : this.options.noneSelectedText;\r\n      }\r\n\r\n      //strip all html-tags and trim the result\r\n      this.$button.attr('title', $.trim(title.replace(/<[^>]*>?/g, '')));\r\n      this.$button.children('.filter-option').html(title);\r\n\r\n      this.$element.trigger('rendered.bs.select');\r\n    },\r\n\r\n    /**\r\n     * @param [style]\r\n     * @param [status]\r\n     */\r\n    setStyle: function (style, status) {\r\n      if (this.$element.attr('class')) {\r\n        this.$newElement.addClass(this.$element.attr('class').replace(/selectpicker|mobile-device|bs-select-hidden|validate\\[.*\\]/gi, ''));\r\n      }\r\n\r\n      var buttonClass = style ? style : this.options.style;\r\n\r\n      if (status == 'add') {\r\n        this.$button.addClass(buttonClass);\r\n      } else if (status == 'remove') {\r\n        this.$button.removeClass(buttonClass);\r\n      } else {\r\n        this.$button.removeClass(this.options.style);\r\n        this.$button.addClass(buttonClass);\r\n      }\r\n    },\r\n\r\n    liHeight: function (refresh) {\r\n      if (!refresh && (this.options.size === false || this.sizeInfo)) return;\r\n\r\n      var newElement = document.createElement('div'),\r\n          menu = document.createElement('div'),\r\n          menuInner = document.createElement('ul'),\r\n          divider = document.createElement('li'),\r\n          li = document.createElement('li'),\r\n          a = document.createElement('a'),\r\n          text = document.createElement('span'),\r\n          header = this.options.header && this.$menu.find('.popover-title').length > 0 ? this.$menu.find('.popover-title')[0].cloneNode(true) : null,\r\n          search = this.options.liveSearch ? document.createElement('div') : null,\r\n          actions = this.options.actionsBox && this.multiple && this.$menu.find('.bs-actionsbox').length > 0 ? this.$menu.find('.bs-actionsbox')[0].cloneNode(true) : null,\r\n          doneButton = this.options.doneButton && this.multiple && this.$menu.find('.bs-donebutton').length > 0 ? this.$menu.find('.bs-donebutton')[0].cloneNode(true) : null;\r\n\r\n      text.className = 'text';\r\n      newElement.className = this.$menu[0].parentNode.className + ' open';\r\n      menu.className = 'dropdown-menu open';\r\n      menuInner.className = 'dropdown-menu inner';\r\n      divider.className = 'divider';\r\n\r\n      text.appendChild(document.createTextNode('Inner text'));\r\n      a.appendChild(text);\r\n      li.appendChild(a);\r\n      menuInner.appendChild(li);\r\n      menuInner.appendChild(divider);\r\n      if (header) menu.appendChild(header);\r\n      if (search) {\r\n        // create a span instead of input as creating an input element is slower\r\n        var input = document.createElement('span');\r\n        search.className = 'bs-searchbox';\r\n        input.className = 'form-control';\r\n        search.appendChild(input);\r\n        menu.appendChild(search);\r\n      }\r\n      if (actions) menu.appendChild(actions);\r\n      menu.appendChild(menuInner);\r\n      if (doneButton) menu.appendChild(doneButton);\r\n      newElement.appendChild(menu);\r\n\r\n      document.body.appendChild(newElement);\r\n\r\n      var liHeight = a.offsetHeight,\r\n          headerHeight = header ? header.offsetHeight : 0,\r\n          searchHeight = search ? search.offsetHeight : 0,\r\n          actionsHeight = actions ? actions.offsetHeight : 0,\r\n          doneButtonHeight = doneButton ? doneButton.offsetHeight : 0,\r\n          dividerHeight = $(divider).outerHeight(true),\r\n          // fall back to jQuery if getComputedStyle is not supported\r\n          menuStyle = typeof getComputedStyle === 'function' ? getComputedStyle(menu) : false,\r\n          $menu = menuStyle ? null : $(menu),\r\n          menuPadding = {\r\n            vert: parseInt(menuStyle ? menuStyle.paddingTop : $menu.css('paddingTop')) +\r\n                  parseInt(menuStyle ? menuStyle.paddingBottom : $menu.css('paddingBottom')) +\r\n                  parseInt(menuStyle ? menuStyle.borderTopWidth : $menu.css('borderTopWidth')) +\r\n                  parseInt(menuStyle ? menuStyle.borderBottomWidth : $menu.css('borderBottomWidth')),\r\n            horiz: parseInt(menuStyle ? menuStyle.paddingLeft : $menu.css('paddingLeft')) +\r\n                  parseInt(menuStyle ? menuStyle.paddingRight : $menu.css('paddingRight')) +\r\n                  parseInt(menuStyle ? menuStyle.borderLeftWidth : $menu.css('borderLeftWidth')) +\r\n                  parseInt(menuStyle ? menuStyle.borderRightWidth : $menu.css('borderRightWidth'))\r\n          },\r\n          menuExtras =  {\r\n            vert: menuPadding.vert +\r\n                  parseInt(menuStyle ? menuStyle.marginTop : $menu.css('marginTop')) +\r\n                  parseInt(menuStyle ? menuStyle.marginBottom : $menu.css('marginBottom')) + 2,\r\n            horiz: menuPadding.horiz +\r\n                  parseInt(menuStyle ? menuStyle.marginLeft : $menu.css('marginLeft')) +\r\n                  parseInt(menuStyle ? menuStyle.marginRight : $menu.css('marginRight')) + 2\r\n          }\r\n\r\n      document.body.removeChild(newElement);\r\n\r\n      this.sizeInfo = {\r\n        liHeight: liHeight,\r\n        headerHeight: headerHeight,\r\n        searchHeight: searchHeight,\r\n        actionsHeight: actionsHeight,\r\n        doneButtonHeight: doneButtonHeight,\r\n        dividerHeight: dividerHeight,\r\n        menuPadding: menuPadding,\r\n        menuExtras: menuExtras\r\n      };\r\n    },\r\n\r\n    setSize: function () {\r\n      this.findLis();\r\n      this.liHeight();\r\n\r\n      if (this.options.header) this.$menu.css('padding-top', 0);\r\n      if (this.options.size === false) return;\r\n\r\n      var that = this,\r\n          $menu = this.$menu,\r\n          $menuInner = this.$menuInner,\r\n          $window = $(window),\r\n          selectHeight = this.$newElement[0].offsetHeight,\r\n          selectWidth = this.$newElement[0].offsetWidth,\r\n          liHeight = this.sizeInfo['liHeight'],\r\n          headerHeight = this.sizeInfo['headerHeight'],\r\n          searchHeight = this.sizeInfo['searchHeight'],\r\n          actionsHeight = this.sizeInfo['actionsHeight'],\r\n          doneButtonHeight = this.sizeInfo['doneButtonHeight'],\r\n          divHeight = this.sizeInfo['dividerHeight'],\r\n          menuPadding = this.sizeInfo['menuPadding'],\r\n          menuExtras = this.sizeInfo['menuExtras'],\r\n          notDisabled = this.options.hideDisabled ? '.disabled' : '',\r\n          menuHeight,\r\n          menuWidth,\r\n          getHeight,\r\n          getWidth,\r\n          selectOffsetTop,\r\n          selectOffsetBot,\r\n          selectOffsetLeft,\r\n          selectOffsetRight,\r\n          getPos = function() {\r\n            var pos = that.$newElement.offset(),\r\n                $container = $(that.options.container),\r\n                containerPos;\r\n\r\n            if (that.options.container && !$container.is('body')) {\r\n              containerPos = $container.offset();\r\n              containerPos.top += parseInt($container.css('borderTopWidth'));\r\n              containerPos.left += parseInt($container.css('borderLeftWidth'));\r\n            } else {\r\n              containerPos = { top: 0, left: 0 };\r\n            }\r\n\r\n            selectOffsetTop = pos.top - containerPos.top - $window.scrollTop();\r\n            selectOffsetBot = $window.height() - selectOffsetTop - selectHeight - containerPos.top;\r\n            selectOffsetLeft = pos.left - containerPos.left - $window.scrollLeft();\r\n            selectOffsetRight = $window.width() - selectOffsetLeft - selectWidth - containerPos.left;\r\n          };\r\n\r\n      getPos();\r\n\r\n      if (this.options.size === 'auto') {\r\n        var getSize = function () {\r\n          var minHeight,\r\n              hasClass = function (className, include) {\r\n                return function (element) {\r\n                    if (include) {\r\n                        return (element.classList ? element.classList.contains(className) : $(element).hasClass(className));\r\n                    } else {\r\n                        return !(element.classList ? element.classList.contains(className) : $(element).hasClass(className));\r\n                    }\r\n                };\r\n              },\r\n              lis = that.$menuInner[0].getElementsByTagName('li'),\r\n              lisVisible = Array.prototype.filter ? Array.prototype.filter.call(lis, hasClass('hidden', false)) : that.$lis.not('.hidden'),\r\n              optGroup = Array.prototype.filter ? Array.prototype.filter.call(lisVisible, hasClass('dropdown-header', true)) : lisVisible.filter('.dropdown-header');\r\n\r\n          getPos();\r\n          menuHeight = selectOffsetBot - menuExtras.vert;\r\n          menuWidth = selectOffsetRight - menuExtras.horiz;\r\n\r\n          if (that.options.container) {\r\n            if (!$menu.data('height')) $menu.data('height', $menu.height());\r\n            getHeight = $menu.data('height');\r\n\r\n            if (!$menu.data('width')) $menu.data('width', $menu.width());\r\n            getWidth = $menu.data('width');\r\n          } else {\r\n            getHeight = $menu.height();\r\n            getWidth = $menu.width();\r\n          }\r\n\r\n          if (that.options.dropupAuto) {\r\n            that.$newElement.toggleClass('dropup', selectOffsetTop > selectOffsetBot && (menuHeight - menuExtras.vert) < getHeight);\r\n          }\r\n\r\n          if (that.$newElement.hasClass('dropup')) {\r\n            menuHeight = selectOffsetTop - menuExtras.vert;\r\n          }\r\n\r\n          if (that.options.dropdownAlignRight === 'auto') {\r\n            $menu.toggleClass('dropdown-menu-right', selectOffsetLeft > selectOffsetRight && (menuWidth - menuExtras.horiz) < (getWidth - selectWidth));\r\n          }\r\n\r\n          if ((lisVisible.length + optGroup.length) > 3) {\r\n            minHeight = liHeight * 3 + menuExtras.vert - 2;\r\n          } else {\r\n            minHeight = 0;\r\n          }\r\n\r\n          $menu.css({\r\n            'max-height': menuHeight + 'px',\r\n            'overflow': 'hidden',\r\n            'min-height': minHeight + headerHeight + searchHeight + actionsHeight + doneButtonHeight + 'px'\r\n          });\r\n          $menuInner.css({\r\n            'max-height': menuHeight - headerHeight - searchHeight - actionsHeight - doneButtonHeight - menuPadding.vert + 'px',\r\n            'overflow-y': 'auto',\r\n            'min-height': Math.max(minHeight - menuPadding.vert, 0) + 'px'\r\n          });\r\n        };\r\n        getSize();\r\n        this.$searchbox.off('input.getSize propertychange.getSize').on('input.getSize propertychange.getSize', getSize);\r\n        $window.off('resize.getSize scroll.getSize').on('resize.getSize scroll.getSize', getSize);\r\n      } else if (this.options.size && this.options.size != 'auto' && this.$lis.not(notDisabled).length > this.options.size) {\r\n        var optIndex = this.$lis.not('.divider').not(notDisabled).children().slice(0, this.options.size).last().parent().index(),\r\n            divLength = this.$lis.slice(0, optIndex + 1).filter('.divider').length;\r\n        menuHeight = liHeight * this.options.size + divLength * divHeight + menuPadding.vert;\r\n\r\n        if (that.options.container) {\r\n          if (!$menu.data('height')) $menu.data('height', $menu.height());\r\n          getHeight = $menu.data('height');\r\n        } else {\r\n          getHeight = $menu.height();\r\n        }\r\n\r\n        if (that.options.dropupAuto) {\r\n          //noinspection JSUnusedAssignment\r\n          this.$newElement.toggleClass('dropup', selectOffsetTop > selectOffsetBot && (menuHeight - menuExtras.vert) < getHeight);\r\n        }\r\n        $menu.css({\r\n          'max-height': menuHeight + headerHeight + searchHeight + actionsHeight + doneButtonHeight + 'px',\r\n          'overflow': 'hidden',\r\n          'min-height': ''\r\n        });\r\n        $menuInner.css({\r\n          'max-height': menuHeight - menuPadding.vert + 'px',\r\n          'overflow-y': 'auto',\r\n          'min-height': ''\r\n        });\r\n      }\r\n    },\r\n\r\n    setWidth: function () {\r\n      if (this.options.width === 'auto') {\r\n        this.$menu.css('min-width', '0');\r\n\r\n        // Get correct width if element is hidden\r\n        var $selectClone = this.$menu.parent().clone().appendTo('body'),\r\n            $selectClone2 = this.options.container ? this.$newElement.clone().appendTo('body') : $selectClone,\r\n            ulWidth = $selectClone.children('.dropdown-menu').outerWidth(),\r\n            btnWidth = $selectClone2.css('width', 'auto').children('button').outerWidth();\r\n\r\n        $selectClone.remove();\r\n        $selectClone2.remove();\r\n\r\n        // Set width to whatever's larger, button title or longest option\r\n        this.$newElement.css('width', Math.max(ulWidth, btnWidth) + 'px');\r\n      } else if (this.options.width === 'fit') {\r\n        // Remove inline min-width so width can be changed from 'auto'\r\n        this.$menu.css('min-width', '');\r\n        this.$newElement.css('width', '').addClass('fit-width');\r\n      } else if (this.options.width) {\r\n        // Remove inline min-width so width can be changed from 'auto'\r\n        this.$menu.css('min-width', '');\r\n        this.$newElement.css('width', this.options.width);\r\n      } else {\r\n        // Remove inline min-width/width so width can be changed\r\n        this.$menu.css('min-width', '');\r\n        this.$newElement.css('width', '');\r\n      }\r\n      // Remove fit-width class if width is changed programmatically\r\n      if (this.$newElement.hasClass('fit-width') && this.options.width !== 'fit') {\r\n        this.$newElement.removeClass('fit-width');\r\n      }\r\n    },\r\n\r\n    selectPosition: function () {\r\n      this.$bsContainer = $('<div class=\"bs-container\" />');\r\n\r\n      var that = this,\r\n          $container = $(this.options.container),\r\n          pos,\r\n          containerPos,\r\n          actualHeight,\r\n          getPlacement = function ($element) {\r\n            that.$bsContainer.addClass($element.attr('class').replace(/form-control|fit-width/gi, '')).toggleClass('dropup', $element.hasClass('dropup'));\r\n            pos = $element.offset();\r\n\r\n            if (!$container.is('body')) {\r\n              containerPos = $container.offset();\r\n              containerPos.top += parseInt($container.css('borderTopWidth')) - $container.scrollTop();\r\n              containerPos.left += parseInt($container.css('borderLeftWidth')) - $container.scrollLeft();\r\n            } else {\r\n              containerPos = { top: 0, left: 0 };\r\n            }\r\n\r\n            actualHeight = $element.hasClass('dropup') ? 0 : $element[0].offsetHeight;\r\n\r\n            that.$bsContainer.css({\r\n              'top': pos.top - containerPos.top + actualHeight,\r\n              'left': pos.left - containerPos.left,\r\n              'width': $element[0].offsetWidth\r\n            });\r\n          };\r\n\r\n      this.$button.on('click', function () {\r\n        var $this = $(this);\r\n\r\n        if (that.isDisabled()) {\r\n          return;\r\n        }\r\n\r\n        getPlacement(that.$newElement);\r\n\r\n        that.$bsContainer\r\n          .appendTo(that.options.container)\r\n          .toggleClass('open', !$this.hasClass('open'))\r\n          .append(that.$menu);\r\n      });\r\n\r\n      $(window).on('resize scroll', function () {\r\n        getPlacement(that.$newElement);\r\n      });\r\n\r\n      this.$element.on('hide.bs.select', function () {\r\n        that.$menu.data('height', that.$menu.height());\r\n        that.$bsContainer.detach();\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @param {number} index - the index of the option that is being changed\r\n     * @param {boolean} selected - true if the option is being selected, false if being deselected\r\n     * @param {JQuery} $lis - the 'li' element that is being modified\r\n     */\r\n    setSelected: function (index, selected, $lis) {\r\n      if (!$lis) {\r\n        this.togglePlaceholder(); // check if setSelected is being called by changing the value of the select\r\n        $lis = this.findLis().eq(this.liObj[index]);\r\n      }\r\n\r\n      $lis.toggleClass('selected', selected).find('a').attr('aria-selected', selected);\r\n    },\r\n\r\n    /**\r\n     * @param {number} index - the index of the option that is being disabled\r\n     * @param {boolean} disabled - true if the option is being disabled, false if being enabled\r\n     * @param {JQuery} $lis - the 'li' element that is being modified\r\n     */\r\n    setDisabled: function (index, disabled, $lis) {\r\n      if (!$lis) {\r\n        $lis = this.findLis().eq(this.liObj[index]);\r\n      }\r\n\r\n      if (disabled) {\r\n        $lis.addClass('disabled').children('a').attr('href', '#').attr('tabindex', -1).attr('aria-disabled', true);\r\n      } else {\r\n        $lis.removeClass('disabled').children('a').removeAttr('href').attr('tabindex', 0).attr('aria-disabled', false);\r\n      }\r\n    },\r\n\r\n    isDisabled: function () {\r\n      return this.$element[0].disabled;\r\n    },\r\n\r\n    checkDisabled: function () {\r\n      var that = this;\r\n\r\n      if (this.isDisabled()) {\r\n        this.$newElement.addClass('disabled');\r\n        this.$button.addClass('disabled').attr('tabindex', -1);\r\n      } else {\r\n        if (this.$button.hasClass('disabled')) {\r\n          this.$newElement.removeClass('disabled');\r\n          this.$button.removeClass('disabled');\r\n        }\r\n\r\n        if (this.$button.attr('tabindex') == -1 && !this.$element.data('tabindex')) {\r\n          this.$button.removeAttr('tabindex');\r\n        }\r\n      }\r\n\r\n      this.$button.click(function () {\r\n        return !that.isDisabled();\r\n      });\r\n    },\r\n\r\n    togglePlaceholder: function () {\r\n      var value = this.$element.val();\r\n      this.$button.toggleClass('bs-placeholder', value === null || value === '');\r\n    },\r\n\r\n    tabIndex: function () {\r\n      if (this.$element.data('tabindex') !== this.$element.attr('tabindex') && \r\n        (this.$element.attr('tabindex') !== -98 && this.$element.attr('tabindex') !== '-98')) {\r\n        this.$element.data('tabindex', this.$element.attr('tabindex'));\r\n        this.$button.attr('tabindex', this.$element.data('tabindex'));\r\n      }\r\n\r\n      this.$element.attr('tabindex', -98);\r\n    },\r\n\r\n    clickListener: function () {\r\n      var that = this,\r\n          $document = $(document);\r\n\r\n      this.$newElement.on('touchstart.dropdown', '.dropdown-menu', function (e) {\r\n        e.stopPropagation();\r\n      });\r\n\r\n      $document.data('spaceSelect', false);\r\n\r\n      this.$button.on('keyup', function (e) {\r\n        if (/(32)/.test(e.keyCode.toString(10)) && $document.data('spaceSelect')) {\r\n            e.preventDefault();\r\n            $document.data('spaceSelect', false);\r\n        }\r\n      });\r\n\r\n      this.$button.on('click', function () {\r\n        that.setSize();\r\n      });\r\n\r\n      this.$element.on('shown.bs.select', function () {\r\n        if (!that.options.liveSearch && !that.multiple) {\r\n          that.$menuInner.find('.selected a').focus();\r\n        } else if (!that.multiple) {\r\n          var selectedIndex = that.liObj[that.$element[0].selectedIndex];\r\n\r\n          if (typeof selectedIndex !== 'number' || that.options.size === false) return;\r\n\r\n          // scroll to selected option\r\n          var offset = that.$lis.eq(selectedIndex)[0].offsetTop - that.$menuInner[0].offsetTop;\r\n          offset = offset - that.$menuInner[0].offsetHeight/2 + that.sizeInfo.liHeight/2;\r\n          that.$menuInner[0].scrollTop = offset;\r\n        }\r\n      });\r\n\r\n      this.$menuInner.on('click', 'li a', function (e) {\r\n        var $this = $(this),\r\n            clickedIndex = $this.parent().data('originalIndex'),\r\n            prevValue = that.$element.val(),\r\n            prevIndex = that.$element.prop('selectedIndex'),\r\n            triggerChange = true;\r\n\r\n        // Don't close on multi choice menu\r\n        if (that.multiple && that.options.maxOptions !== 1) {\r\n          e.stopPropagation();\r\n        }\r\n\r\n        e.preventDefault();\r\n\r\n        //Don't run if we have been disabled\r\n        if (!that.isDisabled() && !$this.parent().hasClass('disabled')) {\r\n          var $options = that.$element.find('option'),\r\n              $option = $options.eq(clickedIndex),\r\n              state = $option.prop('selected'),\r\n              $optgroup = $option.parent('optgroup'),\r\n              maxOptions = that.options.maxOptions,\r\n              maxOptionsGrp = $optgroup.data('maxOptions') || false;\r\n\r\n          if (!that.multiple) { // Deselect all others if not multi select box\r\n            $options.prop('selected', false);\r\n            $option.prop('selected', true);\r\n            that.$menuInner.find('.selected').removeClass('selected').find('a').attr('aria-selected', false);\r\n            that.setSelected(clickedIndex, true);\r\n          } else { // Toggle the one we have chosen if we are multi select.\r\n            $option.prop('selected', !state);\r\n            that.setSelected(clickedIndex, !state);\r\n            $this.blur();\r\n\r\n            if (maxOptions !== false || maxOptionsGrp !== false) {\r\n              var maxReached = maxOptions < $options.filter(':selected').length,\r\n                  maxReachedGrp = maxOptionsGrp < $optgroup.find('option:selected').length;\r\n\r\n              if ((maxOptions && maxReached) || (maxOptionsGrp && maxReachedGrp)) {\r\n                if (maxOptions && maxOptions == 1) {\r\n                  $options.prop('selected', false);\r\n                  $option.prop('selected', true);\r\n                  that.$menuInner.find('.selected').removeClass('selected');\r\n                  that.setSelected(clickedIndex, true);\r\n                } else if (maxOptionsGrp && maxOptionsGrp == 1) {\r\n                  $optgroup.find('option:selected').prop('selected', false);\r\n                  $option.prop('selected', true);\r\n                  var optgroupID = $this.parent().data('optgroup');\r\n                  that.$menuInner.find('[data-optgroup=\"' + optgroupID + '\"]').removeClass('selected');\r\n                  that.setSelected(clickedIndex, true);\r\n                } else {\r\n                  var maxOptionsText = typeof that.options.maxOptionsText === 'string' ? [that.options.maxOptionsText, that.options.maxOptionsText] : that.options.maxOptionsText,\r\n                      maxOptionsArr = typeof maxOptionsText === 'function' ? maxOptionsText(maxOptions, maxOptionsGrp) : maxOptionsText,\r\n                      maxTxt = maxOptionsArr[0].replace('{n}', maxOptions),\r\n                      maxTxtGrp = maxOptionsArr[1].replace('{n}', maxOptionsGrp),\r\n                      $notify = $('<div class=\"notify\"></div>');\r\n                  // If {var} is set in array, replace it\r\n                  /** @deprecated */\r\n                  if (maxOptionsArr[2]) {\r\n                    maxTxt = maxTxt.replace('{var}', maxOptionsArr[2][maxOptions > 1 ? 0 : 1]);\r\n                    maxTxtGrp = maxTxtGrp.replace('{var}', maxOptionsArr[2][maxOptionsGrp > 1 ? 0 : 1]);\r\n                  }\r\n\r\n                  $option.prop('selected', false);\r\n\r\n                  that.$menu.append($notify);\r\n\r\n                  if (maxOptions && maxReached) {\r\n                    $notify.append($('<div>' + maxTxt + '</div>'));\r\n                    triggerChange = false;\r\n                    that.$element.trigger('maxReached.bs.select');\r\n                  }\r\n\r\n                  if (maxOptionsGrp && maxReachedGrp) {\r\n                    $notify.append($('<div>' + maxTxtGrp + '</div>'));\r\n                    triggerChange = false;\r\n                    that.$element.trigger('maxReachedGrp.bs.select');\r\n                  }\r\n\r\n                  setTimeout(function () {\r\n                    that.setSelected(clickedIndex, false);\r\n                  }, 10);\r\n\r\n                  $notify.delay(750).fadeOut(300, function () {\r\n                    $(this).remove();\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          if (!that.multiple || (that.multiple && that.options.maxOptions === 1)) {\r\n            that.$button.focus();\r\n          } else if (that.options.liveSearch) {\r\n            that.$searchbox.focus();\r\n          }\r\n\r\n          // Trigger select 'change'\r\n          if (triggerChange) {\r\n            if ((prevValue != that.$element.val() && that.multiple) || (prevIndex != that.$element.prop('selectedIndex') && !that.multiple)) {\r\n              // $option.prop('selected') is current option state (selected/unselected). state is previous option state.\r\n              changed_arguments = [clickedIndex, $option.prop('selected'), state];\r\n              that.$element\r\n                .triggerNative('change');\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      this.$menu.on('click', 'li.disabled a, .popover-title, .popover-title :not(.close)', function (e) {\r\n        if (e.currentTarget == this) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          if (that.options.liveSearch && !$(e.target).hasClass('close')) {\r\n            that.$searchbox.focus();\r\n          } else {\r\n            that.$button.focus();\r\n          }\r\n        }\r\n      });\r\n\r\n      this.$menuInner.on('click', '.divider, .dropdown-header', function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (that.options.liveSearch) {\r\n          that.$searchbox.focus();\r\n        } else {\r\n          that.$button.focus();\r\n        }\r\n      });\r\n\r\n      this.$menu.on('click', '.popover-title .close', function () {\r\n        that.$button.click();\r\n      });\r\n\r\n      this.$searchbox.on('click', function (e) {\r\n        e.stopPropagation();\r\n      });\r\n\r\n      this.$menu.on('click', '.actions-btn', function (e) {\r\n        if (that.options.liveSearch) {\r\n          that.$searchbox.focus();\r\n        } else {\r\n          that.$button.focus();\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        if ($(this).hasClass('bs-select-all')) {\r\n          that.selectAll();\r\n        } else {\r\n          that.deselectAll();\r\n        }\r\n      });\r\n\r\n      this.$element.change(function () {\r\n        that.render(false);\r\n        that.$element.trigger('changed.bs.select', changed_arguments);\r\n        changed_arguments = null;\r\n      });\r\n    },\r\n\r\n    liveSearchListener: function () {\r\n      var that = this,\r\n          $no_results = $('<li class=\"no-results\"></li>');\r\n\r\n      this.$button.on('click.dropdown.data-api touchstart.dropdown.data-api', function () {\r\n        that.$menuInner.find('.active').removeClass('active');\r\n        if (!!that.$searchbox.val()) {\r\n          that.$searchbox.val('');\r\n          that.$lis.not('.is-hidden').removeClass('hidden');\r\n          if (!!$no_results.parent().length) $no_results.remove();\r\n        }\r\n        if (!that.multiple) that.$menuInner.find('.selected').addClass('active');\r\n        setTimeout(function () {\r\n          that.$searchbox.focus();\r\n        }, 10);\r\n      });\r\n\r\n      this.$searchbox.on('click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api', function (e) {\r\n        e.stopPropagation();\r\n      });\r\n\r\n      this.$searchbox.on('input propertychange', function () {\r\n        if (that.$searchbox.val()) {\r\n          var $searchBase = that.$lis.not('.is-hidden').removeClass('hidden').children('a');\r\n          if (that.options.liveSearchNormalize) {\r\n            $searchBase = $searchBase.not(':a' + that._searchStyle() + '(\"' + normalizeToBase(that.$searchbox.val()) + '\")');\r\n          } else {\r\n            $searchBase = $searchBase.not(':' + that._searchStyle() + '(\"' + that.$searchbox.val() + '\")');\r\n          }\r\n          $searchBase.parent().addClass('hidden');\r\n\r\n          that.$lis.filter('.dropdown-header').each(function () {\r\n            var $this = $(this),\r\n                optgroup = $this.data('optgroup');\r\n\r\n            if (that.$lis.filter('[data-optgroup=' + optgroup + ']').not($this).not('.hidden').length === 0) {\r\n              $this.addClass('hidden');\r\n              that.$lis.filter('[data-optgroup=' + optgroup + 'div]').addClass('hidden');\r\n            }\r\n          });\r\n\r\n          var $lisVisible = that.$lis.not('.hidden');\r\n\r\n          // hide divider if first or last visible, or if followed by another divider\r\n          $lisVisible.each(function (index) {\r\n            var $this = $(this);\r\n\r\n            if ($this.hasClass('divider') && (\r\n              $this.index() === $lisVisible.first().index() ||\r\n              $this.index() === $lisVisible.last().index() ||\r\n              $lisVisible.eq(index + 1).hasClass('divider'))) {\r\n              $this.addClass('hidden');\r\n            }\r\n          });\r\n\r\n          if (!that.$lis.not('.hidden, .no-results').length) {\r\n            if (!!$no_results.parent().length) {\r\n              $no_results.remove();\r\n            }\r\n            $no_results.html(that.options.noneResultsText.replace('{0}', '\"' + htmlEscape(that.$searchbox.val()) + '\"')).show();\r\n            that.$menuInner.append($no_results);\r\n          } else if (!!$no_results.parent().length) {\r\n            $no_results.remove();\r\n          }\r\n        } else {\r\n          that.$lis.not('.is-hidden').removeClass('hidden');\r\n          if (!!$no_results.parent().length) {\r\n            $no_results.remove();\r\n          }\r\n        }\r\n\r\n        that.$lis.filter('.active').removeClass('active');\r\n        if (that.$searchbox.val()) that.$lis.not('.hidden, .divider, .dropdown-header').eq(0).addClass('active').children('a').focus();\r\n        $(this).focus();\r\n      });\r\n    },\r\n\r\n    _searchStyle: function () {\r\n      var styles = {\r\n        begins: 'ibegins',\r\n        startsWith: 'ibegins'\r\n      };\r\n\r\n      return styles[this.options.liveSearchStyle] || 'icontains';\r\n    },\r\n\r\n    val: function (value) {\r\n      if (typeof value !== 'undefined') {\r\n        this.$element.val(value);\r\n        this.render();\r\n\r\n        return this.$element;\r\n      } else {\r\n        return this.$element.val();\r\n      }\r\n    },\r\n\r\n    changeAll: function (status) {\r\n      if (!this.multiple) return;\r\n      if (typeof status === 'undefined') status = true;\r\n\r\n      this.findLis();\r\n\r\n      var $options = this.$element.find('option'),\r\n          $lisVisible = this.$lis.not('.divider, .dropdown-header, .disabled, .hidden'),\r\n          lisVisLen = $lisVisible.length,\r\n          selectedOptions = [];\r\n          \r\n      if (status) {\r\n        if ($lisVisible.filter('.selected').length === $lisVisible.length) return;\r\n      } else {\r\n        if ($lisVisible.filter('.selected').length === 0) return;\r\n      }\r\n          \r\n      $lisVisible.toggleClass('selected', status);\r\n\r\n      for (var i = 0; i < lisVisLen; i++) {\r\n        var origIndex = $lisVisible[i].getAttribute('data-original-index');\r\n        selectedOptions[selectedOptions.length] = $options.eq(origIndex)[0];\r\n      }\r\n\r\n      $(selectedOptions).prop('selected', status);\r\n\r\n      this.render(false);\r\n\r\n      this.togglePlaceholder();\r\n\r\n      this.$element\r\n        .triggerNative('change');\r\n    },\r\n\r\n    selectAll: function () {\r\n      return this.changeAll(true);\r\n    },\r\n\r\n    deselectAll: function () {\r\n      return this.changeAll(false);\r\n    },\r\n\r\n    toggle: function (e) {\r\n      e = e || window.event;\r\n\r\n      if (e) e.stopPropagation();\r\n\r\n      this.$button.trigger('click');\r\n    },\r\n\r\n    keydown: function (e) {\r\n      var $this = $(this),\r\n          $parent = $this.is('input') ? $this.parent().parent() : $this.parent(),\r\n          $items,\r\n          that = $parent.data('this'),\r\n          index,\r\n          next,\r\n          first,\r\n          last,\r\n          prev,\r\n          nextPrev,\r\n          prevIndex,\r\n          isActive,\r\n          selector = ':not(.disabled, .hidden, .dropdown-header, .divider)',\r\n          keyCodeMap = {\r\n            32: ' ',\r\n            48: '0',\r\n            49: '1',\r\n            50: '2',\r\n            51: '3',\r\n            52: '4',\r\n            53: '5',\r\n            54: '6',\r\n            55: '7',\r\n            56: '8',\r\n            57: '9',\r\n            59: ';',\r\n            65: 'a',\r\n            66: 'b',\r\n            67: 'c',\r\n            68: 'd',\r\n            69: 'e',\r\n            70: 'f',\r\n            71: 'g',\r\n            72: 'h',\r\n            73: 'i',\r\n            74: 'j',\r\n            75: 'k',\r\n            76: 'l',\r\n            77: 'm',\r\n            78: 'n',\r\n            79: 'o',\r\n            80: 'p',\r\n            81: 'q',\r\n            82: 'r',\r\n            83: 's',\r\n            84: 't',\r\n            85: 'u',\r\n            86: 'v',\r\n            87: 'w',\r\n            88: 'x',\r\n            89: 'y',\r\n            90: 'z',\r\n            96: '0',\r\n            97: '1',\r\n            98: '2',\r\n            99: '3',\r\n            100: '4',\r\n            101: '5',\r\n            102: '6',\r\n            103: '7',\r\n            104: '8',\r\n            105: '9'\r\n          };\r\n\r\n      if (that.options.liveSearch) $parent = $this.parent().parent();\r\n\r\n      if (that.options.container) $parent = that.$menu;\r\n\r\n      $items = $('[role=\"listbox\"] li', $parent);\r\n\r\n      isActive = that.$newElement.hasClass('open');\r\n\r\n      if (!isActive && (e.keyCode >= 48 && e.keyCode <= 57 || e.keyCode >= 96 && e.keyCode <= 105 || e.keyCode >= 65 && e.keyCode <= 90)) {\r\n        if (!that.options.container) {\r\n          that.setSize();\r\n          that.$menu.parent().addClass('open');\r\n          isActive = true;\r\n        } else {\r\n          that.$button.trigger('click');\r\n        }\r\n        that.$searchbox.focus();\r\n        return;\r\n      }\r\n\r\n      if (that.options.liveSearch) {\r\n        if (/(^9$|27)/.test(e.keyCode.toString(10)) && isActive) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          that.$button.click().focus();\r\n        }\r\n        // $items contains li elements when liveSearch is enabled\r\n        $items = $('[role=\"listbox\"] li' + selector, $parent);\r\n        if (!$this.val() && !/(38|40)/.test(e.keyCode.toString(10))) {\r\n          if ($items.filter('.active').length === 0) {\r\n            $items = that.$menuInner.find('li');\r\n            if (that.options.liveSearchNormalize) {\r\n              $items = $items.filter(':a' + that._searchStyle() + '(' + normalizeToBase(keyCodeMap[e.keyCode]) + ')');\r\n            } else {\r\n              $items = $items.filter(':' + that._searchStyle() + '(' + keyCodeMap[e.keyCode] + ')');\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!$items.length) return;\r\n\r\n      if (/(38|40)/.test(e.keyCode.toString(10))) {\r\n        index = $items.index($items.find('a').filter(':focus').parent());\r\n        first = $items.filter(selector).first().index();\r\n        last = $items.filter(selector).last().index();\r\n        next = $items.eq(index).nextAll(selector).eq(0).index();\r\n        prev = $items.eq(index).prevAll(selector).eq(0).index();\r\n        nextPrev = $items.eq(next).prevAll(selector).eq(0).index();\r\n\r\n        if (that.options.liveSearch) {\r\n          $items.each(function (i) {\r\n            if (!$(this).hasClass('disabled')) {\r\n              $(this).data('index', i);\r\n            }\r\n          });\r\n          index = $items.index($items.filter('.active'));\r\n          first = $items.first().data('index');\r\n          last = $items.last().data('index');\r\n          next = $items.eq(index).nextAll().eq(0).data('index');\r\n          prev = $items.eq(index).prevAll().eq(0).data('index');\r\n          nextPrev = $items.eq(next).prevAll().eq(0).data('index');\r\n        }\r\n\r\n        prevIndex = $this.data('prevIndex');\r\n\r\n        if (e.keyCode == 38) {\r\n          if (that.options.liveSearch) index--;\r\n          if (index != nextPrev && index > prev) index = prev;\r\n          if (index < first) index = first;\r\n          if (index == prevIndex) index = last;\r\n        } else if (e.keyCode == 40) {\r\n          if (that.options.liveSearch) index++;\r\n          if (index == -1) index = 0;\r\n          if (index != nextPrev && index < next) index = next;\r\n          if (index > last) index = last;\r\n          if (index == prevIndex) index = first;\r\n        }\r\n\r\n        $this.data('prevIndex', index);\r\n\r\n        if (!that.options.liveSearch) {\r\n          $items.eq(index).children('a').focus();\r\n        } else {\r\n          e.preventDefault();\r\n          if (!$this.hasClass('dropdown-toggle')) {\r\n            $items.removeClass('active').eq(index).addClass('active').children('a').focus();\r\n            $this.focus();\r\n          }\r\n        }\r\n\r\n      } else if (!$this.is('input')) {\r\n        var keyIndex = [],\r\n            count,\r\n            prevKey;\r\n\r\n        $items.each(function () {\r\n          if (!$(this).hasClass('disabled')) {\r\n            if ($.trim($(this).children('a').text().toLowerCase()).substring(0, 1) == keyCodeMap[e.keyCode]) {\r\n              keyIndex.push($(this).index());\r\n            }\r\n          }\r\n        });\r\n\r\n        count = $(document).data('keycount');\r\n        count++;\r\n        $(document).data('keycount', count);\r\n\r\n        prevKey = $.trim($(':focus').text().toLowerCase()).substring(0, 1);\r\n\r\n        if (prevKey != keyCodeMap[e.keyCode]) {\r\n          count = 1;\r\n          $(document).data('keycount', count);\r\n        } else if (count >= keyIndex.length) {\r\n          $(document).data('keycount', 0);\r\n          if (count > keyIndex.length) count = 1;\r\n        }\r\n\r\n        $items.eq(keyIndex[count - 1]).children('a').focus();\r\n      }\r\n\r\n      // Select focused option if \"Enter\", \"Spacebar\" or \"Tab\" (when selectOnTab is true) are pressed inside the menu.\r\n      if ((/(13|32)/.test(e.keyCode.toString(10)) || (/(^9$)/.test(e.keyCode.toString(10)) && that.options.selectOnTab)) && isActive) {\r\n        if (!/(32)/.test(e.keyCode.toString(10))) e.preventDefault();\r\n        if (!that.options.liveSearch) {\r\n          var elem = $(':focus');\r\n          elem.click();\r\n          // Bring back focus for multiselects\r\n          elem.focus();\r\n          // Prevent screen from scrolling if the user hit the spacebar\r\n          e.preventDefault();\r\n          // Fixes spacebar selection of dropdown items in FF & IE\r\n          $(document).data('spaceSelect', true);\r\n        } else if (!/(32)/.test(e.keyCode.toString(10))) {\r\n          that.$menuInner.find('.active a').click();\r\n          $this.focus();\r\n        }\r\n        $(document).data('keycount', 0);\r\n      }\r\n\r\n      if ((/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && (that.multiple || that.options.liveSearch)) || (/(27)/.test(e.keyCode.toString(10)) && !isActive)) {\r\n        that.$menu.parent().removeClass('open');\r\n        if (that.options.container) that.$newElement.removeClass('open');\r\n        that.$button.focus();\r\n      }\r\n    },\r\n\r\n    mobile: function () {\r\n      this.$element.addClass('mobile-device');\r\n    },\r\n\r\n    refresh: function () {\r\n      this.$lis = null;\r\n      this.liObj = {};\r\n      this.reloadLi();\r\n      this.render();\r\n      this.checkDisabled();\r\n      this.liHeight(true);\r\n      this.setStyle();\r\n      this.setWidth();\r\n      if (this.$lis) this.$searchbox.trigger('propertychange');\r\n\r\n      this.$element.trigger('refreshed.bs.select');\r\n    },\r\n\r\n    hide: function () {\r\n      this.$newElement.hide();\r\n    },\r\n\r\n    show: function () {\r\n      this.$newElement.show();\r\n    },\r\n\r\n    remove: function () {\r\n      this.$newElement.remove();\r\n      this.$element.remove();\r\n    },\r\n\r\n    destroy: function () {\r\n      this.$newElement.before(this.$element).remove();\r\n\r\n      if (this.$bsContainer) {\r\n        this.$bsContainer.remove();\r\n      } else {\r\n        this.$menu.remove();\r\n      }\r\n\r\n      this.$element\r\n        .off('.bs.select')\r\n        .removeData('selectpicker')\r\n        .removeClass('bs-select-hidden selectpicker');\r\n    }\r\n  };\r\n\r\n  // SELECTPICKER PLUGIN DEFINITION\r\n  // ==============================\r\n  function Plugin(option, event) {\r\n    // get the args of the outer function..\r\n    var args = arguments;\r\n    // The arguments of the function are explicitly re-defined from the argument list, because the shift causes them\r\n    // to get lost/corrupted in android 2.3 and IE9 #715 #775\r\n    var _option = option,\r\n        _event = event;\r\n    [].shift.apply(args);\r\n\r\n    var value;\r\n    var chain = this.each(function () {\r\n      var $this = $(this);\r\n      if ($this.is('select')) {\r\n        var data = $this.data('selectpicker'),\r\n            options = typeof _option == 'object' && _option;\r\n\r\n        if (!data) {\r\n          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\r\n          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), $this.data().template, options.template);\r\n          $this.data('selectpicker', (data = new Selectpicker(this, config, _event)));\r\n        } else if (options) {\r\n          for (var i in options) {\r\n            if (options.hasOwnProperty(i)) {\r\n              data.options[i] = options[i];\r\n            }\r\n          }\r\n        }\r\n\r\n        if (typeof _option == 'string') {\r\n          if (data[_option] instanceof Function) {\r\n            value = data[_option].apply(data, args);\r\n          } else {\r\n            value = data.options[_option];\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    if (typeof value !== 'undefined') {\r\n      //noinspection JSUnusedAssignment\r\n      return value;\r\n    } else {\r\n      return chain;\r\n    }\r\n  }\r\n\r\n  var old = $.fn.selectpicker;\r\n  $.fn.selectpicker = Plugin;\r\n  $.fn.selectpicker.Constructor = Selectpicker;\r\n\r\n  // SELECTPICKER NO CONFLICT\r\n  // ========================\r\n  $.fn.selectpicker.noConflict = function () {\r\n    $.fn.selectpicker = old;\r\n    return this;\r\n  };\r\n\r\n  $(document)\r\n      .data('keycount', 0)\r\n      .on('keydown.bs.select', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=\"listbox\"], .bs-searchbox input', Selectpicker.prototype.keydown)\r\n      .on('focusin.modal', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=\"listbox\"], .bs-searchbox input', function (e) {\r\n        e.stopPropagation();\r\n      });\r\n\r\n  // SELECTPICKER DATA-API\r\n  // =====================\r\n  $(window).on('load.bs.select.data-api', function () {\r\n    $('.selectpicker').each(function () {\r\n      var $selectpicker = $(this);\r\n      Plugin.call($selectpicker, $selectpicker.data());\r\n    })\r\n  });\r\n})(jQuery);\r\n\n\n}));\n"

/***/ },

/***/ 85:
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var WPAttachmentFormInput_1 = __webpack_require__(86);
	jQuery(document).ready(function () {
	    jQuery(".wpattachmentforminput").each(function () {
	        new WPAttachmentFormInput_1.WPAttachmentFormInput(jQuery(this), jQuery(this).data());
	    });
	    //	jQuery( ".wpattachmentforminput .btn-remove" ).click( function ( e )
	    //	{
	    //		e.preventDefault();
	    //		var $el = $( this );
	    //		$el.closest( ".list-group-item" ).remove();
	    //
	    //		new WPAttachmentFormInput( $( $( this ).data( "target" ) ), "render" );
	    //	} );
	    //	jQuery( ".wpattachmentforminput .btn-add" ).click( function ( e )
	    //	{
	    //		new WPAttachmentFormInput( $( $( this ).data( "target" ) ), "open" );
	    //	} );
	});


/***/ },

/***/ 86:
/***/ function(module, exports) {

	"use strict";
	var WPAttachmentFormInput = (function () {
	    function WPAttachmentFormInput($el, options) {
	        var _this = this;
	        this.options = {
	            max: -1,
	            title: "",
	            buttonText: "",
	            type: null,
	            frame: "select"
	        };
	        this.$el = $el;
	        // Model
	        this.options = jQuery.extend({}, this.options, options);
	        // View
	        this.template = _.template(this.$el.find("textarea.underscore-template").val());
	        this.wpMedia = wp.media({
	            title: this.options.title,
	            multiple: this.options.max < 0 || this.options.max > 1 ? true : false,
	            library: this.options.type ? { type: this.options.type } : undefined,
	            button: { text: this.options.buttonText },
	            frame: this.options.frame
	        });
	        // Controller
	        this.wpMedia.on("select", function () { return _this.onWPMediaSelect(); });
	        this.$el.on("click", ".btn-add", function () { return _this.open(); });
	        this.$el.on("click", ".btn-remove", function (e) { return _this.onRemoveClick(e); });
	        this.render();
	    }
	    WPAttachmentFormInput.prototype.render = function () {
	        if (this.count >= this.options.max && this.options.max >= 0)
	            this.$el.find(".btn-add").prop("disabled", "disabled");
	        else
	            this.$el.find(".btn-add").prop("disabled", null);
	    };
	    WPAttachmentFormInput.prototype.open = function () {
	        this.wpMedia.open();
	    };
	    ;
	    WPAttachmentFormInput.prototype.add = function (attachmentModel) {
	        var __this = this;
	        attachmentModel.src = attachmentModel.icon;
	        if (!attachmentModel.width)
	            attachmentModel.width = "";
	        if (!attachmentModel.height)
	            attachmentModel.height = "";
	        if (attachmentModel.sizes) {
	            if (attachmentModel.sizes.thumbnail && attachmentModel.sizes.thumbnail.url) {
	                attachmentModel.src = attachmentModel.sizes.thumbnail.url;
	            }
	            else if (attachmentModel.sizes.full && attachmentModel.sizes.full.url) {
	                attachmentModel.src = attachmentModel.sizes.full.url;
	            }
	        }
	        var $el = jQuery(this.template(attachmentModel));
	        this.$el.find(".list-group").append($el);
	    };
	    ;
	    Object.defineProperty(WPAttachmentFormInput.prototype, "count", {
	        /* SET AND GET */
	        get: function () {
	            return this.$el.find(".list-group-item").length;
	        },
	        enumerable: true,
	        configurable: true
	    });
	    /* EVENT HANDLERS */
	    WPAttachmentFormInput.prototype.onWPMediaSelect = function () {
	        var selection = this.wpMedia.state().get('selection');
	        var __this = this;
	        selection.each(function (attachment) {
	            if (__this.options.max < 0 || __this.count < __this.options.max) {
	                __this.add(attachment.toJSON());
	            }
	        });
	        this.render();
	    };
	    ;
	    WPAttachmentFormInput.prototype.onRemoveClick = function (e) {
	        e.preventDefault();
	        var $el = jQuery(e.currentTarget);
	        $el.closest(".list-group-item").remove();
	        this.render();
	    };
	    return WPAttachmentFormInput;
	}());
	exports.WPAttachmentFormInput = WPAttachmentFormInput;


/***/ }

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgN2I0MDJjZGM2YmM0M2EyY2YyMGIiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzYy90dXRvbXZjLnRzIiwid2VicGFjazovLy8uL3NyYy9sZXNzL3R1dG9tdmMubGVzcyIsIndlYnBhY2s6Ly8vLi9+L3NlbGVjdDIvZGlzdC9qcy9zZWxlY3QyLmpzPzQ4NWYiLCJ3ZWJwYWNrOi8vLy4vfi9zY3JpcHQtbG9hZGVyL2FkZFNjcmlwdC5qcyIsIndlYnBhY2s6Ly8vLi9+L3NlbGVjdDIvZGlzdC9qcy9zZWxlY3QyLmpzIiwid2VicGFjazovLy8uL34vYm9vdHN0cmFwL2Rpc3QvanMvYm9vdHN0cmFwLmpzPzM4YWIiLCJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAvZGlzdC9qcy9ib290c3RyYXAuanMiLCJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAtc2VsZWN0L2Rpc3QvanMvYm9vdHN0cmFwLXNlbGVjdC5qcz9jMThiIiwid2VicGFjazovLy8uL34vYm9vdHN0cmFwLXNlbGVjdC9kaXN0L2pzL2Jvb3RzdHJhcC1zZWxlY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzYy9wbHVnaW5zL2pRdWVyeVdQQXR0YWNobWVudEZvcm1JbnB1dC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdHNjL3dwL2Zvcm0vaW5wdXRzL1dQQXR0YWNobWVudEZvcm1JbnB1dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN0Q0EscUJBQU8sRUFBc0IsQ0FBQztBQUM5QixxQkFBTyxFQUFtQyxDQUFDO0FBQzNDLHFCQUFPLEVBQXVD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cyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgN2I0MDJjZGM2YmM0M2EyY2YyMGJcbiAqKi8iLCJpbXBvcnQgXCIuLi9sZXNzL3R1dG9tdmMubGVzc1wiO1xuaW1wb3J0IFwic2NyaXB0IXNlbGVjdDIvZGlzdC9qcy9zZWxlY3QyLmpzXCI7XG5pbXBvcnQgXCJzY3JpcHQhYm9vdHN0cmFwL2Rpc3QvanMvYm9vdHN0cmFwLmpzXCI7XG5pbXBvcnQgXCJzY3JpcHQhYm9vdHN0cmFwLXNlbGVjdC9kaXN0L2pzL2Jvb3RzdHJhcC1zZWxlY3QuanNcIjtcbmltcG9ydCBcIi4vcGx1Z2lucy9qUXVlcnlXUEF0dGFjaG1lbnRGb3JtSW5wdXRcIjtcblxuXG4oZnVuY3Rpb24oICQgKVxue1xuXHQkKCBkb2N1bWVudCApLnJlYWR5KCBmdW5jdGlvbigpXG5cdHtcblx0XHQvLyBTZWxlY3QyRm9ybUlucHV0XG5cdFx0JCggXCIuZm9ybS1pbnB1dC1lbGVtZW50LnNlbGVjdDJcIiApLmVhY2goIGZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHQkKCB0aGlzICkuc2VsZWN0MiggJCggdGhpcyApLmRhdGEoKSApO1xuXHRcdH0gKTtcblx0fSApO1xufSkoIGpRdWVyeSApO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3RzYy90dXRvbXZjLnRzXG4gKiovIiwiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2xlc3MvdHV0b212Yy5sZXNzXG4gKiogbW9kdWxlIGlkID0gNzFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoXCIhIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvc2NyaXB0LWxvYWRlci9hZGRTY3JpcHQuanNcIikocmVxdWlyZShcIiEhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9yYXctbG9hZGVyL2luZGV4LmpzIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvc291cmNlLW1hcC1sb2FkZXIvaW5kZXguanMhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9zZWxlY3QyL2Rpc3QvanMvc2VsZWN0Mi5qc1wiKStcIlxcblxcbi8vIFNDUklQVC1MT0FERVIgRk9PVEVSXFxuLy8jIHNvdXJjZVVSTD1zY3JpcHQ6Ly8vVXNlcnMvam9oYW5uZXNidXZuYXMvRGV2ZWxvcG1lbnQvUEhQL3R1dG9tdmMvbm9kZV9tb2R1bGVzL3NvdXJjZS1tYXAtbG9hZGVyL2luZGV4LmpzIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvc2VsZWN0Mi9kaXN0L2pzL3NlbGVjdDIuanNcIilcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9zY3JpcHQtbG9hZGVyIS4vfi9zZWxlY3QyL2Rpc3QvanMvc2VsZWN0Mi5qc1xuICoqIG1vZHVsZSBpZCA9IDc4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKlxyXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG4qL1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHNyYykge1xyXG5cdGlmICh0eXBlb2YgZXhlY1NjcmlwdCAhPT0gXCJ1bmRlZmluZWRcIilcclxuXHRcdGV4ZWNTY3JpcHQoc3JjKTtcclxuXHRlbHNlXHJcblx0XHRldmFsLmNhbGwobnVsbCwgc3JjKTtcclxufVxyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9zY3JpcHQtbG9hZGVyL2FkZFNjcmlwdC5qc1xuICoqIG1vZHVsZSBpZCA9IDc5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiLyohXFxyXFxuICogU2VsZWN0MiA0LjAuM1xcclxcbiAqIGh0dHBzOi8vc2VsZWN0Mi5naXRodWIuaW9cXHJcXG4gKlxcclxcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxcclxcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zZWxlY3QyL3NlbGVjdDIvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZFxcclxcbiAqL1xcclxcbihmdW5jdGlvbiAoZmFjdG9yeSkge1xcclxcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xcclxcbiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXFxyXFxuICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcXHJcXG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XFxyXFxuICAgIC8vIE5vZGUvQ29tbW9uSlNcXHJcXG4gICAgZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7XFxyXFxuICB9IGVsc2Uge1xcclxcbiAgICAvLyBCcm93c2VyIGdsb2JhbHNcXHJcXG4gICAgZmFjdG9yeShqUXVlcnkpO1xcclxcbiAgfVxcclxcbn0oZnVuY3Rpb24gKGpRdWVyeSkge1xcclxcbiAgLy8gVGhpcyBpcyBuZWVkZWQgc28gd2UgY2FuIGNhdGNoIHRoZSBBTUQgbG9hZGVyIGNvbmZpZ3VyYXRpb24gYW5kIHVzZSBpdFxcclxcbiAgLy8gVGhlIGlubmVyIGZpbGUgc2hvdWxkIGJlIHdyYXBwZWQgKGJ5IGBiYW5uZXIuc3RhcnQuanNgKSBpbiBhIGZ1bmN0aW9uIHRoYXRcXHJcXG4gIC8vIHJldHVybnMgdGhlIEFNRCBsb2FkZXIgcmVmZXJlbmNlcy5cXHJcXG4gIHZhciBTMiA9XFxyXFxuKGZ1bmN0aW9uICgpIHtcXHJcXG4gIC8vIFJlc3RvcmUgdGhlIFNlbGVjdDIgQU1EIGxvYWRlciBzbyBpdCBjYW4gYmUgdXNlZFxcclxcbiAgLy8gTmVlZGVkIG1vc3RseSBpbiB0aGUgbGFuZ3VhZ2UgZmlsZXMsIHdoZXJlIHRoZSBsb2FkZXIgaXMgbm90IGluc2VydGVkXFxyXFxuICBpZiAoalF1ZXJ5ICYmIGpRdWVyeS5mbiAmJiBqUXVlcnkuZm4uc2VsZWN0MiAmJiBqUXVlcnkuZm4uc2VsZWN0Mi5hbWQpIHtcXHJcXG4gICAgdmFyIFMyID0galF1ZXJ5LmZuLnNlbGVjdDIuYW1kO1xcclxcbiAgfVxcclxcbnZhciBTMjsoZnVuY3Rpb24gKCkgeyBpZiAoIVMyIHx8ICFTMi5yZXF1aXJlanMpIHtcXG5pZiAoIVMyKSB7IFMyID0ge307IH0gZWxzZSB7IHJlcXVpcmUgPSBTMjsgfVxcbi8qKlxcbiAqIEBsaWNlbnNlIGFsbW9uZCAwLjMuMSBDb3B5cmlnaHQgKGMpIDIwMTEtMjAxNCwgVGhlIERvam8gRm91bmRhdGlvbiBBbGwgUmlnaHRzIFJlc2VydmVkLlxcbiAqIEF2YWlsYWJsZSB2aWEgdGhlIE1JVCBvciBuZXcgQlNEIGxpY2Vuc2UuXFxuICogc2VlOiBodHRwOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL2FsbW9uZCBmb3IgZGV0YWlsc1xcbiAqL1xcbi8vR29pbmcgc2xvcHB5IHRvIGF2b2lkICd1c2Ugc3RyaWN0JyBzdHJpbmcgY29zdCwgYnV0IHN0cmljdCBwcmFjdGljZXMgc2hvdWxkXFxuLy9iZSBmb2xsb3dlZC5cXG4vKmpzbGludCBzbG9wcHk6IHRydWUgKi9cXG4vKmdsb2JhbCBzZXRUaW1lb3V0OiBmYWxzZSAqL1xcblxcbnZhciByZXF1aXJlanMsIHJlcXVpcmUsIGRlZmluZTtcXG4oZnVuY3Rpb24gKHVuZGVmKSB7XFxuICAgIHZhciBtYWluLCByZXEsIG1ha2VNYXAsIGhhbmRsZXJzLFxcbiAgICAgICAgZGVmaW5lZCA9IHt9LFxcbiAgICAgICAgd2FpdGluZyA9IHt9LFxcbiAgICAgICAgY29uZmlnID0ge30sXFxuICAgICAgICBkZWZpbmluZyA9IHt9LFxcbiAgICAgICAgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxcXG4gICAgICAgIGFwcyA9IFtdLnNsaWNlLFxcbiAgICAgICAganNTdWZmaXhSZWdFeHAgPSAvXFxcXC5qcyQvO1xcblxcbiAgICBmdW5jdGlvbiBoYXNQcm9wKG9iaiwgcHJvcCkge1xcbiAgICAgICAgcmV0dXJuIGhhc093bi5jYWxsKG9iaiwgcHJvcCk7XFxuICAgIH1cXG5cXG4gICAgLyoqXFxuICAgICAqIEdpdmVuIGEgcmVsYXRpdmUgbW9kdWxlIG5hbWUsIGxpa2UgLi9zb21ldGhpbmcsIG5vcm1hbGl6ZSBpdCB0b1xcbiAgICAgKiBhIHJlYWwgbmFtZSB0aGF0IGNhbiBiZSBtYXBwZWQgdG8gYSBwYXRoLlxcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSB0aGUgcmVsYXRpdmUgbmFtZVxcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gYmFzZU5hbWUgYSByZWFsIG5hbWUgdGhhdCB0aGUgbmFtZSBhcmcgaXMgcmVsYXRpdmVcXG4gICAgICogdG8uXFxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IG5vcm1hbGl6ZWQgbmFtZVxcbiAgICAgKi9cXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplKG5hbWUsIGJhc2VOYW1lKSB7XFxuICAgICAgICB2YXIgbmFtZVBhcnRzLCBuYW1lU2VnbWVudCwgbWFwVmFsdWUsIGZvdW5kTWFwLCBsYXN0SW5kZXgsXFxuICAgICAgICAgICAgZm91bmRJLCBmb3VuZFN0YXJNYXAsIHN0YXJJLCBpLCBqLCBwYXJ0LFxcbiAgICAgICAgICAgIGJhc2VQYXJ0cyA9IGJhc2VOYW1lICYmIGJhc2VOYW1lLnNwbGl0KFxcXCIvXFxcIiksXFxuICAgICAgICAgICAgbWFwID0gY29uZmlnLm1hcCxcXG4gICAgICAgICAgICBzdGFyTWFwID0gKG1hcCAmJiBtYXBbJyonXSkgfHwge307XFxuXFxuICAgICAgICAvL0FkanVzdCBhbnkgcmVsYXRpdmUgcGF0aHMuXFxuICAgICAgICBpZiAobmFtZSAmJiBuYW1lLmNoYXJBdCgwKSA9PT0gXFxcIi5cXFwiKSB7XFxuICAgICAgICAgICAgLy9JZiBoYXZlIGEgYmFzZSBuYW1lLCB0cnkgdG8gbm9ybWFsaXplIGFnYWluc3QgaXQsXFxuICAgICAgICAgICAgLy9vdGhlcndpc2UsIGFzc3VtZSBpdCBpcyBhIHRvcC1sZXZlbCByZXF1aXJlIHRoYXQgd2lsbFxcbiAgICAgICAgICAgIC8vYmUgcmVsYXRpdmUgdG8gYmFzZVVybCBpbiB0aGUgZW5kLlxcbiAgICAgICAgICAgIGlmIChiYXNlTmFtZSkge1xcbiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZS5zcGxpdCgnLycpO1xcbiAgICAgICAgICAgICAgICBsYXN0SW5kZXggPSBuYW1lLmxlbmd0aCAtIDE7XFxuXFxuICAgICAgICAgICAgICAgIC8vIE5vZGUgLmpzIGFsbG93YW5jZTpcXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5ub2RlSWRDb21wYXQgJiYganNTdWZmaXhSZWdFeHAudGVzdChuYW1lW2xhc3RJbmRleF0pKSB7XFxuICAgICAgICAgICAgICAgICAgICBuYW1lW2xhc3RJbmRleF0gPSBuYW1lW2xhc3RJbmRleF0ucmVwbGFjZShqc1N1ZmZpeFJlZ0V4cCwgJycpO1xcbiAgICAgICAgICAgICAgICB9XFxuXFxuICAgICAgICAgICAgICAgIC8vTG9wIG9mZiB0aGUgbGFzdCBwYXJ0IG9mIGJhc2VQYXJ0cywgc28gdGhhdCAuIG1hdGNoZXMgdGhlXFxuICAgICAgICAgICAgICAgIC8vXFxcImRpcmVjdG9yeVxcXCIgYW5kIG5vdCBuYW1lIG9mIHRoZSBiYXNlTmFtZSdzIG1vZHVsZS4gRm9yIGluc3RhbmNlLFxcbiAgICAgICAgICAgICAgICAvL2Jhc2VOYW1lIG9mIFxcXCJvbmUvdHdvL3RocmVlXFxcIiwgbWFwcyB0byBcXFwib25lL3R3by90aHJlZS5qc1xcXCIsIGJ1dCB3ZVxcbiAgICAgICAgICAgICAgICAvL3dhbnQgdGhlIGRpcmVjdG9yeSwgXFxcIm9uZS90d29cXFwiIGZvciB0aGlzIG5vcm1hbGl6YXRpb24uXFxuICAgICAgICAgICAgICAgIG5hbWUgPSBiYXNlUGFydHMuc2xpY2UoMCwgYmFzZVBhcnRzLmxlbmd0aCAtIDEpLmNvbmNhdChuYW1lKTtcXG5cXG4gICAgICAgICAgICAgICAgLy9zdGFydCB0cmltRG90c1xcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbmFtZS5sZW5ndGg7IGkgKz0gMSkge1xcbiAgICAgICAgICAgICAgICAgICAgcGFydCA9IG5hbWVbaV07XFxuICAgICAgICAgICAgICAgICAgICBpZiAocGFydCA9PT0gXFxcIi5cXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZS5zcGxpY2UoaSwgMSk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgaSAtPSAxO1xcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0ID09PSBcXFwiLi5cXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDEgJiYgKG5hbWVbMl0gPT09ICcuLicgfHwgbmFtZVswXSA9PT0gJy4uJykpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9FbmQgb2YgdGhlIGxpbmUuIEtlZXAgYXQgbGVhc3Qgb25lIG5vbi1kb3RcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wYXRoIHNlZ21lbnQgYXQgdGhlIGZyb250IHNvIGl0IGNhbiBiZSBtYXBwZWRcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb3JyZWN0bHkgdG8gZGlzay4gT3RoZXJ3aXNlLCB0aGVyZSBpcyBsaWtlbHlcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9ubyBwYXRoIG1hcHBpbmcgZm9yIGEgcGF0aCBzdGFydGluZyB3aXRoICcuLicuXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVGhpcyBjYW4gc3RpbGwgZmFpbCwgYnV0IGNhdGNoZXMgdGhlIG1vc3QgcmVhc29uYWJsZVxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VzZXMgb2YgLi5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID4gMCkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLnNwbGljZShpIC0gMSwgMik7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgLT0gMjtcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgLy9lbmQgdHJpbURvdHNcXG5cXG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuam9pbihcXFwiL1xcXCIpO1xcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZS5pbmRleE9mKCcuLycpID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIC8vIE5vIGJhc2VOYW1lLCBzbyB0aGlzIGlzIElEIGlzIHJlc29sdmVkIHJlbGF0aXZlXFxuICAgICAgICAgICAgICAgIC8vIHRvIGJhc2VVcmwsIHB1bGwgb2ZmIHRoZSBsZWFkaW5nIGRvdC5cXG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDIpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG5cXG4gICAgICAgIC8vQXBwbHkgbWFwIGNvbmZpZyBpZiBhdmFpbGFibGUuXFxuICAgICAgICBpZiAoKGJhc2VQYXJ0cyB8fCBzdGFyTWFwKSAmJiBtYXApIHtcXG4gICAgICAgICAgICBuYW1lUGFydHMgPSBuYW1lLnNwbGl0KCcvJyk7XFxuXFxuICAgICAgICAgICAgZm9yIChpID0gbmFtZVBhcnRzLmxlbmd0aDsgaSA+IDA7IGkgLT0gMSkge1xcbiAgICAgICAgICAgICAgICBuYW1lU2VnbWVudCA9IG5hbWVQYXJ0cy5zbGljZSgwLCBpKS5qb2luKFxcXCIvXFxcIik7XFxuXFxuICAgICAgICAgICAgICAgIGlmIChiYXNlUGFydHMpIHtcXG4gICAgICAgICAgICAgICAgICAgIC8vRmluZCB0aGUgbG9uZ2VzdCBiYXNlTmFtZSBzZWdtZW50IG1hdGNoIGluIHRoZSBjb25maWcuXFxuICAgICAgICAgICAgICAgICAgICAvL1NvLCBkbyBqb2lucyBvbiB0aGUgYmlnZ2VzdCB0byBzbWFsbGVzdCBsZW5ndGhzIG9mIGJhc2VQYXJ0cy5cXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IGJhc2VQYXJ0cy5sZW5ndGg7IGogPiAwOyBqIC09IDEpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBWYWx1ZSA9IG1hcFtiYXNlUGFydHMuc2xpY2UoMCwgaikuam9pbignLycpXTtcXG5cXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Jhc2VOYW1lIHNlZ21lbnQgaGFzICBjb25maWcsIGZpbmQgaWYgaXQgaGFzIG9uZSBmb3JcXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMgbmFtZS5cXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwVmFsdWUpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVmFsdWUgPSBtYXBWYWx1ZVtuYW1lU2VnbWVudF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXBWYWx1ZSkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9NYXRjaCwgdXBkYXRlIG5hbWUgdG8gdGhlIG5ldyB2YWx1ZS5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kTWFwID0gbWFwVmFsdWU7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZEkgPSBpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1cXG5cXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kTWFwKSB7XFxuICAgICAgICAgICAgICAgICAgICBicmVhaztcXG4gICAgICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgICAgICAvL0NoZWNrIGZvciBhIHN0YXIgbWFwIG1hdGNoLCBidXQganVzdCBob2xkIG9uIHRvIGl0LFxcbiAgICAgICAgICAgICAgICAvL2lmIHRoZXJlIGlzIGEgc2hvcnRlciBzZWdtZW50IG1hdGNoIGxhdGVyIGluIGEgbWF0Y2hpbmdcXG4gICAgICAgICAgICAgICAgLy9jb25maWcsIHRoZW4gZmF2b3Igb3ZlciB0aGlzIHN0YXIgbWFwLlxcbiAgICAgICAgICAgICAgICBpZiAoIWZvdW5kU3Rhck1hcCAmJiBzdGFyTWFwICYmIHN0YXJNYXBbbmFtZVNlZ21lbnRdKSB7XFxuICAgICAgICAgICAgICAgICAgICBmb3VuZFN0YXJNYXAgPSBzdGFyTWFwW25hbWVTZWdtZW50XTtcXG4gICAgICAgICAgICAgICAgICAgIHN0YXJJID0gaTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH1cXG5cXG4gICAgICAgICAgICBpZiAoIWZvdW5kTWFwICYmIGZvdW5kU3Rhck1hcCkge1xcbiAgICAgICAgICAgICAgICBmb3VuZE1hcCA9IGZvdW5kU3Rhck1hcDtcXG4gICAgICAgICAgICAgICAgZm91bmRJID0gc3Rhckk7XFxuICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgIGlmIChmb3VuZE1hcCkge1xcbiAgICAgICAgICAgICAgICBuYW1lUGFydHMuc3BsaWNlKDAsIGZvdW5kSSwgZm91bmRNYXApO1xcbiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZVBhcnRzLmpvaW4oJy8nKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuXFxuICAgICAgICByZXR1cm4gbmFtZTtcXG4gICAgfVxcblxcbiAgICBmdW5jdGlvbiBtYWtlUmVxdWlyZShyZWxOYW1lLCBmb3JjZVN5bmMpIHtcXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XFxuICAgICAgICAgICAgLy9BIHZlcnNpb24gb2YgYSByZXF1aXJlIGZ1bmN0aW9uIHRoYXQgcGFzc2VzIGEgbW9kdWxlTmFtZVxcbiAgICAgICAgICAgIC8vdmFsdWUgZm9yIGl0ZW1zIHRoYXQgbWF5IG5lZWQgdG9cXG4gICAgICAgICAgICAvL2xvb2sgdXAgcGF0aHMgcmVsYXRpdmUgdG8gdGhlIG1vZHVsZU5hbWVcXG4gICAgICAgICAgICB2YXIgYXJncyA9IGFwcy5jYWxsKGFyZ3VtZW50cywgMCk7XFxuXFxuICAgICAgICAgICAgLy9JZiBmaXJzdCBhcmcgaXMgbm90IHJlcXVpcmUoJ3N0cmluZycpLCBhbmQgdGhlcmUgaXMgb25seVxcbiAgICAgICAgICAgIC8vb25lIGFyZywgaXQgaXMgdGhlIGFycmF5IGZvcm0gd2l0aG91dCBhIGNhbGxiYWNrLiBJbnNlcnRcXG4gICAgICAgICAgICAvL2EgbnVsbCBzbyB0aGF0IHRoZSBmb2xsb3dpbmcgY29uY2F0IGlzIGNvcnJlY3QuXFxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdICE9PSAnc3RyaW5nJyAmJiBhcmdzLmxlbmd0aCA9PT0gMSkge1xcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2gobnVsbCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIHJldHVybiByZXEuYXBwbHkodW5kZWYsIGFyZ3MuY29uY2F0KFtyZWxOYW1lLCBmb3JjZVN5bmNdKSk7XFxuICAgICAgICB9O1xcbiAgICB9XFxuXFxuICAgIGZ1bmN0aW9uIG1ha2VOb3JtYWxpemUocmVsTmFtZSkge1xcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChuYW1lKSB7XFxuICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShuYW1lLCByZWxOYW1lKTtcXG4gICAgICAgIH07XFxuICAgIH1cXG5cXG4gICAgZnVuY3Rpb24gbWFrZUxvYWQoZGVwTmFtZSkge1xcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xcbiAgICAgICAgICAgIGRlZmluZWRbZGVwTmFtZV0gPSB2YWx1ZTtcXG4gICAgICAgIH07XFxuICAgIH1cXG5cXG4gICAgZnVuY3Rpb24gY2FsbERlcChuYW1lKSB7XFxuICAgICAgICBpZiAoaGFzUHJvcCh3YWl0aW5nLCBuYW1lKSkge1xcbiAgICAgICAgICAgIHZhciBhcmdzID0gd2FpdGluZ1tuYW1lXTtcXG4gICAgICAgICAgICBkZWxldGUgd2FpdGluZ1tuYW1lXTtcXG4gICAgICAgICAgICBkZWZpbmluZ1tuYW1lXSA9IHRydWU7XFxuICAgICAgICAgICAgbWFpbi5hcHBseSh1bmRlZiwgYXJncyk7XFxuICAgICAgICB9XFxuXFxuICAgICAgICBpZiAoIWhhc1Byb3AoZGVmaW5lZCwgbmFtZSkgJiYgIWhhc1Byb3AoZGVmaW5pbmcsIG5hbWUpKSB7XFxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyAnICsgbmFtZSk7XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gZGVmaW5lZFtuYW1lXTtcXG4gICAgfVxcblxcbiAgICAvL1R1cm5zIGEgcGx1Z2luIXJlc291cmNlIHRvIFtwbHVnaW4sIHJlc291cmNlXVxcbiAgICAvL3dpdGggdGhlIHBsdWdpbiBiZWluZyB1bmRlZmluZWQgaWYgdGhlIG5hbWVcXG4gICAgLy9kaWQgbm90IGhhdmUgYSBwbHVnaW4gcHJlZml4LlxcbiAgICBmdW5jdGlvbiBzcGxpdFByZWZpeChuYW1lKSB7XFxuICAgICAgICB2YXIgcHJlZml4LFxcbiAgICAgICAgICAgIGluZGV4ID0gbmFtZSA/IG5hbWUuaW5kZXhPZignIScpIDogLTE7XFxuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xcbiAgICAgICAgICAgIHByZWZpeCA9IG5hbWUuc3Vic3RyaW5nKDAsIGluZGV4KTtcXG4gICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoaW5kZXggKyAxLCBuYW1lLmxlbmd0aCk7XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gW3ByZWZpeCwgbmFtZV07XFxuICAgIH1cXG5cXG4gICAgLyoqXFxuICAgICAqIE1ha2VzIGEgbmFtZSBtYXAsIG5vcm1hbGl6aW5nIHRoZSBuYW1lLCBhbmQgdXNpbmcgYSBwbHVnaW5cXG4gICAgICogZm9yIG5vcm1hbGl6YXRpb24gaWYgbmVjZXNzYXJ5LiBHcmFicyBhIHJlZiB0byBwbHVnaW5cXG4gICAgICogdG9vLCBhcyBhbiBvcHRpbWl6YXRpb24uXFxuICAgICAqL1xcbiAgICBtYWtlTWFwID0gZnVuY3Rpb24gKG5hbWUsIHJlbE5hbWUpIHtcXG4gICAgICAgIHZhciBwbHVnaW4sXFxuICAgICAgICAgICAgcGFydHMgPSBzcGxpdFByZWZpeChuYW1lKSxcXG4gICAgICAgICAgICBwcmVmaXggPSBwYXJ0c1swXTtcXG5cXG4gICAgICAgIG5hbWUgPSBwYXJ0c1sxXTtcXG5cXG4gICAgICAgIGlmIChwcmVmaXgpIHtcXG4gICAgICAgICAgICBwcmVmaXggPSBub3JtYWxpemUocHJlZml4LCByZWxOYW1lKTtcXG4gICAgICAgICAgICBwbHVnaW4gPSBjYWxsRGVwKHByZWZpeCk7XFxuICAgICAgICB9XFxuXFxuICAgICAgICAvL05vcm1hbGl6ZSBhY2NvcmRpbmdcXG4gICAgICAgIGlmIChwcmVmaXgpIHtcXG4gICAgICAgICAgICBpZiAocGx1Z2luICYmIHBsdWdpbi5ub3JtYWxpemUpIHtcXG4gICAgICAgICAgICAgICAgbmFtZSA9IHBsdWdpbi5ub3JtYWxpemUobmFtZSwgbWFrZU5vcm1hbGl6ZShyZWxOYW1lKSk7XFxuICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZShuYW1lLCByZWxOYW1lKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgIG5hbWUgPSBub3JtYWxpemUobmFtZSwgcmVsTmFtZSk7XFxuICAgICAgICAgICAgcGFydHMgPSBzcGxpdFByZWZpeChuYW1lKTtcXG4gICAgICAgICAgICBwcmVmaXggPSBwYXJ0c1swXTtcXG4gICAgICAgICAgICBuYW1lID0gcGFydHNbMV07XFxuICAgICAgICAgICAgaWYgKHByZWZpeCkge1xcbiAgICAgICAgICAgICAgICBwbHVnaW4gPSBjYWxsRGVwKHByZWZpeCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcblxcbiAgICAgICAgLy9Vc2luZyByaWRpY3Vsb3VzIHByb3BlcnR5IG5hbWVzIGZvciBzcGFjZSByZWFzb25zXFxuICAgICAgICByZXR1cm4ge1xcbiAgICAgICAgICAgIGY6IHByZWZpeCA/IHByZWZpeCArICchJyArIG5hbWUgOiBuYW1lLCAvL2Z1bGxOYW1lXFxuICAgICAgICAgICAgbjogbmFtZSxcXG4gICAgICAgICAgICBwcjogcHJlZml4LFxcbiAgICAgICAgICAgIHA6IHBsdWdpblxcbiAgICAgICAgfTtcXG4gICAgfTtcXG5cXG4gICAgZnVuY3Rpb24gbWFrZUNvbmZpZyhuYW1lKSB7XFxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xcbiAgICAgICAgICAgIHJldHVybiAoY29uZmlnICYmIGNvbmZpZy5jb25maWcgJiYgY29uZmlnLmNvbmZpZ1tuYW1lXSkgfHwge307XFxuICAgICAgICB9O1xcbiAgICB9XFxuXFxuICAgIGhhbmRsZXJzID0ge1xcbiAgICAgICAgcmVxdWlyZTogZnVuY3Rpb24gKG5hbWUpIHtcXG4gICAgICAgICAgICByZXR1cm4gbWFrZVJlcXVpcmUobmFtZSk7XFxuICAgICAgICB9LFxcbiAgICAgICAgZXhwb3J0czogZnVuY3Rpb24gKG5hbWUpIHtcXG4gICAgICAgICAgICB2YXIgZSA9IGRlZmluZWRbbmFtZV07XFxuICAgICAgICAgICAgaWYgKHR5cGVvZiBlICE9PSAndW5kZWZpbmVkJykge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gZTtcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gKGRlZmluZWRbbmFtZV0gPSB7fSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSxcXG4gICAgICAgIG1vZHVsZTogZnVuY3Rpb24gKG5hbWUpIHtcXG4gICAgICAgICAgICByZXR1cm4ge1xcbiAgICAgICAgICAgICAgICBpZDogbmFtZSxcXG4gICAgICAgICAgICAgICAgdXJpOiAnJyxcXG4gICAgICAgICAgICAgICAgZXhwb3J0czogZGVmaW5lZFtuYW1lXSxcXG4gICAgICAgICAgICAgICAgY29uZmlnOiBtYWtlQ29uZmlnKG5hbWUpXFxuICAgICAgICAgICAgfTtcXG4gICAgICAgIH1cXG4gICAgfTtcXG5cXG4gICAgbWFpbiA9IGZ1bmN0aW9uIChuYW1lLCBkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSkge1xcbiAgICAgICAgdmFyIGNqc01vZHVsZSwgZGVwTmFtZSwgcmV0LCBtYXAsIGksXFxuICAgICAgICAgICAgYXJncyA9IFtdLFxcbiAgICAgICAgICAgIGNhbGxiYWNrVHlwZSA9IHR5cGVvZiBjYWxsYmFjayxcXG4gICAgICAgICAgICB1c2luZ0V4cG9ydHM7XFxuXFxuICAgICAgICAvL1VzZSBuYW1lIGlmIG5vIHJlbE5hbWVcXG4gICAgICAgIHJlbE5hbWUgPSByZWxOYW1lIHx8IG5hbWU7XFxuXFxuICAgICAgICAvL0NhbGwgdGhlIGNhbGxiYWNrIHRvIGRlZmluZSB0aGUgbW9kdWxlLCBpZiBuZWNlc3NhcnkuXFxuICAgICAgICBpZiAoY2FsbGJhY2tUeXBlID09PSAndW5kZWZpbmVkJyB8fCBjYWxsYmFja1R5cGUgPT09ICdmdW5jdGlvbicpIHtcXG4gICAgICAgICAgICAvL1B1bGwgb3V0IHRoZSBkZWZpbmVkIGRlcGVuZGVuY2llcyBhbmQgcGFzcyB0aGUgb3JkZXJlZFxcbiAgICAgICAgICAgIC8vdmFsdWVzIHRvIHRoZSBjYWxsYmFjay5cXG4gICAgICAgICAgICAvL0RlZmF1bHQgdG8gW3JlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZV0gaWYgbm8gZGVwc1xcbiAgICAgICAgICAgIGRlcHMgPSAhZGVwcy5sZW5ndGggJiYgY2FsbGJhY2subGVuZ3RoID8gWydyZXF1aXJlJywgJ2V4cG9ydHMnLCAnbW9kdWxlJ10gOiBkZXBzO1xcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBkZXBzLmxlbmd0aDsgaSArPSAxKSB7XFxuICAgICAgICAgICAgICAgIG1hcCA9IG1ha2VNYXAoZGVwc1tpXSwgcmVsTmFtZSk7XFxuICAgICAgICAgICAgICAgIGRlcE5hbWUgPSBtYXAuZjtcXG5cXG4gICAgICAgICAgICAgICAgLy9GYXN0IHBhdGggQ29tbW9uSlMgc3RhbmRhcmQgZGVwZW5kZW5jaWVzLlxcbiAgICAgICAgICAgICAgICBpZiAoZGVwTmFtZSA9PT0gXFxcInJlcXVpcmVcXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gaGFuZGxlcnMucmVxdWlyZShuYW1lKTtcXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZXBOYW1lID09PSBcXFwiZXhwb3J0c1xcXCIpIHtcXG4gICAgICAgICAgICAgICAgICAgIC8vQ29tbW9uSlMgbW9kdWxlIHNwZWMgMS4xXFxuICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gaGFuZGxlcnMuZXhwb3J0cyhuYW1lKTtcXG4gICAgICAgICAgICAgICAgICAgIHVzaW5nRXhwb3J0cyA9IHRydWU7XFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwTmFtZSA9PT0gXFxcIm1vZHVsZVxcXCIpIHtcXG4gICAgICAgICAgICAgICAgICAgIC8vQ29tbW9uSlMgbW9kdWxlIHNwZWMgMS4xXFxuICAgICAgICAgICAgICAgICAgICBjanNNb2R1bGUgPSBhcmdzW2ldID0gaGFuZGxlcnMubW9kdWxlKG5hbWUpO1xcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc1Byb3AoZGVmaW5lZCwgZGVwTmFtZSkgfHxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNQcm9wKHdhaXRpbmcsIGRlcE5hbWUpIHx8XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUHJvcChkZWZpbmluZywgZGVwTmFtZSkpIHtcXG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbaV0gPSBjYWxsRGVwKGRlcE5hbWUpO1xcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hcC5wKSB7XFxuICAgICAgICAgICAgICAgICAgICBtYXAucC5sb2FkKG1hcC5uLCBtYWtlUmVxdWlyZShyZWxOYW1lLCB0cnVlKSwgbWFrZUxvYWQoZGVwTmFtZSksIHt9KTtcXG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbaV0gPSBkZWZpbmVkW2RlcE5hbWVdO1xcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG5hbWUgKyAnIG1pc3NpbmcgJyArIGRlcE5hbWUpO1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgIHJldCA9IGNhbGxiYWNrID8gY2FsbGJhY2suYXBwbHkoZGVmaW5lZFtuYW1lXSwgYXJncykgOiB1bmRlZmluZWQ7XFxuXFxuICAgICAgICAgICAgaWYgKG5hbWUpIHtcXG4gICAgICAgICAgICAgICAgLy9JZiBzZXR0aW5nIGV4cG9ydHMgdmlhIFxcXCJtb2R1bGVcXFwiIGlzIGluIHBsYXksXFxuICAgICAgICAgICAgICAgIC8vZmF2b3IgdGhhdCBvdmVyIHJldHVybiB2YWx1ZSBhbmQgZXhwb3J0cy4gQWZ0ZXIgdGhhdCxcXG4gICAgICAgICAgICAgICAgLy9mYXZvciBhIG5vbi11bmRlZmluZWQgcmV0dXJuIHZhbHVlIG92ZXIgZXhwb3J0cyB1c2UuXFxuICAgICAgICAgICAgICAgIGlmIChjanNNb2R1bGUgJiYgY2pzTW9kdWxlLmV4cG9ydHMgIT09IHVuZGVmICYmXFxuICAgICAgICAgICAgICAgICAgICAgICAgY2pzTW9kdWxlLmV4cG9ydHMgIT09IGRlZmluZWRbbmFtZV0pIHtcXG4gICAgICAgICAgICAgICAgICAgIGRlZmluZWRbbmFtZV0gPSBjanNNb2R1bGUuZXhwb3J0cztcXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXQgIT09IHVuZGVmIHx8ICF1c2luZ0V4cG9ydHMpIHtcXG4gICAgICAgICAgICAgICAgICAgIC8vVXNlIHRoZSByZXR1cm4gdmFsdWUgZnJvbSB0aGUgZnVuY3Rpb24uXFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmVkW25hbWVdID0gcmV0O1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lKSB7XFxuICAgICAgICAgICAgLy9NYXkganVzdCBiZSBhbiBvYmplY3QgZGVmaW5pdGlvbiBmb3IgdGhlIG1vZHVsZS4gT25seVxcbiAgICAgICAgICAgIC8vd29ycnkgYWJvdXQgZGVmaW5pbmcgaWYgaGF2ZSBhIG1vZHVsZSBuYW1lLlxcbiAgICAgICAgICAgIGRlZmluZWRbbmFtZV0gPSBjYWxsYmFjaztcXG4gICAgICAgIH1cXG4gICAgfTtcXG5cXG4gICAgcmVxdWlyZWpzID0gcmVxdWlyZSA9IHJlcSA9IGZ1bmN0aW9uIChkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSwgZm9yY2VTeW5jLCBhbHQpIHtcXG4gICAgICAgIGlmICh0eXBlb2YgZGVwcyA9PT0gXFxcInN0cmluZ1xcXCIpIHtcXG4gICAgICAgICAgICBpZiAoaGFuZGxlcnNbZGVwc10pIHtcXG4gICAgICAgICAgICAgICAgLy9jYWxsYmFjayBpbiB0aGlzIGNhc2UgaXMgcmVhbGx5IHJlbE5hbWVcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJzW2RlcHNdKGNhbGxiYWNrKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLy9KdXN0IHJldHVybiB0aGUgbW9kdWxlIHdhbnRlZC4gSW4gdGhpcyBzY2VuYXJpbywgdGhlXFxuICAgICAgICAgICAgLy9kZXBzIGFyZyBpcyB0aGUgbW9kdWxlIG5hbWUsIGFuZCBzZWNvbmQgYXJnIChpZiBwYXNzZWQpXFxuICAgICAgICAgICAgLy9pcyBqdXN0IHRoZSByZWxOYW1lLlxcbiAgICAgICAgICAgIC8vTm9ybWFsaXplIG1vZHVsZSBuYW1lLCBpZiBpdCBjb250YWlucyAuIG9yIC4uXFxuICAgICAgICAgICAgcmV0dXJuIGNhbGxEZXAobWFrZU1hcChkZXBzLCBjYWxsYmFjaykuZik7XFxuICAgICAgICB9IGVsc2UgaWYgKCFkZXBzLnNwbGljZSkge1xcbiAgICAgICAgICAgIC8vZGVwcyBpcyBhIGNvbmZpZyBvYmplY3QsIG5vdCBhbiBhcnJheS5cXG4gICAgICAgICAgICBjb25maWcgPSBkZXBzO1xcbiAgICAgICAgICAgIGlmIChjb25maWcuZGVwcykge1xcbiAgICAgICAgICAgICAgICByZXEoY29uZmlnLmRlcHMsIGNvbmZpZy5jYWxsYmFjayk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmICghY2FsbGJhY2spIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xcbiAgICAgICAgICAgIH1cXG5cXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2suc3BsaWNlKSB7XFxuICAgICAgICAgICAgICAgIC8vY2FsbGJhY2sgaXMgYW4gYXJyYXksIHdoaWNoIG1lYW5zIGl0IGlzIGEgZGVwZW5kZW5jeSBsaXN0LlxcbiAgICAgICAgICAgICAgICAvL0FkanVzdCBhcmdzIGlmIHRoZXJlIGFyZSBkZXBlbmRlbmNpZXNcXG4gICAgICAgICAgICAgICAgZGVwcyA9IGNhbGxiYWNrO1xcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IHJlbE5hbWU7XFxuICAgICAgICAgICAgICAgIHJlbE5hbWUgPSBudWxsO1xcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIGRlcHMgPSB1bmRlZjtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuXFxuICAgICAgICAvL1N1cHBvcnQgcmVxdWlyZShbJ2EnXSlcXG4gICAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24gKCkge307XFxuXFxuICAgICAgICAvL0lmIHJlbE5hbWUgaXMgYSBmdW5jdGlvbiwgaXQgaXMgYW4gZXJyYmFjayBoYW5kbGVyLFxcbiAgICAgICAgLy9zbyByZW1vdmUgaXQuXFxuICAgICAgICBpZiAodHlwZW9mIHJlbE5hbWUgPT09ICdmdW5jdGlvbicpIHtcXG4gICAgICAgICAgICByZWxOYW1lID0gZm9yY2VTeW5jO1xcbiAgICAgICAgICAgIGZvcmNlU3luYyA9IGFsdDtcXG4gICAgICAgIH1cXG5cXG4gICAgICAgIC8vU2ltdWxhdGUgYXN5bmMgY2FsbGJhY2s7XFxuICAgICAgICBpZiAoZm9yY2VTeW5jKSB7XFxuICAgICAgICAgICAgbWFpbih1bmRlZiwgZGVwcywgY2FsbGJhY2ssIHJlbE5hbWUpO1xcbiAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAvL1VzaW5nIGEgbm9uLXplcm8gdmFsdWUgYmVjYXVzZSBvZiBjb25jZXJuIGZvciB3aGF0IG9sZCBicm93c2Vyc1xcbiAgICAgICAgICAgIC8vZG8sIGFuZCBsYXRlc3QgYnJvd3NlcnMgXFxcInVwZ3JhZGVcXFwiIHRvIDQgaWYgbG93ZXIgdmFsdWUgaXMgdXNlZDpcXG4gICAgICAgICAgICAvL2h0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL3RpbWVycy5odG1sI2RvbS13aW5kb3d0aW1lcnMtc2V0dGltZW91dDpcXG4gICAgICAgICAgICAvL0lmIHdhbnQgYSB2YWx1ZSBpbW1lZGlhdGVseSwgdXNlIHJlcXVpcmUoJ2lkJykgaW5zdGVhZCAtLSBzb21ldGhpbmdcXG4gICAgICAgICAgICAvL3RoYXQgd29ya3MgaW4gYWxtb25kIG9uIHRoZSBnbG9iYWwgbGV2ZWwsIGJ1dCBub3QgZ3VhcmFudGVlZCBhbmRcXG4gICAgICAgICAgICAvL3VubGlrZWx5IHRvIHdvcmsgaW4gb3RoZXIgQU1EIGltcGxlbWVudGF0aW9ucy5cXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcXG4gICAgICAgICAgICAgICAgbWFpbih1bmRlZiwgZGVwcywgY2FsbGJhY2ssIHJlbE5hbWUpO1xcbiAgICAgICAgICAgIH0sIDQpO1xcbiAgICAgICAgfVxcblxcbiAgICAgICAgcmV0dXJuIHJlcTtcXG4gICAgfTtcXG5cXG4gICAgLyoqXFxuICAgICAqIEp1c3QgZHJvcHMgdGhlIGNvbmZpZyBvbiB0aGUgZmxvb3IsIGJ1dCByZXR1cm5zIHJlcSBpbiBjYXNlXFxuICAgICAqIHRoZSBjb25maWcgcmV0dXJuIHZhbHVlIGlzIHVzZWQuXFxuICAgICAqL1xcbiAgICByZXEuY29uZmlnID0gZnVuY3Rpb24gKGNmZykge1xcbiAgICAgICAgcmV0dXJuIHJlcShjZmcpO1xcbiAgICB9O1xcblxcbiAgICAvKipcXG4gICAgICogRXhwb3NlIG1vZHVsZSByZWdpc3RyeSBmb3IgZGVidWdnaW5nIGFuZCB0b29saW5nXFxuICAgICAqL1xcbiAgICByZXF1aXJlanMuX2RlZmluZWQgPSBkZWZpbmVkO1xcblxcbiAgICBkZWZpbmUgPSBmdW5jdGlvbiAobmFtZSwgZGVwcywgY2FsbGJhY2spIHtcXG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlZSBhbG1vbmQgUkVBRE1FOiBpbmNvcnJlY3QgbW9kdWxlIGJ1aWxkLCBubyBtb2R1bGUgbmFtZScpO1xcbiAgICAgICAgfVxcblxcbiAgICAgICAgLy9UaGlzIG1vZHVsZSBtYXkgbm90IGhhdmUgZGVwZW5kZW5jaWVzXFxuICAgICAgICBpZiAoIWRlcHMuc3BsaWNlKSB7XFxuICAgICAgICAgICAgLy9kZXBzIGlzIG5vdCBhbiBhcnJheSwgc28gcHJvYmFibHkgbWVhbnNcXG4gICAgICAgICAgICAvL2FuIG9iamVjdCBsaXRlcmFsIG9yIGZhY3RvcnkgZnVuY3Rpb24gZm9yXFxuICAgICAgICAgICAgLy90aGUgdmFsdWUuIEFkanVzdCBhcmdzLlxcbiAgICAgICAgICAgIGNhbGxiYWNrID0gZGVwcztcXG4gICAgICAgICAgICBkZXBzID0gW107XFxuICAgICAgICB9XFxuXFxuICAgICAgICBpZiAoIWhhc1Byb3AoZGVmaW5lZCwgbmFtZSkgJiYgIWhhc1Byb3Aod2FpdGluZywgbmFtZSkpIHtcXG4gICAgICAgICAgICB3YWl0aW5nW25hbWVdID0gW25hbWUsIGRlcHMsIGNhbGxiYWNrXTtcXG4gICAgICAgIH1cXG4gICAgfTtcXG5cXG4gICAgZGVmaW5lLmFtZCA9IHtcXG4gICAgICAgIGpRdWVyeTogdHJ1ZVxcbiAgICB9O1xcbn0oKSk7XFxuXFxuUzIucmVxdWlyZWpzID0gcmVxdWlyZWpzO1MyLnJlcXVpcmUgPSByZXF1aXJlO1MyLmRlZmluZSA9IGRlZmluZTtcXG59XFxufSgpKTtcXG5TMi5kZWZpbmUoXFxcImFsbW9uZFxcXCIsIGZ1bmN0aW9uKCl7fSk7XFxuXFxuLyogZ2xvYmFsIGpRdWVyeTpmYWxzZSwgJDpmYWxzZSAqL1xcclxcblMyLmRlZmluZSgnanF1ZXJ5JyxbXSxmdW5jdGlvbiAoKSB7XFxyXFxuICB2YXIgXyQgPSBqUXVlcnkgfHwgJDtcXHJcXG5cXHJcXG4gIGlmIChfJCA9PSBudWxsICYmIGNvbnNvbGUgJiYgY29uc29sZS5lcnJvcikge1xcclxcbiAgICBjb25zb2xlLmVycm9yKFxcclxcbiAgICAgICdTZWxlY3QyOiBBbiBpbnN0YW5jZSBvZiBqUXVlcnkgb3IgYSBqUXVlcnktY29tcGF0aWJsZSBsaWJyYXJ5IHdhcyBub3QgJyArXFxyXFxuICAgICAgJ2ZvdW5kLiBNYWtlIHN1cmUgdGhhdCB5b3UgYXJlIGluY2x1ZGluZyBqUXVlcnkgYmVmb3JlIFNlbGVjdDIgb24geW91ciAnICtcXHJcXG4gICAgICAnd2ViIHBhZ2UuJ1xcclxcbiAgICApO1xcclxcbiAgfVxcclxcblxcclxcbiAgcmV0dXJuIF8kO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi91dGlscycsW1xcclxcbiAgJ2pxdWVyeSdcXHJcXG5dLCBmdW5jdGlvbiAoJCkge1xcclxcbiAgdmFyIFV0aWxzID0ge307XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQgPSBmdW5jdGlvbiAoQ2hpbGRDbGFzcywgU3VwZXJDbGFzcykge1xcclxcbiAgICB2YXIgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHk7XFxyXFxuXFxyXFxuICAgIGZ1bmN0aW9uIEJhc2VDb25zdHJ1Y3RvciAoKSB7XFxyXFxuICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IENoaWxkQ2xhc3M7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgZm9yICh2YXIga2V5IGluIFN1cGVyQ2xhc3MpIHtcXHJcXG4gICAgICBpZiAoX19oYXNQcm9wLmNhbGwoU3VwZXJDbGFzcywga2V5KSkge1xcclxcbiAgICAgICAgQ2hpbGRDbGFzc1trZXldID0gU3VwZXJDbGFzc1trZXldO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBCYXNlQ29uc3RydWN0b3IucHJvdG90eXBlID0gU3VwZXJDbGFzcy5wcm90b3R5cGU7XFxyXFxuICAgIENoaWxkQ2xhc3MucHJvdG90eXBlID0gbmV3IEJhc2VDb25zdHJ1Y3RvcigpO1xcclxcbiAgICBDaGlsZENsYXNzLl9fc3VwZXJfXyA9IFN1cGVyQ2xhc3MucHJvdG90eXBlO1xcclxcblxcclxcbiAgICByZXR1cm4gQ2hpbGRDbGFzcztcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBmdW5jdGlvbiBnZXRNZXRob2RzICh0aGVDbGFzcykge1xcclxcbiAgICB2YXIgcHJvdG8gPSB0aGVDbGFzcy5wcm90b3R5cGU7XFxyXFxuXFxyXFxuICAgIHZhciBtZXRob2RzID0gW107XFxyXFxuXFxyXFxuICAgIGZvciAodmFyIG1ldGhvZE5hbWUgaW4gcHJvdG8pIHtcXHJcXG4gICAgICB2YXIgbSA9IHByb3RvW21ldGhvZE5hbWVdO1xcclxcblxcclxcbiAgICAgIGlmICh0eXBlb2YgbSAhPT0gJ2Z1bmN0aW9uJykge1xcclxcbiAgICAgICAgY29udGludWU7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGlmIChtZXRob2ROYW1lID09PSAnY29uc3RydWN0b3InKSB7XFxyXFxuICAgICAgICBjb250aW51ZTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgbWV0aG9kcy5wdXNoKG1ldGhvZE5hbWUpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiBtZXRob2RzO1xcclxcbiAgfVxcclxcblxcclxcbiAgVXRpbHMuRGVjb3JhdGUgPSBmdW5jdGlvbiAoU3VwZXJDbGFzcywgRGVjb3JhdG9yQ2xhc3MpIHtcXHJcXG4gICAgdmFyIGRlY29yYXRlZE1ldGhvZHMgPSBnZXRNZXRob2RzKERlY29yYXRvckNsYXNzKTtcXHJcXG4gICAgdmFyIHN1cGVyTWV0aG9kcyA9IGdldE1ldGhvZHMoU3VwZXJDbGFzcyk7XFxyXFxuXFxyXFxuICAgIGZ1bmN0aW9uIERlY29yYXRlZENsYXNzICgpIHtcXHJcXG4gICAgICB2YXIgdW5zaGlmdCA9IEFycmF5LnByb3RvdHlwZS51bnNoaWZ0O1xcclxcblxcclxcbiAgICAgIHZhciBhcmdDb3VudCA9IERlY29yYXRvckNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5sZW5ndGg7XFxyXFxuXFxyXFxuICAgICAgdmFyIGNhbGxlZENvbnN0cnVjdG9yID0gU3VwZXJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3I7XFxyXFxuXFxyXFxuICAgICAgaWYgKGFyZ0NvdW50ID4gMCkge1xcclxcbiAgICAgICAgdW5zaGlmdC5jYWxsKGFyZ3VtZW50cywgU3VwZXJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IpO1xcclxcblxcclxcbiAgICAgICAgY2FsbGVkQ29uc3RydWN0b3IgPSBEZWNvcmF0b3JDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3I7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGNhbGxlZENvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgRGVjb3JhdG9yQ2xhc3MuZGlzcGxheU5hbWUgPSBTdXBlckNsYXNzLmRpc3BsYXlOYW1lO1xcclxcblxcclxcbiAgICBmdW5jdGlvbiBjdHIgKCkge1xcclxcbiAgICAgIHRoaXMuY29uc3RydWN0b3IgPSBEZWNvcmF0ZWRDbGFzcztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBEZWNvcmF0ZWRDbGFzcy5wcm90b3R5cGUgPSBuZXcgY3RyKCk7XFxyXFxuXFxyXFxuICAgIGZvciAodmFyIG0gPSAwOyBtIDwgc3VwZXJNZXRob2RzLmxlbmd0aDsgbSsrKSB7XFxyXFxuICAgICAgICB2YXIgc3VwZXJNZXRob2QgPSBzdXBlck1ldGhvZHNbbV07XFxyXFxuXFxyXFxuICAgICAgICBEZWNvcmF0ZWRDbGFzcy5wcm90b3R5cGVbc3VwZXJNZXRob2RdID1cXHJcXG4gICAgICAgICAgU3VwZXJDbGFzcy5wcm90b3R5cGVbc3VwZXJNZXRob2RdO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciBjYWxsZWRNZXRob2QgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSkge1xcclxcbiAgICAgIC8vIFN0dWIgb3V0IHRoZSBvcmlnaW5hbCBtZXRob2QgaWYgaXQncyBub3QgZGVjb3JhdGluZyBhbiBhY3R1YWwgbWV0aG9kXFxyXFxuICAgICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZnVuY3Rpb24gKCkge307XFxyXFxuXFxyXFxuICAgICAgaWYgKG1ldGhvZE5hbWUgaW4gRGVjb3JhdGVkQ2xhc3MucHJvdG90eXBlKSB7XFxyXFxuICAgICAgICBvcmlnaW5hbE1ldGhvZCA9IERlY29yYXRlZENsYXNzLnByb3RvdHlwZVttZXRob2ROYW1lXTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyIGRlY29yYXRlZE1ldGhvZCA9IERlY29yYXRvckNsYXNzLnByb3RvdHlwZVttZXRob2ROYW1lXTtcXHJcXG5cXHJcXG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdmFyIHVuc2hpZnQgPSBBcnJheS5wcm90b3R5cGUudW5zaGlmdDtcXHJcXG5cXHJcXG4gICAgICAgIHVuc2hpZnQuY2FsbChhcmd1bWVudHMsIG9yaWdpbmFsTWV0aG9kKTtcXHJcXG5cXHJcXG4gICAgICAgIHJldHVybiBkZWNvcmF0ZWRNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcXHJcXG4gICAgICB9O1xcclxcbiAgICB9O1xcclxcblxcclxcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRlY29yYXRlZE1ldGhvZHMubGVuZ3RoOyBkKyspIHtcXHJcXG4gICAgICB2YXIgZGVjb3JhdGVkTWV0aG9kID0gZGVjb3JhdGVkTWV0aG9kc1tkXTtcXHJcXG5cXHJcXG4gICAgICBEZWNvcmF0ZWRDbGFzcy5wcm90b3R5cGVbZGVjb3JhdGVkTWV0aG9kXSA9IGNhbGxlZE1ldGhvZChkZWNvcmF0ZWRNZXRob2QpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiBEZWNvcmF0ZWRDbGFzcztcXHJcXG4gIH07XFxyXFxuXFxyXFxuICB2YXIgT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudCwgY2FsbGJhY2spIHtcXHJcXG4gICAgdGhpcy5saXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVycyB8fCB7fTtcXHJcXG5cXHJcXG4gICAgaWYgKGV2ZW50IGluIHRoaXMubGlzdGVuZXJzKSB7XFxyXFxuICAgICAgdGhpcy5saXN0ZW5lcnNbZXZlbnRdLnB1c2goY2FsbGJhY2spO1xcclxcbiAgICB9IGVsc2Uge1xcclxcbiAgICAgIHRoaXMubGlzdGVuZXJzW2V2ZW50XSA9IFtjYWxsYmFja107XFxyXFxuICAgIH1cXHJcXG4gIH07XFxyXFxuXFxyXFxuICBPYnNlcnZhYmxlLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKGV2ZW50KSB7XFxyXFxuICAgIHZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcXHJcXG4gICAgdmFyIHBhcmFtcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcXHJcXG5cXHJcXG4gICAgdGhpcy5saXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVycyB8fCB7fTtcXHJcXG5cXHJcXG4gICAgLy8gUGFyYW1zIHNob3VsZCBhbHdheXMgY29tZSBpbiBhcyBhbiBhcnJheVxcclxcbiAgICBpZiAocGFyYW1zID09IG51bGwpIHtcXHJcXG4gICAgICBwYXJhbXMgPSBbXTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICAvLyBJZiB0aGVyZSBhcmUgbm8gYXJndW1lbnRzIHRvIHRoZSBldmVudCwgdXNlIGEgdGVtcG9yYXJ5IG9iamVjdFxcclxcbiAgICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgIHBhcmFtcy5wdXNoKHt9KTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICAvLyBTZXQgdGhlIGBfdHlwZWAgb2YgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgZXZlbnRcXHJcXG4gICAgcGFyYW1zWzBdLl90eXBlID0gZXZlbnQ7XFxyXFxuXFxyXFxuICAgIGlmIChldmVudCBpbiB0aGlzLmxpc3RlbmVycykge1xcclxcbiAgICAgIHRoaXMuaW52b2tlKHRoaXMubGlzdGVuZXJzW2V2ZW50XSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoJyonIGluIHRoaXMubGlzdGVuZXJzKSB7XFxyXFxuICAgICAgdGhpcy5pbnZva2UodGhpcy5saXN0ZW5lcnNbJyonXSwgYXJndW1lbnRzKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIE9ic2VydmFibGUucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uIChsaXN0ZW5lcnMsIHBhcmFtcykge1xcclxcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XFxyXFxuICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIHBhcmFtcyk7XFxyXFxuICAgIH1cXHJcXG4gIH07XFxyXFxuXFxyXFxuICBVdGlscy5PYnNlcnZhYmxlID0gT2JzZXJ2YWJsZTtcXHJcXG5cXHJcXG4gIFV0aWxzLmdlbmVyYXRlQ2hhcnMgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XFxyXFxuICAgIHZhciBjaGFycyA9ICcnO1xcclxcblxcclxcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XFxyXFxuICAgICAgdmFyIHJhbmRvbUNoYXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzNik7XFxyXFxuICAgICAgY2hhcnMgKz0gcmFuZG9tQ2hhci50b1N0cmluZygzNik7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgcmV0dXJuIGNoYXJzO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFV0aWxzLmJpbmQgPSBmdW5jdGlvbiAoZnVuYywgY29udGV4dCkge1xcclxcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKTtcXHJcXG4gICAgfTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBVdGlscy5fY29udmVydERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICBmb3IgKHZhciBvcmlnaW5hbEtleSBpbiBkYXRhKSB7XFxyXFxuICAgICAgdmFyIGtleXMgPSBvcmlnaW5hbEtleS5zcGxpdCgnLScpO1xcclxcblxcclxcbiAgICAgIHZhciBkYXRhTGV2ZWwgPSBkYXRhO1xcclxcblxcclxcbiAgICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMSkge1xcclxcbiAgICAgICAgY29udGludWU7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwga2V5cy5sZW5ndGg7IGsrKykge1xcclxcbiAgICAgICAgdmFyIGtleSA9IGtleXNba107XFxyXFxuXFxyXFxuICAgICAgICAvLyBMb3dlcmNhc2UgdGhlIGZpcnN0IGxldHRlclxcclxcbiAgICAgICAgLy8gQnkgZGVmYXVsdCwgZGFzaC1zZXBhcmF0ZWQgYmVjb21lcyBjYW1lbENhc2VcXHJcXG4gICAgICAgIGtleSA9IGtleS5zdWJzdHJpbmcoMCwgMSkudG9Mb3dlckNhc2UoKSArIGtleS5zdWJzdHJpbmcoMSk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAoIShrZXkgaW4gZGF0YUxldmVsKSkge1xcclxcbiAgICAgICAgICBkYXRhTGV2ZWxba2V5XSA9IHt9O1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgaWYgKGsgPT0ga2V5cy5sZW5ndGggLSAxKSB7XFxyXFxuICAgICAgICAgIGRhdGFMZXZlbFtrZXldID0gZGF0YVtvcmlnaW5hbEtleV07XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBkYXRhTGV2ZWwgPSBkYXRhTGV2ZWxba2V5XTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgZGVsZXRlIGRhdGFbb3JpZ2luYWxLZXldO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiBkYXRhO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFV0aWxzLmhhc1Njcm9sbCA9IGZ1bmN0aW9uIChpbmRleCwgZWwpIHtcXHJcXG4gICAgLy8gQWRhcHRlZCBmcm9tIHRoZSBmdW5jdGlvbiBjcmVhdGVkIGJ5IEBTaGFkb3dTY3JpcHRlclxcclxcbiAgICAvLyBhbmQgYWRhcHRlZCBieSBAQmlsbEJhcnJ5IG9uIHRoZSBTdGFjayBFeGNoYW5nZSBDb2RlIFJldmlldyB3ZWJzaXRlLlxcclxcbiAgICAvLyBUaGUgb3JpZ2luYWwgY29kZSBjYW4gYmUgZm91bmQgYXRcXHJcXG4gICAgLy8gaHR0cDovL2NvZGVyZXZpZXcuc3RhY2tleGNoYW5nZS5jb20vcS8xMzMzOFxcclxcbiAgICAvLyBhbmQgd2FzIGRlc2lnbmVkIHRvIGJlIHVzZWQgd2l0aCB0aGUgU2l6emxlIHNlbGVjdG9yIGVuZ2luZS5cXHJcXG5cXHJcXG4gICAgdmFyICRlbCA9ICQoZWwpO1xcclxcbiAgICB2YXIgb3ZlcmZsb3dYID0gZWwuc3R5bGUub3ZlcmZsb3dYO1xcclxcbiAgICB2YXIgb3ZlcmZsb3dZID0gZWwuc3R5bGUub3ZlcmZsb3dZO1xcclxcblxcclxcbiAgICAvL0NoZWNrIGJvdGggeCBhbmQgeSBkZWNsYXJhdGlvbnNcXHJcXG4gICAgaWYgKG92ZXJmbG93WCA9PT0gb3ZlcmZsb3dZICYmXFxyXFxuICAgICAgICAob3ZlcmZsb3dZID09PSAnaGlkZGVuJyB8fCBvdmVyZmxvd1kgPT09ICd2aXNpYmxlJykpIHtcXHJcXG4gICAgICByZXR1cm4gZmFsc2U7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKG92ZXJmbG93WCA9PT0gJ3Njcm9sbCcgfHwgb3ZlcmZsb3dZID09PSAnc2Nyb2xsJykge1xcclxcbiAgICAgIHJldHVybiB0cnVlO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiAoJGVsLmlubmVySGVpZ2h0KCkgPCBlbC5zY3JvbGxIZWlnaHQgfHxcXHJcXG4gICAgICAkZWwuaW5uZXJXaWR0aCgpIDwgZWwuc2Nyb2xsV2lkdGgpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFV0aWxzLmVzY2FwZU1hcmt1cCA9IGZ1bmN0aW9uIChtYXJrdXApIHtcXHJcXG4gICAgdmFyIHJlcGxhY2VNYXAgPSB7XFxyXFxuICAgICAgJ1xcXFxcXFxcJzogJyYjOTI7JyxcXHJcXG4gICAgICAnJic6ICcmYW1wOycsXFxyXFxuICAgICAgJzwnOiAnJmx0OycsXFxyXFxuICAgICAgJz4nOiAnJmd0OycsXFxyXFxuICAgICAgJ1xcXCInOiAnJnF1b3Q7JyxcXHJcXG4gICAgICAnXFxcXCcnOiAnJiMzOTsnLFxcclxcbiAgICAgICcvJzogJyYjNDc7J1xcclxcbiAgICB9O1xcclxcblxcclxcbiAgICAvLyBEbyBub3QgdHJ5IHRvIGVzY2FwZSB0aGUgbWFya3VwIGlmIGl0J3Mgbm90IGEgc3RyaW5nXFxyXFxuICAgIGlmICh0eXBlb2YgbWFya3VwICE9PSAnc3RyaW5nJykge1xcclxcbiAgICAgIHJldHVybiBtYXJrdXA7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgcmV0dXJuIFN0cmluZyhtYXJrdXApLnJlcGxhY2UoL1smPD5cXFwiJ1xcXFwvXFxcXFxcXFxdL2csIGZ1bmN0aW9uIChtYXRjaCkge1xcclxcbiAgICAgIHJldHVybiByZXBsYWNlTWFwW21hdGNoXTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgLy8gQXBwZW5kIGFuIGFycmF5IG9mIGpRdWVyeSBub2RlcyB0byBhIGdpdmVuIGVsZW1lbnQuXFxyXFxuICBVdGlscy5hcHBlbmRNYW55ID0gZnVuY3Rpb24gKCRlbGVtZW50LCAkbm9kZXMpIHtcXHJcXG4gICAgLy8galF1ZXJ5IDEuNy54IGRvZXMgbm90IHN1cHBvcnQgJC5mbi5hcHBlbmQoKSB3aXRoIGFuIGFycmF5XFxyXFxuICAgIC8vIEZhbGwgYmFjayB0byBhIGpRdWVyeSBvYmplY3QgY29sbGVjdGlvbiB1c2luZyAkLmZuLmFkZCgpXFxyXFxuICAgIGlmICgkLmZuLmpxdWVyeS5zdWJzdHIoMCwgMykgPT09ICcxLjcnKSB7XFxyXFxuICAgICAgdmFyICRqcU5vZGVzID0gJCgpO1xcclxcblxcclxcbiAgICAgICQubWFwKCRub2RlcywgZnVuY3Rpb24gKG5vZGUpIHtcXHJcXG4gICAgICAgICRqcU5vZGVzID0gJGpxTm9kZXMuYWRkKG5vZGUpO1xcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgICRub2RlcyA9ICRqcU5vZGVzO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgICRlbGVtZW50LmFwcGVuZCgkbm9kZXMpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBVdGlscztcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ3NlbGVjdDIvcmVzdWx0cycsW1xcclxcbiAgJ2pxdWVyeScsXFxyXFxuICAnLi91dGlscydcXHJcXG5dLCBmdW5jdGlvbiAoJCwgVXRpbHMpIHtcXHJcXG4gIGZ1bmN0aW9uIFJlc3VsdHMgKCRlbGVtZW50LCBvcHRpb25zLCBkYXRhQWRhcHRlcikge1xcclxcbiAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XFxyXFxuICAgIHRoaXMuZGF0YSA9IGRhdGFBZGFwdGVyO1xcclxcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xcclxcblxcclxcbiAgICBSZXN1bHRzLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpO1xcclxcbiAgfVxcclxcblxcclxcbiAgVXRpbHMuRXh0ZW5kKFJlc3VsdHMsIFV0aWxzLk9ic2VydmFibGUpO1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgJHJlc3VsdHMgPSAkKFxcclxcbiAgICAgICc8dWwgY2xhc3M9XFxcInNlbGVjdDItcmVzdWx0c19fb3B0aW9uc1xcXCIgcm9sZT1cXFwidHJlZVxcXCI+PC91bD4nXFxyXFxuICAgICk7XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLm9wdGlvbnMuZ2V0KCdtdWx0aXBsZScpKSB7XFxyXFxuICAgICAgJHJlc3VsdHMuYXR0cignYXJpYS1tdWx0aXNlbGVjdGFibGUnLCAndHJ1ZScpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuJHJlc3VsdHMgPSAkcmVzdWx0cztcXHJcXG5cXHJcXG4gICAgcmV0dXJuICRyZXN1bHRzO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB0aGlzLiRyZXN1bHRzLmVtcHR5KCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuZGlzcGxheU1lc3NhZ2UgPSBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgIHZhciBlc2NhcGVNYXJrdXAgPSB0aGlzLm9wdGlvbnMuZ2V0KCdlc2NhcGVNYXJrdXAnKTtcXHJcXG5cXHJcXG4gICAgdGhpcy5jbGVhcigpO1xcclxcbiAgICB0aGlzLmhpZGVMb2FkaW5nKCk7XFxyXFxuXFxyXFxuICAgIHZhciAkbWVzc2FnZSA9ICQoXFxyXFxuICAgICAgJzxsaSByb2xlPVxcXCJ0cmVlaXRlbVxcXCIgYXJpYS1saXZlPVxcXCJhc3NlcnRpdmVcXFwiJyArXFxyXFxuICAgICAgJyBjbGFzcz1cXFwic2VsZWN0Mi1yZXN1bHRzX19vcHRpb25cXFwiPjwvbGk+J1xcclxcbiAgICApO1xcclxcblxcclxcbiAgICB2YXIgbWVzc2FnZSA9IHRoaXMub3B0aW9ucy5nZXQoJ3RyYW5zbGF0aW9ucycpLmdldChwYXJhbXMubWVzc2FnZSk7XFxyXFxuXFxyXFxuICAgICRtZXNzYWdlLmFwcGVuZChcXHJcXG4gICAgICBlc2NhcGVNYXJrdXAoXFxyXFxuICAgICAgICBtZXNzYWdlKHBhcmFtcy5hcmdzKVxcclxcbiAgICAgIClcXHJcXG4gICAgKTtcXHJcXG5cXHJcXG4gICAgJG1lc3NhZ2VbMF0uY2xhc3NOYW1lICs9ICcgc2VsZWN0Mi1yZXN1bHRzX19tZXNzYWdlJztcXHJcXG5cXHJcXG4gICAgdGhpcy4kcmVzdWx0cy5hcHBlbmQoJG1lc3NhZ2UpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLmhpZGVNZXNzYWdlcyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdGhpcy4kcmVzdWx0cy5maW5kKCcuc2VsZWN0Mi1yZXN1bHRzX19tZXNzYWdlJykucmVtb3ZlKCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgdGhpcy5oaWRlTG9hZGluZygpO1xcclxcblxcclxcbiAgICB2YXIgJG9wdGlvbnMgPSBbXTtcXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEucmVzdWx0cyA9PSBudWxsIHx8IGRhdGEucmVzdWx0cy5sZW5ndGggPT09IDApIHtcXHJcXG4gICAgICBpZiAodGhpcy4kcmVzdWx0cy5jaGlsZHJlbigpLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdyZXN1bHRzOm1lc3NhZ2UnLCB7XFxyXFxuICAgICAgICAgIG1lc3NhZ2U6ICdub1Jlc3VsdHMnXFxyXFxuICAgICAgICB9KTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRhdGEucmVzdWx0cyA9IHRoaXMuc29ydChkYXRhLnJlc3VsdHMpO1xcclxcblxcclxcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRhdGEucmVzdWx0cy5sZW5ndGg7IGQrKykge1xcclxcbiAgICAgIHZhciBpdGVtID0gZGF0YS5yZXN1bHRzW2RdO1xcclxcblxcclxcbiAgICAgIHZhciAkb3B0aW9uID0gdGhpcy5vcHRpb24oaXRlbSk7XFxyXFxuXFxyXFxuICAgICAgJG9wdGlvbnMucHVzaCgkb3B0aW9uKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLiRyZXN1bHRzLmFwcGVuZCgkb3B0aW9ucyk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUucG9zaXRpb24gPSBmdW5jdGlvbiAoJHJlc3VsdHMsICRkcm9wZG93bikge1xcclxcbiAgICB2YXIgJHJlc3VsdHNDb250YWluZXIgPSAkZHJvcGRvd24uZmluZCgnLnNlbGVjdDItcmVzdWx0cycpO1xcclxcbiAgICAkcmVzdWx0c0NvbnRhaW5lci5hcHBlbmQoJHJlc3VsdHMpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLnNvcnQgPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICB2YXIgc29ydGVyID0gdGhpcy5vcHRpb25zLmdldCgnc29ydGVyJyk7XFxyXFxuXFxyXFxuICAgIHJldHVybiBzb3J0ZXIoZGF0YSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuaGlnaGxpZ2h0Rmlyc3RJdGVtID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgJG9wdGlvbnMgPSB0aGlzLiRyZXN1bHRzXFxyXFxuICAgICAgLmZpbmQoJy5zZWxlY3QyLXJlc3VsdHNfX29wdGlvblthcmlhLXNlbGVjdGVkXScpO1xcclxcblxcclxcbiAgICB2YXIgJHNlbGVjdGVkID0gJG9wdGlvbnMuZmlsdGVyKCdbYXJpYS1zZWxlY3RlZD10cnVlXScpO1xcclxcblxcclxcbiAgICAvLyBDaGVjayBpZiB0aGVyZSBhcmUgYW55IHNlbGVjdGVkIG9wdGlvbnNcXHJcXG4gICAgaWYgKCRzZWxlY3RlZC5sZW5ndGggPiAwKSB7XFxyXFxuICAgICAgLy8gSWYgdGhlcmUgYXJlIHNlbGVjdGVkIG9wdGlvbnMsIGhpZ2hsaWdodCB0aGUgZmlyc3RcXHJcXG4gICAgICAkc2VsZWN0ZWQuZmlyc3QoKS50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XFxyXFxuICAgIH0gZWxzZSB7XFxyXFxuICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vIHNlbGVjdGVkIG9wdGlvbnMsIGhpZ2hsaWdodCB0aGUgZmlyc3Qgb3B0aW9uXFxyXFxuICAgICAgLy8gaW4gdGhlIGRyb3Bkb3duXFxyXFxuICAgICAgJG9wdGlvbnMuZmlyc3QoKS50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy5lbnN1cmVIaWdobGlnaHRWaXNpYmxlKCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuc2V0Q2xhc3NlcyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICB0aGlzLmRhdGEuY3VycmVudChmdW5jdGlvbiAoc2VsZWN0ZWQpIHtcXHJcXG4gICAgICB2YXIgc2VsZWN0ZWRJZHMgPSAkLm1hcChzZWxlY3RlZCwgZnVuY3Rpb24gKHMpIHtcXHJcXG4gICAgICAgIHJldHVybiBzLmlkLnRvU3RyaW5nKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdmFyICRvcHRpb25zID0gc2VsZi4kcmVzdWx0c1xcclxcbiAgICAgICAgLmZpbmQoJy5zZWxlY3QyLXJlc3VsdHNfX29wdGlvblthcmlhLXNlbGVjdGVkXScpO1xcclxcblxcclxcbiAgICAgICRvcHRpb25zLmVhY2goZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdmFyICRvcHRpb24gPSAkKHRoaXMpO1xcclxcblxcclxcbiAgICAgICAgdmFyIGl0ZW0gPSAkLmRhdGEodGhpcywgJ2RhdGEnKTtcXHJcXG5cXHJcXG4gICAgICAgIC8vIGlkIG5lZWRzIHRvIGJlIGNvbnZlcnRlZCB0byBhIHN0cmluZyB3aGVuIGNvbXBhcmluZ1xcclxcbiAgICAgICAgdmFyIGlkID0gJycgKyBpdGVtLmlkO1xcclxcblxcclxcbiAgICAgICAgaWYgKChpdGVtLmVsZW1lbnQgIT0gbnVsbCAmJiBpdGVtLmVsZW1lbnQuc2VsZWN0ZWQpIHx8XFxyXFxuICAgICAgICAgICAgKGl0ZW0uZWxlbWVudCA9PSBudWxsICYmICQuaW5BcnJheShpZCwgc2VsZWN0ZWRJZHMpID4gLTEpKSB7XFxyXFxuICAgICAgICAgICRvcHRpb24uYXR0cignYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAkb3B0aW9uLmF0dHIoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuc2hvd0xvYWRpbmcgPSBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgIHRoaXMuaGlkZUxvYWRpbmcoKTtcXHJcXG5cXHJcXG4gICAgdmFyIGxvYWRpbmdNb3JlID0gdGhpcy5vcHRpb25zLmdldCgndHJhbnNsYXRpb25zJykuZ2V0KCdzZWFyY2hpbmcnKTtcXHJcXG5cXHJcXG4gICAgdmFyIGxvYWRpbmcgPSB7XFxyXFxuICAgICAgZGlzYWJsZWQ6IHRydWUsXFxyXFxuICAgICAgbG9hZGluZzogdHJ1ZSxcXHJcXG4gICAgICB0ZXh0OiBsb2FkaW5nTW9yZShwYXJhbXMpXFxyXFxuICAgIH07XFxyXFxuICAgIHZhciAkbG9hZGluZyA9IHRoaXMub3B0aW9uKGxvYWRpbmcpO1xcclxcbiAgICAkbG9hZGluZy5jbGFzc05hbWUgKz0gJyBsb2FkaW5nLXJlc3VsdHMnO1xcclxcblxcclxcbiAgICB0aGlzLiRyZXN1bHRzLnByZXBlbmQoJGxvYWRpbmcpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLmhpZGVMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB0aGlzLiRyZXN1bHRzLmZpbmQoJy5sb2FkaW5nLXJlc3VsdHMnKS5yZW1vdmUoKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBSZXN1bHRzLnByb3RvdHlwZS5vcHRpb24gPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICB2YXIgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcXHJcXG4gICAgb3B0aW9uLmNsYXNzTmFtZSA9ICdzZWxlY3QyLXJlc3VsdHNfX29wdGlvbic7XFxyXFxuXFxyXFxuICAgIHZhciBhdHRycyA9IHtcXHJcXG4gICAgICAncm9sZSc6ICd0cmVlaXRlbScsXFxyXFxuICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiAnZmFsc2UnXFxyXFxuICAgIH07XFxyXFxuXFxyXFxuICAgIGlmIChkYXRhLmRpc2FibGVkKSB7XFxyXFxuICAgICAgZGVsZXRlIGF0dHJzWydhcmlhLXNlbGVjdGVkJ107XFxyXFxuICAgICAgYXR0cnNbJ2FyaWEtZGlzYWJsZWQnXSA9ICd0cnVlJztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoZGF0YS5pZCA9PSBudWxsKSB7XFxyXFxuICAgICAgZGVsZXRlIGF0dHJzWydhcmlhLXNlbGVjdGVkJ107XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEuX3Jlc3VsdElkICE9IG51bGwpIHtcXHJcXG4gICAgICBvcHRpb24uaWQgPSBkYXRhLl9yZXN1bHRJZDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoZGF0YS50aXRsZSkge1xcclxcbiAgICAgIG9wdGlvbi50aXRsZSA9IGRhdGEudGl0bGU7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEuY2hpbGRyZW4pIHtcXHJcXG4gICAgICBhdHRycy5yb2xlID0gJ2dyb3VwJztcXHJcXG4gICAgICBhdHRyc1snYXJpYS1sYWJlbCddID0gZGF0YS50ZXh0O1xcclxcbiAgICAgIGRlbGV0ZSBhdHRyc1snYXJpYS1zZWxlY3RlZCddO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGZvciAodmFyIGF0dHIgaW4gYXR0cnMpIHtcXHJcXG4gICAgICB2YXIgdmFsID0gYXR0cnNbYXR0cl07XFxyXFxuXFxyXFxuICAgICAgb3B0aW9uLnNldEF0dHJpYnV0ZShhdHRyLCB2YWwpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChkYXRhLmNoaWxkcmVuKSB7XFxyXFxuICAgICAgdmFyICRvcHRpb24gPSAkKG9wdGlvbik7XFxyXFxuXFxyXFxuICAgICAgdmFyIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3Ryb25nJyk7XFxyXFxuICAgICAgbGFiZWwuY2xhc3NOYW1lID0gJ3NlbGVjdDItcmVzdWx0c19fZ3JvdXAnO1xcclxcblxcclxcbiAgICAgIHZhciAkbGFiZWwgPSAkKGxhYmVsKTtcXHJcXG4gICAgICB0aGlzLnRlbXBsYXRlKGRhdGEsIGxhYmVsKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgJGNoaWxkcmVuID0gW107XFxyXFxuXFxyXFxuICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBkYXRhLmNoaWxkcmVuLmxlbmd0aDsgYysrKSB7XFxyXFxuICAgICAgICB2YXIgY2hpbGQgPSBkYXRhLmNoaWxkcmVuW2NdO1xcclxcblxcclxcbiAgICAgICAgdmFyICRjaGlsZCA9IHRoaXMub3B0aW9uKGNoaWxkKTtcXHJcXG5cXHJcXG4gICAgICAgICRjaGlsZHJlbi5wdXNoKCRjaGlsZCk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHZhciAkY2hpbGRyZW5Db250YWluZXIgPSAkKCc8dWw+PC91bD4nLCB7XFxyXFxuICAgICAgICAnY2xhc3MnOiAnc2VsZWN0Mi1yZXN1bHRzX19vcHRpb25zIHNlbGVjdDItcmVzdWx0c19fb3B0aW9ucy0tbmVzdGVkJ1xcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgICRjaGlsZHJlbkNvbnRhaW5lci5hcHBlbmQoJGNoaWxkcmVuKTtcXHJcXG5cXHJcXG4gICAgICAkb3B0aW9uLmFwcGVuZChsYWJlbCk7XFxyXFxuICAgICAgJG9wdGlvbi5hcHBlbmQoJGNoaWxkcmVuQ29udGFpbmVyKTtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICB0aGlzLnRlbXBsYXRlKGRhdGEsIG9wdGlvbik7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgJC5kYXRhKG9wdGlvbiwgJ2RhdGEnLCBkYXRhKTtcXHJcXG5cXHJcXG4gICAgcmV0dXJuIG9wdGlvbjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBSZXN1bHRzLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHZhciBpZCA9IGNvbnRhaW5lci5pZCArICctcmVzdWx0cyc7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHJlc3VsdHMuYXR0cignaWQnLCBpZCk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbigncmVzdWx0czphbGwnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi5jbGVhcigpO1xcclxcbiAgICAgIHNlbGYuYXBwZW5kKHBhcmFtcy5kYXRhKTtcXHJcXG5cXHJcXG4gICAgICBpZiAoY29udGFpbmVyLmlzT3BlbigpKSB7XFxyXFxuICAgICAgICBzZWxmLnNldENsYXNzZXMoKTtcXHJcXG4gICAgICAgIHNlbGYuaGlnaGxpZ2h0Rmlyc3RJdGVtKCk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOmFwcGVuZCcsIGZ1bmN0aW9uIChwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLmFwcGVuZChwYXJhbXMuZGF0YSk7XFxyXFxuXFxyXFxuICAgICAgaWYgKGNvbnRhaW5lci5pc09wZW4oKSkge1xcclxcbiAgICAgICAgc2VsZi5zZXRDbGFzc2VzKCk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdxdWVyeScsIGZ1bmN0aW9uIChwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLmhpZGVNZXNzYWdlcygpO1xcclxcbiAgICAgIHNlbGYuc2hvd0xvYWRpbmcocGFyYW1zKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignc2VsZWN0JywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIGlmICghY29udGFpbmVyLmlzT3BlbigpKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHNlbGYuc2V0Q2xhc3NlcygpO1xcclxcbiAgICAgIHNlbGYuaGlnaGxpZ2h0Rmlyc3RJdGVtKCk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3Vuc2VsZWN0JywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIGlmICghY29udGFpbmVyLmlzT3BlbigpKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHNlbGYuc2V0Q2xhc3NlcygpO1xcclxcbiAgICAgIHNlbGYuaGlnaGxpZ2h0Rmlyc3RJdGVtKCk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ29wZW4nLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgLy8gV2hlbiB0aGUgZHJvcGRvd24gaXMgb3BlbiwgYXJpYS1leHBlbmRlZD1cXFwidHJ1ZVxcXCJcXHJcXG4gICAgICBzZWxmLiRyZXN1bHRzLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xcclxcbiAgICAgIHNlbGYuJHJlc3VsdHMuYXR0cignYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLnNldENsYXNzZXMoKTtcXHJcXG4gICAgICBzZWxmLmVuc3VyZUhpZ2hsaWdodFZpc2libGUoKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignY2xvc2UnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgLy8gV2hlbiB0aGUgZHJvcGRvd24gaXMgY2xvc2VkLCBhcmlhLWV4cGVuZGVkPVxcXCJmYWxzZVxcXCJcXHJcXG4gICAgICBzZWxmLiRyZXN1bHRzLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcXHJcXG4gICAgICBzZWxmLiRyZXN1bHRzLmF0dHIoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcXHJcXG4gICAgICBzZWxmLiRyZXN1bHRzLnJlbW92ZUF0dHIoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOnRvZ2dsZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgJGhpZ2hsaWdodGVkID0gc2VsZi5nZXRIaWdobGlnaHRlZFJlc3VsdHMoKTtcXHJcXG5cXHJcXG4gICAgICBpZiAoJGhpZ2hsaWdodGVkLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAkaGlnaGxpZ2h0ZWQudHJpZ2dlcignbW91c2V1cCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOnNlbGVjdCcsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgJGhpZ2hsaWdodGVkID0gc2VsZi5nZXRIaWdobGlnaHRlZFJlc3VsdHMoKTtcXHJcXG5cXHJcXG4gICAgICBpZiAoJGhpZ2hsaWdodGVkLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB2YXIgZGF0YSA9ICRoaWdobGlnaHRlZC5kYXRhKCdkYXRhJyk7XFxyXFxuXFxyXFxuICAgICAgaWYgKCRoaWdobGlnaHRlZC5hdHRyKCdhcmlhLXNlbGVjdGVkJykgPT0gJ3RydWUnKSB7XFxyXFxuICAgICAgICBzZWxmLnRyaWdnZXIoJ2Nsb3NlJywge30pO1xcclxcbiAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICBzZWxmLnRyaWdnZXIoJ3NlbGVjdCcsIHtcXHJcXG4gICAgICAgICAgZGF0YTogZGF0YVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOnByZXZpb3VzJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHZhciAkaGlnaGxpZ2h0ZWQgPSBzZWxmLmdldEhpZ2hsaWdodGVkUmVzdWx0cygpO1xcclxcblxcclxcbiAgICAgIHZhciAkb3B0aW9ucyA9IHNlbGYuJHJlc3VsdHMuZmluZCgnW2FyaWEtc2VsZWN0ZWRdJyk7XFxyXFxuXFxyXFxuICAgICAgdmFyIGN1cnJlbnRJbmRleCA9ICRvcHRpb25zLmluZGV4KCRoaWdobGlnaHRlZCk7XFxyXFxuXFxyXFxuICAgICAgLy8gSWYgd2UgYXJlIGFscmVhZHkgYXQgdGUgdG9wLCBkb24ndCBtb3ZlIGZ1cnRoZXJcXHJcXG4gICAgICBpZiAoY3VycmVudEluZGV4ID09PSAwKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHZhciBuZXh0SW5kZXggPSBjdXJyZW50SW5kZXggLSAxO1xcclxcblxcclxcbiAgICAgIC8vIElmIG5vbmUgYXJlIGhpZ2hsaWdodGVkLCBoaWdobGlnaHQgdGhlIGZpcnN0XFxyXFxuICAgICAgaWYgKCRoaWdobGlnaHRlZC5sZW5ndGggPT09IDApIHtcXHJcXG4gICAgICAgIG5leHRJbmRleCA9IDA7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHZhciAkbmV4dCA9ICRvcHRpb25zLmVxKG5leHRJbmRleCk7XFxyXFxuXFxyXFxuICAgICAgJG5leHQudHJpZ2dlcignbW91c2VlbnRlcicpO1xcclxcblxcclxcbiAgICAgIHZhciBjdXJyZW50T2Zmc2V0ID0gc2VsZi4kcmVzdWx0cy5vZmZzZXQoKS50b3A7XFxyXFxuICAgICAgdmFyIG5leHRUb3AgPSAkbmV4dC5vZmZzZXQoKS50b3A7XFxyXFxuICAgICAgdmFyIG5leHRPZmZzZXQgPSBzZWxmLiRyZXN1bHRzLnNjcm9sbFRvcCgpICsgKG5leHRUb3AgLSBjdXJyZW50T2Zmc2V0KTtcXHJcXG5cXHJcXG4gICAgICBpZiAobmV4dEluZGV4ID09PSAwKSB7XFxyXFxuICAgICAgICBzZWxmLiRyZXN1bHRzLnNjcm9sbFRvcCgwKTtcXHJcXG4gICAgICB9IGVsc2UgaWYgKG5leHRUb3AgLSBjdXJyZW50T2Zmc2V0IDwgMCkge1xcclxcbiAgICAgICAgc2VsZi4kcmVzdWx0cy5zY3JvbGxUb3AobmV4dE9mZnNldCk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOm5leHQnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyICRoaWdobGlnaHRlZCA9IHNlbGYuZ2V0SGlnaGxpZ2h0ZWRSZXN1bHRzKCk7XFxyXFxuXFxyXFxuICAgICAgdmFyICRvcHRpb25zID0gc2VsZi4kcmVzdWx0cy5maW5kKCdbYXJpYS1zZWxlY3RlZF0nKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgY3VycmVudEluZGV4ID0gJG9wdGlvbnMuaW5kZXgoJGhpZ2hsaWdodGVkKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgbmV4dEluZGV4ID0gY3VycmVudEluZGV4ICsgMTtcXHJcXG5cXHJcXG4gICAgICAvLyBJZiB3ZSBhcmUgYXQgdGhlIGxhc3Qgb3B0aW9uLCBzdGF5IHRoZXJlXFxyXFxuICAgICAgaWYgKG5leHRJbmRleCA+PSAkb3B0aW9ucy5sZW5ndGgpIHtcXHJcXG4gICAgICAgIHJldHVybjtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyICRuZXh0ID0gJG9wdGlvbnMuZXEobmV4dEluZGV4KTtcXHJcXG5cXHJcXG4gICAgICAkbmV4dC50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XFxyXFxuXFxyXFxuICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSBzZWxmLiRyZXN1bHRzLm9mZnNldCgpLnRvcCArXFxyXFxuICAgICAgICBzZWxmLiRyZXN1bHRzLm91dGVySGVpZ2h0KGZhbHNlKTtcXHJcXG4gICAgICB2YXIgbmV4dEJvdHRvbSA9ICRuZXh0Lm9mZnNldCgpLnRvcCArICRuZXh0Lm91dGVySGVpZ2h0KGZhbHNlKTtcXHJcXG4gICAgICB2YXIgbmV4dE9mZnNldCA9IHNlbGYuJHJlc3VsdHMuc2Nyb2xsVG9wKCkgKyBuZXh0Qm90dG9tIC0gY3VycmVudE9mZnNldDtcXHJcXG5cXHJcXG4gICAgICBpZiAobmV4dEluZGV4ID09PSAwKSB7XFxyXFxuICAgICAgICBzZWxmLiRyZXN1bHRzLnNjcm9sbFRvcCgwKTtcXHJcXG4gICAgICB9IGVsc2UgaWYgKG5leHRCb3R0b20gPiBjdXJyZW50T2Zmc2V0KSB7XFxyXFxuICAgICAgICBzZWxmLiRyZXN1bHRzLnNjcm9sbFRvcChuZXh0T2Zmc2V0KTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3Jlc3VsdHM6Zm9jdXMnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgcGFyYW1zLmVsZW1lbnQuYWRkQ2xhc3MoJ3NlbGVjdDItcmVzdWx0c19fb3B0aW9uLS1oaWdobGlnaHRlZCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOm1lc3NhZ2UnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi5kaXNwbGF5TWVzc2FnZShwYXJhbXMpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgaWYgKCQuZm4ubW91c2V3aGVlbCkge1xcclxcbiAgICAgIHRoaXMuJHJlc3VsdHMub24oJ21vdXNld2hlZWwnLCBmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgICAgdmFyIHRvcCA9IHNlbGYuJHJlc3VsdHMuc2Nyb2xsVG9wKCk7XFxyXFxuXFxyXFxuICAgICAgICB2YXIgYm90dG9tID0gc2VsZi4kcmVzdWx0cy5nZXQoMCkuc2Nyb2xsSGVpZ2h0IC0gdG9wICsgZS5kZWx0YVk7XFxyXFxuXFxyXFxuICAgICAgICB2YXIgaXNBdFRvcCA9IGUuZGVsdGFZID4gMCAmJiB0b3AgLSBlLmRlbHRhWSA8PSAwO1xcclxcbiAgICAgICAgdmFyIGlzQXRCb3R0b20gPSBlLmRlbHRhWSA8IDAgJiYgYm90dG9tIDw9IHNlbGYuJHJlc3VsdHMuaGVpZ2h0KCk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAoaXNBdFRvcCkge1xcclxcbiAgICAgICAgICBzZWxmLiRyZXN1bHRzLnNjcm9sbFRvcCgwKTtcXHJcXG5cXHJcXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xcclxcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xcclxcbiAgICAgICAgfSBlbHNlIGlmIChpc0F0Qm90dG9tKSB7XFxyXFxuICAgICAgICAgIHNlbGYuJHJlc3VsdHMuc2Nyb2xsVG9wKFxcclxcbiAgICAgICAgICAgIHNlbGYuJHJlc3VsdHMuZ2V0KDApLnNjcm9sbEhlaWdodCAtIHNlbGYuJHJlc3VsdHMuaGVpZ2h0KClcXHJcXG4gICAgICAgICAgKTtcXHJcXG5cXHJcXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xcclxcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuJHJlc3VsdHMub24oJ21vdXNldXAnLCAnLnNlbGVjdDItcmVzdWx0c19fb3B0aW9uW2FyaWEtc2VsZWN0ZWRdJyxcXHJcXG4gICAgICBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgZGF0YSA9ICR0aGlzLmRhdGEoJ2RhdGEnKTtcXHJcXG5cXHJcXG4gICAgICBpZiAoJHRoaXMuYXR0cignYXJpYS1zZWxlY3RlZCcpID09PSAndHJ1ZScpIHtcXHJcXG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMuZ2V0KCdtdWx0aXBsZScpKSB7XFxyXFxuICAgICAgICAgIHNlbGYudHJpZ2dlcigndW5zZWxlY3QnLCB7XFxyXFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZ0LFxcclxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFcXHJcXG4gICAgICAgICAgfSk7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICBzZWxmLnRyaWdnZXIoJ2Nsb3NlJywge30pO1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ3NlbGVjdCcsIHtcXHJcXG4gICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2dCxcXHJcXG4gICAgICAgIGRhdGE6IGRhdGFcXHJcXG4gICAgICB9KTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHJlc3VsdHMub24oJ21vdXNlZW50ZXInLCAnLnNlbGVjdDItcmVzdWx0c19fb3B0aW9uW2FyaWEtc2VsZWN0ZWRdJyxcXHJcXG4gICAgICBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgdmFyIGRhdGEgPSAkKHRoaXMpLmRhdGEoJ2RhdGEnKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLmdldEhpZ2hsaWdodGVkUmVzdWx0cygpXFxyXFxuICAgICAgICAgIC5yZW1vdmVDbGFzcygnc2VsZWN0Mi1yZXN1bHRzX19vcHRpb24tLWhpZ2hsaWdodGVkJyk7XFxyXFxuXFxyXFxuICAgICAgc2VsZi50cmlnZ2VyKCdyZXN1bHRzOmZvY3VzJywge1xcclxcbiAgICAgICAgZGF0YTogZGF0YSxcXHJcXG4gICAgICAgIGVsZW1lbnQ6ICQodGhpcylcXHJcXG4gICAgICB9KTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuZ2V0SGlnaGxpZ2h0ZWRSZXN1bHRzID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgJGhpZ2hsaWdodGVkID0gdGhpcy4kcmVzdWx0c1xcclxcbiAgICAuZmluZCgnLnNlbGVjdDItcmVzdWx0c19fb3B0aW9uLS1oaWdobGlnaHRlZCcpO1xcclxcblxcclxcbiAgICByZXR1cm4gJGhpZ2hsaWdodGVkO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHRoaXMuJHJlc3VsdHMucmVtb3ZlKCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUmVzdWx0cy5wcm90b3R5cGUuZW5zdXJlSGlnaGxpZ2h0VmlzaWJsZSA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyICRoaWdobGlnaHRlZCA9IHRoaXMuZ2V0SGlnaGxpZ2h0ZWRSZXN1bHRzKCk7XFxyXFxuXFxyXFxuICAgIGlmICgkaGlnaGxpZ2h0ZWQubGVuZ3RoID09PSAwKSB7XFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciAkb3B0aW9ucyA9IHRoaXMuJHJlc3VsdHMuZmluZCgnW2FyaWEtc2VsZWN0ZWRdJyk7XFxyXFxuXFxyXFxuICAgIHZhciBjdXJyZW50SW5kZXggPSAkb3B0aW9ucy5pbmRleCgkaGlnaGxpZ2h0ZWQpO1xcclxcblxcclxcbiAgICB2YXIgY3VycmVudE9mZnNldCA9IHRoaXMuJHJlc3VsdHMub2Zmc2V0KCkudG9wO1xcclxcbiAgICB2YXIgbmV4dFRvcCA9ICRoaWdobGlnaHRlZC5vZmZzZXQoKS50b3A7XFxyXFxuICAgIHZhciBuZXh0T2Zmc2V0ID0gdGhpcy4kcmVzdWx0cy5zY3JvbGxUb3AoKSArIChuZXh0VG9wIC0gY3VycmVudE9mZnNldCk7XFxyXFxuXFxyXFxuICAgIHZhciBvZmZzZXREZWx0YSA9IG5leHRUb3AgLSBjdXJyZW50T2Zmc2V0O1xcclxcbiAgICBuZXh0T2Zmc2V0IC09ICRoaWdobGlnaHRlZC5vdXRlckhlaWdodChmYWxzZSkgKiAyO1xcclxcblxcclxcbiAgICBpZiAoY3VycmVudEluZGV4IDw9IDIpIHtcXHJcXG4gICAgICB0aGlzLiRyZXN1bHRzLnNjcm9sbFRvcCgwKTtcXHJcXG4gICAgfSBlbHNlIGlmIChvZmZzZXREZWx0YSA+IHRoaXMuJHJlc3VsdHMub3V0ZXJIZWlnaHQoKSB8fCBvZmZzZXREZWx0YSA8IDApIHtcXHJcXG4gICAgICB0aGlzLiRyZXN1bHRzLnNjcm9sbFRvcChuZXh0T2Zmc2V0KTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFJlc3VsdHMucHJvdG90eXBlLnRlbXBsYXRlID0gZnVuY3Rpb24gKHJlc3VsdCwgY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMub3B0aW9ucy5nZXQoJ3RlbXBsYXRlUmVzdWx0Jyk7XFxyXFxuICAgIHZhciBlc2NhcGVNYXJrdXAgPSB0aGlzLm9wdGlvbnMuZ2V0KCdlc2NhcGVNYXJrdXAnKTtcXHJcXG5cXHJcXG4gICAgdmFyIGNvbnRlbnQgPSB0ZW1wbGF0ZShyZXN1bHQsIGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIGlmIChjb250ZW50ID09IG51bGwpIHtcXHJcXG4gICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcXHJcXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcXHJcXG4gICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gZXNjYXBlTWFya3VwKGNvbnRlbnQpO1xcclxcbiAgICB9IGVsc2Uge1xcclxcbiAgICAgICQoY29udGFpbmVyKS5hcHBlbmQoY29udGVudCk7XFxyXFxuICAgIH1cXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gUmVzdWx0cztcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ3NlbGVjdDIva2V5cycsW1xcclxcblxcclxcbl0sIGZ1bmN0aW9uICgpIHtcXHJcXG4gIHZhciBLRVlTID0ge1xcclxcbiAgICBCQUNLU1BBQ0U6IDgsXFxyXFxuICAgIFRBQjogOSxcXHJcXG4gICAgRU5URVI6IDEzLFxcclxcbiAgICBTSElGVDogMTYsXFxyXFxuICAgIENUUkw6IDE3LFxcclxcbiAgICBBTFQ6IDE4LFxcclxcbiAgICBFU0M6IDI3LFxcclxcbiAgICBTUEFDRTogMzIsXFxyXFxuICAgIFBBR0VfVVA6IDMzLFxcclxcbiAgICBQQUdFX0RPV046IDM0LFxcclxcbiAgICBFTkQ6IDM1LFxcclxcbiAgICBIT01FOiAzNixcXHJcXG4gICAgTEVGVDogMzcsXFxyXFxuICAgIFVQOiAzOCxcXHJcXG4gICAgUklHSFQ6IDM5LFxcclxcbiAgICBET1dOOiA0MCxcXHJcXG4gICAgREVMRVRFOiA0NlxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBLRVlTO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9zZWxlY3Rpb24vYmFzZScsW1xcclxcbiAgJ2pxdWVyeScsXFxyXFxuICAnLi4vdXRpbHMnLFxcclxcbiAgJy4uL2tleXMnXFxyXFxuXSwgZnVuY3Rpb24gKCQsIFV0aWxzLCBLRVlTKSB7XFxyXFxuICBmdW5jdGlvbiBCYXNlU2VsZWN0aW9uICgkZWxlbWVudCwgb3B0aW9ucykge1xcclxcbiAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XFxyXFxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XFxyXFxuXFxyXFxuICAgIEJhc2VTZWxlY3Rpb24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQoQmFzZVNlbGVjdGlvbiwgVXRpbHMuT2JzZXJ2YWJsZSk7XFxyXFxuXFxyXFxuICBCYXNlU2VsZWN0aW9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHZhciAkc2VsZWN0aW9uID0gJChcXHJcXG4gICAgICAnPHNwYW4gY2xhc3M9XFxcInNlbGVjdDItc2VsZWN0aW9uXFxcIiByb2xlPVxcXCJjb21ib2JveFxcXCIgJyArXFxyXFxuICAgICAgJyBhcmlhLWhhc3BvcHVwPVxcXCJ0cnVlXFxcIiBhcmlhLWV4cGFuZGVkPVxcXCJmYWxzZVxcXCI+JyArXFxyXFxuICAgICAgJzwvc3Bhbj4nXFxyXFxuICAgICk7XFxyXFxuXFxyXFxuICAgIHRoaXMuX3RhYmluZGV4ID0gMDtcXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMuJGVsZW1lbnQuZGF0YSgnb2xkLXRhYmluZGV4JykgIT0gbnVsbCkge1xcclxcbiAgICAgIHRoaXMuX3RhYmluZGV4ID0gdGhpcy4kZWxlbWVudC5kYXRhKCdvbGQtdGFiaW5kZXgnKTtcXHJcXG4gICAgfSBlbHNlIGlmICh0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JykgIT0gbnVsbCkge1xcclxcbiAgICAgIHRoaXMuX3RhYmluZGV4ID0gdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgICRzZWxlY3Rpb24uYXR0cigndGl0bGUnLCB0aGlzLiRlbGVtZW50LmF0dHIoJ3RpdGxlJykpO1xcclxcbiAgICAkc2VsZWN0aW9uLmF0dHIoJ3RhYmluZGV4JywgdGhpcy5fdGFiaW5kZXgpO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24gPSAkc2VsZWN0aW9uO1xcclxcblxcclxcbiAgICByZXR1cm4gJHNlbGVjdGlvbjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBCYXNlU2VsZWN0aW9uLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHZhciBpZCA9IGNvbnRhaW5lci5pZCArICctY29udGFpbmVyJztcXHJcXG4gICAgdmFyIHJlc3VsdHNJZCA9IGNvbnRhaW5lci5pZCArICctcmVzdWx0cyc7XFxyXFxuXFxyXFxuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24ub24oJ2ZvY3VzJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYudHJpZ2dlcignZm9jdXMnLCBldnQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdibHVyJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYuX2hhbmRsZUJsdXIoZXZ0KTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlbGVjdGlvbi5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ2tleXByZXNzJywgZXZ0KTtcXHJcXG5cXHJcXG4gICAgICBpZiAoZXZ0LndoaWNoID09PSBLRVlTLlNQQUNFKSB7XFxyXFxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3Jlc3VsdHM6Zm9jdXMnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi4kc2VsZWN0aW9uLmF0dHIoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIHBhcmFtcy5kYXRhLl9yZXN1bHRJZCk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3NlbGVjdGlvbjp1cGRhdGUnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi51cGRhdGUocGFyYW1zLmRhdGEpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdvcGVuJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIC8vIFdoZW4gdGhlIGRyb3Bkb3duIGlzIG9wZW4sIGFyaWEtZXhwYW5kZWQ9XFxcInRydWVcXFwiXFxyXFxuICAgICAgc2VsZi4kc2VsZWN0aW9uLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xcclxcbiAgICAgIHNlbGYuJHNlbGVjdGlvbi5hdHRyKCdhcmlhLW93bnMnLCByZXN1bHRzSWQpO1xcclxcblxcclxcbiAgICAgIHNlbGYuX2F0dGFjaENsb3NlSGFuZGxlcihjb250YWluZXIpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdjbG9zZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAvLyBXaGVuIHRoZSBkcm9wZG93biBpcyBjbG9zZWQsIGFyaWEtZXhwYW5kZWQ9XFxcImZhbHNlXFxcIlxcclxcbiAgICAgIHNlbGYuJHNlbGVjdGlvbi5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XFxyXFxuICAgICAgc2VsZi4kc2VsZWN0aW9uLnJlbW92ZUF0dHIoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcpO1xcclxcbiAgICAgIHNlbGYuJHNlbGVjdGlvbi5yZW1vdmVBdHRyKCdhcmlhLW93bnMnKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLiRzZWxlY3Rpb24uZm9jdXMoKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLl9kZXRhY2hDbG9zZUhhbmRsZXIoY29udGFpbmVyKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignZW5hYmxlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJHNlbGVjdGlvbi5hdHRyKCd0YWJpbmRleCcsIHNlbGYuX3RhYmluZGV4KTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignZGlzYWJsZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLiRzZWxlY3Rpb24uYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQmFzZVNlbGVjdGlvbi5wcm90b3R5cGUuX2hhbmRsZUJsdXIgPSBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgLy8gVGhpcyBuZWVkcyB0byBiZSBkZWxheWVkIGFzIHRoZSBhY3RpdmUgZWxlbWVudCBpcyB0aGUgYm9keSB3aGVuIHRoZSB0YWJcXHJcXG4gICAgLy8ga2V5IGlzIHByZXNzZWQsIHBvc3NpYmx5IGFsb25nIHdpdGggb3RoZXJzLlxcclxcbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgLy8gRG9uJ3QgdHJpZ2dlciBgYmx1cmAgaWYgdGhlIGZvY3VzIGlzIHN0aWxsIGluIHRoZSBzZWxlY3Rpb25cXHJcXG4gICAgICBpZiAoXFxyXFxuICAgICAgICAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBzZWxmLiRzZWxlY3Rpb25bMF0pIHx8XFxyXFxuICAgICAgICAoJC5jb250YWlucyhzZWxmLiRzZWxlY3Rpb25bMF0sIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKVxcclxcbiAgICAgICkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ2JsdXInLCBldnQpO1xcclxcbiAgICB9LCAxKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBCYXNlU2VsZWN0aW9uLnByb3RvdHlwZS5fYXR0YWNoQ2xvc2VIYW5kbGVyID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgICQoZG9jdW1lbnQuYm9keSkub24oJ21vdXNlZG93bi5zZWxlY3QyLicgKyBjb250YWluZXIuaWQsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgdmFyICR0YXJnZXQgPSAkKGUudGFyZ2V0KTtcXHJcXG5cXHJcXG4gICAgICB2YXIgJHNlbGVjdCA9ICR0YXJnZXQuY2xvc2VzdCgnLnNlbGVjdDInKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgJGFsbCA9ICQoJy5zZWxlY3QyLnNlbGVjdDItY29udGFpbmVyLS1vcGVuJyk7XFxyXFxuXFxyXFxuICAgICAgJGFsbC5lYWNoKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAodGhpcyA9PSAkc2VsZWN0WzBdKSB7XFxyXFxuICAgICAgICAgIHJldHVybjtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIHZhciAkZWxlbWVudCA9ICR0aGlzLmRhdGEoJ2VsZW1lbnQnKTtcXHJcXG5cXHJcXG4gICAgICAgICRlbGVtZW50LnNlbGVjdDIoJ2Nsb3NlJyk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VTZWxlY3Rpb24ucHJvdG90eXBlLl9kZXRhY2hDbG9zZUhhbmRsZXIgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XFxyXFxuICAgICQoZG9jdW1lbnQuYm9keSkub2ZmKCdtb3VzZWRvd24uc2VsZWN0Mi4nICsgY29udGFpbmVyLmlkKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBCYXNlU2VsZWN0aW9uLnByb3RvdHlwZS5wb3NpdGlvbiA9IGZ1bmN0aW9uICgkc2VsZWN0aW9uLCAkY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciAkc2VsZWN0aW9uQ29udGFpbmVyID0gJGNvbnRhaW5lci5maW5kKCcuc2VsZWN0aW9uJyk7XFxyXFxuICAgICRzZWxlY3Rpb25Db250YWluZXIuYXBwZW5kKCRzZWxlY3Rpb24pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VTZWxlY3Rpb24ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHRoaXMuX2RldGFjaENsb3NlSGFuZGxlcih0aGlzLmNvbnRhaW5lcik7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQmFzZVNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgYHVwZGF0ZWAgbWV0aG9kIG11c3QgYmUgZGVmaW5lZCBpbiBjaGlsZCBjbGFzc2VzLicpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBCYXNlU2VsZWN0aW9uO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9zZWxlY3Rpb24vc2luZ2xlJyxbXFxyXFxuICAnanF1ZXJ5JyxcXHJcXG4gICcuL2Jhc2UnLFxcclxcbiAgJy4uL3V0aWxzJyxcXHJcXG4gICcuLi9rZXlzJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCBCYXNlU2VsZWN0aW9uLCBVdGlscywgS0VZUykge1xcclxcbiAgZnVuY3Rpb24gU2luZ2xlU2VsZWN0aW9uICgpIHtcXHJcXG4gICAgU2luZ2xlU2VsZWN0aW9uLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xcclxcbiAgfVxcclxcblxcclxcbiAgVXRpbHMuRXh0ZW5kKFNpbmdsZVNlbGVjdGlvbiwgQmFzZVNlbGVjdGlvbik7XFxyXFxuXFxyXFxuICBTaW5nbGVTZWxlY3Rpb24ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyICRzZWxlY3Rpb24gPSBTaW5nbGVTZWxlY3Rpb24uX19zdXBlcl9fLnJlbmRlci5jYWxsKHRoaXMpO1xcclxcblxcclxcbiAgICAkc2VsZWN0aW9uLmFkZENsYXNzKCdzZWxlY3QyLXNlbGVjdGlvbi0tc2luZ2xlJyk7XFxyXFxuXFxyXFxuICAgICRzZWxlY3Rpb24uaHRtbChcXHJcXG4gICAgICAnPHNwYW4gY2xhc3M9XFxcInNlbGVjdDItc2VsZWN0aW9uX19yZW5kZXJlZFxcXCI+PC9zcGFuPicgK1xcclxcbiAgICAgICc8c3BhbiBjbGFzcz1cXFwic2VsZWN0Mi1zZWxlY3Rpb25fX2Fycm93XFxcIiByb2xlPVxcXCJwcmVzZW50YXRpb25cXFwiPicgK1xcclxcbiAgICAgICAgJzxiIHJvbGU9XFxcInByZXNlbnRhdGlvblxcXCI+PC9iPicgK1xcclxcbiAgICAgICc8L3NwYW4+J1xcclxcbiAgICApO1xcclxcblxcclxcbiAgICByZXR1cm4gJHNlbGVjdGlvbjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTaW5nbGVTZWxlY3Rpb24ucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoY29udGFpbmVyLCAkY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgU2luZ2xlU2VsZWN0aW9uLl9fc3VwZXJfXy5iaW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XFxyXFxuXFxyXFxuICAgIHZhciBpZCA9IGNvbnRhaW5lci5pZCArICctY29udGFpbmVyJztcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLmZpbmQoJy5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5hdHRyKCdpZCcsIGlkKTtcXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLmF0dHIoJ2FyaWEtbGFiZWxsZWRieScsIGlkKTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgLy8gT25seSByZXNwb25kIHRvIGxlZnQgY2xpY2tzXFxyXFxuICAgICAgaWYgKGV2dC53aGljaCAhPT0gMSkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ3RvZ2dsZScsIHtcXHJcXG4gICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2dFxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdmb2N1cycsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICAvLyBVc2VyIGZvY3VzZXMgb24gdGhlIGNvbnRhaW5lclxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdibHVyJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIC8vIFVzZXIgZXhpdHMgdGhlIGNvbnRhaW5lclxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdmb2N1cycsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBpZiAoIWNvbnRhaW5lci5pc09wZW4oKSkge1xcclxcbiAgICAgICAgc2VsZi4kc2VsZWN0aW9uLmZvY3VzKCk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdzZWxlY3Rpb246dXBkYXRlJywgZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgIHNlbGYudXBkYXRlKHBhcmFtcy5kYXRhKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2luZ2xlU2VsZWN0aW9uLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLmZpbmQoJy5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5lbXB0eSgpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNpbmdsZVNlbGVjdGlvbi5wcm90b3R5cGUuZGlzcGxheSA9IGZ1bmN0aW9uIChkYXRhLCBjb250YWluZXIpIHtcXHJcXG4gICAgdmFyIHRlbXBsYXRlID0gdGhpcy5vcHRpb25zLmdldCgndGVtcGxhdGVTZWxlY3Rpb24nKTtcXHJcXG4gICAgdmFyIGVzY2FwZU1hcmt1cCA9IHRoaXMub3B0aW9ucy5nZXQoJ2VzY2FwZU1hcmt1cCcpO1xcclxcblxcclxcbiAgICByZXR1cm4gZXNjYXBlTWFya3VwKHRlbXBsYXRlKGRhdGEsIGNvbnRhaW5lcikpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNpbmdsZVNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0aW9uQ29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICByZXR1cm4gJCgnPHNwYW4+PC9zcGFuPicpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNpbmdsZVNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKSB7XFxyXFxuICAgICAgdGhpcy5jbGVhcigpO1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgc2VsZWN0aW9uID0gZGF0YVswXTtcXHJcXG5cXHJcXG4gICAgdmFyICRyZW5kZXJlZCA9IHRoaXMuJHNlbGVjdGlvbi5maW5kKCcuc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJyk7XFxyXFxuICAgIHZhciBmb3JtYXR0ZWQgPSB0aGlzLmRpc3BsYXkoc2VsZWN0aW9uLCAkcmVuZGVyZWQpO1xcclxcblxcclxcbiAgICAkcmVuZGVyZWQuZW1wdHkoKS5hcHBlbmQoZm9ybWF0dGVkKTtcXHJcXG4gICAgJHJlbmRlcmVkLnByb3AoJ3RpdGxlJywgc2VsZWN0aW9uLnRpdGxlIHx8IHNlbGVjdGlvbi50ZXh0KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gU2luZ2xlU2VsZWN0aW9uO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9zZWxlY3Rpb24vbXVsdGlwbGUnLFtcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJy4vYmFzZScsXFxyXFxuICAnLi4vdXRpbHMnXFxyXFxuXSwgZnVuY3Rpb24gKCQsIEJhc2VTZWxlY3Rpb24sIFV0aWxzKSB7XFxyXFxuICBmdW5jdGlvbiBNdWx0aXBsZVNlbGVjdGlvbiAoJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgTXVsdGlwbGVTZWxlY3Rpb24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQoTXVsdGlwbGVTZWxlY3Rpb24sIEJhc2VTZWxlY3Rpb24pO1xcclxcblxcclxcbiAgTXVsdGlwbGVTZWxlY3Rpb24ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyICRzZWxlY3Rpb24gPSBNdWx0aXBsZVNlbGVjdGlvbi5fX3N1cGVyX18ucmVuZGVyLmNhbGwodGhpcyk7XFxyXFxuXFxyXFxuICAgICRzZWxlY3Rpb24uYWRkQ2xhc3MoJ3NlbGVjdDItc2VsZWN0aW9uLS1tdWx0aXBsZScpO1xcclxcblxcclxcbiAgICAkc2VsZWN0aW9uLmh0bWwoXFxyXFxuICAgICAgJzx1bCBjbGFzcz1cXFwic2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkXFxcIj48L3VsPidcXHJcXG4gICAgKTtcXHJcXG5cXHJcXG4gICAgcmV0dXJuICRzZWxlY3Rpb247XFxyXFxuICB9O1xcclxcblxcclxcbiAgTXVsdGlwbGVTZWxlY3Rpb24ucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoY29udGFpbmVyLCAkY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgTXVsdGlwbGVTZWxlY3Rpb24uX19zdXBlcl9fLmJpbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ3RvZ2dsZScsIHtcXHJcXG4gICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2dFxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKFxcclxcbiAgICAgICdjbGljaycsXFxyXFxuICAgICAgJy5zZWxlY3QyLXNlbGVjdGlvbl9fY2hvaWNlX19yZW1vdmUnLFxcclxcbiAgICAgIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICAgIC8vIElnbm9yZSB0aGUgZXZlbnQgaWYgaXQgaXMgZGlzYWJsZWRcXHJcXG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMuZ2V0KCdkaXNhYmxlZCcpKSB7XFxyXFxuICAgICAgICAgIHJldHVybjtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIHZhciAkcmVtb3ZlID0gJCh0aGlzKTtcXHJcXG4gICAgICAgIHZhciAkc2VsZWN0aW9uID0gJHJlbW92ZS5wYXJlbnQoKTtcXHJcXG5cXHJcXG4gICAgICAgIHZhciBkYXRhID0gJHNlbGVjdGlvbi5kYXRhKCdkYXRhJyk7XFxyXFxuXFxyXFxuICAgICAgICBzZWxmLnRyaWdnZXIoJ3Vuc2VsZWN0Jywge1xcclxcbiAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldnQsXFxyXFxuICAgICAgICAgIGRhdGE6IGRhdGFcXHJcXG4gICAgICAgIH0pO1xcclxcbiAgICAgIH1cXHJcXG4gICAgKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBNdWx0aXBsZVNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHRoaXMuJHNlbGVjdGlvbi5maW5kKCcuc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJykuZW1wdHkoKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBNdWx0aXBsZVNlbGVjdGlvbi5wcm90b3R5cGUuZGlzcGxheSA9IGZ1bmN0aW9uIChkYXRhLCBjb250YWluZXIpIHtcXHJcXG4gICAgdmFyIHRlbXBsYXRlID0gdGhpcy5vcHRpb25zLmdldCgndGVtcGxhdGVTZWxlY3Rpb24nKTtcXHJcXG4gICAgdmFyIGVzY2FwZU1hcmt1cCA9IHRoaXMub3B0aW9ucy5nZXQoJ2VzY2FwZU1hcmt1cCcpO1xcclxcblxcclxcbiAgICByZXR1cm4gZXNjYXBlTWFya3VwKHRlbXBsYXRlKGRhdGEsIGNvbnRhaW5lcikpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIE11bHRpcGxlU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3Rpb25Db250YWluZXIgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHZhciAkY29udGFpbmVyID0gJChcXHJcXG4gICAgICAnPGxpIGNsYXNzPVxcXCJzZWxlY3QyLXNlbGVjdGlvbl9fY2hvaWNlXFxcIj4nICtcXHJcXG4gICAgICAgICc8c3BhbiBjbGFzcz1cXFwic2VsZWN0Mi1zZWxlY3Rpb25fX2Nob2ljZV9fcmVtb3ZlXFxcIiByb2xlPVxcXCJwcmVzZW50YXRpb25cXFwiPicgK1xcclxcbiAgICAgICAgICAnJnRpbWVzOycgK1xcclxcbiAgICAgICAgJzwvc3Bhbj4nICtcXHJcXG4gICAgICAnPC9saT4nXFxyXFxuICAgICk7XFxyXFxuXFxyXFxuICAgIHJldHVybiAkY29udGFpbmVyO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIE11bHRpcGxlU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICB0aGlzLmNsZWFyKCk7XFxyXFxuXFxyXFxuICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgJHNlbGVjdGlvbnMgPSBbXTtcXHJcXG5cXHJcXG4gICAgZm9yICh2YXIgZCA9IDA7IGQgPCBkYXRhLmxlbmd0aDsgZCsrKSB7XFxyXFxuICAgICAgdmFyIHNlbGVjdGlvbiA9IGRhdGFbZF07XFxyXFxuXFxyXFxuICAgICAgdmFyICRzZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvbkNvbnRhaW5lcigpO1xcclxcbiAgICAgIHZhciBmb3JtYXR0ZWQgPSB0aGlzLmRpc3BsYXkoc2VsZWN0aW9uLCAkc2VsZWN0aW9uKTtcXHJcXG5cXHJcXG4gICAgICAkc2VsZWN0aW9uLmFwcGVuZChmb3JtYXR0ZWQpO1xcclxcbiAgICAgICRzZWxlY3Rpb24ucHJvcCgndGl0bGUnLCBzZWxlY3Rpb24udGl0bGUgfHwgc2VsZWN0aW9uLnRleHQpO1xcclxcblxcclxcbiAgICAgICRzZWxlY3Rpb24uZGF0YSgnZGF0YScsIHNlbGVjdGlvbik7XFxyXFxuXFxyXFxuICAgICAgJHNlbGVjdGlvbnMucHVzaCgkc2VsZWN0aW9uKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgJHJlbmRlcmVkID0gdGhpcy4kc2VsZWN0aW9uLmZpbmQoJy5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKTtcXHJcXG5cXHJcXG4gICAgVXRpbHMuYXBwZW5kTWFueSgkcmVuZGVyZWQsICRzZWxlY3Rpb25zKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gTXVsdGlwbGVTZWxlY3Rpb247XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL3NlbGVjdGlvbi9wbGFjZWhvbGRlcicsW1xcclxcbiAgJy4uL3V0aWxzJ1xcclxcbl0sIGZ1bmN0aW9uIChVdGlscykge1xcclxcbiAgZnVuY3Rpb24gUGxhY2Vob2xkZXIgKGRlY29yYXRlZCwgJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMubm9ybWFsaXplUGxhY2Vob2xkZXIob3B0aW9ucy5nZXQoJ3BsYWNlaG9sZGVyJykpO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCAkZWxlbWVudCwgb3B0aW9ucyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBQbGFjZWhvbGRlci5wcm90b3R5cGUubm9ybWFsaXplUGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoXywgcGxhY2Vob2xkZXIpIHtcXHJcXG4gICAgaWYgKHR5cGVvZiBwbGFjZWhvbGRlciA9PT0gJ3N0cmluZycpIHtcXHJcXG4gICAgICBwbGFjZWhvbGRlciA9IHtcXHJcXG4gICAgICAgIGlkOiAnJyxcXHJcXG4gICAgICAgIHRleHQ6IHBsYWNlaG9sZGVyXFxyXFxuICAgICAgfTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gcGxhY2Vob2xkZXI7XFxyXFxuICB9O1xcclxcblxcclxcbiAgUGxhY2Vob2xkZXIucHJvdG90eXBlLmNyZWF0ZVBsYWNlaG9sZGVyID0gZnVuY3Rpb24gKGRlY29yYXRlZCwgcGxhY2Vob2xkZXIpIHtcXHJcXG4gICAgdmFyICRwbGFjZWhvbGRlciA9IHRoaXMuc2VsZWN0aW9uQ29udGFpbmVyKCk7XFxyXFxuXFxyXFxuICAgICRwbGFjZWhvbGRlci5odG1sKHRoaXMuZGlzcGxheShwbGFjZWhvbGRlcikpO1xcclxcbiAgICAkcGxhY2Vob2xkZXIuYWRkQ2xhc3MoJ3NlbGVjdDItc2VsZWN0aW9uX19wbGFjZWhvbGRlcicpXFxyXFxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnc2VsZWN0Mi1zZWxlY3Rpb25fX2Nob2ljZScpO1xcclxcblxcclxcbiAgICByZXR1cm4gJHBsYWNlaG9sZGVyO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFBsYWNlaG9sZGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBkYXRhKSB7XFxyXFxuICAgIHZhciBzaW5nbGVQbGFjZWhvbGRlciA9IChcXHJcXG4gICAgICBkYXRhLmxlbmd0aCA9PSAxICYmIGRhdGFbMF0uaWQgIT0gdGhpcy5wbGFjZWhvbGRlci5pZFxcclxcbiAgICApO1xcclxcbiAgICB2YXIgbXVsdGlwbGVTZWxlY3Rpb25zID0gZGF0YS5sZW5ndGggPiAxO1xcclxcblxcclxcbiAgICBpZiAobXVsdGlwbGVTZWxlY3Rpb25zIHx8IHNpbmdsZVBsYWNlaG9sZGVyKSB7XFxyXFxuICAgICAgcmV0dXJuIGRlY29yYXRlZC5jYWxsKHRoaXMsIGRhdGEpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuY2xlYXIoKTtcXHJcXG5cXHJcXG4gICAgdmFyICRwbGFjZWhvbGRlciA9IHRoaXMuY3JlYXRlUGxhY2Vob2xkZXIodGhpcy5wbGFjZWhvbGRlcik7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlbGVjdGlvbi5maW5kKCcuc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJykuYXBwZW5kKCRwbGFjZWhvbGRlcik7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIFBsYWNlaG9sZGVyO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9zZWxlY3Rpb24vYWxsb3dDbGVhcicsW1xcclxcbiAgJ2pxdWVyeScsXFxyXFxuICAnLi4va2V5cydcXHJcXG5dLCBmdW5jdGlvbiAoJCwgS0VZUykge1xcclxcbiAgZnVuY3Rpb24gQWxsb3dDbGVhciAoKSB7IH1cXHJcXG5cXHJcXG4gIEFsbG93Q2xlYXIucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBjb250YWluZXIsICRjb250YWluZXIpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCBjb250YWluZXIsICRjb250YWluZXIpO1xcclxcblxcclxcbiAgICBpZiAodGhpcy5wbGFjZWhvbGRlciA9PSBudWxsKSB7XFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5nZXQoJ2RlYnVnJykgJiYgd2luZG93LmNvbnNvbGUgJiYgY29uc29sZS5lcnJvcikge1xcclxcbiAgICAgICAgY29uc29sZS5lcnJvcihcXHJcXG4gICAgICAgICAgJ1NlbGVjdDI6IFRoZSBgYWxsb3dDbGVhcmAgb3B0aW9uIHNob3VsZCBiZSB1c2VkIGluIGNvbWJpbmF0aW9uICcgK1xcclxcbiAgICAgICAgICAnd2l0aCB0aGUgYHBsYWNlaG9sZGVyYCBvcHRpb24uJ1xcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdtb3VzZWRvd24nLCAnLnNlbGVjdDItc2VsZWN0aW9uX19jbGVhcicsXFxyXFxuICAgICAgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgICAgc2VsZi5faGFuZGxlQ2xlYXIoZXZ0KTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbigna2V5cHJlc3MnLCBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgc2VsZi5faGFuZGxlS2V5Ym9hcmRDbGVhcihldnQsIGNvbnRhaW5lcik7XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEFsbG93Q2xlYXIucHJvdG90eXBlLl9oYW5kbGVDbGVhciA9IGZ1bmN0aW9uIChfLCBldnQpIHtcXHJcXG4gICAgLy8gSWdub3JlIHRoZSBldmVudCBpZiBpdCBpcyBkaXNhYmxlZFxcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZWQnKSkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgJGNsZWFyID0gdGhpcy4kc2VsZWN0aW9uLmZpbmQoJy5zZWxlY3QyLXNlbGVjdGlvbl9fY2xlYXInKTtcXHJcXG5cXHJcXG4gICAgLy8gSWdub3JlIHRoZSBldmVudCBpZiBub3RoaW5nIGhhcyBiZWVuIHNlbGVjdGVkXFxyXFxuICAgIGlmICgkY2xlYXIubGVuZ3RoID09PSAwKSB7XFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcXHJcXG5cXHJcXG4gICAgdmFyIGRhdGEgPSAkY2xlYXIuZGF0YSgnZGF0YScpO1xcclxcblxcclxcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRhdGEubGVuZ3RoOyBkKyspIHtcXHJcXG4gICAgICB2YXIgdW5zZWxlY3REYXRhID0ge1xcclxcbiAgICAgICAgZGF0YTogZGF0YVtkXVxcclxcbiAgICAgIH07XFxyXFxuXFxyXFxuICAgICAgLy8gVHJpZ2dlciB0aGUgYHVuc2VsZWN0YCBldmVudCwgc28gcGVvcGxlIGNhbiBwcmV2ZW50IGl0IGZyb20gYmVpbmdcXHJcXG4gICAgICAvLyBjbGVhcmVkLlxcclxcbiAgICAgIHRoaXMudHJpZ2dlcigndW5zZWxlY3QnLCB1bnNlbGVjdERhdGEpO1xcclxcblxcclxcbiAgICAgIC8vIElmIHRoZSBldmVudCB3YXMgcHJldmVudGVkLCBkb24ndCBjbGVhciBpdCBvdXQuXFxyXFxuICAgICAgaWYgKHVuc2VsZWN0RGF0YS5wcmV2ZW50ZWQpIHtcXHJcXG4gICAgICAgIHJldHVybjtcXHJcXG4gICAgICB9XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy4kZWxlbWVudC52YWwodGhpcy5wbGFjZWhvbGRlci5pZCkudHJpZ2dlcignY2hhbmdlJyk7XFxyXFxuXFxyXFxuICAgIHRoaXMudHJpZ2dlcigndG9nZ2xlJywge30pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEFsbG93Q2xlYXIucHJvdG90eXBlLl9oYW5kbGVLZXlib2FyZENsZWFyID0gZnVuY3Rpb24gKF8sIGV2dCwgY29udGFpbmVyKSB7XFxyXFxuICAgIGlmIChjb250YWluZXIuaXNPcGVuKCkpIHtcXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKGV2dC53aGljaCA9PSBLRVlTLkRFTEVURSB8fCBldnQud2hpY2ggPT0gS0VZUy5CQUNLU1BBQ0UpIHtcXHJcXG4gICAgICB0aGlzLl9oYW5kbGVDbGVhcihldnQpO1xcclxcbiAgICB9XFxyXFxuICB9O1xcclxcblxcclxcbiAgQWxsb3dDbGVhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRlY29yYXRlZCwgZGF0YSkge1xcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCBkYXRhKTtcXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMuJHNlbGVjdGlvbi5maW5kKCcuc2VsZWN0Mi1zZWxlY3Rpb25fX3BsYWNlaG9sZGVyJykubGVuZ3RoID4gMCB8fFxcclxcbiAgICAgICAgZGF0YS5sZW5ndGggPT09IDApIHtcXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdmFyICRyZW1vdmUgPSAkKFxcclxcbiAgICAgICc8c3BhbiBjbGFzcz1cXFwic2VsZWN0Mi1zZWxlY3Rpb25fX2NsZWFyXFxcIj4nICtcXHJcXG4gICAgICAgICcmdGltZXM7JyArXFxyXFxuICAgICAgJzwvc3Bhbj4nXFxyXFxuICAgICk7XFxyXFxuICAgICRyZW1vdmUuZGF0YSgnZGF0YScsIGRhdGEpO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24uZmluZCgnLnNlbGVjdDItc2VsZWN0aW9uX19yZW5kZXJlZCcpLnByZXBlbmQoJHJlbW92ZSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIEFsbG93Q2xlYXI7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL3NlbGVjdGlvbi9zZWFyY2gnLFtcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJy4uL3V0aWxzJyxcXHJcXG4gICcuLi9rZXlzJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCBVdGlscywgS0VZUykge1xcclxcbiAgZnVuY3Rpb24gU2VhcmNoIChkZWNvcmF0ZWQsICRlbGVtZW50LCBvcHRpb25zKSB7XFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsICRlbGVtZW50LCBvcHRpb25zKTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIFNlYXJjaC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGRlY29yYXRlZCkge1xcclxcbiAgICB2YXIgJHNlYXJjaCA9ICQoXFxyXFxuICAgICAgJzxsaSBjbGFzcz1cXFwic2VsZWN0Mi1zZWFyY2ggc2VsZWN0Mi1zZWFyY2gtLWlubGluZVxcXCI+JyArXFxyXFxuICAgICAgICAnPGlucHV0IGNsYXNzPVxcXCJzZWxlY3QyLXNlYXJjaF9fZmllbGRcXFwiIHR5cGU9XFxcInNlYXJjaFxcXCIgdGFiaW5kZXg9XFxcIi0xXFxcIicgK1xcclxcbiAgICAgICAgJyBhdXRvY29tcGxldGU9XFxcIm9mZlxcXCIgYXV0b2NvcnJlY3Q9XFxcIm9mZlxcXCIgYXV0b2NhcGl0YWxpemU9XFxcIm9mZlxcXCInICtcXHJcXG4gICAgICAgICcgc3BlbGxjaGVjaz1cXFwiZmFsc2VcXFwiIHJvbGU9XFxcInRleHRib3hcXFwiIGFyaWEtYXV0b2NvbXBsZXRlPVxcXCJsaXN0XFxcIiAvPicgK1xcclxcbiAgICAgICc8L2xpPidcXHJcXG4gICAgKTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VhcmNoQ29udGFpbmVyID0gJHNlYXJjaDtcXHJcXG4gICAgdGhpcy4kc2VhcmNoID0gJHNlYXJjaC5maW5kKCdpbnB1dCcpO1xcclxcblxcclxcbiAgICB2YXIgJHJlbmRlcmVkID0gZGVjb3JhdGVkLmNhbGwodGhpcyk7XFxyXFxuXFxyXFxuICAgIHRoaXMuX3RyYW5zZmVyVGFiSW5kZXgoKTtcXHJcXG5cXHJcXG4gICAgcmV0dXJuICRyZW5kZXJlZDtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWFyY2gucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBjb250YWluZXIsICRjb250YWluZXIpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCBjb250YWluZXIsICRjb250YWluZXIpO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ29wZW4nLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgc2VsZi4kc2VhcmNoLnRyaWdnZXIoJ2ZvY3VzJyk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ2Nsb3NlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC52YWwoJycpO1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC5yZW1vdmVBdHRyKCdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnKTtcXHJcXG4gICAgICBzZWxmLiRzZWFyY2gudHJpZ2dlcignZm9jdXMnKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignZW5hYmxlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLl90cmFuc2ZlclRhYkluZGV4KCk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ2Rpc2FibGUnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgc2VsZi4kc2VhcmNoLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ2ZvY3VzJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC50cmlnZ2VyKCdmb2N1cycpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOmZvY3VzJywgZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC5hdHRyKCdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnLCBwYXJhbXMuaWQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdmb2N1c2luJywgJy5zZWxlY3QyLXNlYXJjaC0taW5saW5lJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYudHJpZ2dlcignZm9jdXMnLCBldnQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKCdmb2N1c291dCcsICcuc2VsZWN0Mi1zZWFyY2gtLWlubGluZScsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLl9oYW5kbGVCbHVyKGV2dCk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24ub24oJ2tleWRvd24nLCAnLnNlbGVjdDItc2VhcmNoLS1pbmxpbmUnLCBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xcclxcblxcclxcbiAgICAgIHNlbGYudHJpZ2dlcigna2V5cHJlc3MnLCBldnQpO1xcclxcblxcclxcbiAgICAgIHNlbGYuX2tleVVwUHJldmVudGVkID0gZXZ0LmlzRGVmYXVsdFByZXZlbnRlZCgpO1xcclxcblxcclxcbiAgICAgIHZhciBrZXkgPSBldnQud2hpY2g7XFxyXFxuXFxyXFxuICAgICAgaWYgKGtleSA9PT0gS0VZUy5CQUNLU1BBQ0UgJiYgc2VsZi4kc2VhcmNoLnZhbCgpID09PSAnJykge1xcclxcbiAgICAgICAgdmFyICRwcmV2aW91c0Nob2ljZSA9IHNlbGYuJHNlYXJjaENvbnRhaW5lclxcclxcbiAgICAgICAgICAucHJldignLnNlbGVjdDItc2VsZWN0aW9uX19jaG9pY2UnKTtcXHJcXG5cXHJcXG4gICAgICAgIGlmICgkcHJldmlvdXNDaG9pY2UubGVuZ3RoID4gMCkge1xcclxcbiAgICAgICAgICB2YXIgaXRlbSA9ICRwcmV2aW91c0Nob2ljZS5kYXRhKCdkYXRhJyk7XFxyXFxuXFxyXFxuICAgICAgICAgIHNlbGYuc2VhcmNoUmVtb3ZlQ2hvaWNlKGl0ZW0pO1xcclxcblxcclxcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICAvLyBUcnkgdG8gZGV0ZWN0IHRoZSBJRSB2ZXJzaW9uIHNob3VsZCB0aGUgYGRvY3VtZW50TW9kZWAgcHJvcGVydHkgdGhhdFxcclxcbiAgICAvLyBpcyBzdG9yZWQgb24gdGhlIGRvY3VtZW50LiBUaGlzIGlzIG9ubHkgaW1wbGVtZW50ZWQgaW4gSUUgYW5kIGlzXFxyXFxuICAgIC8vIHNsaWdodGx5IGNsZWFuZXIgdGhhbiBkb2luZyBhIHVzZXIgYWdlbnQgY2hlY2suXFxyXFxuICAgIC8vIFRoaXMgcHJvcGVydHkgaXMgbm90IGF2YWlsYWJsZSBpbiBFZGdlLCBidXQgRWRnZSBhbHNvIGRvZXNuJ3QgaGF2ZVxcclxcbiAgICAvLyB0aGlzIGJ1Zy5cXHJcXG4gICAgdmFyIG1zaWUgPSBkb2N1bWVudC5kb2N1bWVudE1vZGU7XFxyXFxuICAgIHZhciBkaXNhYmxlSW5wdXRFdmVudHMgPSBtc2llICYmIG1zaWUgPD0gMTE7XFxyXFxuXFxyXFxuICAgIC8vIFdvcmthcm91bmQgZm9yIGJyb3dzZXJzIHdoaWNoIGRvIG5vdCBzdXBwb3J0IHRoZSBgaW5wdXRgIGV2ZW50XFxyXFxuICAgIC8vIFRoaXMgd2lsbCBwcmV2ZW50IGRvdWJsZS10cmlnZ2VyaW5nIG9mIGV2ZW50cyBmb3IgYnJvd3NlcnMgd2hpY2ggc3VwcG9ydFxcclxcbiAgICAvLyBib3RoIHRoZSBga2V5dXBgIGFuZCBgaW5wdXRgIGV2ZW50cy5cXHJcXG4gICAgdGhpcy4kc2VsZWN0aW9uLm9uKFxcclxcbiAgICAgICdpbnB1dC5zZWFyY2hjaGVjaycsXFxyXFxuICAgICAgJy5zZWxlY3QyLXNlYXJjaC0taW5saW5lJyxcXHJcXG4gICAgICBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgICAgICAvLyBJRSB3aWxsIHRyaWdnZXIgdGhlIGBpbnB1dGAgZXZlbnQgd2hlbiBhIHBsYWNlaG9sZGVyIGlzIHVzZWQgb24gYVxcclxcbiAgICAgICAgLy8gc2VhcmNoIGJveC4gVG8gZ2V0IGFyb3VuZCB0aGlzIGlzc3VlLCB3ZSBhcmUgZm9yY2VkIHRvIGlnbm9yZSBhbGxcXHJcXG4gICAgICAgIC8vIGBpbnB1dGAgZXZlbnRzIGluIElFIGFuZCBrZWVwIHVzaW5nIGBrZXl1cGAuXFxyXFxuICAgICAgICBpZiAoZGlzYWJsZUlucHV0RXZlbnRzKSB7XFxyXFxuICAgICAgICAgIHNlbGYuJHNlbGVjdGlvbi5vZmYoJ2lucHV0LnNlYXJjaCBpbnB1dC5zZWFyY2hjaGVjaycpO1xcclxcbiAgICAgICAgICByZXR1cm47XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAvLyBVbmJpbmQgdGhlIGR1cGxpY2F0ZWQgYGtleXVwYCBldmVudFxcclxcbiAgICAgICAgc2VsZi4kc2VsZWN0aW9uLm9mZigna2V5dXAuc2VhcmNoJyk7XFxyXFxuICAgICAgfVxcclxcbiAgICApO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24ub24oXFxyXFxuICAgICAgJ2tleXVwLnNlYXJjaCBpbnB1dC5zZWFyY2gnLFxcclxcbiAgICAgICcuc2VsZWN0Mi1zZWFyY2gtLWlubGluZScsXFxyXFxuICAgICAgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgICAgLy8gSUUgd2lsbCB0cmlnZ2VyIHRoZSBgaW5wdXRgIGV2ZW50IHdoZW4gYSBwbGFjZWhvbGRlciBpcyB1c2VkIG9uIGFcXHJcXG4gICAgICAgIC8vIHNlYXJjaCBib3guIFRvIGdldCBhcm91bmQgdGhpcyBpc3N1ZSwgd2UgYXJlIGZvcmNlZCB0byBpZ25vcmUgYWxsXFxyXFxuICAgICAgICAvLyBgaW5wdXRgIGV2ZW50cyBpbiBJRSBhbmQga2VlcCB1c2luZyBga2V5dXBgLlxcclxcbiAgICAgICAgaWYgKGRpc2FibGVJbnB1dEV2ZW50cyAmJiBldnQudHlwZSA9PT0gJ2lucHV0Jykge1xcclxcbiAgICAgICAgICBzZWxmLiRzZWxlY3Rpb24ub2ZmKCdpbnB1dC5zZWFyY2ggaW5wdXQuc2VhcmNoY2hlY2snKTtcXHJcXG4gICAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgdmFyIGtleSA9IGV2dC53aGljaDtcXHJcXG5cXHJcXG4gICAgICAgIC8vIFdlIGNhbiBmcmVlbHkgaWdub3JlIGV2ZW50cyBmcm9tIG1vZGlmaWVyIGtleXNcXHJcXG4gICAgICAgIGlmIChrZXkgPT0gS0VZUy5TSElGVCB8fCBrZXkgPT0gS0VZUy5DVFJMIHx8IGtleSA9PSBLRVlTLkFMVCkge1xcclxcbiAgICAgICAgICByZXR1cm47XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAvLyBUYWJiaW5nIHdpbGwgYmUgaGFuZGxlZCBkdXJpbmcgdGhlIGBrZXlkb3duYCBwaGFzZVxcclxcbiAgICAgICAgaWYgKGtleSA9PSBLRVlTLlRBQikge1xcclxcbiAgICAgICAgICByZXR1cm47XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBzZWxmLmhhbmRsZVNlYXJjaChldnQpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICAvKipcXHJcXG4gICAqIFRoaXMgbWV0aG9kIHdpbGwgdHJhbnNmZXIgdGhlIHRhYmluZGV4IGF0dHJpYnV0ZSBmcm9tIHRoZSByZW5kZXJlZFxcclxcbiAgICogc2VsZWN0aW9uIHRvIHRoZSBzZWFyY2ggYm94LiBUaGlzIGFsbG93cyBmb3IgdGhlIHNlYXJjaCBib3ggdG8gYmUgdXNlZCBhc1xcclxcbiAgICogdGhlIHByaW1hcnkgZm9jdXMgaW5zdGVhZCBvZiB0aGUgc2VsZWN0aW9uIGNvbnRhaW5lci5cXHJcXG4gICAqXFxyXFxuICAgKiBAcHJpdmF0ZVxcclxcbiAgICovXFxyXFxuICBTZWFyY2gucHJvdG90eXBlLl90cmFuc2ZlclRhYkluZGV4ID0gZnVuY3Rpb24gKGRlY29yYXRlZCkge1xcclxcbiAgICB0aGlzLiRzZWFyY2guYXR0cigndGFiaW5kZXgnLCB0aGlzLiRzZWxlY3Rpb24uYXR0cigndGFiaW5kZXgnKSk7XFxyXFxuICAgIHRoaXMuJHNlbGVjdGlvbi5hdHRyKCd0YWJpbmRleCcsICctMScpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlYXJjaC5wcm90b3R5cGUuY3JlYXRlUGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBwbGFjZWhvbGRlcikge1xcclxcbiAgICB0aGlzLiRzZWFyY2guYXR0cigncGxhY2Vob2xkZXInLCBwbGFjZWhvbGRlci50ZXh0KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWFyY2gucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGRhdGEpIHtcXHJcXG4gICAgdmFyIHNlYXJjaEhhZEZvY3VzID0gdGhpcy4kc2VhcmNoWzBdID09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlYXJjaC5hdHRyKCdwbGFjZWhvbGRlcicsICcnKTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgZGF0YSk7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlbGVjdGlvbi5maW5kKCcuc2VsZWN0Mi1zZWxlY3Rpb25fX3JlbmRlcmVkJylcXHJcXG4gICAgICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLiRzZWFyY2hDb250YWluZXIpO1xcclxcblxcclxcbiAgICB0aGlzLnJlc2l6ZVNlYXJjaCgpO1xcclxcbiAgICBpZiAoc2VhcmNoSGFkRm9jdXMpIHtcXHJcXG4gICAgICB0aGlzLiRzZWFyY2guZm9jdXMoKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlYXJjaC5wcm90b3R5cGUuaGFuZGxlU2VhcmNoID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB0aGlzLnJlc2l6ZVNlYXJjaCgpO1xcclxcblxcclxcbiAgICBpZiAoIXRoaXMuX2tleVVwUHJldmVudGVkKSB7XFxyXFxuICAgICAgdmFyIGlucHV0ID0gdGhpcy4kc2VhcmNoLnZhbCgpO1xcclxcblxcclxcbiAgICAgIHRoaXMudHJpZ2dlcigncXVlcnknLCB7XFxyXFxuICAgICAgICB0ZXJtOiBpbnB1dFxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuX2tleVVwUHJldmVudGVkID0gZmFsc2U7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VhcmNoLnByb3RvdHlwZS5zZWFyY2hSZW1vdmVDaG9pY2UgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBpdGVtKSB7XFxyXFxuICAgIHRoaXMudHJpZ2dlcigndW5zZWxlY3QnLCB7XFxyXFxuICAgICAgZGF0YTogaXRlbVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VhcmNoLnZhbChpdGVtLnRleHQpO1xcclxcbiAgICB0aGlzLmhhbmRsZVNlYXJjaCgpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlYXJjaC5wcm90b3R5cGUucmVzaXplU2VhcmNoID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB0aGlzLiRzZWFyY2guY3NzKCd3aWR0aCcsICcyNXB4Jyk7XFxyXFxuXFxyXFxuICAgIHZhciB3aWR0aCA9ICcnO1xcclxcblxcclxcbiAgICBpZiAodGhpcy4kc2VhcmNoLmF0dHIoJ3BsYWNlaG9sZGVyJykgIT09ICcnKSB7XFxyXFxuICAgICAgd2lkdGggPSB0aGlzLiRzZWxlY3Rpb24uZmluZCgnLnNlbGVjdDItc2VsZWN0aW9uX19yZW5kZXJlZCcpLmlubmVyV2lkdGgoKTtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICB2YXIgbWluaW11bVdpZHRoID0gdGhpcy4kc2VhcmNoLnZhbCgpLmxlbmd0aCArIDE7XFxyXFxuXFxyXFxuICAgICAgd2lkdGggPSAobWluaW11bVdpZHRoICogMC43NSkgKyAnZW0nO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlYXJjaC5jc3MoJ3dpZHRoJywgd2lkdGgpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBTZWFyY2g7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL3NlbGVjdGlvbi9ldmVudFJlbGF5JyxbXFxyXFxuICAnanF1ZXJ5J1xcclxcbl0sIGZ1bmN0aW9uICgkKSB7XFxyXFxuICBmdW5jdGlvbiBFdmVudFJlbGF5ICgpIHsgfVxcclxcblxcclxcbiAgRXZlbnRSZWxheS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuICAgIHZhciByZWxheUV2ZW50cyA9IFtcXHJcXG4gICAgICAnb3BlbicsICdvcGVuaW5nJyxcXHJcXG4gICAgICAnY2xvc2UnLCAnY2xvc2luZycsXFxyXFxuICAgICAgJ3NlbGVjdCcsICdzZWxlY3RpbmcnLFxcclxcbiAgICAgICd1bnNlbGVjdCcsICd1bnNlbGVjdGluZydcXHJcXG4gICAgXTtcXHJcXG5cXHJcXG4gICAgdmFyIHByZXZlbnRhYmxlRXZlbnRzID0gWydvcGVuaW5nJywgJ2Nsb3NpbmcnLCAnc2VsZWN0aW5nJywgJ3Vuc2VsZWN0aW5nJ107XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIGNvbnRhaW5lciwgJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignKicsIGZ1bmN0aW9uIChuYW1lLCBwYXJhbXMpIHtcXHJcXG4gICAgICAvLyBJZ25vcmUgZXZlbnRzIHRoYXQgc2hvdWxkIG5vdCBiZSByZWxheWVkXFxyXFxuICAgICAgaWYgKCQuaW5BcnJheShuYW1lLCByZWxheUV2ZW50cykgPT09IC0xKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIC8vIFRoZSBwYXJhbWV0ZXJzIHNob3VsZCBhbHdheXMgYmUgYW4gb2JqZWN0XFxyXFxuICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xcclxcblxcclxcbiAgICAgIC8vIEdlbmVyYXRlIHRoZSBqUXVlcnkgZXZlbnQgZm9yIHRoZSBTZWxlY3QyIGV2ZW50XFxyXFxuICAgICAgdmFyIGV2dCA9ICQuRXZlbnQoJ3NlbGVjdDI6JyArIG5hbWUsIHtcXHJcXG4gICAgICAgIHBhcmFtczogcGFyYW1zXFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgc2VsZi4kZWxlbWVudC50cmlnZ2VyKGV2dCk7XFxyXFxuXFxyXFxuICAgICAgLy8gT25seSBoYW5kbGUgcHJldmVudGFibGUgZXZlbnRzIGlmIGl0IHdhcyBvbmVcXHJcXG4gICAgICBpZiAoJC5pbkFycmF5KG5hbWUsIHByZXZlbnRhYmxlRXZlbnRzKSA9PT0gLTEpIHtcXHJcXG4gICAgICAgIHJldHVybjtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcGFyYW1zLnByZXZlbnRlZCA9IGV2dC5pc0RlZmF1bHRQcmV2ZW50ZWQoKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIEV2ZW50UmVsYXk7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL3RyYW5zbGF0aW9uJyxbXFxyXFxuICAnanF1ZXJ5JyxcXHJcXG4gICdyZXF1aXJlJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCByZXF1aXJlKSB7XFxyXFxuICBmdW5jdGlvbiBUcmFuc2xhdGlvbiAoZGljdCkge1xcclxcbiAgICB0aGlzLmRpY3QgPSBkaWN0IHx8IHt9O1xcclxcbiAgfVxcclxcblxcclxcbiAgVHJhbnNsYXRpb24ucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgcmV0dXJuIHRoaXMuZGljdDtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBUcmFuc2xhdGlvbi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xcclxcbiAgICByZXR1cm4gdGhpcy5kaWN0W2tleV07XFxyXFxuICB9O1xcclxcblxcclxcbiAgVHJhbnNsYXRpb24ucHJvdG90eXBlLmV4dGVuZCA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbikge1xcclxcbiAgICB0aGlzLmRpY3QgPSAkLmV4dGVuZCh7fSwgdHJhbnNsYXRpb24uYWxsKCksIHRoaXMuZGljdCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgLy8gU3RhdGljIGZ1bmN0aW9uc1xcclxcblxcclxcbiAgVHJhbnNsYXRpb24uX2NhY2hlID0ge307XFxyXFxuXFxyXFxuICBUcmFuc2xhdGlvbi5sb2FkUGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XFxyXFxuICAgIGlmICghKHBhdGggaW4gVHJhbnNsYXRpb24uX2NhY2hlKSkge1xcclxcbiAgICAgIHZhciB0cmFuc2xhdGlvbnMgPSByZXF1aXJlKHBhdGgpO1xcclxcblxcclxcbiAgICAgIFRyYW5zbGF0aW9uLl9jYWNoZVtwYXRoXSA9IHRyYW5zbGF0aW9ucztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW9uKFRyYW5zbGF0aW9uLl9jYWNoZVtwYXRoXSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIFRyYW5zbGF0aW9uO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kaWFjcml0aWNzJyxbXFxyXFxuXFxyXFxuXSwgZnVuY3Rpb24gKCkge1xcclxcbiAgdmFyIGRpYWNyaXRpY3MgPSB7XFxyXFxuICAgICdcXFxcdTI0QjYnOiAnQScsXFxyXFxuICAgICdcXFxcdUZGMjEnOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzAnOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzEnOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzInOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQTYnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQTQnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQUEnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQTgnOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzMnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxMDAnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxMDInOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQjAnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQUUnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQjQnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQjInOiAnQScsXFxyXFxuICAgICdcXFxcdTAyMjYnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxRTAnOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzQnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxREUnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQTInOiAnQScsXFxyXFxuICAgICdcXFxcdTAwQzUnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxRkEnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxQ0QnOiAnQScsXFxyXFxuICAgICdcXFxcdTAyMDAnOiAnQScsXFxyXFxuICAgICdcXFxcdTAyMDInOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQTAnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQUMnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFQjYnOiAnQScsXFxyXFxuICAgICdcXFxcdTFFMDAnOiAnQScsXFxyXFxuICAgICdcXFxcdTAxMDQnOiAnQScsXFxyXFxuICAgICdcXFxcdTAyM0EnOiAnQScsXFxyXFxuICAgICdcXFxcdTJDNkYnOiAnQScsXFxyXFxuICAgICdcXFxcdUE3MzInOiAnQUEnLFxcclxcbiAgICAnXFxcXHUwMEM2JzogJ0FFJyxcXHJcXG4gICAgJ1xcXFx1MDFGQyc6ICdBRScsXFxyXFxuICAgICdcXFxcdTAxRTInOiAnQUUnLFxcclxcbiAgICAnXFxcXHVBNzM0JzogJ0FPJyxcXHJcXG4gICAgJ1xcXFx1QTczNic6ICdBVScsXFxyXFxuICAgICdcXFxcdUE3MzgnOiAnQVYnLFxcclxcbiAgICAnXFxcXHVBNzNBJzogJ0FWJyxcXHJcXG4gICAgJ1xcXFx1QTczQyc6ICdBWScsXFxyXFxuICAgICdcXFxcdTI0QjcnOiAnQicsXFxyXFxuICAgICdcXFxcdUZGMjInOiAnQicsXFxyXFxuICAgICdcXFxcdTFFMDInOiAnQicsXFxyXFxuICAgICdcXFxcdTFFMDQnOiAnQicsXFxyXFxuICAgICdcXFxcdTFFMDYnOiAnQicsXFxyXFxuICAgICdcXFxcdTAyNDMnOiAnQicsXFxyXFxuICAgICdcXFxcdTAxODInOiAnQicsXFxyXFxuICAgICdcXFxcdTAxODEnOiAnQicsXFxyXFxuICAgICdcXFxcdTI0QjgnOiAnQycsXFxyXFxuICAgICdcXFxcdUZGMjMnOiAnQycsXFxyXFxuICAgICdcXFxcdTAxMDYnOiAnQycsXFxyXFxuICAgICdcXFxcdTAxMDgnOiAnQycsXFxyXFxuICAgICdcXFxcdTAxMEEnOiAnQycsXFxyXFxuICAgICdcXFxcdTAxMEMnOiAnQycsXFxyXFxuICAgICdcXFxcdTAwQzcnOiAnQycsXFxyXFxuICAgICdcXFxcdTFFMDgnOiAnQycsXFxyXFxuICAgICdcXFxcdTAxODcnOiAnQycsXFxyXFxuICAgICdcXFxcdTAyM0InOiAnQycsXFxyXFxuICAgICdcXFxcdUE3M0UnOiAnQycsXFxyXFxuICAgICdcXFxcdTI0QjknOiAnRCcsXFxyXFxuICAgICdcXFxcdUZGMjQnOiAnRCcsXFxyXFxuICAgICdcXFxcdTFFMEEnOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxMEUnOiAnRCcsXFxyXFxuICAgICdcXFxcdTFFMEMnOiAnRCcsXFxyXFxuICAgICdcXFxcdTFFMTAnOiAnRCcsXFxyXFxuICAgICdcXFxcdTFFMTInOiAnRCcsXFxyXFxuICAgICdcXFxcdTFFMEUnOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxMTAnOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxOEInOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxOEEnOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxODknOiAnRCcsXFxyXFxuICAgICdcXFxcdUE3NzknOiAnRCcsXFxyXFxuICAgICdcXFxcdTAxRjEnOiAnRFonLFxcclxcbiAgICAnXFxcXHUwMUM0JzogJ0RaJyxcXHJcXG4gICAgJ1xcXFx1MDFGMic6ICdEeicsXFxyXFxuICAgICdcXFxcdTAxQzUnOiAnRHonLFxcclxcbiAgICAnXFxcXHUyNEJBJzogJ0UnLFxcclxcbiAgICAnXFxcXHVGRjI1JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMEM4JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMEM5JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMENBJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUMwJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUJFJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUM0JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUMyJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUJDJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTEyJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRTE0JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRTE2JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTE0JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTE2JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMENCJzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUJBJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTFBJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMjA0JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMjA2JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUI4JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRUM2JzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMjI4JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRTFDJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTE4JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRTE4JzogJ0UnLFxcclxcbiAgICAnXFxcXHUxRTFBJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMTkwJzogJ0UnLFxcclxcbiAgICAnXFxcXHUwMThFJzogJ0UnLFxcclxcbiAgICAnXFxcXHUyNEJCJzogJ0YnLFxcclxcbiAgICAnXFxcXHVGRjI2JzogJ0YnLFxcclxcbiAgICAnXFxcXHUxRTFFJzogJ0YnLFxcclxcbiAgICAnXFxcXHUwMTkxJzogJ0YnLFxcclxcbiAgICAnXFxcXHVBNzdCJzogJ0YnLFxcclxcbiAgICAnXFxcXHUyNEJDJzogJ0cnLFxcclxcbiAgICAnXFxcXHVGRjI3JzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMUY0JzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMTFDJzogJ0cnLFxcclxcbiAgICAnXFxcXHUxRTIwJzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMTFFJzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMTIwJzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMUU2JzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMTIyJzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMUU0JzogJ0cnLFxcclxcbiAgICAnXFxcXHUwMTkzJzogJ0cnLFxcclxcbiAgICAnXFxcXHVBN0EwJzogJ0cnLFxcclxcbiAgICAnXFxcXHVBNzdEJzogJ0cnLFxcclxcbiAgICAnXFxcXHVBNzdFJzogJ0cnLFxcclxcbiAgICAnXFxcXHUyNEJEJzogJ0gnLFxcclxcbiAgICAnXFxcXHVGRjI4JzogJ0gnLFxcclxcbiAgICAnXFxcXHUwMTI0JzogJ0gnLFxcclxcbiAgICAnXFxcXHUxRTIyJzogJ0gnLFxcclxcbiAgICAnXFxcXHUxRTI2JzogJ0gnLFxcclxcbiAgICAnXFxcXHUwMjFFJzogJ0gnLFxcclxcbiAgICAnXFxcXHUxRTI0JzogJ0gnLFxcclxcbiAgICAnXFxcXHUxRTI4JzogJ0gnLFxcclxcbiAgICAnXFxcXHUxRTJBJzogJ0gnLFxcclxcbiAgICAnXFxcXHUwMTI2JzogJ0gnLFxcclxcbiAgICAnXFxcXHUyQzY3JzogJ0gnLFxcclxcbiAgICAnXFxcXHUyQzc1JzogJ0gnLFxcclxcbiAgICAnXFxcXHVBNzhEJzogJ0gnLFxcclxcbiAgICAnXFxcXHUyNEJFJzogJ0knLFxcclxcbiAgICAnXFxcXHVGRjI5JzogJ0knLFxcclxcbiAgICAnXFxcXHUwMENDJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMENEJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMENFJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTI4JzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTJBJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTJDJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTMwJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMENGJzogJ0knLFxcclxcbiAgICAnXFxcXHUxRTJFJzogJ0knLFxcclxcbiAgICAnXFxcXHUxRUM4JzogJ0knLFxcclxcbiAgICAnXFxcXHUwMUNGJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMjA4JzogJ0knLFxcclxcbiAgICAnXFxcXHUwMjBBJzogJ0knLFxcclxcbiAgICAnXFxcXHUxRUNBJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTJFJzogJ0knLFxcclxcbiAgICAnXFxcXHUxRTJDJzogJ0knLFxcclxcbiAgICAnXFxcXHUwMTk3JzogJ0knLFxcclxcbiAgICAnXFxcXHUyNEJGJzogJ0onLFxcclxcbiAgICAnXFxcXHVGRjJBJzogJ0onLFxcclxcbiAgICAnXFxcXHUwMTM0JzogJ0onLFxcclxcbiAgICAnXFxcXHUwMjQ4JzogJ0onLFxcclxcbiAgICAnXFxcXHUyNEMwJzogJ0snLFxcclxcbiAgICAnXFxcXHVGRjJCJzogJ0snLFxcclxcbiAgICAnXFxcXHUxRTMwJzogJ0snLFxcclxcbiAgICAnXFxcXHUwMUU4JzogJ0snLFxcclxcbiAgICAnXFxcXHUxRTMyJzogJ0snLFxcclxcbiAgICAnXFxcXHUwMTM2JzogJ0snLFxcclxcbiAgICAnXFxcXHUxRTM0JzogJ0snLFxcclxcbiAgICAnXFxcXHUwMTk4JzogJ0snLFxcclxcbiAgICAnXFxcXHUyQzY5JzogJ0snLFxcclxcbiAgICAnXFxcXHVBNzQwJzogJ0snLFxcclxcbiAgICAnXFxcXHVBNzQyJzogJ0snLFxcclxcbiAgICAnXFxcXHVBNzQ0JzogJ0snLFxcclxcbiAgICAnXFxcXHVBN0EyJzogJ0snLFxcclxcbiAgICAnXFxcXHUyNEMxJzogJ0wnLFxcclxcbiAgICAnXFxcXHVGRjJDJzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMTNGJzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMTM5JzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMTNEJzogJ0wnLFxcclxcbiAgICAnXFxcXHUxRTM2JzogJ0wnLFxcclxcbiAgICAnXFxcXHUxRTM4JzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMTNCJzogJ0wnLFxcclxcbiAgICAnXFxcXHUxRTNDJzogJ0wnLFxcclxcbiAgICAnXFxcXHUxRTNBJzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMTQxJzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMjNEJzogJ0wnLFxcclxcbiAgICAnXFxcXHUyQzYyJzogJ0wnLFxcclxcbiAgICAnXFxcXHUyQzYwJzogJ0wnLFxcclxcbiAgICAnXFxcXHVBNzQ4JzogJ0wnLFxcclxcbiAgICAnXFxcXHVBNzQ2JzogJ0wnLFxcclxcbiAgICAnXFxcXHVBNzgwJzogJ0wnLFxcclxcbiAgICAnXFxcXHUwMUM3JzogJ0xKJyxcXHJcXG4gICAgJ1xcXFx1MDFDOCc6ICdMaicsXFxyXFxuICAgICdcXFxcdTI0QzInOiAnTScsXFxyXFxuICAgICdcXFxcdUZGMkQnOiAnTScsXFxyXFxuICAgICdcXFxcdTFFM0UnOiAnTScsXFxyXFxuICAgICdcXFxcdTFFNDAnOiAnTScsXFxyXFxuICAgICdcXFxcdTFFNDInOiAnTScsXFxyXFxuICAgICdcXFxcdTJDNkUnOiAnTScsXFxyXFxuICAgICdcXFxcdTAxOUMnOiAnTScsXFxyXFxuICAgICdcXFxcdTI0QzMnOiAnTicsXFxyXFxuICAgICdcXFxcdUZGMkUnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxRjgnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxNDMnOiAnTicsXFxyXFxuICAgICdcXFxcdTAwRDEnOiAnTicsXFxyXFxuICAgICdcXFxcdTFFNDQnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxNDcnOiAnTicsXFxyXFxuICAgICdcXFxcdTFFNDYnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxNDUnOiAnTicsXFxyXFxuICAgICdcXFxcdTFFNEEnOiAnTicsXFxyXFxuICAgICdcXFxcdTFFNDgnOiAnTicsXFxyXFxuICAgICdcXFxcdTAyMjAnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxOUQnOiAnTicsXFxyXFxuICAgICdcXFxcdUE3OTAnOiAnTicsXFxyXFxuICAgICdcXFxcdUE3QTQnOiAnTicsXFxyXFxuICAgICdcXFxcdTAxQ0EnOiAnTkonLFxcclxcbiAgICAnXFxcXHUwMUNCJzogJ05qJyxcXHJcXG4gICAgJ1xcXFx1MjRDNCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1RkYyRic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBEMic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBEMyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBENCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVEMic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVEMCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVENic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVENCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBENSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUU0Qyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIyQyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUU0RSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDE0Qyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUU1MCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUU1Mic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDE0RSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIyRSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIzMCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBENic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIyQSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVDRSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDE1MCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFEMSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIwQyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDIwRSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFBMCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVEQyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVEQSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVFMCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVERSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVFMic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVDQyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MUVEOCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFFQSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFFQyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDBEOCc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFGRSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDE4Nic6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDE5Ric6ICdPJyxcXHJcXG4gICAgJ1xcXFx1QTc0QSc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1QTc0Qyc6ICdPJyxcXHJcXG4gICAgJ1xcXFx1MDFBMic6ICdPSScsXFxyXFxuICAgICdcXFxcdUE3NEUnOiAnT08nLFxcclxcbiAgICAnXFxcXHUwMjIyJzogJ09VJyxcXHJcXG4gICAgJ1xcXFx1MjRDNSc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1RkYzMCc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1MUU1NCc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1MUU1Nic6ICdQJyxcXHJcXG4gICAgJ1xcXFx1MDFBNCc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1MkM2Myc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1QTc1MCc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1QTc1Mic6ICdQJyxcXHJcXG4gICAgJ1xcXFx1QTc1NCc6ICdQJyxcXHJcXG4gICAgJ1xcXFx1MjRDNic6ICdRJyxcXHJcXG4gICAgJ1xcXFx1RkYzMSc6ICdRJyxcXHJcXG4gICAgJ1xcXFx1QTc1Nic6ICdRJyxcXHJcXG4gICAgJ1xcXFx1QTc1OCc6ICdRJyxcXHJcXG4gICAgJ1xcXFx1MDI0QSc6ICdRJyxcXHJcXG4gICAgJ1xcXFx1MjRDNyc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1RkYzMic6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDE1NCc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MUU1OCc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDE1OCc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDIxMCc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDIxMic6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MUU1QSc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MUU1Qyc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDE1Nic6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MUU1RSc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MDI0Qyc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MkM2NCc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1QTc1QSc6ICdSJyxcXHJcXG4gICAgJ1xcXFx1QTdBNic6ICdSJyxcXHJcXG4gICAgJ1xcXFx1QTc4Mic6ICdSJyxcXHJcXG4gICAgJ1xcXFx1MjRDOCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1RkYzMyc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU5RSc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MDE1QSc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU2NCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MDE1Qyc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU2MCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MDE2MCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU2Nic6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU2Mic6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MUU2OCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MDIxOCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MDE1RSc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MkM3RSc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1QTdBOCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1QTc4NCc6ICdTJyxcXHJcXG4gICAgJ1xcXFx1MjRDOSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1RkYzNCc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MUU2QSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDE2NCc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MUU2Qyc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDIxQSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDE2Mic6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MUU3MCc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MUU2RSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDE2Nic6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDFBQyc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDFBRSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1MDIzRSc6ICdUJyxcXHJcXG4gICAgJ1xcXFx1QTc4Nic6ICdUJyxcXHJcXG4gICAgJ1xcXFx1QTcyOCc6ICdUWicsXFxyXFxuICAgICdcXFxcdTI0Q0EnOiAnVScsXFxyXFxuICAgICdcXFxcdUZGMzUnOiAnVScsXFxyXFxuICAgICdcXFxcdTAwRDknOiAnVScsXFxyXFxuICAgICdcXFxcdTAwREEnOiAnVScsXFxyXFxuICAgICdcXFxcdTAwREInOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNjgnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFNzgnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNkEnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFN0EnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNkMnOiAnVScsXFxyXFxuICAgICdcXFxcdTAwREMnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxREInOiAnVScsXFxyXFxuICAgICdcXFxcdTAxRDcnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxRDUnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxRDknOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRTYnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNkUnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNzAnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxRDMnOiAnVScsXFxyXFxuICAgICdcXFxcdTAyMTQnOiAnVScsXFxyXFxuICAgICdcXFxcdTAyMTYnOiAnVScsXFxyXFxuICAgICdcXFxcdTAxQUYnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRUEnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRTgnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRUUnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRUMnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRjAnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFRTQnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFNzInOiAnVScsXFxyXFxuICAgICdcXFxcdTAxNzInOiAnVScsXFxyXFxuICAgICdcXFxcdTFFNzYnOiAnVScsXFxyXFxuICAgICdcXFxcdTFFNzQnOiAnVScsXFxyXFxuICAgICdcXFxcdTAyNDQnOiAnVScsXFxyXFxuICAgICdcXFxcdTI0Q0InOiAnVicsXFxyXFxuICAgICdcXFxcdUZGMzYnOiAnVicsXFxyXFxuICAgICdcXFxcdTFFN0MnOiAnVicsXFxyXFxuICAgICdcXFxcdTFFN0UnOiAnVicsXFxyXFxuICAgICdcXFxcdTAxQjInOiAnVicsXFxyXFxuICAgICdcXFxcdUE3NUUnOiAnVicsXFxyXFxuICAgICdcXFxcdTAyNDUnOiAnVicsXFxyXFxuICAgICdcXFxcdUE3NjAnOiAnVlknLFxcclxcbiAgICAnXFxcXHUyNENDJzogJ1cnLFxcclxcbiAgICAnXFxcXHVGRjM3JzogJ1cnLFxcclxcbiAgICAnXFxcXHUxRTgwJzogJ1cnLFxcclxcbiAgICAnXFxcXHUxRTgyJzogJ1cnLFxcclxcbiAgICAnXFxcXHUwMTc0JzogJ1cnLFxcclxcbiAgICAnXFxcXHUxRTg2JzogJ1cnLFxcclxcbiAgICAnXFxcXHUxRTg0JzogJ1cnLFxcclxcbiAgICAnXFxcXHUxRTg4JzogJ1cnLFxcclxcbiAgICAnXFxcXHUyQzcyJzogJ1cnLFxcclxcbiAgICAnXFxcXHUyNENEJzogJ1gnLFxcclxcbiAgICAnXFxcXHVGRjM4JzogJ1gnLFxcclxcbiAgICAnXFxcXHUxRThBJzogJ1gnLFxcclxcbiAgICAnXFxcXHUxRThDJzogJ1gnLFxcclxcbiAgICAnXFxcXHUyNENFJzogJ1knLFxcclxcbiAgICAnXFxcXHVGRjM5JzogJ1knLFxcclxcbiAgICAnXFxcXHUxRUYyJzogJ1knLFxcclxcbiAgICAnXFxcXHUwMEREJzogJ1knLFxcclxcbiAgICAnXFxcXHUwMTc2JzogJ1knLFxcclxcbiAgICAnXFxcXHUxRUY4JzogJ1knLFxcclxcbiAgICAnXFxcXHUwMjMyJzogJ1knLFxcclxcbiAgICAnXFxcXHUxRThFJzogJ1knLFxcclxcbiAgICAnXFxcXHUwMTc4JzogJ1knLFxcclxcbiAgICAnXFxcXHUxRUY2JzogJ1knLFxcclxcbiAgICAnXFxcXHUxRUY0JzogJ1knLFxcclxcbiAgICAnXFxcXHUwMUIzJzogJ1knLFxcclxcbiAgICAnXFxcXHUwMjRFJzogJ1knLFxcclxcbiAgICAnXFxcXHUxRUZFJzogJ1knLFxcclxcbiAgICAnXFxcXHUyNENGJzogJ1onLFxcclxcbiAgICAnXFxcXHVGRjNBJzogJ1onLFxcclxcbiAgICAnXFxcXHUwMTc5JzogJ1onLFxcclxcbiAgICAnXFxcXHUxRTkwJzogJ1onLFxcclxcbiAgICAnXFxcXHUwMTdCJzogJ1onLFxcclxcbiAgICAnXFxcXHUwMTdEJzogJ1onLFxcclxcbiAgICAnXFxcXHUxRTkyJzogJ1onLFxcclxcbiAgICAnXFxcXHUxRTk0JzogJ1onLFxcclxcbiAgICAnXFxcXHUwMUI1JzogJ1onLFxcclxcbiAgICAnXFxcXHUwMjI0JzogJ1onLFxcclxcbiAgICAnXFxcXHUyQzdGJzogJ1onLFxcclxcbiAgICAnXFxcXHUyQzZCJzogJ1onLFxcclxcbiAgICAnXFxcXHVBNzYyJzogJ1onLFxcclxcbiAgICAnXFxcXHUyNEQwJzogJ2EnLFxcclxcbiAgICAnXFxcXHVGRjQxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRTlBJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEUwJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEUxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEUyJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUE3JzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUE1JzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUFCJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUE5JzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEUzJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMTAxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMTAzJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUIxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUFGJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUI1JzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUIzJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMjI3JzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMUUxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEU0JzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMURGJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUEzJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMEU1JzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMUZCJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMUNFJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMjAxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMjAzJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUExJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUFEJzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRUI3JzogJ2EnLFxcclxcbiAgICAnXFxcXHUxRTAxJzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMTA1JzogJ2EnLFxcclxcbiAgICAnXFxcXHUyQzY1JzogJ2EnLFxcclxcbiAgICAnXFxcXHUwMjUwJzogJ2EnLFxcclxcbiAgICAnXFxcXHVBNzMzJzogJ2FhJyxcXHJcXG4gICAgJ1xcXFx1MDBFNic6ICdhZScsXFxyXFxuICAgICdcXFxcdTAxRkQnOiAnYWUnLFxcclxcbiAgICAnXFxcXHUwMUUzJzogJ2FlJyxcXHJcXG4gICAgJ1xcXFx1QTczNSc6ICdhbycsXFxyXFxuICAgICdcXFxcdUE3MzcnOiAnYXUnLFxcclxcbiAgICAnXFxcXHVBNzM5JzogJ2F2JyxcXHJcXG4gICAgJ1xcXFx1QTczQic6ICdhdicsXFxyXFxuICAgICdcXFxcdUE3M0QnOiAnYXknLFxcclxcbiAgICAnXFxcXHUyNEQxJzogJ2InLFxcclxcbiAgICAnXFxcXHVGRjQyJzogJ2InLFxcclxcbiAgICAnXFxcXHUxRTAzJzogJ2InLFxcclxcbiAgICAnXFxcXHUxRTA1JzogJ2InLFxcclxcbiAgICAnXFxcXHUxRTA3JzogJ2InLFxcclxcbiAgICAnXFxcXHUwMTgwJzogJ2InLFxcclxcbiAgICAnXFxcXHUwMTgzJzogJ2InLFxcclxcbiAgICAnXFxcXHUwMjUzJzogJ2InLFxcclxcbiAgICAnXFxcXHUyNEQyJzogJ2MnLFxcclxcbiAgICAnXFxcXHVGRjQzJzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMTA3JzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMTA5JzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMTBCJzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMTBEJzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMEU3JzogJ2MnLFxcclxcbiAgICAnXFxcXHUxRTA5JzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMTg4JzogJ2MnLFxcclxcbiAgICAnXFxcXHUwMjNDJzogJ2MnLFxcclxcbiAgICAnXFxcXHVBNzNGJzogJ2MnLFxcclxcbiAgICAnXFxcXHUyMTg0JzogJ2MnLFxcclxcbiAgICAnXFxcXHUyNEQzJzogJ2QnLFxcclxcbiAgICAnXFxcXHVGRjQ0JzogJ2QnLFxcclxcbiAgICAnXFxcXHUxRTBCJzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMTBGJzogJ2QnLFxcclxcbiAgICAnXFxcXHUxRTBEJzogJ2QnLFxcclxcbiAgICAnXFxcXHUxRTExJzogJ2QnLFxcclxcbiAgICAnXFxcXHUxRTEzJzogJ2QnLFxcclxcbiAgICAnXFxcXHUxRTBGJzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMTExJzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMThDJzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMjU2JzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMjU3JzogJ2QnLFxcclxcbiAgICAnXFxcXHVBNzdBJzogJ2QnLFxcclxcbiAgICAnXFxcXHUwMUYzJzogJ2R6JyxcXHJcXG4gICAgJ1xcXFx1MDFDNic6ICdkeicsXFxyXFxuICAgICdcXFxcdTI0RDQnOiAnZScsXFxyXFxuICAgICdcXFxcdUZGNDUnOiAnZScsXFxyXFxuICAgICdcXFxcdTAwRTgnOiAnZScsXFxyXFxuICAgICdcXFxcdTAwRTknOiAnZScsXFxyXFxuICAgICdcXFxcdTAwRUEnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQzEnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQkYnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQzUnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQzMnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQkQnOiAnZScsXFxyXFxuICAgICdcXFxcdTAxMTMnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFMTUnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFMTcnOiAnZScsXFxyXFxuICAgICdcXFxcdTAxMTUnOiAnZScsXFxyXFxuICAgICdcXFxcdTAxMTcnOiAnZScsXFxyXFxuICAgICdcXFxcdTAwRUInOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQkInOiAnZScsXFxyXFxuICAgICdcXFxcdTAxMUInOiAnZScsXFxyXFxuICAgICdcXFxcdTAyMDUnOiAnZScsXFxyXFxuICAgICdcXFxcdTAyMDcnOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQjknOiAnZScsXFxyXFxuICAgICdcXFxcdTFFQzcnOiAnZScsXFxyXFxuICAgICdcXFxcdTAyMjknOiAnZScsXFxyXFxuICAgICdcXFxcdTFFMUQnOiAnZScsXFxyXFxuICAgICdcXFxcdTAxMTknOiAnZScsXFxyXFxuICAgICdcXFxcdTFFMTknOiAnZScsXFxyXFxuICAgICdcXFxcdTFFMUInOiAnZScsXFxyXFxuICAgICdcXFxcdTAyNDcnOiAnZScsXFxyXFxuICAgICdcXFxcdTAyNUInOiAnZScsXFxyXFxuICAgICdcXFxcdTAxREQnOiAnZScsXFxyXFxuICAgICdcXFxcdTI0RDUnOiAnZicsXFxyXFxuICAgICdcXFxcdUZGNDYnOiAnZicsXFxyXFxuICAgICdcXFxcdTFFMUYnOiAnZicsXFxyXFxuICAgICdcXFxcdTAxOTInOiAnZicsXFxyXFxuICAgICdcXFxcdUE3N0MnOiAnZicsXFxyXFxuICAgICdcXFxcdTI0RDYnOiAnZycsXFxyXFxuICAgICdcXFxcdUZGNDcnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxRjUnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxMUQnOiAnZycsXFxyXFxuICAgICdcXFxcdTFFMjEnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxMUYnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxMjEnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxRTcnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxMjMnOiAnZycsXFxyXFxuICAgICdcXFxcdTAxRTUnOiAnZycsXFxyXFxuICAgICdcXFxcdTAyNjAnOiAnZycsXFxyXFxuICAgICdcXFxcdUE3QTEnOiAnZycsXFxyXFxuICAgICdcXFxcdTFENzknOiAnZycsXFxyXFxuICAgICdcXFxcdUE3N0YnOiAnZycsXFxyXFxuICAgICdcXFxcdTI0RDcnOiAnaCcsXFxyXFxuICAgICdcXFxcdUZGNDgnOiAnaCcsXFxyXFxuICAgICdcXFxcdTAxMjUnOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFMjMnOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFMjcnOiAnaCcsXFxyXFxuICAgICdcXFxcdTAyMUYnOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFMjUnOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFMjknOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFMkInOiAnaCcsXFxyXFxuICAgICdcXFxcdTFFOTYnOiAnaCcsXFxyXFxuICAgICdcXFxcdTAxMjcnOiAnaCcsXFxyXFxuICAgICdcXFxcdTJDNjgnOiAnaCcsXFxyXFxuICAgICdcXFxcdTJDNzYnOiAnaCcsXFxyXFxuICAgICdcXFxcdTAyNjUnOiAnaCcsXFxyXFxuICAgICdcXFxcdTAxOTUnOiAnaHYnLFxcclxcbiAgICAnXFxcXHUyNEQ4JzogJ2knLFxcclxcbiAgICAnXFxcXHVGRjQ5JzogJ2knLFxcclxcbiAgICAnXFxcXHUwMEVDJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMEVEJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMEVFJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMTI5JzogJ2knLFxcclxcbiAgICAnXFxcXHUwMTJCJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMTJEJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMEVGJzogJ2knLFxcclxcbiAgICAnXFxcXHUxRTJGJzogJ2knLFxcclxcbiAgICAnXFxcXHUxRUM5JzogJ2knLFxcclxcbiAgICAnXFxcXHUwMUQwJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMjA5JzogJ2knLFxcclxcbiAgICAnXFxcXHUwMjBCJzogJ2knLFxcclxcbiAgICAnXFxcXHUxRUNCJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMTJGJzogJ2knLFxcclxcbiAgICAnXFxcXHUxRTJEJzogJ2knLFxcclxcbiAgICAnXFxcXHUwMjY4JzogJ2knLFxcclxcbiAgICAnXFxcXHUwMTMxJzogJ2knLFxcclxcbiAgICAnXFxcXHUyNEQ5JzogJ2onLFxcclxcbiAgICAnXFxcXHVGRjRBJzogJ2onLFxcclxcbiAgICAnXFxcXHUwMTM1JzogJ2onLFxcclxcbiAgICAnXFxcXHUwMUYwJzogJ2onLFxcclxcbiAgICAnXFxcXHUwMjQ5JzogJ2onLFxcclxcbiAgICAnXFxcXHUyNERBJzogJ2snLFxcclxcbiAgICAnXFxcXHVGRjRCJzogJ2snLFxcclxcbiAgICAnXFxcXHUxRTMxJzogJ2snLFxcclxcbiAgICAnXFxcXHUwMUU5JzogJ2snLFxcclxcbiAgICAnXFxcXHUxRTMzJzogJ2snLFxcclxcbiAgICAnXFxcXHUwMTM3JzogJ2snLFxcclxcbiAgICAnXFxcXHUxRTM1JzogJ2snLFxcclxcbiAgICAnXFxcXHUwMTk5JzogJ2snLFxcclxcbiAgICAnXFxcXHUyQzZBJzogJ2snLFxcclxcbiAgICAnXFxcXHVBNzQxJzogJ2snLFxcclxcbiAgICAnXFxcXHVBNzQzJzogJ2snLFxcclxcbiAgICAnXFxcXHVBNzQ1JzogJ2snLFxcclxcbiAgICAnXFxcXHVBN0EzJzogJ2snLFxcclxcbiAgICAnXFxcXHUyNERCJzogJ2wnLFxcclxcbiAgICAnXFxcXHVGRjRDJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTQwJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTNBJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTNFJzogJ2wnLFxcclxcbiAgICAnXFxcXHUxRTM3JzogJ2wnLFxcclxcbiAgICAnXFxcXHUxRTM5JzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTNDJzogJ2wnLFxcclxcbiAgICAnXFxcXHUxRTNEJzogJ2wnLFxcclxcbiAgICAnXFxcXHUxRTNCJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTdGJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTQyJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMTlBJzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMjZCJzogJ2wnLFxcclxcbiAgICAnXFxcXHUyQzYxJzogJ2wnLFxcclxcbiAgICAnXFxcXHVBNzQ5JzogJ2wnLFxcclxcbiAgICAnXFxcXHVBNzgxJzogJ2wnLFxcclxcbiAgICAnXFxcXHVBNzQ3JzogJ2wnLFxcclxcbiAgICAnXFxcXHUwMUM5JzogJ2xqJyxcXHJcXG4gICAgJ1xcXFx1MjREQyc6ICdtJyxcXHJcXG4gICAgJ1xcXFx1RkY0RCc6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MUUzRic6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MUU0MSc6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MUU0Myc6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MDI3MSc6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MDI2Ric6ICdtJyxcXHJcXG4gICAgJ1xcXFx1MjRERCc6ICduJyxcXHJcXG4gICAgJ1xcXFx1RkY0RSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDFGOSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDE0NCc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDBGMSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MUU0NSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDE0OCc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MUU0Nyc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDE0Nic6ICduJyxcXHJcXG4gICAgJ1xcXFx1MUU0Qic6ICduJyxcXHJcXG4gICAgJ1xcXFx1MUU0OSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDE5RSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDI3Mic6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDE0OSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1QTc5MSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1QTdBNSc6ICduJyxcXHJcXG4gICAgJ1xcXFx1MDFDQyc6ICduaicsXFxyXFxuICAgICdcXFxcdTI0REUnOiAnbycsXFxyXFxuICAgICdcXFxcdUZGNEYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjInOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjMnOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjQnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRDMnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRDEnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRDcnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRDUnOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjUnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFNEQnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMkQnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFNEYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxNEQnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFNTEnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFNTMnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxNEYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMkYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMzEnOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMkInOiAnbycsXFxyXFxuICAgICdcXFxcdTFFQ0YnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxNTEnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxRDInOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMEQnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyMEYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxQTEnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFREQnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFREInOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRTEnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFREYnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRTMnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFQ0QnOiAnbycsXFxyXFxuICAgICdcXFxcdTFFRDknOiAnbycsXFxyXFxuICAgICdcXFxcdTAxRUInOiAnbycsXFxyXFxuICAgICdcXFxcdTAxRUQnOiAnbycsXFxyXFxuICAgICdcXFxcdTAwRjgnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxRkYnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyNTQnOiAnbycsXFxyXFxuICAgICdcXFxcdUE3NEInOiAnbycsXFxyXFxuICAgICdcXFxcdUE3NEQnOiAnbycsXFxyXFxuICAgICdcXFxcdTAyNzUnOiAnbycsXFxyXFxuICAgICdcXFxcdTAxQTMnOiAnb2knLFxcclxcbiAgICAnXFxcXHUwMjIzJzogJ291JyxcXHJcXG4gICAgJ1xcXFx1QTc0Ric6ICdvbycsXFxyXFxuICAgICdcXFxcdTI0REYnOiAncCcsXFxyXFxuICAgICdcXFxcdUZGNTAnOiAncCcsXFxyXFxuICAgICdcXFxcdTFFNTUnOiAncCcsXFxyXFxuICAgICdcXFxcdTFFNTcnOiAncCcsXFxyXFxuICAgICdcXFxcdTAxQTUnOiAncCcsXFxyXFxuICAgICdcXFxcdTFEN0QnOiAncCcsXFxyXFxuICAgICdcXFxcdUE3NTEnOiAncCcsXFxyXFxuICAgICdcXFxcdUE3NTMnOiAncCcsXFxyXFxuICAgICdcXFxcdUE3NTUnOiAncCcsXFxyXFxuICAgICdcXFxcdTI0RTAnOiAncScsXFxyXFxuICAgICdcXFxcdUZGNTEnOiAncScsXFxyXFxuICAgICdcXFxcdTAyNEInOiAncScsXFxyXFxuICAgICdcXFxcdUE3NTcnOiAncScsXFxyXFxuICAgICdcXFxcdUE3NTknOiAncScsXFxyXFxuICAgICdcXFxcdTI0RTEnOiAncicsXFxyXFxuICAgICdcXFxcdUZGNTInOiAncicsXFxyXFxuICAgICdcXFxcdTAxNTUnOiAncicsXFxyXFxuICAgICdcXFxcdTFFNTknOiAncicsXFxyXFxuICAgICdcXFxcdTAxNTknOiAncicsXFxyXFxuICAgICdcXFxcdTAyMTEnOiAncicsXFxyXFxuICAgICdcXFxcdTAyMTMnOiAncicsXFxyXFxuICAgICdcXFxcdTFFNUInOiAncicsXFxyXFxuICAgICdcXFxcdTFFNUQnOiAncicsXFxyXFxuICAgICdcXFxcdTAxNTcnOiAncicsXFxyXFxuICAgICdcXFxcdTFFNUYnOiAncicsXFxyXFxuICAgICdcXFxcdTAyNEQnOiAncicsXFxyXFxuICAgICdcXFxcdTAyN0QnOiAncicsXFxyXFxuICAgICdcXFxcdUE3NUInOiAncicsXFxyXFxuICAgICdcXFxcdUE3QTcnOiAncicsXFxyXFxuICAgICdcXFxcdUE3ODMnOiAncicsXFxyXFxuICAgICdcXFxcdTI0RTInOiAncycsXFxyXFxuICAgICdcXFxcdUZGNTMnOiAncycsXFxyXFxuICAgICdcXFxcdTAwREYnOiAncycsXFxyXFxuICAgICdcXFxcdTAxNUInOiAncycsXFxyXFxuICAgICdcXFxcdTFFNjUnOiAncycsXFxyXFxuICAgICdcXFxcdTAxNUQnOiAncycsXFxyXFxuICAgICdcXFxcdTFFNjEnOiAncycsXFxyXFxuICAgICdcXFxcdTAxNjEnOiAncycsXFxyXFxuICAgICdcXFxcdTFFNjcnOiAncycsXFxyXFxuICAgICdcXFxcdTFFNjMnOiAncycsXFxyXFxuICAgICdcXFxcdTFFNjknOiAncycsXFxyXFxuICAgICdcXFxcdTAyMTknOiAncycsXFxyXFxuICAgICdcXFxcdTAxNUYnOiAncycsXFxyXFxuICAgICdcXFxcdTAyM0YnOiAncycsXFxyXFxuICAgICdcXFxcdUE3QTknOiAncycsXFxyXFxuICAgICdcXFxcdUE3ODUnOiAncycsXFxyXFxuICAgICdcXFxcdTFFOUInOiAncycsXFxyXFxuICAgICdcXFxcdTI0RTMnOiAndCcsXFxyXFxuICAgICdcXFxcdUZGNTQnOiAndCcsXFxyXFxuICAgICdcXFxcdTFFNkInOiAndCcsXFxyXFxuICAgICdcXFxcdTFFOTcnOiAndCcsXFxyXFxuICAgICdcXFxcdTAxNjUnOiAndCcsXFxyXFxuICAgICdcXFxcdTFFNkQnOiAndCcsXFxyXFxuICAgICdcXFxcdTAyMUInOiAndCcsXFxyXFxuICAgICdcXFxcdTAxNjMnOiAndCcsXFxyXFxuICAgICdcXFxcdTFFNzEnOiAndCcsXFxyXFxuICAgICdcXFxcdTFFNkYnOiAndCcsXFxyXFxuICAgICdcXFxcdTAxNjcnOiAndCcsXFxyXFxuICAgICdcXFxcdTAxQUQnOiAndCcsXFxyXFxuICAgICdcXFxcdTAyODgnOiAndCcsXFxyXFxuICAgICdcXFxcdTJDNjYnOiAndCcsXFxyXFxuICAgICdcXFxcdUE3ODcnOiAndCcsXFxyXFxuICAgICdcXFxcdUE3MjknOiAndHonLFxcclxcbiAgICAnXFxcXHUyNEU0JzogJ3UnLFxcclxcbiAgICAnXFxcXHVGRjU1JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMEY5JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMEZBJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMEZCJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTY5JzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRTc5JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTZCJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRTdCJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTZEJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMEZDJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMURDJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMUQ4JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMUQ2JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMURBJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUU3JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTZGJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTcxJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMUQ0JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMjE1JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMjE3JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMUIwJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUVCJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUU5JzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUVGJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUVEJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUYxJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRUU1JzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRTczJzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMTczJzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRTc3JzogJ3UnLFxcclxcbiAgICAnXFxcXHUxRTc1JzogJ3UnLFxcclxcbiAgICAnXFxcXHUwMjg5JzogJ3UnLFxcclxcbiAgICAnXFxcXHUyNEU1JzogJ3YnLFxcclxcbiAgICAnXFxcXHVGRjU2JzogJ3YnLFxcclxcbiAgICAnXFxcXHUxRTdEJzogJ3YnLFxcclxcbiAgICAnXFxcXHUxRTdGJzogJ3YnLFxcclxcbiAgICAnXFxcXHUwMjhCJzogJ3YnLFxcclxcbiAgICAnXFxcXHVBNzVGJzogJ3YnLFxcclxcbiAgICAnXFxcXHUwMjhDJzogJ3YnLFxcclxcbiAgICAnXFxcXHVBNzYxJzogJ3Z5JyxcXHJcXG4gICAgJ1xcXFx1MjRFNic6ICd3JyxcXHJcXG4gICAgJ1xcXFx1RkY1Nyc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU4MSc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU4Myc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MDE3NSc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU4Nyc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU4NSc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU5OCc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MUU4OSc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MkM3Myc6ICd3JyxcXHJcXG4gICAgJ1xcXFx1MjRFNyc6ICd4JyxcXHJcXG4gICAgJ1xcXFx1RkY1OCc6ICd4JyxcXHJcXG4gICAgJ1xcXFx1MUU4Qic6ICd4JyxcXHJcXG4gICAgJ1xcXFx1MUU4RCc6ICd4JyxcXHJcXG4gICAgJ1xcXFx1MjRFOCc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1RkY1OSc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUVGMyc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDBGRCc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDE3Nyc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUVGOSc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDIzMyc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUU4Ric6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDBGRic6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUVGNyc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUU5OSc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUVGNSc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDFCNCc6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MDI0Ric6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MUVGRic6ICd5JyxcXHJcXG4gICAgJ1xcXFx1MjRFOSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1RkY1QSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDE3QSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MUU5MSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDE3Qyc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDE3RSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MUU5Myc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MUU5NSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDFCNic6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDIyNSc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDI0MCc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MkM2Qyc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1QTc2Myc6ICd6JyxcXHJcXG4gICAgJ1xcXFx1MDM4Nic6ICdcXFxcdTAzOTEnLFxcclxcbiAgICAnXFxcXHUwMzg4JzogJ1xcXFx1MDM5NScsXFxyXFxuICAgICdcXFxcdTAzODknOiAnXFxcXHUwMzk3JyxcXHJcXG4gICAgJ1xcXFx1MDM4QSc6ICdcXFxcdTAzOTknLFxcclxcbiAgICAnXFxcXHUwM0FBJzogJ1xcXFx1MDM5OScsXFxyXFxuICAgICdcXFxcdTAzOEMnOiAnXFxcXHUwMzlGJyxcXHJcXG4gICAgJ1xcXFx1MDM4RSc6ICdcXFxcdTAzQTUnLFxcclxcbiAgICAnXFxcXHUwM0FCJzogJ1xcXFx1MDNBNScsXFxyXFxuICAgICdcXFxcdTAzOEYnOiAnXFxcXHUwM0E5JyxcXHJcXG4gICAgJ1xcXFx1MDNBQyc6ICdcXFxcdTAzQjEnLFxcclxcbiAgICAnXFxcXHUwM0FEJzogJ1xcXFx1MDNCNScsXFxyXFxuICAgICdcXFxcdTAzQUUnOiAnXFxcXHUwM0I3JyxcXHJcXG4gICAgJ1xcXFx1MDNBRic6ICdcXFxcdTAzQjknLFxcclxcbiAgICAnXFxcXHUwM0NBJzogJ1xcXFx1MDNCOScsXFxyXFxuICAgICdcXFxcdTAzOTAnOiAnXFxcXHUwM0I5JyxcXHJcXG4gICAgJ1xcXFx1MDNDQyc6ICdcXFxcdTAzQkYnLFxcclxcbiAgICAnXFxcXHUwM0NEJzogJ1xcXFx1MDNDNScsXFxyXFxuICAgICdcXFxcdTAzQ0InOiAnXFxcXHUwM0M1JyxcXHJcXG4gICAgJ1xcXFx1MDNCMCc6ICdcXFxcdTAzQzUnLFxcclxcbiAgICAnXFxcXHUwM0M5JzogJ1xcXFx1MDNDOScsXFxyXFxuICAgICdcXFxcdTAzQzInOiAnXFxcXHUwM0MzJ1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBkaWFjcml0aWNzO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kYXRhL2Jhc2UnLFtcXHJcXG4gICcuLi91dGlscydcXHJcXG5dLCBmdW5jdGlvbiAoVXRpbHMpIHtcXHJcXG4gIGZ1bmN0aW9uIEJhc2VBZGFwdGVyICgkZWxlbWVudCwgb3B0aW9ucykge1xcclxcbiAgICBCYXNlQWRhcHRlci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIFV0aWxzLkV4dGVuZChCYXNlQWRhcHRlciwgVXRpbHMuT2JzZXJ2YWJsZSk7XFxyXFxuXFxyXFxuICBCYXNlQWRhcHRlci5wcm90b3R5cGUuY3VycmVudCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xcclxcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBgY3VycmVudGAgbWV0aG9kIG11c3QgYmUgZGVmaW5lZCBpbiBjaGlsZCBjbGFzc2VzLicpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VBZGFwdGVyLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7XFxyXFxuICAgIHRocm93IG5ldyBFcnJvcignVGhlIGBxdWVyeWAgbWV0aG9kIG11c3QgYmUgZGVmaW5lZCBpbiBjaGlsZCBjbGFzc2VzLicpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VBZGFwdGVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICAvLyBDYW4gYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3Nlc1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VBZGFwdGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICAvLyBDYW4gYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3Nlc1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEJhc2VBZGFwdGVyLnByb3RvdHlwZS5nZW5lcmF0ZVJlc3VsdElkID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgZGF0YSkge1xcclxcbiAgICB2YXIgaWQgPSBjb250YWluZXIuaWQgKyAnLXJlc3VsdC0nO1xcclxcblxcclxcbiAgICBpZCArPSBVdGlscy5nZW5lcmF0ZUNoYXJzKDQpO1xcclxcblxcclxcbiAgICBpZiAoZGF0YS5pZCAhPSBudWxsKSB7XFxyXFxuICAgICAgaWQgKz0gJy0nICsgZGF0YS5pZC50b1N0cmluZygpO1xcclxcbiAgICB9IGVsc2Uge1xcclxcbiAgICAgIGlkICs9ICctJyArIFV0aWxzLmdlbmVyYXRlQ2hhcnMoNCk7XFxyXFxuICAgIH1cXHJcXG4gICAgcmV0dXJuIGlkO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBCYXNlQWRhcHRlcjtcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ3NlbGVjdDIvZGF0YS9zZWxlY3QnLFtcXHJcXG4gICcuL2Jhc2UnLFxcclxcbiAgJy4uL3V0aWxzJyxcXHJcXG4gICdqcXVlcnknXFxyXFxuXSwgZnVuY3Rpb24gKEJhc2VBZGFwdGVyLCBVdGlscywgJCkge1xcclxcbiAgZnVuY3Rpb24gU2VsZWN0QWRhcHRlciAoJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xcclxcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xcclxcblxcclxcbiAgICBTZWxlY3RBZGFwdGVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpO1xcclxcbiAgfVxcclxcblxcclxcbiAgVXRpbHMuRXh0ZW5kKFNlbGVjdEFkYXB0ZXIsIEJhc2VBZGFwdGVyKTtcXHJcXG5cXHJcXG4gIFNlbGVjdEFkYXB0ZXIucHJvdG90eXBlLmN1cnJlbnQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcXHJcXG4gICAgdmFyIGRhdGEgPSBbXTtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICB0aGlzLiRlbGVtZW50LmZpbmQoJzpzZWxlY3RlZCcpLmVhY2goZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHZhciAkb3B0aW9uID0gJCh0aGlzKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgb3B0aW9uID0gc2VsZi5pdGVtKCRvcHRpb24pO1xcclxcblxcclxcbiAgICAgIGRhdGEucHVzaChvcHRpb24pO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY2FsbGJhY2soZGF0YSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0QWRhcHRlci5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBkYXRhLnNlbGVjdGVkID0gdHJ1ZTtcXHJcXG5cXHJcXG4gICAgLy8gSWYgZGF0YS5lbGVtZW50IGlzIGEgRE9NIG5vZGUsIHVzZSBpdCBpbnN0ZWFkXFxyXFxuICAgIGlmICgkKGRhdGEuZWxlbWVudCkuaXMoJ29wdGlvbicpKSB7XFxyXFxuICAgICAgZGF0YS5lbGVtZW50LnNlbGVjdGVkID0gdHJ1ZTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoJ2NoYW5nZScpO1xcclxcblxcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAodGhpcy4kZWxlbWVudC5wcm9wKCdtdWx0aXBsZScpKSB7XFxyXFxuICAgICAgdGhpcy5jdXJyZW50KGZ1bmN0aW9uIChjdXJyZW50RGF0YSkge1xcclxcbiAgICAgICAgdmFyIHZhbCA9IFtdO1xcclxcblxcclxcbiAgICAgICAgZGF0YSA9IFtkYXRhXTtcXHJcXG4gICAgICAgIGRhdGEucHVzaC5hcHBseShkYXRhLCBjdXJyZW50RGF0YSk7XFxyXFxuXFxyXFxuICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRhdGEubGVuZ3RoOyBkKyspIHtcXHJcXG4gICAgICAgICAgdmFyIGlkID0gZGF0YVtkXS5pZDtcXHJcXG5cXHJcXG4gICAgICAgICAgaWYgKCQuaW5BcnJheShpZCwgdmFsKSA9PT0gLTEpIHtcXHJcXG4gICAgICAgICAgICB2YWwucHVzaChpZCk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIHNlbGYuJGVsZW1lbnQudmFsKHZhbCk7XFxyXFxuICAgICAgICBzZWxmLiRlbGVtZW50LnRyaWdnZXIoJ2NoYW5nZScpO1xcclxcbiAgICAgIH0pO1xcclxcbiAgICB9IGVsc2Uge1xcclxcbiAgICAgIHZhciB2YWwgPSBkYXRhLmlkO1xcclxcblxcclxcbiAgICAgIHRoaXMuJGVsZW1lbnQudmFsKHZhbCk7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdjaGFuZ2UnKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdEFkYXB0ZXIucHJvdG90eXBlLnVuc2VsZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBpZiAoIXRoaXMuJGVsZW1lbnQucHJvcCgnbXVsdGlwbGUnKSkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBkYXRhLnNlbGVjdGVkID0gZmFsc2U7XFxyXFxuXFxyXFxuICAgIGlmICgkKGRhdGEuZWxlbWVudCkuaXMoJ29wdGlvbicpKSB7XFxyXFxuICAgICAgZGF0YS5lbGVtZW50LnNlbGVjdGVkID0gZmFsc2U7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdjaGFuZ2UnKTtcXHJcXG5cXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy5jdXJyZW50KGZ1bmN0aW9uIChjdXJyZW50RGF0YSkge1xcclxcbiAgICAgIHZhciB2YWwgPSBbXTtcXHJcXG5cXHJcXG4gICAgICBmb3IgKHZhciBkID0gMDsgZCA8IGN1cnJlbnREYXRhLmxlbmd0aDsgZCsrKSB7XFxyXFxuICAgICAgICB2YXIgaWQgPSBjdXJyZW50RGF0YVtkXS5pZDtcXHJcXG5cXHJcXG4gICAgICAgIGlmIChpZCAhPT0gZGF0YS5pZCAmJiAkLmluQXJyYXkoaWQsIHZhbCkgPT09IC0xKSB7XFxyXFxuICAgICAgICAgIHZhbC5wdXNoKGlkKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgc2VsZi4kZWxlbWVudC52YWwodmFsKTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLiRlbGVtZW50LnRyaWdnZXIoJ2NoYW5nZScpO1xcclxcbiAgICB9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RBZGFwdGVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3NlbGVjdCcsIGZ1bmN0aW9uIChwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLnNlbGVjdChwYXJhbXMuZGF0YSk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ3Vuc2VsZWN0JywgZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgIHNlbGYudW5zZWxlY3QocGFyYW1zLmRhdGEpO1xcclxcbiAgICB9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RBZGFwdGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICAvLyBSZW1vdmUgYW55dGhpbmcgYWRkZWQgdG8gY2hpbGQgZWxlbWVudHNcXHJcXG4gICAgdGhpcy4kZWxlbWVudC5maW5kKCcqJykuZWFjaChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgLy8gUmVtb3ZlIGFueSBjdXN0b20gZGF0YSBzZXQgYnkgU2VsZWN0MlxcclxcbiAgICAgICQucmVtb3ZlRGF0YSh0aGlzLCAnZGF0YScpO1xcclxcbiAgICB9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RBZGFwdGVyLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7XFxyXFxuICAgIHZhciBkYXRhID0gW107XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgdmFyICRvcHRpb25zID0gdGhpcy4kZWxlbWVudC5jaGlsZHJlbigpO1xcclxcblxcclxcbiAgICAkb3B0aW9ucy5lYWNoKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgJG9wdGlvbiA9ICQodGhpcyk7XFxyXFxuXFxyXFxuICAgICAgaWYgKCEkb3B0aW9uLmlzKCdvcHRpb24nKSAmJiAhJG9wdGlvbi5pcygnb3B0Z3JvdXAnKSkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB2YXIgb3B0aW9uID0gc2VsZi5pdGVtKCRvcHRpb24pO1xcclxcblxcclxcbiAgICAgIHZhciBtYXRjaGVzID0gc2VsZi5tYXRjaGVzKHBhcmFtcywgb3B0aW9uKTtcXHJcXG5cXHJcXG4gICAgICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xcclxcbiAgICAgICAgZGF0YS5wdXNoKG1hdGNoZXMpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNhbGxiYWNrKHtcXHJcXG4gICAgICByZXN1bHRzOiBkYXRhXFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdEFkYXB0ZXIucHJvdG90eXBlLmFkZE9wdGlvbnMgPSBmdW5jdGlvbiAoJG9wdGlvbnMpIHtcXHJcXG4gICAgVXRpbHMuYXBwZW5kTWFueSh0aGlzLiRlbGVtZW50LCAkb3B0aW9ucyk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0QWRhcHRlci5wcm90b3R5cGUub3B0aW9uID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgdmFyIG9wdGlvbjtcXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEuY2hpbGRyZW4pIHtcXHJcXG4gICAgICBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRncm91cCcpO1xcclxcbiAgICAgIG9wdGlvbi5sYWJlbCA9IGRhdGEudGV4dDtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9uLnRleHRDb250ZW50ICE9PSB1bmRlZmluZWQpIHtcXHJcXG4gICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGRhdGEudGV4dDtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgb3B0aW9uLmlubmVyVGV4dCA9IGRhdGEudGV4dDtcXHJcXG4gICAgICB9XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEuaWQpIHtcXHJcXG4gICAgICBvcHRpb24udmFsdWUgPSBkYXRhLmlkO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChkYXRhLmRpc2FibGVkKSB7XFxyXFxuICAgICAgb3B0aW9uLmRpc2FibGVkID0gdHJ1ZTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoZGF0YS5zZWxlY3RlZCkge1xcclxcbiAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKGRhdGEudGl0bGUpIHtcXHJcXG4gICAgICBvcHRpb24udGl0bGUgPSBkYXRhLnRpdGxlO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciAkb3B0aW9uID0gJChvcHRpb24pO1xcclxcblxcclxcbiAgICB2YXIgbm9ybWFsaXplZERhdGEgPSB0aGlzLl9ub3JtYWxpemVJdGVtKGRhdGEpO1xcclxcbiAgICBub3JtYWxpemVkRGF0YS5lbGVtZW50ID0gb3B0aW9uO1xcclxcblxcclxcbiAgICAvLyBPdmVycmlkZSB0aGUgb3B0aW9uJ3MgZGF0YSB3aXRoIHRoZSBjb21iaW5lZCBkYXRhXFxyXFxuICAgICQuZGF0YShvcHRpb24sICdkYXRhJywgbm9ybWFsaXplZERhdGEpO1xcclxcblxcclxcbiAgICByZXR1cm4gJG9wdGlvbjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RBZGFwdGVyLnByb3RvdHlwZS5pdGVtID0gZnVuY3Rpb24gKCRvcHRpb24pIHtcXHJcXG4gICAgdmFyIGRhdGEgPSB7fTtcXHJcXG5cXHJcXG4gICAgZGF0YSA9ICQuZGF0YSgkb3B0aW9uWzBdLCAnZGF0YScpO1xcclxcblxcclxcbiAgICBpZiAoZGF0YSAhPSBudWxsKSB7XFxyXFxuICAgICAgcmV0dXJuIGRhdGE7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKCRvcHRpb24uaXMoJ29wdGlvbicpKSB7XFxyXFxuICAgICAgZGF0YSA9IHtcXHJcXG4gICAgICAgIGlkOiAkb3B0aW9uLnZhbCgpLFxcclxcbiAgICAgICAgdGV4dDogJG9wdGlvbi50ZXh0KCksXFxyXFxuICAgICAgICBkaXNhYmxlZDogJG9wdGlvbi5wcm9wKCdkaXNhYmxlZCcpLFxcclxcbiAgICAgICAgc2VsZWN0ZWQ6ICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnKSxcXHJcXG4gICAgICAgIHRpdGxlOiAkb3B0aW9uLnByb3AoJ3RpdGxlJylcXHJcXG4gICAgICB9O1xcclxcbiAgICB9IGVsc2UgaWYgKCRvcHRpb24uaXMoJ29wdGdyb3VwJykpIHtcXHJcXG4gICAgICBkYXRhID0ge1xcclxcbiAgICAgICAgdGV4dDogJG9wdGlvbi5wcm9wKCdsYWJlbCcpLFxcclxcbiAgICAgICAgY2hpbGRyZW46IFtdLFxcclxcbiAgICAgICAgdGl0bGU6ICRvcHRpb24ucHJvcCgndGl0bGUnKVxcclxcbiAgICAgIH07XFxyXFxuXFxyXFxuICAgICAgdmFyICRjaGlsZHJlbiA9ICRvcHRpb24uY2hpbGRyZW4oJ29wdGlvbicpO1xcclxcbiAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xcclxcblxcclxcbiAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgJGNoaWxkcmVuLmxlbmd0aDsgYysrKSB7XFxyXFxuICAgICAgICB2YXIgJGNoaWxkID0gJCgkY2hpbGRyZW5bY10pO1xcclxcblxcclxcbiAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5pdGVtKCRjaGlsZCk7XFxyXFxuXFxyXFxuICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgZGF0YS5jaGlsZHJlbiA9IGNoaWxkcmVuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRhdGEgPSB0aGlzLl9ub3JtYWxpemVJdGVtKGRhdGEpO1xcclxcbiAgICBkYXRhLmVsZW1lbnQgPSAkb3B0aW9uWzBdO1xcclxcblxcclxcbiAgICAkLmRhdGEoJG9wdGlvblswXSwgJ2RhdGEnLCBkYXRhKTtcXHJcXG5cXHJcXG4gICAgcmV0dXJuIGRhdGE7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0QWRhcHRlci5wcm90b3R5cGUuX25vcm1hbGl6ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xcclxcbiAgICBpZiAoISQuaXNQbGFpbk9iamVjdChpdGVtKSkge1xcclxcbiAgICAgIGl0ZW0gPSB7XFxyXFxuICAgICAgICBpZDogaXRlbSxcXHJcXG4gICAgICAgIHRleHQ6IGl0ZW1cXHJcXG4gICAgICB9O1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGl0ZW0gPSAkLmV4dGVuZCh7fSwge1xcclxcbiAgICAgIHRleHQ6ICcnXFxyXFxuICAgIH0sIGl0ZW0pO1xcclxcblxcclxcbiAgICB2YXIgZGVmYXVsdHMgPSB7XFxyXFxuICAgICAgc2VsZWN0ZWQ6IGZhbHNlLFxcclxcbiAgICAgIGRpc2FibGVkOiBmYWxzZVxcclxcbiAgICB9O1xcclxcblxcclxcbiAgICBpZiAoaXRlbS5pZCAhPSBudWxsKSB7XFxyXFxuICAgICAgaXRlbS5pZCA9IGl0ZW0uaWQudG9TdHJpbmcoKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoaXRlbS50ZXh0ICE9IG51bGwpIHtcXHJcXG4gICAgICBpdGVtLnRleHQgPSBpdGVtLnRleHQudG9TdHJpbmcoKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoaXRlbS5fcmVzdWx0SWQgPT0gbnVsbCAmJiBpdGVtLmlkICYmIHRoaXMuY29udGFpbmVyICE9IG51bGwpIHtcXHJcXG4gICAgICBpdGVtLl9yZXN1bHRJZCA9IHRoaXMuZ2VuZXJhdGVSZXN1bHRJZCh0aGlzLmNvbnRhaW5lciwgaXRlbSk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgaXRlbSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0QWRhcHRlci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChwYXJhbXMsIGRhdGEpIHtcXHJcXG4gICAgdmFyIG1hdGNoZXIgPSB0aGlzLm9wdGlvbnMuZ2V0KCdtYXRjaGVyJyk7XFxyXFxuXFxyXFxuICAgIHJldHVybiBtYXRjaGVyKHBhcmFtcywgZGF0YSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIFNlbGVjdEFkYXB0ZXI7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2RhdGEvYXJyYXknLFtcXHJcXG4gICcuL3NlbGVjdCcsXFxyXFxuICAnLi4vdXRpbHMnLFxcclxcbiAgJ2pxdWVyeSdcXHJcXG5dLCBmdW5jdGlvbiAoU2VsZWN0QWRhcHRlciwgVXRpbHMsICQpIHtcXHJcXG4gIGZ1bmN0aW9uIEFycmF5QWRhcHRlciAoJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgdmFyIGRhdGEgPSBvcHRpb25zLmdldCgnZGF0YScpIHx8IFtdO1xcclxcblxcclxcbiAgICBBcnJheUFkYXB0ZXIuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgJGVsZW1lbnQsIG9wdGlvbnMpO1xcclxcblxcclxcbiAgICB0aGlzLmFkZE9wdGlvbnModGhpcy5jb252ZXJ0VG9PcHRpb25zKGRhdGEpKTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIFV0aWxzLkV4dGVuZChBcnJheUFkYXB0ZXIsIFNlbGVjdEFkYXB0ZXIpO1xcclxcblxcclxcbiAgQXJyYXlBZGFwdGVyLnByb3RvdHlwZS5zZWxlY3QgPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICB2YXIgJG9wdGlvbiA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykuZmlsdGVyKGZ1bmN0aW9uIChpLCBlbG0pIHtcXHJcXG4gICAgICByZXR1cm4gZWxtLnZhbHVlID09IGRhdGEuaWQudG9TdHJpbmcoKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGlmICgkb3B0aW9uLmxlbmd0aCA9PT0gMCkge1xcclxcbiAgICAgICRvcHRpb24gPSB0aGlzLm9wdGlvbihkYXRhKTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLmFkZE9wdGlvbnMoJG9wdGlvbik7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgQXJyYXlBZGFwdGVyLl9fc3VwZXJfXy5zZWxlY3QuY2FsbCh0aGlzLCBkYXRhKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBBcnJheUFkYXB0ZXIucHJvdG90eXBlLmNvbnZlcnRUb09wdGlvbnMgPSBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHZhciAkZXhpc3RpbmcgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ29wdGlvbicpO1xcclxcbiAgICB2YXIgZXhpc3RpbmdJZHMgPSAkZXhpc3RpbmcubWFwKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICByZXR1cm4gc2VsZi5pdGVtKCQodGhpcykpLmlkO1xcclxcbiAgICB9KS5nZXQoKTtcXHJcXG5cXHJcXG4gICAgdmFyICRvcHRpb25zID0gW107XFxyXFxuXFxyXFxuICAgIC8vIEZpbHRlciBvdXQgYWxsIGl0ZW1zIGV4Y2VwdCBmb3IgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIGFyZ3VtZW50XFxyXFxuICAgIGZ1bmN0aW9uIG9ubHlJdGVtIChpdGVtKSB7XFxyXFxuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIHJldHVybiAkKHRoaXMpLnZhbCgpID09IGl0ZW0uaWQ7XFxyXFxuICAgICAgfTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRhdGEubGVuZ3RoOyBkKyspIHtcXHJcXG4gICAgICB2YXIgaXRlbSA9IHRoaXMuX25vcm1hbGl6ZUl0ZW0oZGF0YVtkXSk7XFxyXFxuXFxyXFxuICAgICAgLy8gU2tpcCBpdGVtcyB3aGljaCB3ZXJlIHByZS1sb2FkZWQsIG9ubHkgbWVyZ2UgdGhlIGRhdGFcXHJcXG4gICAgICBpZiAoJC5pbkFycmF5KGl0ZW0uaWQsIGV4aXN0aW5nSWRzKSA+PSAwKSB7XFxyXFxuICAgICAgICB2YXIgJGV4aXN0aW5nT3B0aW9uID0gJGV4aXN0aW5nLmZpbHRlcihvbmx5SXRlbShpdGVtKSk7XFxyXFxuXFxyXFxuICAgICAgICB2YXIgZXhpc3RpbmdEYXRhID0gdGhpcy5pdGVtKCRleGlzdGluZ09wdGlvbik7XFxyXFxuICAgICAgICB2YXIgbmV3RGF0YSA9ICQuZXh0ZW5kKHRydWUsIHt9LCBpdGVtLCBleGlzdGluZ0RhdGEpO1xcclxcblxcclxcbiAgICAgICAgdmFyICRuZXdPcHRpb24gPSB0aGlzLm9wdGlvbihuZXdEYXRhKTtcXHJcXG5cXHJcXG4gICAgICAgICRleGlzdGluZ09wdGlvbi5yZXBsYWNlV2l0aCgkbmV3T3B0aW9uKTtcXHJcXG5cXHJcXG4gICAgICAgIGNvbnRpbnVlO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB2YXIgJG9wdGlvbiA9IHRoaXMub3B0aW9uKGl0ZW0pO1xcclxcblxcclxcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuKSB7XFxyXFxuICAgICAgICB2YXIgJGNoaWxkcmVuID0gdGhpcy5jb252ZXJ0VG9PcHRpb25zKGl0ZW0uY2hpbGRyZW4pO1xcclxcblxcclxcbiAgICAgICAgVXRpbHMuYXBwZW5kTWFueSgkb3B0aW9uLCAkY2hpbGRyZW4pO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAkb3B0aW9ucy5wdXNoKCRvcHRpb24pO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiAkb3B0aW9ucztcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gQXJyYXlBZGFwdGVyO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kYXRhL2FqYXgnLFtcXHJcXG4gICcuL2FycmF5JyxcXHJcXG4gICcuLi91dGlscycsXFxyXFxuICAnanF1ZXJ5J1xcclxcbl0sIGZ1bmN0aW9uIChBcnJheUFkYXB0ZXIsIFV0aWxzLCAkKSB7XFxyXFxuICBmdW5jdGlvbiBBamF4QWRhcHRlciAoJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgdGhpcy5hamF4T3B0aW9ucyA9IHRoaXMuX2FwcGx5RGVmYXVsdHMob3B0aW9ucy5nZXQoJ2FqYXgnKSk7XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLmFqYXhPcHRpb25zLnByb2Nlc3NSZXN1bHRzICE9IG51bGwpIHtcXHJcXG4gICAgICB0aGlzLnByb2Nlc3NSZXN1bHRzID0gdGhpcy5hamF4T3B0aW9ucy5wcm9jZXNzUmVzdWx0cztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBBamF4QWRhcHRlci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCAkZWxlbWVudCwgb3B0aW9ucyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQoQWpheEFkYXB0ZXIsIEFycmF5QWRhcHRlcik7XFxyXFxuXFxyXFxuICBBamF4QWRhcHRlci5wcm90b3R5cGUuX2FwcGx5RGVmYXVsdHMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xcclxcbiAgICB2YXIgZGVmYXVsdHMgPSB7XFxyXFxuICAgICAgZGF0YTogZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBwYXJhbXMsIHtcXHJcXG4gICAgICAgICAgcTogcGFyYW1zLnRlcm1cXHJcXG4gICAgICAgIH0pO1xcclxcbiAgICAgIH0sXFxyXFxuICAgICAgdHJhbnNwb3J0OiBmdW5jdGlvbiAocGFyYW1zLCBzdWNjZXNzLCBmYWlsdXJlKSB7XFxyXFxuICAgICAgICB2YXIgJHJlcXVlc3QgPSAkLmFqYXgocGFyYW1zKTtcXHJcXG5cXHJcXG4gICAgICAgICRyZXF1ZXN0LnRoZW4oc3VjY2Vzcyk7XFxyXFxuICAgICAgICAkcmVxdWVzdC5mYWlsKGZhaWx1cmUpO1xcclxcblxcclxcbiAgICAgICAgcmV0dXJuICRyZXF1ZXN0O1xcclxcbiAgICAgIH1cXHJcXG4gICAgfTtcXHJcXG5cXHJcXG4gICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucywgdHJ1ZSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQWpheEFkYXB0ZXIucHJvdG90eXBlLnByb2Nlc3NSZXN1bHRzID0gZnVuY3Rpb24gKHJlc3VsdHMpIHtcXHJcXG4gICAgcmV0dXJuIHJlc3VsdHM7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQWpheEFkYXB0ZXIucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHtcXHJcXG4gICAgdmFyIG1hdGNoZXMgPSBbXTtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBpZiAodGhpcy5fcmVxdWVzdCAhPSBudWxsKSB7XFxyXFxuICAgICAgLy8gSlNPTlAgcmVxdWVzdHMgY2Fubm90IGFsd2F5cyBiZSBhYm9ydGVkXFxyXFxuICAgICAgaWYgKCQuaXNGdW5jdGlvbih0aGlzLl9yZXF1ZXN0LmFib3J0KSkge1xcclxcbiAgICAgICAgdGhpcy5fcmVxdWVzdC5hYm9ydCgpO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB0aGlzLl9yZXF1ZXN0ID0gbnVsbDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHtcXHJcXG4gICAgICB0eXBlOiAnR0VUJ1xcclxcbiAgICB9LCB0aGlzLmFqYXhPcHRpb25zKTtcXHJcXG5cXHJcXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnVybCA9PT0gJ2Z1bmN0aW9uJykge1xcclxcbiAgICAgIG9wdGlvbnMudXJsID0gb3B0aW9ucy51cmwuY2FsbCh0aGlzLiRlbGVtZW50LCBwYXJhbXMpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5kYXRhID09PSAnZnVuY3Rpb24nKSB7XFxyXFxuICAgICAgb3B0aW9ucy5kYXRhID0gb3B0aW9ucy5kYXRhLmNhbGwodGhpcy4kZWxlbWVudCwgcGFyYW1zKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBmdW5jdGlvbiByZXF1ZXN0ICgpIHtcXHJcXG4gICAgICB2YXIgJHJlcXVlc3QgPSBvcHRpb25zLnRyYW5zcG9ydChvcHRpb25zLCBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBzZWxmLnByb2Nlc3NSZXN1bHRzKGRhdGEsIHBhcmFtcyk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmdldCgnZGVidWcnKSAmJiB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLmVycm9yKSB7XFxyXFxuICAgICAgICAgIC8vIENoZWNrIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSByZXNwb25zZSBpbmNsdWRlZCBhIGByZXN1bHRzYCBrZXkuXFxyXFxuICAgICAgICAgIGlmICghcmVzdWx0cyB8fCAhcmVzdWx0cy5yZXN1bHRzIHx8ICEkLmlzQXJyYXkocmVzdWx0cy5yZXN1bHRzKSkge1xcclxcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXFxyXFxuICAgICAgICAgICAgICAnU2VsZWN0MjogVGhlIEFKQVggcmVzdWx0cyBkaWQgbm90IHJldHVybiBhbiBhcnJheSBpbiB0aGUgJyArXFxyXFxuICAgICAgICAgICAgICAnYHJlc3VsdHNgIGtleSBvZiB0aGUgcmVzcG9uc2UuJ1xcclxcbiAgICAgICAgICAgICk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGNhbGxiYWNrKHJlc3VsdHMpO1xcclxcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gZGV0ZWN0IGlmIGEgcmVxdWVzdCB3YXMgYWJvcnRlZFxcclxcbiAgICAgICAgLy8gT25seSB3b3JrcyBpZiB0aGUgdHJhbnNwb3J0IGV4cG9zZXMgYSBzdGF0dXMgcHJvcGVydHlcXHJcXG4gICAgICAgIGlmICgkcmVxdWVzdC5zdGF0dXMgJiYgJHJlcXVlc3Quc3RhdHVzID09PSAnMCcpIHtcXHJcXG4gICAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgc2VsZi50cmlnZ2VyKCdyZXN1bHRzOm1lc3NhZ2UnLCB7XFxyXFxuICAgICAgICAgIG1lc3NhZ2U6ICdlcnJvckxvYWRpbmcnXFxyXFxuICAgICAgICB9KTtcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLl9yZXF1ZXN0ID0gJHJlcXVlc3Q7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMuYWpheE9wdGlvbnMuZGVsYXkgJiYgcGFyYW1zLnRlcm0gIT0gbnVsbCkge1xcclxcbiAgICAgIGlmICh0aGlzLl9xdWVyeVRpbWVvdXQpIHtcXHJcXG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fcXVlcnlUaW1lb3V0KTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdGhpcy5fcXVlcnlUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQocmVxdWVzdCwgdGhpcy5hamF4T3B0aW9ucy5kZWxheSk7XFxyXFxuICAgIH0gZWxzZSB7XFxyXFxuICAgICAgcmVxdWVzdCgpO1xcclxcbiAgICB9XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIEFqYXhBZGFwdGVyO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kYXRhL3RhZ3MnLFtcXHJcXG4gICdqcXVlcnknXFxyXFxuXSwgZnVuY3Rpb24gKCQpIHtcXHJcXG4gIGZ1bmN0aW9uIFRhZ3MgKGRlY29yYXRlZCwgJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgdmFyIHRhZ3MgPSBvcHRpb25zLmdldCgndGFncycpO1xcclxcblxcclxcbiAgICB2YXIgY3JlYXRlVGFnID0gb3B0aW9ucy5nZXQoJ2NyZWF0ZVRhZycpO1xcclxcblxcclxcbiAgICBpZiAoY3JlYXRlVGFnICE9PSB1bmRlZmluZWQpIHtcXHJcXG4gICAgICB0aGlzLmNyZWF0ZVRhZyA9IGNyZWF0ZVRhZztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgaW5zZXJ0VGFnID0gb3B0aW9ucy5nZXQoJ2luc2VydFRhZycpO1xcclxcblxcclxcbiAgICBpZiAoaW5zZXJ0VGFnICE9PSB1bmRlZmluZWQpIHtcXHJcXG4gICAgICAgIHRoaXMuaW5zZXJ0VGFnID0gaW5zZXJ0VGFnO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsICRlbGVtZW50LCBvcHRpb25zKTtcXHJcXG5cXHJcXG4gICAgaWYgKCQuaXNBcnJheSh0YWdzKSkge1xcclxcbiAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgdGFncy5sZW5ndGg7IHQrKykge1xcclxcbiAgICAgICAgdmFyIHRhZyA9IHRhZ3NbdF07XFxyXFxuICAgICAgICB2YXIgaXRlbSA9IHRoaXMuX25vcm1hbGl6ZUl0ZW0odGFnKTtcXHJcXG5cXHJcXG4gICAgICAgIHZhciAkb3B0aW9uID0gdGhpcy5vcHRpb24oaXRlbSk7XFxyXFxuXFxyXFxuICAgICAgICB0aGlzLiRlbGVtZW50LmFwcGVuZCgkb3B0aW9uKTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH1cXHJcXG4gIH1cXHJcXG5cXHJcXG4gIFRhZ3MucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKGRlY29yYXRlZCwgcGFyYW1zLCBjYWxsYmFjaykge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHRoaXMuX3JlbW92ZU9sZFRhZ3MoKTtcXHJcXG5cXHJcXG4gICAgaWYgKHBhcmFtcy50ZXJtID09IG51bGwgfHwgcGFyYW1zLnBhZ2UgIT0gbnVsbCkge1xcclxcbiAgICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIHBhcmFtcywgY2FsbGJhY2spO1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBmdW5jdGlvbiB3cmFwcGVyIChvYmosIGNoaWxkKSB7XFxyXFxuICAgICAgdmFyIGRhdGEgPSBvYmoucmVzdWx0cztcXHJcXG5cXHJcXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcXHJcXG4gICAgICAgIHZhciBvcHRpb24gPSBkYXRhW2ldO1xcclxcblxcclxcbiAgICAgICAgdmFyIGNoZWNrQ2hpbGRyZW4gPSAoXFxyXFxuICAgICAgICAgIG9wdGlvbi5jaGlsZHJlbiAhPSBudWxsICYmXFxyXFxuICAgICAgICAgICF3cmFwcGVyKHtcXHJcXG4gICAgICAgICAgICByZXN1bHRzOiBvcHRpb24uY2hpbGRyZW5cXHJcXG4gICAgICAgICAgfSwgdHJ1ZSlcXHJcXG4gICAgICAgICk7XFxyXFxuXFxyXFxuICAgICAgICB2YXIgY2hlY2tUZXh0ID0gb3B0aW9uLnRleHQgPT09IHBhcmFtcy50ZXJtO1xcclxcblxcclxcbiAgICAgICAgaWYgKGNoZWNrVGV4dCB8fCBjaGVja0NoaWxkcmVuKSB7XFxyXFxuICAgICAgICAgIGlmIChjaGlsZCkge1xcclxcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICBvYmouZGF0YSA9IGRhdGE7XFxyXFxuICAgICAgICAgIGNhbGxiYWNrKG9iaik7XFxyXFxuXFxyXFxuICAgICAgICAgIHJldHVybjtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKGNoaWxkKSB7XFxyXFxuICAgICAgICByZXR1cm4gdHJ1ZTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyIHRhZyA9IHNlbGYuY3JlYXRlVGFnKHBhcmFtcyk7XFxyXFxuXFxyXFxuICAgICAgaWYgKHRhZyAhPSBudWxsKSB7XFxyXFxuICAgICAgICB2YXIgJG9wdGlvbiA9IHNlbGYub3B0aW9uKHRhZyk7XFxyXFxuICAgICAgICAkb3B0aW9uLmF0dHIoJ2RhdGEtc2VsZWN0Mi10YWcnLCB0cnVlKTtcXHJcXG5cXHJcXG4gICAgICAgIHNlbGYuYWRkT3B0aW9ucyhbJG9wdGlvbl0pO1xcclxcblxcclxcbiAgICAgICAgc2VsZi5pbnNlcnRUYWcoZGF0YSwgdGFnKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgb2JqLnJlc3VsdHMgPSBkYXRhO1xcclxcblxcclxcbiAgICAgIGNhbGxiYWNrKG9iaik7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgcGFyYW1zLCB3cmFwcGVyKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBUYWdzLnByb3RvdHlwZS5jcmVhdGVUYWcgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBwYXJhbXMpIHtcXHJcXG4gICAgdmFyIHRlcm0gPSAkLnRyaW0ocGFyYW1zLnRlcm0pO1xcclxcblxcclxcbiAgICBpZiAodGVybSA9PT0gJycpIHtcXHJcXG4gICAgICByZXR1cm4gbnVsbDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4ge1xcclxcbiAgICAgIGlkOiB0ZXJtLFxcclxcbiAgICAgIHRleHQ6IHRlcm1cXHJcXG4gICAgfTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBUYWdzLnByb3RvdHlwZS5pbnNlcnRUYWcgPSBmdW5jdGlvbiAoXywgZGF0YSwgdGFnKSB7XFxyXFxuICAgIGRhdGEudW5zaGlmdCh0YWcpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFRhZ3MucHJvdG90eXBlLl9yZW1vdmVPbGRUYWdzID0gZnVuY3Rpb24gKF8pIHtcXHJcXG4gICAgdmFyIHRhZyA9IHRoaXMuX2xhc3RUYWc7XFxyXFxuXFxyXFxuICAgIHZhciAkb3B0aW9ucyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uW2RhdGEtc2VsZWN0Mi10YWddJyk7XFxyXFxuXFxyXFxuICAgICRvcHRpb25zLmVhY2goZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIGlmICh0aGlzLnNlbGVjdGVkKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgICQodGhpcykucmVtb3ZlKCk7XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBUYWdzO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kYXRhL3Rva2VuaXplcicsW1xcclxcbiAgJ2pxdWVyeSdcXHJcXG5dLCBmdW5jdGlvbiAoJCkge1xcclxcbiAgZnVuY3Rpb24gVG9rZW5pemVyIChkZWNvcmF0ZWQsICRlbGVtZW50LCBvcHRpb25zKSB7XFxyXFxuICAgIHZhciB0b2tlbml6ZXIgPSBvcHRpb25zLmdldCgndG9rZW5pemVyJyk7XFxyXFxuXFxyXFxuICAgIGlmICh0b2tlbml6ZXIgIT09IHVuZGVmaW5lZCkge1xcclxcbiAgICAgIHRoaXMudG9rZW5pemVyID0gdG9rZW5pemVyO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsICRlbGVtZW50LCBvcHRpb25zKTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIFRva2VuaXplci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCBjb250YWluZXIsICRjb250YWluZXIpO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWFyY2ggPSAgY29udGFpbmVyLmRyb3Bkb3duLiRzZWFyY2ggfHwgY29udGFpbmVyLnNlbGVjdGlvbi4kc2VhcmNoIHx8XFxyXFxuICAgICAgJGNvbnRhaW5lci5maW5kKCcuc2VsZWN0Mi1zZWFyY2hfX2ZpZWxkJyk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgVG9rZW5pemVyLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIHBhcmFtcywgY2FsbGJhY2spIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICBmdW5jdGlvbiBjcmVhdGVBbmRTZWxlY3QgKGRhdGEpIHtcXHJcXG4gICAgICAvLyBOb3JtYWxpemUgdGhlIGRhdGEgb2JqZWN0IHNvIHdlIGNhbiB1c2UgaXQgZm9yIGNoZWNrc1xcclxcbiAgICAgIHZhciBpdGVtID0gc2VsZi5fbm9ybWFsaXplSXRlbShkYXRhKTtcXHJcXG5cXHJcXG4gICAgICAvLyBDaGVjayBpZiB0aGUgZGF0YSBvYmplY3QgYWxyZWFkeSBleGlzdHMgYXMgYSB0YWdcXHJcXG4gICAgICAvLyBTZWxlY3QgaXQgaWYgaXQgZG9lc24ndFxcclxcbiAgICAgIHZhciAkZXhpc3RpbmdPcHRpb25zID0gc2VsZi4kZWxlbWVudC5maW5kKCdvcHRpb24nKS5maWx0ZXIoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgcmV0dXJuICQodGhpcykudmFsKCkgPT09IGl0ZW0uaWQ7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgLy8gSWYgYW4gZXhpc3Rpbmcgb3B0aW9uIHdhc24ndCBmb3VuZCBmb3IgaXQsIGNyZWF0ZSB0aGUgb3B0aW9uXFxyXFxuICAgICAgaWYgKCEkZXhpc3RpbmdPcHRpb25zLmxlbmd0aCkge1xcclxcbiAgICAgICAgdmFyICRvcHRpb24gPSBzZWxmLm9wdGlvbihpdGVtKTtcXHJcXG4gICAgICAgICRvcHRpb24uYXR0cignZGF0YS1zZWxlY3QyLXRhZycsIHRydWUpO1xcclxcblxcclxcbiAgICAgICAgc2VsZi5fcmVtb3ZlT2xkVGFncygpO1xcclxcbiAgICAgICAgc2VsZi5hZGRPcHRpb25zKFskb3B0aW9uXSk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIC8vIFNlbGVjdCB0aGUgaXRlbSwgbm93IHRoYXQgd2Uga25vdyB0aGVyZSBpcyBhbiBvcHRpb24gZm9yIGl0XFxyXFxuICAgICAgc2VsZWN0KGl0ZW0pO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGZ1bmN0aW9uIHNlbGVjdCAoZGF0YSkge1xcclxcbiAgICAgIHNlbGYudHJpZ2dlcignc2VsZWN0Jywge1xcclxcbiAgICAgICAgZGF0YTogZGF0YVxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHBhcmFtcy50ZXJtID0gcGFyYW1zLnRlcm0gfHwgJyc7XFxyXFxuXFxyXFxuICAgIHZhciB0b2tlbkRhdGEgPSB0aGlzLnRva2VuaXplcihwYXJhbXMsIHRoaXMub3B0aW9ucywgY3JlYXRlQW5kU2VsZWN0KTtcXHJcXG5cXHJcXG4gICAgaWYgKHRva2VuRGF0YS50ZXJtICE9PSBwYXJhbXMudGVybSkge1xcclxcbiAgICAgIC8vIFJlcGxhY2UgdGhlIHNlYXJjaCB0ZXJtIGlmIHdlIGhhdmUgdGhlIHNlYXJjaCBib3hcXHJcXG4gICAgICBpZiAodGhpcy4kc2VhcmNoLmxlbmd0aCkge1xcclxcbiAgICAgICAgdGhpcy4kc2VhcmNoLnZhbCh0b2tlbkRhdGEudGVybSk7XFxyXFxuICAgICAgICB0aGlzLiRzZWFyY2guZm9jdXMoKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcGFyYW1zLnRlcm0gPSB0b2tlbkRhdGEudGVybTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCBwYXJhbXMsIGNhbGxiYWNrKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBUb2tlbml6ZXIucHJvdG90eXBlLnRva2VuaXplciA9IGZ1bmN0aW9uIChfLCBwYXJhbXMsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XFxyXFxuICAgIHZhciBzZXBhcmF0b3JzID0gb3B0aW9ucy5nZXQoJ3Rva2VuU2VwYXJhdG9ycycpIHx8IFtdO1xcclxcbiAgICB2YXIgdGVybSA9IHBhcmFtcy50ZXJtO1xcclxcbiAgICB2YXIgaSA9IDA7XFxyXFxuXFxyXFxuICAgIHZhciBjcmVhdGVUYWcgPSB0aGlzLmNyZWF0ZVRhZyB8fCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgcmV0dXJuIHtcXHJcXG4gICAgICAgIGlkOiBwYXJhbXMudGVybSxcXHJcXG4gICAgICAgIHRleHQ6IHBhcmFtcy50ZXJtXFxyXFxuICAgICAgfTtcXHJcXG4gICAgfTtcXHJcXG5cXHJcXG4gICAgd2hpbGUgKGkgPCB0ZXJtLmxlbmd0aCkge1xcclxcbiAgICAgIHZhciB0ZXJtQ2hhciA9IHRlcm1baV07XFxyXFxuXFxyXFxuICAgICAgaWYgKCQuaW5BcnJheSh0ZXJtQ2hhciwgc2VwYXJhdG9ycykgPT09IC0xKSB7XFxyXFxuICAgICAgICBpKys7XFxyXFxuXFxyXFxuICAgICAgICBjb250aW51ZTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyIHBhcnQgPSB0ZXJtLnN1YnN0cigwLCBpKTtcXHJcXG4gICAgICB2YXIgcGFydFBhcmFtcyA9ICQuZXh0ZW5kKHt9LCBwYXJhbXMsIHtcXHJcXG4gICAgICAgIHRlcm06IHBhcnRcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICB2YXIgZGF0YSA9IGNyZWF0ZVRhZyhwYXJ0UGFyYW1zKTtcXHJcXG5cXHJcXG4gICAgICBpZiAoZGF0YSA9PSBudWxsKSB7XFxyXFxuICAgICAgICBpKys7XFxyXFxuICAgICAgICBjb250aW51ZTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgY2FsbGJhY2soZGF0YSk7XFxyXFxuXFxyXFxuICAgICAgLy8gUmVzZXQgdGhlIHRlcm0gdG8gbm90IGluY2x1ZGUgdGhlIHRva2VuaXplZCBwb3J0aW9uXFxyXFxuICAgICAgdGVybSA9IHRlcm0uc3Vic3RyKGkgKyAxKSB8fCAnJztcXHJcXG4gICAgICBpID0gMDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4ge1xcclxcbiAgICAgIHRlcm06IHRlcm1cXHJcXG4gICAgfTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gVG9rZW5pemVyO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kYXRhL21pbmltdW1JbnB1dExlbmd0aCcsW1xcclxcblxcclxcbl0sIGZ1bmN0aW9uICgpIHtcXHJcXG4gIGZ1bmN0aW9uIE1pbmltdW1JbnB1dExlbmd0aCAoZGVjb3JhdGVkLCAkZSwgb3B0aW9ucykge1xcclxcbiAgICB0aGlzLm1pbmltdW1JbnB1dExlbmd0aCA9IG9wdGlvbnMuZ2V0KCdtaW5pbXVtSW5wdXRMZW5ndGgnKTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgJGUsIG9wdGlvbnMpO1xcclxcbiAgfVxcclxcblxcclxcbiAgTWluaW11bUlucHV0TGVuZ3RoLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIHBhcmFtcywgY2FsbGJhY2spIHtcXHJcXG4gICAgcGFyYW1zLnRlcm0gPSBwYXJhbXMudGVybSB8fCAnJztcXHJcXG5cXHJcXG4gICAgaWYgKHBhcmFtcy50ZXJtLmxlbmd0aCA8IHRoaXMubWluaW11bUlucHV0TGVuZ3RoKSB7XFxyXFxuICAgICAgdGhpcy50cmlnZ2VyKCdyZXN1bHRzOm1lc3NhZ2UnLCB7XFxyXFxuICAgICAgICBtZXNzYWdlOiAnaW5wdXRUb29TaG9ydCcsXFxyXFxuICAgICAgICBhcmdzOiB7XFxyXFxuICAgICAgICAgIG1pbmltdW06IHRoaXMubWluaW11bUlucHV0TGVuZ3RoLFxcclxcbiAgICAgICAgICBpbnB1dDogcGFyYW1zLnRlcm0sXFxyXFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zXFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIHBhcmFtcywgY2FsbGJhY2spO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBNaW5pbXVtSW5wdXRMZW5ndGg7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2RhdGEvbWF4aW11bUlucHV0TGVuZ3RoJyxbXFxyXFxuXFxyXFxuXSwgZnVuY3Rpb24gKCkge1xcclxcbiAgZnVuY3Rpb24gTWF4aW11bUlucHV0TGVuZ3RoIChkZWNvcmF0ZWQsICRlLCBvcHRpb25zKSB7XFxyXFxuICAgIHRoaXMubWF4aW11bUlucHV0TGVuZ3RoID0gb3B0aW9ucy5nZXQoJ21heGltdW1JbnB1dExlbmd0aCcpO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCAkZSwgb3B0aW9ucyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBNYXhpbXVtSW5wdXRMZW5ndGgucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKGRlY29yYXRlZCwgcGFyYW1zLCBjYWxsYmFjaykge1xcclxcbiAgICBwYXJhbXMudGVybSA9IHBhcmFtcy50ZXJtIHx8ICcnO1xcclxcblxcclxcbiAgICBpZiAodGhpcy5tYXhpbXVtSW5wdXRMZW5ndGggPiAwICYmXFxyXFxuICAgICAgICBwYXJhbXMudGVybS5sZW5ndGggPiB0aGlzLm1heGltdW1JbnB1dExlbmd0aCkge1xcclxcbiAgICAgIHRoaXMudHJpZ2dlcigncmVzdWx0czptZXNzYWdlJywge1xcclxcbiAgICAgICAgbWVzc2FnZTogJ2lucHV0VG9vTG9uZycsXFxyXFxuICAgICAgICBhcmdzOiB7XFxyXFxuICAgICAgICAgIG1heGltdW06IHRoaXMubWF4aW11bUlucHV0TGVuZ3RoLFxcclxcbiAgICAgICAgICBpbnB1dDogcGFyYW1zLnRlcm0sXFxyXFxuICAgICAgICAgIHBhcmFtczogcGFyYW1zXFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIHBhcmFtcywgY2FsbGJhY2spO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBNYXhpbXVtSW5wdXRMZW5ndGg7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2RhdGEvbWF4aW11bVNlbGVjdGlvbkxlbmd0aCcsW1xcclxcblxcclxcbl0sIGZ1bmN0aW9uICgpe1xcclxcbiAgZnVuY3Rpb24gTWF4aW11bVNlbGVjdGlvbkxlbmd0aCAoZGVjb3JhdGVkLCAkZSwgb3B0aW9ucykge1xcclxcbiAgICB0aGlzLm1heGltdW1TZWxlY3Rpb25MZW5ndGggPSBvcHRpb25zLmdldCgnbWF4aW11bVNlbGVjdGlvbkxlbmd0aCcpO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCAkZSwgb3B0aW9ucyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBNYXhpbXVtU2VsZWN0aW9uTGVuZ3RoLnByb3RvdHlwZS5xdWVyeSA9XFxyXFxuICAgIGZ1bmN0aW9uIChkZWNvcmF0ZWQsIHBhcmFtcywgY2FsbGJhY2spIHtcXHJcXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgICAgdGhpcy5jdXJyZW50KGZ1bmN0aW9uIChjdXJyZW50RGF0YSkge1xcclxcbiAgICAgICAgdmFyIGNvdW50ID0gY3VycmVudERhdGEgIT0gbnVsbCA/IGN1cnJlbnREYXRhLmxlbmd0aCA6IDA7XFxyXFxuICAgICAgICBpZiAoc2VsZi5tYXhpbXVtU2VsZWN0aW9uTGVuZ3RoID4gMCAmJlxcclxcbiAgICAgICAgICBjb3VudCA+PSBzZWxmLm1heGltdW1TZWxlY3Rpb25MZW5ndGgpIHtcXHJcXG4gICAgICAgICAgc2VsZi50cmlnZ2VyKCdyZXN1bHRzOm1lc3NhZ2UnLCB7XFxyXFxuICAgICAgICAgICAgbWVzc2FnZTogJ21heGltdW1TZWxlY3RlZCcsXFxyXFxuICAgICAgICAgICAgYXJnczoge1xcclxcbiAgICAgICAgICAgICAgbWF4aW11bTogc2VsZi5tYXhpbXVtU2VsZWN0aW9uTGVuZ3RoXFxyXFxuICAgICAgICAgICAgfVxcclxcbiAgICAgICAgICB9KTtcXHJcXG4gICAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgZGVjb3JhdGVkLmNhbGwoc2VsZiwgcGFyYW1zLCBjYWxsYmFjayk7XFxyXFxuICAgICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIE1heGltdW1TZWxlY3Rpb25MZW5ndGg7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duJyxbXFxyXFxuICAnanF1ZXJ5JyxcXHJcXG4gICcuL3V0aWxzJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCBVdGlscykge1xcclxcbiAgZnVuY3Rpb24gRHJvcGRvd24gKCRlbGVtZW50LCBvcHRpb25zKSB7XFxyXFxuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcXHJcXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcXHJcXG5cXHJcXG4gICAgRHJvcGRvd24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQoRHJvcGRvd24sIFV0aWxzLk9ic2VydmFibGUpO1xcclxcblxcclxcbiAgRHJvcGRvd24ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyICRkcm9wZG93biA9ICQoXFxyXFxuICAgICAgJzxzcGFuIGNsYXNzPVxcXCJzZWxlY3QyLWRyb3Bkb3duXFxcIj4nICtcXHJcXG4gICAgICAgICc8c3BhbiBjbGFzcz1cXFwic2VsZWN0Mi1yZXN1bHRzXFxcIj48L3NwYW4+JyArXFxyXFxuICAgICAgJzwvc3Bhbj4nXFxyXFxuICAgICk7XFxyXFxuXFxyXFxuICAgICRkcm9wZG93bi5hdHRyKCdkaXInLCB0aGlzLm9wdGlvbnMuZ2V0KCdkaXInKSk7XFxyXFxuXFxyXFxuICAgIHRoaXMuJGRyb3Bkb3duID0gJGRyb3Bkb3duO1xcclxcblxcclxcbiAgICByZXR1cm4gJGRyb3Bkb3duO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIERyb3Bkb3duLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICAvLyBTaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3Nlc1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIERyb3Bkb3duLnByb3RvdHlwZS5wb3NpdGlvbiA9IGZ1bmN0aW9uICgkZHJvcGRvd24sICRjb250YWluZXIpIHtcXHJcXG4gICAgLy8gU2hvdWxkIGJlIGltcGxtZW50ZWQgaW4gc3ViY2xhc3Nlc1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIERyb3Bkb3duLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICAvLyBSZW1vdmUgdGhlIGRyb3Bkb3duIGZyb20gdGhlIERPTVxcclxcbiAgICB0aGlzLiRkcm9wZG93bi5yZW1vdmUoKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gRHJvcGRvd247XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duL3NlYXJjaCcsW1xcclxcbiAgJ2pxdWVyeScsXFxyXFxuICAnLi4vdXRpbHMnXFxyXFxuXSwgZnVuY3Rpb24gKCQsIFV0aWxzKSB7XFxyXFxuICBmdW5jdGlvbiBTZWFyY2ggKCkgeyB9XFxyXFxuXFxyXFxuICBTZWFyY2gucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQpIHtcXHJcXG4gICAgdmFyICRyZW5kZXJlZCA9IGRlY29yYXRlZC5jYWxsKHRoaXMpO1xcclxcblxcclxcbiAgICB2YXIgJHNlYXJjaCA9ICQoXFxyXFxuICAgICAgJzxzcGFuIGNsYXNzPVxcXCJzZWxlY3QyLXNlYXJjaCBzZWxlY3QyLXNlYXJjaC0tZHJvcGRvd25cXFwiPicgK1xcclxcbiAgICAgICAgJzxpbnB1dCBjbGFzcz1cXFwic2VsZWN0Mi1zZWFyY2hfX2ZpZWxkXFxcIiB0eXBlPVxcXCJzZWFyY2hcXFwiIHRhYmluZGV4PVxcXCItMVxcXCInICtcXHJcXG4gICAgICAgICcgYXV0b2NvbXBsZXRlPVxcXCJvZmZcXFwiIGF1dG9jb3JyZWN0PVxcXCJvZmZcXFwiIGF1dG9jYXBpdGFsaXplPVxcXCJvZmZcXFwiJyArXFxyXFxuICAgICAgICAnIHNwZWxsY2hlY2s9XFxcImZhbHNlXFxcIiByb2xlPVxcXCJ0ZXh0Ym94XFxcIiAvPicgK1xcclxcbiAgICAgICc8L3NwYW4+J1xcclxcbiAgICApO1xcclxcblxcclxcbiAgICB0aGlzLiRzZWFyY2hDb250YWluZXIgPSAkc2VhcmNoO1xcclxcbiAgICB0aGlzLiRzZWFyY2ggPSAkc2VhcmNoLmZpbmQoJ2lucHV0Jyk7XFxyXFxuXFxyXFxuICAgICRyZW5kZXJlZC5wcmVwZW5kKCRzZWFyY2gpO1xcclxcblxcclxcbiAgICByZXR1cm4gJHJlbmRlcmVkO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlYXJjaC5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIGNvbnRhaW5lciwgJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIHRoaXMuJHNlYXJjaC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ2tleXByZXNzJywgZXZ0KTtcXHJcXG5cXHJcXG4gICAgICBzZWxmLl9rZXlVcFByZXZlbnRlZCA9IGV2dC5pc0RlZmF1bHRQcmV2ZW50ZWQoKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIC8vIFdvcmthcm91bmQgZm9yIGJyb3dzZXJzIHdoaWNoIGRvIG5vdCBzdXBwb3J0IHRoZSBgaW5wdXRgIGV2ZW50XFxyXFxuICAgIC8vIFRoaXMgd2lsbCBwcmV2ZW50IGRvdWJsZS10cmlnZ2VyaW5nIG9mIGV2ZW50cyBmb3IgYnJvd3NlcnMgd2hpY2ggc3VwcG9ydFxcclxcbiAgICAvLyBib3RoIHRoZSBga2V5dXBgIGFuZCBgaW5wdXRgIGV2ZW50cy5cXHJcXG4gICAgdGhpcy4kc2VhcmNoLm9uKCdpbnB1dCcsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICAvLyBVbmJpbmQgdGhlIGR1cGxpY2F0ZWQgYGtleXVwYCBldmVudFxcclxcbiAgICAgICQodGhpcykub2ZmKCdrZXl1cCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kc2VhcmNoLm9uKCdrZXl1cCBpbnB1dCcsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLmhhbmRsZVNlYXJjaChldnQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdvcGVuJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJHNlYXJjaC5hdHRyKCd0YWJpbmRleCcsIDApO1xcclxcblxcclxcbiAgICAgIHNlbGYuJHNlYXJjaC5mb2N1cygpO1xcclxcblxcclxcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIHNlbGYuJHNlYXJjaC5mb2N1cygpO1xcclxcbiAgICAgIH0sIDApO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdjbG9zZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLiRzZWFyY2guYXR0cigndGFiaW5kZXgnLCAtMSk7XFxyXFxuXFxyXFxuICAgICAgc2VsZi4kc2VhcmNoLnZhbCgnJyk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ2ZvY3VzJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIGlmIChjb250YWluZXIuaXNPcGVuKCkpIHtcXHJcXG4gICAgICAgIHNlbGYuJHNlYXJjaC5mb2N1cygpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbigncmVzdWx0czphbGwnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgaWYgKHBhcmFtcy5xdWVyeS50ZXJtID09IG51bGwgfHwgcGFyYW1zLnF1ZXJ5LnRlcm0gPT09ICcnKSB7XFxyXFxuICAgICAgICB2YXIgc2hvd1NlYXJjaCA9IHNlbGYuc2hvd1NlYXJjaChwYXJhbXMpO1xcclxcblxcclxcbiAgICAgICAgaWYgKHNob3dTZWFyY2gpIHtcXHJcXG4gICAgICAgICAgc2VsZi4kc2VhcmNoQ29udGFpbmVyLnJlbW92ZUNsYXNzKCdzZWxlY3QyLXNlYXJjaC0taGlkZScpO1xcclxcbiAgICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICAgc2VsZi4kc2VhcmNoQ29udGFpbmVyLmFkZENsYXNzKCdzZWxlY3QyLXNlYXJjaC0taGlkZScpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH1cXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VhcmNoLnByb3RvdHlwZS5oYW5kbGVTZWFyY2ggPSBmdW5jdGlvbiAoZXZ0KSB7XFxyXFxuICAgIGlmICghdGhpcy5fa2V5VXBQcmV2ZW50ZWQpIHtcXHJcXG4gICAgICB2YXIgaW5wdXQgPSB0aGlzLiRzZWFyY2gudmFsKCk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy50cmlnZ2VyKCdxdWVyeScsIHtcXHJcXG4gICAgICAgIHRlcm06IGlucHV0XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy5fa2V5VXBQcmV2ZW50ZWQgPSBmYWxzZTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWFyY2gucHJvdG90eXBlLnNob3dTZWFyY2ggPSBmdW5jdGlvbiAoXywgcGFyYW1zKSB7XFxyXFxuICAgIHJldHVybiB0cnVlO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBTZWFyY2g7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duL2hpZGVQbGFjZWhvbGRlcicsW1xcclxcblxcclxcbl0sIGZ1bmN0aW9uICgpIHtcXHJcXG4gIGZ1bmN0aW9uIEhpZGVQbGFjZWhvbGRlciAoZGVjb3JhdGVkLCAkZWxlbWVudCwgb3B0aW9ucywgZGF0YUFkYXB0ZXIpIHtcXHJcXG4gICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMubm9ybWFsaXplUGxhY2Vob2xkZXIob3B0aW9ucy5nZXQoJ3BsYWNlaG9sZGVyJykpO1xcclxcblxcclxcbiAgICBkZWNvcmF0ZWQuY2FsbCh0aGlzLCAkZWxlbWVudCwgb3B0aW9ucywgZGF0YUFkYXB0ZXIpO1xcclxcbiAgfVxcclxcblxcclxcbiAgSGlkZVBsYWNlaG9sZGVyLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBkYXRhKSB7XFxyXFxuICAgIGRhdGEucmVzdWx0cyA9IHRoaXMucmVtb3ZlUGxhY2Vob2xkZXIoZGF0YS5yZXN1bHRzKTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgZGF0YSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgSGlkZVBsYWNlaG9sZGVyLnByb3RvdHlwZS5ub3JtYWxpemVQbGFjZWhvbGRlciA9IGZ1bmN0aW9uIChfLCBwbGFjZWhvbGRlcikge1xcclxcbiAgICBpZiAodHlwZW9mIHBsYWNlaG9sZGVyID09PSAnc3RyaW5nJykge1xcclxcbiAgICAgIHBsYWNlaG9sZGVyID0ge1xcclxcbiAgICAgICAgaWQ6ICcnLFxcclxcbiAgICAgICAgdGV4dDogcGxhY2Vob2xkZXJcXHJcXG4gICAgICB9O1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiBwbGFjZWhvbGRlcjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBIaWRlUGxhY2Vob2xkZXIucHJvdG90eXBlLnJlbW92ZVBsYWNlaG9sZGVyID0gZnVuY3Rpb24gKF8sIGRhdGEpIHtcXHJcXG4gICAgdmFyIG1vZGlmaWVkRGF0YSA9IGRhdGEuc2xpY2UoMCk7XFxyXFxuXFxyXFxuICAgIGZvciAodmFyIGQgPSBkYXRhLmxlbmd0aCAtIDE7IGQgPj0gMDsgZC0tKSB7XFxyXFxuICAgICAgdmFyIGl0ZW0gPSBkYXRhW2RdO1xcclxcblxcclxcbiAgICAgIGlmICh0aGlzLnBsYWNlaG9sZGVyLmlkID09PSBpdGVtLmlkKSB7XFxyXFxuICAgICAgICBtb2RpZmllZERhdGEuc3BsaWNlKGQsIDEpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gbW9kaWZpZWREYXRhO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBIaWRlUGxhY2Vob2xkZXI7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duL2luZmluaXRlU2Nyb2xsJyxbXFxyXFxuICAnanF1ZXJ5J1xcclxcbl0sIGZ1bmN0aW9uICgkKSB7XFxyXFxuICBmdW5jdGlvbiBJbmZpbml0ZVNjcm9sbCAoZGVjb3JhdGVkLCAkZWxlbWVudCwgb3B0aW9ucywgZGF0YUFkYXB0ZXIpIHtcXHJcXG4gICAgdGhpcy5sYXN0UGFyYW1zID0ge307XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsICRlbGVtZW50LCBvcHRpb25zLCBkYXRhQWRhcHRlcik7XFxyXFxuXFxyXFxuICAgIHRoaXMuJGxvYWRpbmdNb3JlID0gdGhpcy5jcmVhdGVMb2FkaW5nTW9yZSgpO1xcclxcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIEluZmluaXRlU2Nyb2xsLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAoZGVjb3JhdGVkLCBkYXRhKSB7XFxyXFxuICAgIHRoaXMuJGxvYWRpbmdNb3JlLnJlbW92ZSgpO1xcclxcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgZGF0YSk7XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLnNob3dMb2FkaW5nTW9yZShkYXRhKSkge1xcclxcbiAgICAgIHRoaXMuJHJlc3VsdHMuYXBwZW5kKHRoaXMuJGxvYWRpbmdNb3JlKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEluZmluaXRlU2Nyb2xsLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGRlY29yYXRlZCwgY29udGFpbmVyLCAkY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgY29udGFpbmVyLCAkY29udGFpbmVyKTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdxdWVyeScsIGZ1bmN0aW9uIChwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLmxhc3RQYXJhbXMgPSBwYXJhbXM7XFxyXFxuICAgICAgc2VsZi5sb2FkaW5nID0gdHJ1ZTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbigncXVlcnk6YXBwZW5kJywgZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgIHNlbGYubGFzdFBhcmFtcyA9IHBhcmFtcztcXHJcXG4gICAgICBzZWxmLmxvYWRpbmcgPSB0cnVlO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kcmVzdWx0cy5vbignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHZhciBpc0xvYWRNb3JlVmlzaWJsZSA9ICQuY29udGFpbnMoXFxyXFxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXFxyXFxuICAgICAgICBzZWxmLiRsb2FkaW5nTW9yZVswXVxcclxcbiAgICAgICk7XFxyXFxuXFxyXFxuICAgICAgaWYgKHNlbGYubG9hZGluZyB8fCAhaXNMb2FkTW9yZVZpc2libGUpIHtcXHJcXG4gICAgICAgIHJldHVybjtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSBzZWxmLiRyZXN1bHRzLm9mZnNldCgpLnRvcCArXFxyXFxuICAgICAgICBzZWxmLiRyZXN1bHRzLm91dGVySGVpZ2h0KGZhbHNlKTtcXHJcXG4gICAgICB2YXIgbG9hZGluZ01vcmVPZmZzZXQgPSBzZWxmLiRsb2FkaW5nTW9yZS5vZmZzZXQoKS50b3AgK1xcclxcbiAgICAgICAgc2VsZi4kbG9hZGluZ01vcmUub3V0ZXJIZWlnaHQoZmFsc2UpO1xcclxcblxcclxcbiAgICAgIGlmIChjdXJyZW50T2Zmc2V0ICsgNTAgPj0gbG9hZGluZ01vcmVPZmZzZXQpIHtcXHJcXG4gICAgICAgIHNlbGYubG9hZE1vcmUoKTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEluZmluaXRlU2Nyb2xsLnByb3RvdHlwZS5sb2FkTW9yZSA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcXHJcXG5cXHJcXG4gICAgdmFyIHBhcmFtcyA9ICQuZXh0ZW5kKHt9LCB7cGFnZTogMX0sIHRoaXMubGFzdFBhcmFtcyk7XFxyXFxuXFxyXFxuICAgIHBhcmFtcy5wYWdlKys7XFxyXFxuXFxyXFxuICAgIHRoaXMudHJpZ2dlcigncXVlcnk6YXBwZW5kJywgcGFyYW1zKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBJbmZpbml0ZVNjcm9sbC5wcm90b3R5cGUuc2hvd0xvYWRpbmdNb3JlID0gZnVuY3Rpb24gKF8sIGRhdGEpIHtcXHJcXG4gICAgcmV0dXJuIGRhdGEucGFnaW5hdGlvbiAmJiBkYXRhLnBhZ2luYXRpb24ubW9yZTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBJbmZpbml0ZVNjcm9sbC5wcm90b3R5cGUuY3JlYXRlTG9hZGluZ01vcmUgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHZhciAkb3B0aW9uID0gJChcXHJcXG4gICAgICAnPGxpICcgK1xcclxcbiAgICAgICdjbGFzcz1cXFwic2VsZWN0Mi1yZXN1bHRzX19vcHRpb24gc2VsZWN0Mi1yZXN1bHRzX19vcHRpb24tLWxvYWQtbW9yZVxcXCInICtcXHJcXG4gICAgICAncm9sZT1cXFwidHJlZWl0ZW1cXFwiIGFyaWEtZGlzYWJsZWQ9XFxcInRydWVcXFwiPjwvbGk+J1xcclxcbiAgICApO1xcclxcblxcclxcbiAgICB2YXIgbWVzc2FnZSA9IHRoaXMub3B0aW9ucy5nZXQoJ3RyYW5zbGF0aW9ucycpLmdldCgnbG9hZGluZ01vcmUnKTtcXHJcXG5cXHJcXG4gICAgJG9wdGlvbi5odG1sKG1lc3NhZ2UodGhpcy5sYXN0UGFyYW1zKSk7XFxyXFxuXFxyXFxuICAgIHJldHVybiAkb3B0aW9uO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBJbmZpbml0ZVNjcm9sbDtcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ3NlbGVjdDIvZHJvcGRvd24vYXR0YWNoQm9keScsW1xcclxcbiAgJ2pxdWVyeScsXFxyXFxuICAnLi4vdXRpbHMnXFxyXFxuXSwgZnVuY3Rpb24gKCQsIFV0aWxzKSB7XFxyXFxuICBmdW5jdGlvbiBBdHRhY2hCb2R5IChkZWNvcmF0ZWQsICRlbGVtZW50LCBvcHRpb25zKSB7XFxyXFxuICAgIHRoaXMuJGRyb3Bkb3duUGFyZW50ID0gb3B0aW9ucy5nZXQoJ2Ryb3Bkb3duUGFyZW50JykgfHwgJChkb2N1bWVudC5ib2R5KTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgJGVsZW1lbnQsIG9wdGlvbnMpO1xcclxcbiAgfVxcclxcblxcclxcbiAgQXR0YWNoQm9keS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIHZhciBzZXR1cFJlc3VsdHNFdmVudHMgPSBmYWxzZTtcXHJcXG5cXHJcXG4gICAgZGVjb3JhdGVkLmNhbGwodGhpcywgY29udGFpbmVyLCAkY29udGFpbmVyKTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCdvcGVuJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuX3Nob3dEcm9wZG93bigpO1xcclxcbiAgICAgIHNlbGYuX2F0dGFjaFBvc2l0aW9uaW5nSGFuZGxlcihjb250YWluZXIpO1xcclxcblxcclxcbiAgICAgIGlmICghc2V0dXBSZXN1bHRzRXZlbnRzKSB7XFxyXFxuICAgICAgICBzZXR1cFJlc3VsdHNFdmVudHMgPSB0cnVlO1xcclxcblxcclxcbiAgICAgICAgY29udGFpbmVyLm9uKCdyZXN1bHRzOmFsbCcsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgICAgc2VsZi5fcG9zaXRpb25Ecm9wZG93bigpO1xcclxcbiAgICAgICAgICBzZWxmLl9yZXNpemVEcm9wZG93bigpO1xcclxcbiAgICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgICBjb250YWluZXIub24oJ3Jlc3VsdHM6YXBwZW5kJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgICBzZWxmLl9wb3NpdGlvbkRyb3Bkb3duKCk7XFxyXFxuICAgICAgICAgIHNlbGYuX3Jlc2l6ZURyb3Bkb3duKCk7XFxyXFxuICAgICAgICB9KTtcXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICBjb250YWluZXIub24oJ2Nsb3NlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuX2hpZGVEcm9wZG93bigpO1xcclxcbiAgICAgIHNlbGYuX2RldGFjaFBvc2l0aW9uaW5nSGFuZGxlcihjb250YWluZXIpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kZHJvcGRvd25Db250YWluZXIub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEF0dGFjaEJvZHkucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoZGVjb3JhdGVkKSB7XFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMpO1xcclxcblxcclxcbiAgICB0aGlzLiRkcm9wZG93bkNvbnRhaW5lci5yZW1vdmUoKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBBdHRhY2hCb2R5LnByb3RvdHlwZS5wb3NpdGlvbiA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsICRkcm9wZG93biwgJGNvbnRhaW5lcikge1xcclxcbiAgICAvLyBDbG9uZSBhbGwgb2YgdGhlIGNvbnRhaW5lciBjbGFzc2VzXFxyXFxuICAgICRkcm9wZG93bi5hdHRyKCdjbGFzcycsICRjb250YWluZXIuYXR0cignY2xhc3MnKSk7XFxyXFxuXFxyXFxuICAgICRkcm9wZG93bi5yZW1vdmVDbGFzcygnc2VsZWN0MicpO1xcclxcbiAgICAkZHJvcGRvd24uYWRkQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1vcGVuJyk7XFxyXFxuXFxyXFxuICAgICRkcm9wZG93bi5jc3Moe1xcclxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxcclxcbiAgICAgIHRvcDogLTk5OTk5OVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kY29udGFpbmVyID0gJGNvbnRhaW5lcjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBBdHRhY2hCb2R5LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoZGVjb3JhdGVkKSB7XFxyXFxuICAgIHZhciAkY29udGFpbmVyID0gJCgnPHNwYW4+PC9zcGFuPicpO1xcclxcblxcclxcbiAgICB2YXIgJGRyb3Bkb3duID0gZGVjb3JhdGVkLmNhbGwodGhpcyk7XFxyXFxuICAgICRjb250YWluZXIuYXBwZW5kKCRkcm9wZG93bik7XFxyXFxuXFxyXFxuICAgIHRoaXMuJGRyb3Bkb3duQ29udGFpbmVyID0gJGNvbnRhaW5lcjtcXHJcXG5cXHJcXG4gICAgcmV0dXJuICRjb250YWluZXI7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQXR0YWNoQm9keS5wcm90b3R5cGUuX2hpZGVEcm9wZG93biA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQpIHtcXHJcXG4gICAgdGhpcy4kZHJvcGRvd25Db250YWluZXIuZGV0YWNoKCk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQXR0YWNoQm9keS5wcm90b3R5cGUuX2F0dGFjaFBvc2l0aW9uaW5nSGFuZGxlciA9XFxyXFxuICAgICAgZnVuY3Rpb24gKGRlY29yYXRlZCwgY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgdmFyIHNjcm9sbEV2ZW50ID0gJ3Njcm9sbC5zZWxlY3QyLicgKyBjb250YWluZXIuaWQ7XFxyXFxuICAgIHZhciByZXNpemVFdmVudCA9ICdyZXNpemUuc2VsZWN0Mi4nICsgY29udGFpbmVyLmlkO1xcclxcbiAgICB2YXIgb3JpZW50YXRpb25FdmVudCA9ICdvcmllbnRhdGlvbmNoYW5nZS5zZWxlY3QyLicgKyBjb250YWluZXIuaWQ7XFxyXFxuXFxyXFxuICAgIHZhciAkd2F0Y2hlcnMgPSB0aGlzLiRjb250YWluZXIucGFyZW50cygpLmZpbHRlcihVdGlscy5oYXNTY3JvbGwpO1xcclxcbiAgICAkd2F0Y2hlcnMuZWFjaChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgJCh0aGlzKS5kYXRhKCdzZWxlY3QyLXNjcm9sbC1wb3NpdGlvbicsIHtcXHJcXG4gICAgICAgIHg6ICQodGhpcykuc2Nyb2xsTGVmdCgpLFxcclxcbiAgICAgICAgeTogJCh0aGlzKS5zY3JvbGxUb3AoKVxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgJHdhdGNoZXJzLm9uKHNjcm9sbEV2ZW50LCBmdW5jdGlvbiAoZXYpIHtcXHJcXG4gICAgICB2YXIgcG9zaXRpb24gPSAkKHRoaXMpLmRhdGEoJ3NlbGVjdDItc2Nyb2xsLXBvc2l0aW9uJyk7XFxyXFxuICAgICAgJCh0aGlzKS5zY3JvbGxUb3AocG9zaXRpb24ueSk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICAkKHdpbmRvdykub24oc2Nyb2xsRXZlbnQgKyAnICcgKyByZXNpemVFdmVudCArICcgJyArIG9yaWVudGF0aW9uRXZlbnQsXFxyXFxuICAgICAgZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICBzZWxmLl9wb3NpdGlvbkRyb3Bkb3duKCk7XFxyXFxuICAgICAgc2VsZi5fcmVzaXplRHJvcGRvd24oKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQXR0YWNoQm9keS5wcm90b3R5cGUuX2RldGFjaFBvc2l0aW9uaW5nSGFuZGxlciA9XFxyXFxuICAgICAgZnVuY3Rpb24gKGRlY29yYXRlZCwgY29udGFpbmVyKSB7XFxyXFxuICAgIHZhciBzY3JvbGxFdmVudCA9ICdzY3JvbGwuc2VsZWN0Mi4nICsgY29udGFpbmVyLmlkO1xcclxcbiAgICB2YXIgcmVzaXplRXZlbnQgPSAncmVzaXplLnNlbGVjdDIuJyArIGNvbnRhaW5lci5pZDtcXHJcXG4gICAgdmFyIG9yaWVudGF0aW9uRXZlbnQgPSAnb3JpZW50YXRpb25jaGFuZ2Uuc2VsZWN0Mi4nICsgY29udGFpbmVyLmlkO1xcclxcblxcclxcbiAgICB2YXIgJHdhdGNoZXJzID0gdGhpcy4kY29udGFpbmVyLnBhcmVudHMoKS5maWx0ZXIoVXRpbHMuaGFzU2Nyb2xsKTtcXHJcXG4gICAgJHdhdGNoZXJzLm9mZihzY3JvbGxFdmVudCk7XFxyXFxuXFxyXFxuICAgICQod2luZG93KS5vZmYoc2Nyb2xsRXZlbnQgKyAnICcgKyByZXNpemVFdmVudCArICcgJyArIG9yaWVudGF0aW9uRXZlbnQpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEF0dGFjaEJvZHkucHJvdG90eXBlLl9wb3NpdGlvbkRyb3Bkb3duID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgJHdpbmRvdyA9ICQod2luZG93KTtcXHJcXG5cXHJcXG4gICAgdmFyIGlzQ3VycmVudGx5QWJvdmUgPSB0aGlzLiRkcm9wZG93bi5oYXNDbGFzcygnc2VsZWN0Mi1kcm9wZG93bi0tYWJvdmUnKTtcXHJcXG4gICAgdmFyIGlzQ3VycmVudGx5QmVsb3cgPSB0aGlzLiRkcm9wZG93bi5oYXNDbGFzcygnc2VsZWN0Mi1kcm9wZG93bi0tYmVsb3cnKTtcXHJcXG5cXHJcXG4gICAgdmFyIG5ld0RpcmVjdGlvbiA9IG51bGw7XFxyXFxuXFxyXFxuICAgIHZhciBvZmZzZXQgPSB0aGlzLiRjb250YWluZXIub2Zmc2V0KCk7XFxyXFxuXFxyXFxuICAgIG9mZnNldC5ib3R0b20gPSBvZmZzZXQudG9wICsgdGhpcy4kY29udGFpbmVyLm91dGVySGVpZ2h0KGZhbHNlKTtcXHJcXG5cXHJcXG4gICAgdmFyIGNvbnRhaW5lciA9IHtcXHJcXG4gICAgICBoZWlnaHQ6IHRoaXMuJGNvbnRhaW5lci5vdXRlckhlaWdodChmYWxzZSlcXHJcXG4gICAgfTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLnRvcCA9IG9mZnNldC50b3A7XFxyXFxuICAgIGNvbnRhaW5lci5ib3R0b20gPSBvZmZzZXQudG9wICsgY29udGFpbmVyLmhlaWdodDtcXHJcXG5cXHJcXG4gICAgdmFyIGRyb3Bkb3duID0ge1xcclxcbiAgICAgIGhlaWdodDogdGhpcy4kZHJvcGRvd24ub3V0ZXJIZWlnaHQoZmFsc2UpXFxyXFxuICAgIH07XFxyXFxuXFxyXFxuICAgIHZhciB2aWV3cG9ydCA9IHtcXHJcXG4gICAgICB0b3A6ICR3aW5kb3cuc2Nyb2xsVG9wKCksXFxyXFxuICAgICAgYm90dG9tOiAkd2luZG93LnNjcm9sbFRvcCgpICsgJHdpbmRvdy5oZWlnaHQoKVxcclxcbiAgICB9O1xcclxcblxcclxcbiAgICB2YXIgZW5vdWdoUm9vbUFib3ZlID0gdmlld3BvcnQudG9wIDwgKG9mZnNldC50b3AgLSBkcm9wZG93bi5oZWlnaHQpO1xcclxcbiAgICB2YXIgZW5vdWdoUm9vbUJlbG93ID0gdmlld3BvcnQuYm90dG9tID4gKG9mZnNldC5ib3R0b20gKyBkcm9wZG93bi5oZWlnaHQpO1xcclxcblxcclxcbiAgICB2YXIgY3NzID0ge1xcclxcbiAgICAgIGxlZnQ6IG9mZnNldC5sZWZ0LFxcclxcbiAgICAgIHRvcDogY29udGFpbmVyLmJvdHRvbVxcclxcbiAgICB9O1xcclxcblxcclxcbiAgICAvLyBEZXRlcm1pbmUgd2hhdCB0aGUgcGFyZW50IGVsZW1lbnQgaXMgdG8gdXNlIGZvciBjYWxjaXVsYXRpbmcgdGhlIG9mZnNldFxcclxcbiAgICB2YXIgJG9mZnNldFBhcmVudCA9IHRoaXMuJGRyb3Bkb3duUGFyZW50O1xcclxcblxcclxcbiAgICAvLyBGb3Igc3RhdGljYWxseSBwb3NpdG9uZWQgZWxlbWVudHMsIHdlIG5lZWQgdG8gZ2V0IHRoZSBlbGVtZW50XFxyXFxuICAgIC8vIHRoYXQgaXMgZGV0ZXJtaW5pbmcgdGhlIG9mZnNldFxcclxcbiAgICBpZiAoJG9mZnNldFBhcmVudC5jc3MoJ3Bvc2l0aW9uJykgPT09ICdzdGF0aWMnKSB7XFxyXFxuICAgICAgJG9mZnNldFBhcmVudCA9ICRvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50KCk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdmFyIHBhcmVudE9mZnNldCA9ICRvZmZzZXRQYXJlbnQub2Zmc2V0KCk7XFxyXFxuXFxyXFxuICAgIGNzcy50b3AgLT0gcGFyZW50T2Zmc2V0LnRvcDtcXHJcXG4gICAgY3NzLmxlZnQgLT0gcGFyZW50T2Zmc2V0LmxlZnQ7XFxyXFxuXFxyXFxuICAgIGlmICghaXNDdXJyZW50bHlBYm92ZSAmJiAhaXNDdXJyZW50bHlCZWxvdykge1xcclxcbiAgICAgIG5ld0RpcmVjdGlvbiA9ICdiZWxvdyc7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKCFlbm91Z2hSb29tQmVsb3cgJiYgZW5vdWdoUm9vbUFib3ZlICYmICFpc0N1cnJlbnRseUFib3ZlKSB7XFxyXFxuICAgICAgbmV3RGlyZWN0aW9uID0gJ2Fib3ZlJztcXHJcXG4gICAgfSBlbHNlIGlmICghZW5vdWdoUm9vbUFib3ZlICYmIGVub3VnaFJvb21CZWxvdyAmJiBpc0N1cnJlbnRseUFib3ZlKSB7XFxyXFxuICAgICAgbmV3RGlyZWN0aW9uID0gJ2JlbG93JztcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAobmV3RGlyZWN0aW9uID09ICdhYm92ZScgfHxcXHJcXG4gICAgICAoaXNDdXJyZW50bHlBYm92ZSAmJiBuZXdEaXJlY3Rpb24gIT09ICdiZWxvdycpKSB7XFxyXFxuICAgICAgY3NzLnRvcCA9IGNvbnRhaW5lci50b3AgLSBwYXJlbnRPZmZzZXQudG9wIC0gZHJvcGRvd24uaGVpZ2h0O1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChuZXdEaXJlY3Rpb24gIT0gbnVsbCkge1xcclxcbiAgICAgIHRoaXMuJGRyb3Bkb3duXFxyXFxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ3NlbGVjdDItZHJvcGRvd24tLWJlbG93IHNlbGVjdDItZHJvcGRvd24tLWFib3ZlJylcXHJcXG4gICAgICAgIC5hZGRDbGFzcygnc2VsZWN0Mi1kcm9wZG93bi0tJyArIG5ld0RpcmVjdGlvbik7XFxyXFxuICAgICAgdGhpcy4kY29udGFpbmVyXFxyXFxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1iZWxvdyBzZWxlY3QyLWNvbnRhaW5lci0tYWJvdmUnKVxcclxcbiAgICAgICAgLmFkZENsYXNzKCdzZWxlY3QyLWNvbnRhaW5lci0tJyArIG5ld0RpcmVjdGlvbik7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy4kZHJvcGRvd25Db250YWluZXIuY3NzKGNzcyk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQXR0YWNoQm9keS5wcm90b3R5cGUuX3Jlc2l6ZURyb3Bkb3duID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgY3NzID0ge1xcclxcbiAgICAgIHdpZHRoOiB0aGlzLiRjb250YWluZXIub3V0ZXJXaWR0aChmYWxzZSkgKyAncHgnXFxyXFxuICAgIH07XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLm9wdGlvbnMuZ2V0KCdkcm9wZG93bkF1dG9XaWR0aCcpKSB7XFxyXFxuICAgICAgY3NzLm1pbldpZHRoID0gY3NzLndpZHRoO1xcclxcbiAgICAgIGNzcy5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XFxyXFxuICAgICAgY3NzLndpZHRoID0gJ2F1dG8nO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuJGRyb3Bkb3duLmNzcyhjc3MpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIEF0dGFjaEJvZHkucHJvdG90eXBlLl9zaG93RHJvcGRvd24gPSBmdW5jdGlvbiAoZGVjb3JhdGVkKSB7XFxyXFxuICAgIHRoaXMuJGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZFRvKHRoaXMuJGRyb3Bkb3duUGFyZW50KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5fcG9zaXRpb25Ecm9wZG93bigpO1xcclxcbiAgICB0aGlzLl9yZXNpemVEcm9wZG93bigpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBBdHRhY2hCb2R5O1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9kcm9wZG93bi9taW5pbXVtUmVzdWx0c0ZvclNlYXJjaCcsW1xcclxcblxcclxcbl0sIGZ1bmN0aW9uICgpIHtcXHJcXG4gIGZ1bmN0aW9uIGNvdW50UmVzdWx0cyAoZGF0YSkge1xcclxcbiAgICB2YXIgY291bnQgPSAwO1xcclxcblxcclxcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGRhdGEubGVuZ3RoOyBkKyspIHtcXHJcXG4gICAgICB2YXIgaXRlbSA9IGRhdGFbZF07XFxyXFxuXFxyXFxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcXHJcXG4gICAgICAgIGNvdW50ICs9IGNvdW50UmVzdWx0cyhpdGVtLmNoaWxkcmVuKTtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgY291bnQrKztcXHJcXG4gICAgICB9XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgcmV0dXJuIGNvdW50O1xcclxcbiAgfVxcclxcblxcclxcbiAgZnVuY3Rpb24gTWluaW11bVJlc3VsdHNGb3JTZWFyY2ggKGRlY29yYXRlZCwgJGVsZW1lbnQsIG9wdGlvbnMsIGRhdGFBZGFwdGVyKSB7XFxyXFxuICAgIHRoaXMubWluaW11bVJlc3VsdHNGb3JTZWFyY2ggPSBvcHRpb25zLmdldCgnbWluaW11bVJlc3VsdHNGb3JTZWFyY2gnKTtcXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMubWluaW11bVJlc3VsdHNGb3JTZWFyY2ggPCAwKSB7XFxyXFxuICAgICAgdGhpcy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaCA9IEluZmluaXR5O1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsICRlbGVtZW50LCBvcHRpb25zLCBkYXRhQWRhcHRlcik7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBNaW5pbXVtUmVzdWx0c0ZvclNlYXJjaC5wcm90b3R5cGUuc2hvd1NlYXJjaCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIHBhcmFtcykge1xcclxcbiAgICBpZiAoY291bnRSZXN1bHRzKHBhcmFtcy5kYXRhLnJlc3VsdHMpIDwgdGhpcy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaCkge1xcclxcbiAgICAgIHJldHVybiBmYWxzZTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gZGVjb3JhdGVkLmNhbGwodGhpcywgcGFyYW1zKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gTWluaW11bVJlc3VsdHNGb3JTZWFyY2g7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duL3NlbGVjdE9uQ2xvc2UnLFtcXHJcXG5cXHJcXG5dLCBmdW5jdGlvbiAoKSB7XFxyXFxuICBmdW5jdGlvbiBTZWxlY3RPbkNsb3NlICgpIHsgfVxcclxcblxcclxcbiAgU2VsZWN0T25DbG9zZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIGNvbnRhaW5lciwgJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignY2xvc2UnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi5faGFuZGxlU2VsZWN0T25DbG9zZShwYXJhbXMpO1xcclxcbiAgICB9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RPbkNsb3NlLnByb3RvdHlwZS5faGFuZGxlU2VsZWN0T25DbG9zZSA9IGZ1bmN0aW9uIChfLCBwYXJhbXMpIHtcXHJcXG4gICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMub3JpZ2luYWxTZWxlY3QyRXZlbnQgIT0gbnVsbCkge1xcclxcbiAgICAgIHZhciBldmVudCA9IHBhcmFtcy5vcmlnaW5hbFNlbGVjdDJFdmVudDtcXHJcXG5cXHJcXG4gICAgICAvLyBEb24ndCBzZWxlY3QgYW4gaXRlbSBpZiB0aGUgY2xvc2UgZXZlbnQgd2FzIHRyaWdnZXJlZCBmcm9tIGEgc2VsZWN0IG9yXFxyXFxuICAgICAgLy8gdW5zZWxlY3QgZXZlbnRcXHJcXG4gICAgICBpZiAoZXZlbnQuX3R5cGUgPT09ICdzZWxlY3QnIHx8IGV2ZW50Ll90eXBlID09PSAndW5zZWxlY3QnKSB7XFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciAkaGlnaGxpZ2h0ZWRSZXN1bHRzID0gdGhpcy5nZXRIaWdobGlnaHRlZFJlc3VsdHMoKTtcXHJcXG5cXHJcXG4gICAgLy8gT25seSBzZWxlY3QgaGlnaGxpZ2h0ZWQgcmVzdWx0c1xcclxcbiAgICBpZiAoJGhpZ2hsaWdodGVkUmVzdWx0cy5sZW5ndGggPCAxKSB7XFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciBkYXRhID0gJGhpZ2hsaWdodGVkUmVzdWx0cy5kYXRhKCdkYXRhJyk7XFxyXFxuXFxyXFxuICAgIC8vIERvbid0IHJlLXNlbGVjdCBhbHJlYWR5IHNlbGVjdGVkIHJlc3VsdGVcXHJcXG4gICAgaWYgKFxcclxcbiAgICAgIChkYXRhLmVsZW1lbnQgIT0gbnVsbCAmJiBkYXRhLmVsZW1lbnQuc2VsZWN0ZWQpIHx8XFxyXFxuICAgICAgKGRhdGEuZWxlbWVudCA9PSBudWxsICYmIGRhdGEuc2VsZWN0ZWQpXFxyXFxuICAgICkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLnRyaWdnZXIoJ3NlbGVjdCcsIHtcXHJcXG4gICAgICAgIGRhdGE6IGRhdGFcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIFNlbGVjdE9uQ2xvc2U7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2Ryb3Bkb3duL2Nsb3NlT25TZWxlY3QnLFtcXHJcXG5cXHJcXG5dLCBmdW5jdGlvbiAoKSB7XFxyXFxuICBmdW5jdGlvbiBDbG9zZU9uU2VsZWN0ICgpIHsgfVxcclxcblxcclxcbiAgQ2xvc2VPblNlbGVjdC5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChkZWNvcmF0ZWQsIGNvbnRhaW5lciwgJGNvbnRhaW5lcikge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIGRlY29yYXRlZC5jYWxsKHRoaXMsIGNvbnRhaW5lciwgJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIGNvbnRhaW5lci5vbignc2VsZWN0JywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYuX3NlbGVjdFRyaWdnZXJlZChldnQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgY29udGFpbmVyLm9uKCd1bnNlbGVjdCcsIGZ1bmN0aW9uIChldnQpIHtcXHJcXG4gICAgICBzZWxmLl9zZWxlY3RUcmlnZ2VyZWQoZXZ0KTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgQ2xvc2VPblNlbGVjdC5wcm90b3R5cGUuX3NlbGVjdFRyaWdnZXJlZCA9IGZ1bmN0aW9uIChfLCBldnQpIHtcXHJcXG4gICAgdmFyIG9yaWdpbmFsRXZlbnQgPSBldnQub3JpZ2luYWxFdmVudDtcXHJcXG5cXHJcXG4gICAgLy8gRG9uJ3QgY2xvc2UgaWYgdGhlIGNvbnRyb2wga2V5IGlzIGJlaW5nIGhlbGRcXHJcXG4gICAgaWYgKG9yaWdpbmFsRXZlbnQgJiYgb3JpZ2luYWxFdmVudC5jdHJsS2V5KSB7XFxyXFxuICAgICAgcmV0dXJuO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMudHJpZ2dlcignY2xvc2UnLCB7XFxyXFxuICAgICAgb3JpZ2luYWxFdmVudDogb3JpZ2luYWxFdmVudCxcXHJcXG4gICAgICBvcmlnaW5hbFNlbGVjdDJFdmVudDogZXZ0XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHJldHVybiBDbG9zZU9uU2VsZWN0O1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnc2VsZWN0Mi9pMThuL2VuJyxbXSxmdW5jdGlvbiAoKSB7XFxyXFxuICAvLyBFbmdsaXNoXFxyXFxuICByZXR1cm4ge1xcclxcbiAgICBlcnJvckxvYWRpbmc6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICByZXR1cm4gJ1RoZSByZXN1bHRzIGNvdWxkIG5vdCBiZSBsb2FkZWQuJztcXHJcXG4gICAgfSxcXHJcXG4gICAgaW5wdXRUb29Mb25nOiBmdW5jdGlvbiAoYXJncykge1xcclxcbiAgICAgIHZhciBvdmVyQ2hhcnMgPSBhcmdzLmlucHV0Lmxlbmd0aCAtIGFyZ3MubWF4aW11bTtcXHJcXG5cXHJcXG4gICAgICB2YXIgbWVzc2FnZSA9ICdQbGVhc2UgZGVsZXRlICcgKyBvdmVyQ2hhcnMgKyAnIGNoYXJhY3Rlcic7XFxyXFxuXFxyXFxuICAgICAgaWYgKG92ZXJDaGFycyAhPSAxKSB7XFxyXFxuICAgICAgICBtZXNzYWdlICs9ICdzJztcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuIG1lc3NhZ2U7XFxyXFxuICAgIH0sXFxyXFxuICAgIGlucHV0VG9vU2hvcnQ6IGZ1bmN0aW9uIChhcmdzKSB7XFxyXFxuICAgICAgdmFyIHJlbWFpbmluZ0NoYXJzID0gYXJncy5taW5pbXVtIC0gYXJncy5pbnB1dC5sZW5ndGg7XFxyXFxuXFxyXFxuICAgICAgdmFyIG1lc3NhZ2UgPSAnUGxlYXNlIGVudGVyICcgKyByZW1haW5pbmdDaGFycyArICcgb3IgbW9yZSBjaGFyYWN0ZXJzJztcXHJcXG5cXHJcXG4gICAgICByZXR1cm4gbWVzc2FnZTtcXHJcXG4gICAgfSxcXHJcXG4gICAgbG9hZGluZ01vcmU6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICByZXR1cm4gJ0xvYWRpbmcgbW9yZSByZXN1bHRz4oCmJztcXHJcXG4gICAgfSxcXHJcXG4gICAgbWF4aW11bVNlbGVjdGVkOiBmdW5jdGlvbiAoYXJncykge1xcclxcbiAgICAgIHZhciBtZXNzYWdlID0gJ1lvdSBjYW4gb25seSBzZWxlY3QgJyArIGFyZ3MubWF4aW11bSArICcgaXRlbSc7XFxyXFxuXFxyXFxuICAgICAgaWYgKGFyZ3MubWF4aW11bSAhPSAxKSB7XFxyXFxuICAgICAgICBtZXNzYWdlICs9ICdzJztcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuIG1lc3NhZ2U7XFxyXFxuICAgIH0sXFxyXFxuICAgIG5vUmVzdWx0czogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHJldHVybiAnTm8gcmVzdWx0cyBmb3VuZCc7XFxyXFxuICAgIH0sXFxyXFxuICAgIHNlYXJjaGluZzogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHJldHVybiAnU2VhcmNoaW5n4oCmJztcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ3NlbGVjdDIvZGVmYXVsdHMnLFtcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJ3JlcXVpcmUnLFxcclxcblxcclxcbiAgJy4vcmVzdWx0cycsXFxyXFxuXFxyXFxuICAnLi9zZWxlY3Rpb24vc2luZ2xlJyxcXHJcXG4gICcuL3NlbGVjdGlvbi9tdWx0aXBsZScsXFxyXFxuICAnLi9zZWxlY3Rpb24vcGxhY2Vob2xkZXInLFxcclxcbiAgJy4vc2VsZWN0aW9uL2FsbG93Q2xlYXInLFxcclxcbiAgJy4vc2VsZWN0aW9uL3NlYXJjaCcsXFxyXFxuICAnLi9zZWxlY3Rpb24vZXZlbnRSZWxheScsXFxyXFxuXFxyXFxuICAnLi91dGlscycsXFxyXFxuICAnLi90cmFuc2xhdGlvbicsXFxyXFxuICAnLi9kaWFjcml0aWNzJyxcXHJcXG5cXHJcXG4gICcuL2RhdGEvc2VsZWN0JyxcXHJcXG4gICcuL2RhdGEvYXJyYXknLFxcclxcbiAgJy4vZGF0YS9hamF4JyxcXHJcXG4gICcuL2RhdGEvdGFncycsXFxyXFxuICAnLi9kYXRhL3Rva2VuaXplcicsXFxyXFxuICAnLi9kYXRhL21pbmltdW1JbnB1dExlbmd0aCcsXFxyXFxuICAnLi9kYXRhL21heGltdW1JbnB1dExlbmd0aCcsXFxyXFxuICAnLi9kYXRhL21heGltdW1TZWxlY3Rpb25MZW5ndGgnLFxcclxcblxcclxcbiAgJy4vZHJvcGRvd24nLFxcclxcbiAgJy4vZHJvcGRvd24vc2VhcmNoJyxcXHJcXG4gICcuL2Ryb3Bkb3duL2hpZGVQbGFjZWhvbGRlcicsXFxyXFxuICAnLi9kcm9wZG93bi9pbmZpbml0ZVNjcm9sbCcsXFxyXFxuICAnLi9kcm9wZG93bi9hdHRhY2hCb2R5JyxcXHJcXG4gICcuL2Ryb3Bkb3duL21pbmltdW1SZXN1bHRzRm9yU2VhcmNoJyxcXHJcXG4gICcuL2Ryb3Bkb3duL3NlbGVjdE9uQ2xvc2UnLFxcclxcbiAgJy4vZHJvcGRvd24vY2xvc2VPblNlbGVjdCcsXFxyXFxuXFxyXFxuICAnLi9pMThuL2VuJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCByZXF1aXJlLFxcclxcblxcclxcbiAgICAgICAgICAgICBSZXN1bHRzTGlzdCxcXHJcXG5cXHJcXG4gICAgICAgICAgICAgU2luZ2xlU2VsZWN0aW9uLCBNdWx0aXBsZVNlbGVjdGlvbiwgUGxhY2Vob2xkZXIsIEFsbG93Q2xlYXIsXFxyXFxuICAgICAgICAgICAgIFNlbGVjdGlvblNlYXJjaCwgRXZlbnRSZWxheSxcXHJcXG5cXHJcXG4gICAgICAgICAgICAgVXRpbHMsIFRyYW5zbGF0aW9uLCBESUFDUklUSUNTLFxcclxcblxcclxcbiAgICAgICAgICAgICBTZWxlY3REYXRhLCBBcnJheURhdGEsIEFqYXhEYXRhLCBUYWdzLCBUb2tlbml6ZXIsXFxyXFxuICAgICAgICAgICAgIE1pbmltdW1JbnB1dExlbmd0aCwgTWF4aW11bUlucHV0TGVuZ3RoLCBNYXhpbXVtU2VsZWN0aW9uTGVuZ3RoLFxcclxcblxcclxcbiAgICAgICAgICAgICBEcm9wZG93biwgRHJvcGRvd25TZWFyY2gsIEhpZGVQbGFjZWhvbGRlciwgSW5maW5pdGVTY3JvbGwsXFxyXFxuICAgICAgICAgICAgIEF0dGFjaEJvZHksIE1pbmltdW1SZXN1bHRzRm9yU2VhcmNoLCBTZWxlY3RPbkNsb3NlLCBDbG9zZU9uU2VsZWN0LFxcclxcblxcclxcbiAgICAgICAgICAgICBFbmdsaXNoVHJhbnNsYXRpb24pIHtcXHJcXG4gIGZ1bmN0aW9uIERlZmF1bHRzICgpIHtcXHJcXG4gICAgdGhpcy5yZXNldCgpO1xcclxcbiAgfVxcclxcblxcclxcbiAgRGVmYXVsdHMucHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcXHJcXG4gICAgb3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLmRlZmF1bHRzLCBvcHRpb25zKTtcXHJcXG5cXHJcXG4gICAgaWYgKG9wdGlvbnMuZGF0YUFkYXB0ZXIgPT0gbnVsbCkge1xcclxcbiAgICAgIGlmIChvcHRpb25zLmFqYXggIT0gbnVsbCkge1xcclxcbiAgICAgICAgb3B0aW9ucy5kYXRhQWRhcHRlciA9IEFqYXhEYXRhO1xcclxcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5kYXRhICE9IG51bGwpIHtcXHJcXG4gICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIgPSBBcnJheURhdGE7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIgPSBTZWxlY3REYXRhO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5taW5pbXVtSW5wdXRMZW5ndGggPiAwKSB7XFxyXFxuICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIsXFxyXFxuICAgICAgICAgIE1pbmltdW1JbnB1dExlbmd0aFxcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKG9wdGlvbnMubWF4aW11bUlucHV0TGVuZ3RoID4gMCkge1xcclxcbiAgICAgICAgb3B0aW9ucy5kYXRhQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyLFxcclxcbiAgICAgICAgICBNYXhpbXVtSW5wdXRMZW5ndGhcXHJcXG4gICAgICAgICk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGlmIChvcHRpb25zLm1heGltdW1TZWxlY3Rpb25MZW5ndGggPiAwKSB7XFxyXFxuICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIsXFxyXFxuICAgICAgICAgIE1heGltdW1TZWxlY3Rpb25MZW5ndGhcXHJcXG4gICAgICAgICk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGlmIChvcHRpb25zLnRhZ3MpIHtcXHJcXG4gICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIgPSBVdGlscy5EZWNvcmF0ZShvcHRpb25zLmRhdGFBZGFwdGVyLCBUYWdzKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKG9wdGlvbnMudG9rZW5TZXBhcmF0b3JzICE9IG51bGwgfHwgb3B0aW9ucy50b2tlbml6ZXIgIT0gbnVsbCkge1xcclxcbiAgICAgICAgb3B0aW9ucy5kYXRhQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyLFxcclxcbiAgICAgICAgICBUb2tlbml6ZXJcXHJcXG4gICAgICAgICk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGlmIChvcHRpb25zLnF1ZXJ5ICE9IG51bGwpIHtcXHJcXG4gICAgICAgIHZhciBRdWVyeSA9IHJlcXVpcmUob3B0aW9ucy5hbWRCYXNlICsgJ2NvbXBhdC9xdWVyeScpO1xcclxcblxcclxcbiAgICAgICAgb3B0aW9ucy5kYXRhQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyLFxcclxcbiAgICAgICAgICBRdWVyeVxcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKG9wdGlvbnMuaW5pdFNlbGVjdGlvbiAhPSBudWxsKSB7XFxyXFxuICAgICAgICB2YXIgSW5pdFNlbGVjdGlvbiA9IHJlcXVpcmUob3B0aW9ucy5hbWRCYXNlICsgJ2NvbXBhdC9pbml0U2VsZWN0aW9uJyk7XFxyXFxuXFxyXFxuICAgICAgICBvcHRpb25zLmRhdGFBZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMuZGF0YUFkYXB0ZXIsXFxyXFxuICAgICAgICAgIEluaXRTZWxlY3Rpb25cXHJcXG4gICAgICAgICk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChvcHRpb25zLnJlc3VsdHNBZGFwdGVyID09IG51bGwpIHtcXHJcXG4gICAgICBvcHRpb25zLnJlc3VsdHNBZGFwdGVyID0gUmVzdWx0c0xpc3Q7XFxyXFxuXFxyXFxuICAgICAgaWYgKG9wdGlvbnMuYWpheCAhPSBudWxsKSB7XFxyXFxuICAgICAgICBvcHRpb25zLnJlc3VsdHNBZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMucmVzdWx0c0FkYXB0ZXIsXFxyXFxuICAgICAgICAgIEluZmluaXRlU2Nyb2xsXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5wbGFjZWhvbGRlciAhPSBudWxsKSB7XFxyXFxuICAgICAgICBvcHRpb25zLnJlc3VsdHNBZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMucmVzdWx0c0FkYXB0ZXIsXFxyXFxuICAgICAgICAgIEhpZGVQbGFjZWhvbGRlclxcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKG9wdGlvbnMuc2VsZWN0T25DbG9zZSkge1xcclxcbiAgICAgICAgb3B0aW9ucy5yZXN1bHRzQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLnJlc3VsdHNBZGFwdGVyLFxcclxcbiAgICAgICAgICBTZWxlY3RPbkNsb3NlXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAob3B0aW9ucy5kcm9wZG93bkFkYXB0ZXIgPT0gbnVsbCkge1xcclxcbiAgICAgIGlmIChvcHRpb25zLm11bHRpcGxlKSB7XFxyXFxuICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlciA9IERyb3Bkb3duO1xcclxcbiAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICB2YXIgU2VhcmNoYWJsZURyb3Bkb3duID0gVXRpbHMuRGVjb3JhdGUoRHJvcGRvd24sIERyb3Bkb3duU2VhcmNoKTtcXHJcXG5cXHJcXG4gICAgICAgIG9wdGlvbnMuZHJvcGRvd25BZGFwdGVyID0gU2VhcmNoYWJsZURyb3Bkb3duO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaCAhPT0gMCkge1xcclxcbiAgICAgICAgb3B0aW9ucy5kcm9wZG93bkFkYXB0ZXIgPSBVdGlscy5EZWNvcmF0ZShcXHJcXG4gICAgICAgICAgb3B0aW9ucy5kcm9wZG93bkFkYXB0ZXIsXFxyXFxuICAgICAgICAgIE1pbmltdW1SZXN1bHRzRm9yU2VhcmNoXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5jbG9zZU9uU2VsZWN0KSB7XFxyXFxuICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlcixcXHJcXG4gICAgICAgICAgQ2xvc2VPblNlbGVjdFxcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKFxcclxcbiAgICAgICAgb3B0aW9ucy5kcm9wZG93bkNzc0NsYXNzICE9IG51bGwgfHxcXHJcXG4gICAgICAgIG9wdGlvbnMuZHJvcGRvd25Dc3MgIT0gbnVsbCB8fFxcclxcbiAgICAgICAgb3B0aW9ucy5hZGFwdERyb3Bkb3duQ3NzQ2xhc3MgIT0gbnVsbFxcclxcbiAgICAgICkge1xcclxcbiAgICAgICAgdmFyIERyb3Bkb3duQ1NTID0gcmVxdWlyZShvcHRpb25zLmFtZEJhc2UgKyAnY29tcGF0L2Ryb3Bkb3duQ3NzJyk7XFxyXFxuXFxyXFxuICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlcixcXHJcXG4gICAgICAgICAgRHJvcGRvd25DU1NcXHJcXG4gICAgICAgICk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIG9wdGlvbnMuZHJvcGRvd25BZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICBvcHRpb25zLmRyb3Bkb3duQWRhcHRlcixcXHJcXG4gICAgICAgIEF0dGFjaEJvZHlcXHJcXG4gICAgICApO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChvcHRpb25zLnNlbGVjdGlvbkFkYXB0ZXIgPT0gbnVsbCkge1xcclxcbiAgICAgIGlmIChvcHRpb25zLm11bHRpcGxlKSB7XFxyXFxuICAgICAgICBvcHRpb25zLnNlbGVjdGlvbkFkYXB0ZXIgPSBNdWx0aXBsZVNlbGVjdGlvbjtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgb3B0aW9ucy5zZWxlY3Rpb25BZGFwdGVyID0gU2luZ2xlU2VsZWN0aW9uO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAvLyBBZGQgdGhlIHBsYWNlaG9sZGVyIG1peGluIGlmIGEgcGxhY2Vob2xkZXIgd2FzIHNwZWNpZmllZFxcclxcbiAgICAgIGlmIChvcHRpb25zLnBsYWNlaG9sZGVyICE9IG51bGwpIHtcXHJcXG4gICAgICAgIG9wdGlvbnMuc2VsZWN0aW9uQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgICBvcHRpb25zLnNlbGVjdGlvbkFkYXB0ZXIsXFxyXFxuICAgICAgICAgIFBsYWNlaG9sZGVyXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5hbGxvd0NsZWFyKSB7XFxyXFxuICAgICAgICBvcHRpb25zLnNlbGVjdGlvbkFkYXB0ZXIgPSBVdGlscy5EZWNvcmF0ZShcXHJcXG4gICAgICAgICAgb3B0aW9ucy5zZWxlY3Rpb25BZGFwdGVyLFxcclxcbiAgICAgICAgICBBbGxvd0NsZWFyXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAob3B0aW9ucy5tdWx0aXBsZSkge1xcclxcbiAgICAgICAgb3B0aW9ucy5zZWxlY3Rpb25BZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMuc2VsZWN0aW9uQWRhcHRlcixcXHJcXG4gICAgICAgICAgU2VsZWN0aW9uU2VhcmNoXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAoXFxyXFxuICAgICAgICBvcHRpb25zLmNvbnRhaW5lckNzc0NsYXNzICE9IG51bGwgfHxcXHJcXG4gICAgICAgIG9wdGlvbnMuY29udGFpbmVyQ3NzICE9IG51bGwgfHxcXHJcXG4gICAgICAgIG9wdGlvbnMuYWRhcHRDb250YWluZXJDc3NDbGFzcyAhPSBudWxsXFxyXFxuICAgICAgKSB7XFxyXFxuICAgICAgICB2YXIgQ29udGFpbmVyQ1NTID0gcmVxdWlyZShvcHRpb25zLmFtZEJhc2UgKyAnY29tcGF0L2NvbnRhaW5lckNzcycpO1xcclxcblxcclxcbiAgICAgICAgb3B0aW9ucy5zZWxlY3Rpb25BZGFwdGVyID0gVXRpbHMuRGVjb3JhdGUoXFxyXFxuICAgICAgICAgIG9wdGlvbnMuc2VsZWN0aW9uQWRhcHRlcixcXHJcXG4gICAgICAgICAgQ29udGFpbmVyQ1NTXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBvcHRpb25zLnNlbGVjdGlvbkFkYXB0ZXIgPSBVdGlscy5EZWNvcmF0ZShcXHJcXG4gICAgICAgIG9wdGlvbnMuc2VsZWN0aW9uQWRhcHRlcixcXHJcXG4gICAgICAgIEV2ZW50UmVsYXlcXHJcXG4gICAgICApO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5sYW5ndWFnZSA9PT0gJ3N0cmluZycpIHtcXHJcXG4gICAgICAvLyBDaGVjayBpZiB0aGUgbGFuZ3VhZ2UgaXMgc3BlY2lmaWVkIHdpdGggYSByZWdpb25cXHJcXG4gICAgICBpZiAob3B0aW9ucy5sYW5ndWFnZS5pbmRleE9mKCctJykgPiAwKSB7XFxyXFxuICAgICAgICAvLyBFeHRyYWN0IHRoZSByZWdpb24gaW5mb3JtYXRpb24gaWYgaXQgaXMgaW5jbHVkZWRcXHJcXG4gICAgICAgIHZhciBsYW5ndWFnZVBhcnRzID0gb3B0aW9ucy5sYW5ndWFnZS5zcGxpdCgnLScpO1xcclxcbiAgICAgICAgdmFyIGJhc2VMYW5ndWFnZSA9IGxhbmd1YWdlUGFydHNbMF07XFxyXFxuXFxyXFxuICAgICAgICBvcHRpb25zLmxhbmd1YWdlID0gW29wdGlvbnMubGFuZ3VhZ2UsIGJhc2VMYW5ndWFnZV07XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIG9wdGlvbnMubGFuZ3VhZ2UgPSBbb3B0aW9ucy5sYW5ndWFnZV07XFxyXFxuICAgICAgfVxcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmICgkLmlzQXJyYXkob3B0aW9ucy5sYW5ndWFnZSkpIHtcXHJcXG4gICAgICB2YXIgbGFuZ3VhZ2VzID0gbmV3IFRyYW5zbGF0aW9uKCk7XFxyXFxuICAgICAgb3B0aW9ucy5sYW5ndWFnZS5wdXNoKCdlbicpO1xcclxcblxcclxcbiAgICAgIHZhciBsYW5ndWFnZU5hbWVzID0gb3B0aW9ucy5sYW5ndWFnZTtcXHJcXG5cXHJcXG4gICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGxhbmd1YWdlTmFtZXMubGVuZ3RoOyBsKyspIHtcXHJcXG4gICAgICAgIHZhciBuYW1lID0gbGFuZ3VhZ2VOYW1lc1tsXTtcXHJcXG4gICAgICAgIHZhciBsYW5ndWFnZSA9IHt9O1xcclxcblxcclxcbiAgICAgICAgdHJ5IHtcXHJcXG4gICAgICAgICAgLy8gVHJ5IHRvIGxvYWQgaXQgd2l0aCB0aGUgb3JpZ2luYWwgbmFtZVxcclxcbiAgICAgICAgICBsYW5ndWFnZSA9IFRyYW5zbGF0aW9uLmxvYWRQYXRoKG5hbWUpO1xcclxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcclxcbiAgICAgICAgICB0cnkge1xcclxcbiAgICAgICAgICAgIC8vIElmIHdlIGNvdWxkbid0IGxvYWQgaXQsIGNoZWNrIGlmIGl0IHdhc24ndCB0aGUgZnVsbCBwYXRoXFxyXFxuICAgICAgICAgICAgbmFtZSA9IHRoaXMuZGVmYXVsdHMuYW1kTGFuZ3VhZ2VCYXNlICsgbmFtZTtcXHJcXG4gICAgICAgICAgICBsYW5ndWFnZSA9IFRyYW5zbGF0aW9uLmxvYWRQYXRoKG5hbWUpO1xcclxcbiAgICAgICAgICB9IGNhdGNoIChleCkge1xcclxcbiAgICAgICAgICAgIC8vIFRoZSB0cmFuc2xhdGlvbiBjb3VsZCBub3QgYmUgbG9hZGVkIGF0IGFsbC4gU29tZXRpbWVzIHRoaXMgaXNcXHJcXG4gICAgICAgICAgICAvLyBiZWNhdXNlIG9mIGEgY29uZmlndXJhdGlvbiBwcm9ibGVtLCBvdGhlciB0aW1lcyB0aGlzIGNhbiBiZVxcclxcbiAgICAgICAgICAgIC8vIGJlY2F1c2Ugb2YgaG93IFNlbGVjdDIgaGVscHMgbG9hZCBhbGwgcG9zc2libGUgdHJhbnNsYXRpb24gZmlsZXMuXFxyXFxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGVidWcgJiYgd2luZG93LmNvbnNvbGUgJiYgY29uc29sZS53YXJuKSB7XFxyXFxuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXFxyXFxuICAgICAgICAgICAgICAgICdTZWxlY3QyOiBUaGUgbGFuZ3VhZ2UgZmlsZSBmb3IgXFxcIicgKyBuYW1lICsgJ1xcXCIgY291bGQgbm90IGJlICcgK1xcclxcbiAgICAgICAgICAgICAgICAnYXV0b21hdGljYWxseSBsb2FkZWQuIEEgZmFsbGJhY2sgd2lsbCBiZSB1c2VkIGluc3RlYWQuJ1xcclxcbiAgICAgICAgICAgICAgKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgICAgY29udGludWU7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGxhbmd1YWdlcy5leHRlbmQobGFuZ3VhZ2UpO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBvcHRpb25zLnRyYW5zbGF0aW9ucyA9IGxhbmd1YWdlcztcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICB2YXIgYmFzZVRyYW5zbGF0aW9uID0gVHJhbnNsYXRpb24ubG9hZFBhdGgoXFxyXFxuICAgICAgICB0aGlzLmRlZmF1bHRzLmFtZExhbmd1YWdlQmFzZSArICdlbidcXHJcXG4gICAgICApO1xcclxcbiAgICAgIHZhciBjdXN0b21UcmFuc2xhdGlvbiA9IG5ldyBUcmFuc2xhdGlvbihvcHRpb25zLmxhbmd1YWdlKTtcXHJcXG5cXHJcXG4gICAgICBjdXN0b21UcmFuc2xhdGlvbi5leHRlbmQoYmFzZVRyYW5zbGF0aW9uKTtcXHJcXG5cXHJcXG4gICAgICBvcHRpb25zLnRyYW5zbGF0aW9ucyA9IGN1c3RvbVRyYW5zbGF0aW9uO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHJldHVybiBvcHRpb25zO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIERlZmF1bHRzLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgZnVuY3Rpb24gc3RyaXBEaWFjcml0aWNzICh0ZXh0KSB7XFxyXFxuICAgICAgLy8gVXNlZCAndW5pIHJhbmdlICsgbmFtZWQgZnVuY3Rpb24nIGZyb20gaHR0cDovL2pzcGVyZi5jb20vZGlhY3JpdGljcy8xOFxcclxcbiAgICAgIGZ1bmN0aW9uIG1hdGNoKGEpIHtcXHJcXG4gICAgICAgIHJldHVybiBESUFDUklUSUNTW2FdIHx8IGE7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL1teXFxcXHUwMDAwLVxcXFx1MDA3RV0vZywgbWF0Y2gpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGZ1bmN0aW9uIG1hdGNoZXIgKHBhcmFtcywgZGF0YSkge1xcclxcbiAgICAgIC8vIEFsd2F5cyByZXR1cm4gdGhlIG9iamVjdCBpZiB0aGVyZSBpcyBub3RoaW5nIHRvIGNvbXBhcmVcXHJcXG4gICAgICBpZiAoJC50cmltKHBhcmFtcy50ZXJtKSA9PT0gJycpIHtcXHJcXG4gICAgICAgIHJldHVybiBkYXRhO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAvLyBEbyBhIHJlY3Vyc2l2ZSBjaGVjayBmb3Igb3B0aW9ucyB3aXRoIGNoaWxkcmVuXFxyXFxuICAgICAgaWYgKGRhdGEuY2hpbGRyZW4gJiYgZGF0YS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XFxyXFxuICAgICAgICAvLyBDbG9uZSB0aGUgZGF0YSBvYmplY3QgaWYgdGhlcmUgYXJlIGNoaWxkcmVuXFxyXFxuICAgICAgICAvLyBUaGlzIGlzIHJlcXVpcmVkIGFzIHdlIG1vZGlmeSB0aGUgb2JqZWN0IHRvIHJlbW92ZSBhbnkgbm9uLW1hdGNoZXNcXHJcXG4gICAgICAgIHZhciBtYXRjaCA9ICQuZXh0ZW5kKHRydWUsIHt9LCBkYXRhKTtcXHJcXG5cXHJcXG4gICAgICAgIC8vIENoZWNrIGVhY2ggY2hpbGQgb2YgdGhlIG9wdGlvblxcclxcbiAgICAgICAgZm9yICh2YXIgYyA9IGRhdGEuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgYyA+PSAwOyBjLS0pIHtcXHJcXG4gICAgICAgICAgdmFyIGNoaWxkID0gZGF0YS5jaGlsZHJlbltjXTtcXHJcXG5cXHJcXG4gICAgICAgICAgdmFyIG1hdGNoZXMgPSBtYXRjaGVyKHBhcmFtcywgY2hpbGQpO1xcclxcblxcclxcbiAgICAgICAgICAvLyBJZiB0aGVyZSB3YXNuJ3QgYSBtYXRjaCwgcmVtb3ZlIHRoZSBvYmplY3QgaW4gdGhlIGFycmF5XFxyXFxuICAgICAgICAgIGlmIChtYXRjaGVzID09IG51bGwpIHtcXHJcXG4gICAgICAgICAgICBtYXRjaC5jaGlsZHJlbi5zcGxpY2UoYywgMSk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIC8vIElmIGFueSBjaGlsZHJlbiBtYXRjaGVkLCByZXR1cm4gdGhlIG5ldyBvYmplY3RcXHJcXG4gICAgICAgIGlmIChtYXRjaC5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XFxyXFxuICAgICAgICAgIHJldHVybiBtYXRjaDtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIC8vIElmIHRoZXJlIHdlcmUgbm8gbWF0Y2hpbmcgY2hpbGRyZW4sIGNoZWNrIGp1c3QgdGhlIHBsYWluIG9iamVjdFxcclxcbiAgICAgICAgcmV0dXJuIG1hdGNoZXIocGFyYW1zLCBtYXRjaCk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHZhciBvcmlnaW5hbCA9IHN0cmlwRGlhY3JpdGljcyhkYXRhLnRleHQpLnRvVXBwZXJDYXNlKCk7XFxyXFxuICAgICAgdmFyIHRlcm0gPSBzdHJpcERpYWNyaXRpY3MocGFyYW1zLnRlcm0pLnRvVXBwZXJDYXNlKCk7XFxyXFxuXFxyXFxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRleHQgY29udGFpbnMgdGhlIHRlcm1cXHJcXG4gICAgICBpZiAob3JpZ2luYWwuaW5kZXhPZih0ZXJtKSA+IC0xKSB7XFxyXFxuICAgICAgICByZXR1cm4gZGF0YTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgLy8gSWYgaXQgZG9lc24ndCBjb250YWluIHRoZSB0ZXJtLCBkb24ndCByZXR1cm4gYW55dGhpbmdcXHJcXG4gICAgICByZXR1cm4gbnVsbDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLmRlZmF1bHRzID0ge1xcclxcbiAgICAgIGFtZEJhc2U6ICcuLycsXFxyXFxuICAgICAgYW1kTGFuZ3VhZ2VCYXNlOiAnLi9pMThuLycsXFxyXFxuICAgICAgY2xvc2VPblNlbGVjdDogdHJ1ZSxcXHJcXG4gICAgICBkZWJ1ZzogZmFsc2UsXFxyXFxuICAgICAgZHJvcGRvd25BdXRvV2lkdGg6IGZhbHNlLFxcclxcbiAgICAgIGVzY2FwZU1hcmt1cDogVXRpbHMuZXNjYXBlTWFya3VwLFxcclxcbiAgICAgIGxhbmd1YWdlOiBFbmdsaXNoVHJhbnNsYXRpb24sXFxyXFxuICAgICAgbWF0Y2hlcjogbWF0Y2hlcixcXHJcXG4gICAgICBtaW5pbXVtSW5wdXRMZW5ndGg6IDAsXFxyXFxuICAgICAgbWF4aW11bUlucHV0TGVuZ3RoOiAwLFxcclxcbiAgICAgIG1heGltdW1TZWxlY3Rpb25MZW5ndGg6IDAsXFxyXFxuICAgICAgbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6IDAsXFxyXFxuICAgICAgc2VsZWN0T25DbG9zZTogZmFsc2UsXFxyXFxuICAgICAgc29ydGVyOiBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICAgICAgcmV0dXJuIGRhdGE7XFxyXFxuICAgICAgfSxcXHJcXG4gICAgICB0ZW1wbGF0ZVJlc3VsdDogZnVuY3Rpb24gKHJlc3VsdCkge1xcclxcbiAgICAgICAgcmV0dXJuIHJlc3VsdC50ZXh0O1xcclxcbiAgICAgIH0sXFxyXFxuICAgICAgdGVtcGxhdGVTZWxlY3Rpb246IGZ1bmN0aW9uIChzZWxlY3Rpb24pIHtcXHJcXG4gICAgICAgIHJldHVybiBzZWxlY3Rpb24udGV4dDtcXHJcXG4gICAgICB9LFxcclxcbiAgICAgIHRoZW1lOiAnZGVmYXVsdCcsXFxyXFxuICAgICAgd2lkdGg6ICdyZXNvbHZlJ1xcclxcbiAgICB9O1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIERlZmF1bHRzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xcclxcbiAgICB2YXIgY2FtZWxLZXkgPSAkLmNhbWVsQ2FzZShrZXkpO1xcclxcblxcclxcbiAgICB2YXIgZGF0YSA9IHt9O1xcclxcbiAgICBkYXRhW2NhbWVsS2V5XSA9IHZhbHVlO1xcclxcblxcclxcbiAgICB2YXIgY29udmVydGVkRGF0YSA9IFV0aWxzLl9jb252ZXJ0RGF0YShkYXRhKTtcXHJcXG5cXHJcXG4gICAgJC5leHRlbmQodGhpcy5kZWZhdWx0cywgY29udmVydGVkRGF0YSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgdmFyIGRlZmF1bHRzID0gbmV3IERlZmF1bHRzKCk7XFxyXFxuXFxyXFxuICByZXR1cm4gZGVmYXVsdHM7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL29wdGlvbnMnLFtcXHJcXG4gICdyZXF1aXJlJyxcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJy4vZGVmYXVsdHMnLFxcclxcbiAgJy4vdXRpbHMnXFxyXFxuXSwgZnVuY3Rpb24gKHJlcXVpcmUsICQsIERlZmF1bHRzLCBVdGlscykge1xcclxcbiAgZnVuY3Rpb24gT3B0aW9ucyAob3B0aW9ucywgJGVsZW1lbnQpIHtcXHJcXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcXHJcXG5cXHJcXG4gICAgaWYgKCRlbGVtZW50ICE9IG51bGwpIHtcXHJcXG4gICAgICB0aGlzLmZyb21FbGVtZW50KCRlbGVtZW50KTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLm9wdGlvbnMgPSBEZWZhdWx0cy5hcHBseSh0aGlzLm9wdGlvbnMpO1xcclxcblxcclxcbiAgICBpZiAoJGVsZW1lbnQgJiYgJGVsZW1lbnQuaXMoJ2lucHV0JykpIHtcXHJcXG4gICAgICB2YXIgSW5wdXRDb21wYXQgPSByZXF1aXJlKHRoaXMuZ2V0KCdhbWRCYXNlJykgKyAnY29tcGF0L2lucHV0RGF0YScpO1xcclxcblxcclxcbiAgICAgIHRoaXMub3B0aW9ucy5kYXRhQWRhcHRlciA9IFV0aWxzLkRlY29yYXRlKFxcclxcbiAgICAgICAgdGhpcy5vcHRpb25zLmRhdGFBZGFwdGVyLFxcclxcbiAgICAgICAgSW5wdXRDb21wYXRcXHJcXG4gICAgICApO1xcclxcbiAgICB9XFxyXFxuICB9XFxyXFxuXFxyXFxuICBPcHRpb25zLnByb3RvdHlwZS5mcm9tRWxlbWVudCA9IGZ1bmN0aW9uICgkZSkge1xcclxcbiAgICB2YXIgZXhjbHVkZWREYXRhID0gWydzZWxlY3QyJ107XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGUgPT0gbnVsbCkge1xcclxcbiAgICAgIHRoaXMub3B0aW9ucy5tdWx0aXBsZSA9ICRlLnByb3AoJ211bHRpcGxlJyk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9PSBudWxsKSB7XFxyXFxuICAgICAgdGhpcy5vcHRpb25zLmRpc2FibGVkID0gJGUucHJvcCgnZGlzYWJsZWQnKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLmxhbmd1YWdlID09IG51bGwpIHtcXHJcXG4gICAgICBpZiAoJGUucHJvcCgnbGFuZycpKSB7XFxyXFxuICAgICAgICB0aGlzLm9wdGlvbnMubGFuZ3VhZ2UgPSAkZS5wcm9wKCdsYW5nJykudG9Mb3dlckNhc2UoKTtcXHJcXG4gICAgICB9IGVsc2UgaWYgKCRlLmNsb3Nlc3QoJ1tsYW5nXScpLnByb3AoJ2xhbmcnKSkge1xcclxcbiAgICAgICAgdGhpcy5vcHRpb25zLmxhbmd1YWdlID0gJGUuY2xvc2VzdCgnW2xhbmddJykucHJvcCgnbGFuZycpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLmRpciA9PSBudWxsKSB7XFxyXFxuICAgICAgaWYgKCRlLnByb3AoJ2RpcicpKSB7XFxyXFxuICAgICAgICB0aGlzLm9wdGlvbnMuZGlyID0gJGUucHJvcCgnZGlyJyk7XFxyXFxuICAgICAgfSBlbHNlIGlmICgkZS5jbG9zZXN0KCdbZGlyXScpLnByb3AoJ2RpcicpKSB7XFxyXFxuICAgICAgICB0aGlzLm9wdGlvbnMuZGlyID0gJGUuY2xvc2VzdCgnW2Rpcl0nKS5wcm9wKCdkaXInKTtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgdGhpcy5vcHRpb25zLmRpciA9ICdsdHInO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICAkZS5wcm9wKCdkaXNhYmxlZCcsIHRoaXMub3B0aW9ucy5kaXNhYmxlZCk7XFxyXFxuICAgICRlLnByb3AoJ211bHRpcGxlJywgdGhpcy5vcHRpb25zLm11bHRpcGxlKTtcXHJcXG5cXHJcXG4gICAgaWYgKCRlLmRhdGEoJ3NlbGVjdDJUYWdzJykpIHtcXHJcXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnICYmIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUud2Fybikge1xcclxcbiAgICAgICAgY29uc29sZS53YXJuKFxcclxcbiAgICAgICAgICAnU2VsZWN0MjogVGhlIGBkYXRhLXNlbGVjdDItdGFnc2AgYXR0cmlidXRlIGhhcyBiZWVuIGNoYW5nZWQgdG8gJyArXFxyXFxuICAgICAgICAgICd1c2UgdGhlIGBkYXRhLWRhdGFgIGFuZCBgZGF0YS10YWdzPVxcXCJ0cnVlXFxcImAgYXR0cmlidXRlcyBhbmQgd2lsbCBiZSAnICtcXHJcXG4gICAgICAgICAgJ3JlbW92ZWQgaW4gZnV0dXJlIHZlcnNpb25zIG9mIFNlbGVjdDIuJ1xcclxcbiAgICAgICAgKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgJGUuZGF0YSgnZGF0YScsICRlLmRhdGEoJ3NlbGVjdDJUYWdzJykpO1xcclxcbiAgICAgICRlLmRhdGEoJ3RhZ3MnLCB0cnVlKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoJGUuZGF0YSgnYWpheFVybCcpKSB7XFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWJ1ZyAmJiB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLndhcm4pIHtcXHJcXG4gICAgICAgIGNvbnNvbGUud2FybihcXHJcXG4gICAgICAgICAgJ1NlbGVjdDI6IFRoZSBgZGF0YS1hamF4LXVybGAgYXR0cmlidXRlIGhhcyBiZWVuIGNoYW5nZWQgdG8gJyArXFxyXFxuICAgICAgICAgICdgZGF0YS1hamF4LS11cmxgIGFuZCBzdXBwb3J0IGZvciB0aGUgb2xkIGF0dHJpYnV0ZSB3aWxsIGJlIHJlbW92ZWQnICtcXHJcXG4gICAgICAgICAgJyBpbiBmdXR1cmUgdmVyc2lvbnMgb2YgU2VsZWN0Mi4nXFxyXFxuICAgICAgICApO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAkZS5hdHRyKCdhamF4LS11cmwnLCAkZS5kYXRhKCdhamF4VXJsJykpO1xcclxcbiAgICAgICRlLmRhdGEoJ2FqYXgtLXVybCcsICRlLmRhdGEoJ2FqYXhVcmwnKSk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdmFyIGRhdGFzZXQgPSB7fTtcXHJcXG5cXHJcXG4gICAgLy8gUHJlZmVyIHRoZSBlbGVtZW50J3MgYGRhdGFzZXRgIGF0dHJpYnV0ZSBpZiBpdCBleGlzdHNcXHJcXG4gICAgLy8galF1ZXJ5IDEueCBkb2VzIG5vdCBjb3JyZWN0bHkgaGFuZGxlIGRhdGEgYXR0cmlidXRlcyB3aXRoIG11bHRpcGxlIGRhc2hlc1xcclxcbiAgICBpZiAoJC5mbi5qcXVlcnkgJiYgJC5mbi5qcXVlcnkuc3Vic3RyKDAsIDIpID09ICcxLicgJiYgJGVbMF0uZGF0YXNldCkge1xcclxcbiAgICAgIGRhdGFzZXQgPSAkLmV4dGVuZCh0cnVlLCB7fSwgJGVbMF0uZGF0YXNldCwgJGUuZGF0YSgpKTtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICBkYXRhc2V0ID0gJGUuZGF0YSgpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciBkYXRhID0gJC5leHRlbmQodHJ1ZSwge30sIGRhdGFzZXQpO1xcclxcblxcclxcbiAgICBkYXRhID0gVXRpbHMuX2NvbnZlcnREYXRhKGRhdGEpO1xcclxcblxcclxcbiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xcclxcbiAgICAgIGlmICgkLmluQXJyYXkoa2V5LCBleGNsdWRlZERhdGEpID4gLTEpIHtcXHJcXG4gICAgICAgIGNvbnRpbnVlO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAoJC5pc1BsYWluT2JqZWN0KHRoaXMub3B0aW9uc1trZXldKSkge1xcclxcbiAgICAgICAgJC5leHRlbmQodGhpcy5vcHRpb25zW2tleV0sIGRhdGFba2V5XSk7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIHRoaXMub3B0aW9uc1trZXldID0gZGF0YVtrZXldO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gdGhpcztcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBPcHRpb25zLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XFxyXFxuICAgIHJldHVybiB0aGlzLm9wdGlvbnNba2V5XTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBPcHRpb25zLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcXHJcXG4gICAgdGhpcy5vcHRpb25zW2tleV0gPSB2YWw7XFxyXFxuICB9O1xcclxcblxcclxcbiAgcmV0dXJuIE9wdGlvbnM7XFxyXFxufSk7XFxyXFxuXFxuUzIuZGVmaW5lKCdzZWxlY3QyL2NvcmUnLFtcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJy4vb3B0aW9ucycsXFxyXFxuICAnLi91dGlscycsXFxyXFxuICAnLi9rZXlzJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCBPcHRpb25zLCBVdGlscywgS0VZUykge1xcclxcbiAgdmFyIFNlbGVjdDIgPSBmdW5jdGlvbiAoJGVsZW1lbnQsIG9wdGlvbnMpIHtcXHJcXG4gICAgaWYgKCRlbGVtZW50LmRhdGEoJ3NlbGVjdDInKSAhPSBudWxsKSB7XFxyXFxuICAgICAgJGVsZW1lbnQuZGF0YSgnc2VsZWN0MicpLmRlc3Ryb3koKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XFxyXFxuXFxyXFxuICAgIHRoaXMuaWQgPSB0aGlzLl9nZW5lcmF0ZUlkKCRlbGVtZW50KTtcXHJcXG5cXHJcXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XFxyXFxuXFxyXFxuICAgIHRoaXMub3B0aW9ucyA9IG5ldyBPcHRpb25zKG9wdGlvbnMsICRlbGVtZW50KTtcXHJcXG5cXHJcXG4gICAgU2VsZWN0Mi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTtcXHJcXG5cXHJcXG4gICAgLy8gU2V0IHVwIHRoZSB0YWJpbmRleFxcclxcblxcclxcbiAgICB2YXIgdGFiaW5kZXggPSAkZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpIHx8IDA7XFxyXFxuICAgICRlbGVtZW50LmRhdGEoJ29sZC10YWJpbmRleCcsIHRhYmluZGV4KTtcXHJcXG4gICAgJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcXHJcXG5cXHJcXG4gICAgLy8gU2V0IHVwIGNvbnRhaW5lcnMgYW5kIGFkYXB0ZXJzXFxyXFxuXFxyXFxuICAgIHZhciBEYXRhQWRhcHRlciA9IHRoaXMub3B0aW9ucy5nZXQoJ2RhdGFBZGFwdGVyJyk7XFxyXFxuICAgIHRoaXMuZGF0YUFkYXB0ZXIgPSBuZXcgRGF0YUFkYXB0ZXIoJGVsZW1lbnQsIHRoaXMub3B0aW9ucyk7XFxyXFxuXFxyXFxuICAgIHZhciAkY29udGFpbmVyID0gdGhpcy5yZW5kZXIoKTtcXHJcXG5cXHJcXG4gICAgdGhpcy5fcGxhY2VDb250YWluZXIoJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIHZhciBTZWxlY3Rpb25BZGFwdGVyID0gdGhpcy5vcHRpb25zLmdldCgnc2VsZWN0aW9uQWRhcHRlcicpO1xcclxcbiAgICB0aGlzLnNlbGVjdGlvbiA9IG5ldyBTZWxlY3Rpb25BZGFwdGVyKCRlbGVtZW50LCB0aGlzLm9wdGlvbnMpO1xcclxcbiAgICB0aGlzLiRzZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvbi5yZW5kZXIoKTtcXHJcXG5cXHJcXG4gICAgdGhpcy5zZWxlY3Rpb24ucG9zaXRpb24odGhpcy4kc2VsZWN0aW9uLCAkY29udGFpbmVyKTtcXHJcXG5cXHJcXG4gICAgdmFyIERyb3Bkb3duQWRhcHRlciA9IHRoaXMub3B0aW9ucy5nZXQoJ2Ryb3Bkb3duQWRhcHRlcicpO1xcclxcbiAgICB0aGlzLmRyb3Bkb3duID0gbmV3IERyb3Bkb3duQWRhcHRlcigkZWxlbWVudCwgdGhpcy5vcHRpb25zKTtcXHJcXG4gICAgdGhpcy4kZHJvcGRvd24gPSB0aGlzLmRyb3Bkb3duLnJlbmRlcigpO1xcclxcblxcclxcbiAgICB0aGlzLmRyb3Bkb3duLnBvc2l0aW9uKHRoaXMuJGRyb3Bkb3duLCAkY29udGFpbmVyKTtcXHJcXG5cXHJcXG4gICAgdmFyIFJlc3VsdHNBZGFwdGVyID0gdGhpcy5vcHRpb25zLmdldCgncmVzdWx0c0FkYXB0ZXInKTtcXHJcXG4gICAgdGhpcy5yZXN1bHRzID0gbmV3IFJlc3VsdHNBZGFwdGVyKCRlbGVtZW50LCB0aGlzLm9wdGlvbnMsIHRoaXMuZGF0YUFkYXB0ZXIpO1xcclxcbiAgICB0aGlzLiRyZXN1bHRzID0gdGhpcy5yZXN1bHRzLnJlbmRlcigpO1xcclxcblxcclxcbiAgICB0aGlzLnJlc3VsdHMucG9zaXRpb24odGhpcy4kcmVzdWx0cywgdGhpcy4kZHJvcGRvd24pO1xcclxcblxcclxcbiAgICAvLyBCaW5kIGV2ZW50c1xcclxcblxcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIC8vIEJpbmQgdGhlIGNvbnRhaW5lciB0byBhbGwgb2YgdGhlIGFkYXB0ZXJzXFxyXFxuICAgIHRoaXMuX2JpbmRBZGFwdGVycygpO1xcclxcblxcclxcbiAgICAvLyBSZWdpc3RlciBhbnkgRE9NIGV2ZW50IGhhbmRsZXJzXFxyXFxuICAgIHRoaXMuX3JlZ2lzdGVyRG9tRXZlbnRzKCk7XFxyXFxuXFxyXFxuICAgIC8vIFJlZ2lzdGVyIGFueSBpbnRlcm5hbCBldmVudCBoYW5kbGVyc1xcclxcbiAgICB0aGlzLl9yZWdpc3RlckRhdGFFdmVudHMoKTtcXHJcXG4gICAgdGhpcy5fcmVnaXN0ZXJTZWxlY3Rpb25FdmVudHMoKTtcXHJcXG4gICAgdGhpcy5fcmVnaXN0ZXJEcm9wZG93bkV2ZW50cygpO1xcclxcbiAgICB0aGlzLl9yZWdpc3RlclJlc3VsdHNFdmVudHMoKTtcXHJcXG4gICAgdGhpcy5fcmVnaXN0ZXJFdmVudHMoKTtcXHJcXG5cXHJcXG4gICAgLy8gU2V0IHRoZSBpbml0aWFsIHN0YXRlXFxyXFxuICAgIHRoaXMuZGF0YUFkYXB0ZXIuY3VycmVudChmdW5jdGlvbiAoaW5pdGlhbERhdGEpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIoJ3NlbGVjdGlvbjp1cGRhdGUnLCB7XFxyXFxuICAgICAgICBkYXRhOiBpbml0aWFsRGF0YVxcclxcbiAgICAgIH0pO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgLy8gSGlkZSB0aGUgb3JpZ2luYWwgc2VsZWN0XFxyXFxuICAgICRlbGVtZW50LmFkZENsYXNzKCdzZWxlY3QyLWhpZGRlbi1hY2Nlc3NpYmxlJyk7XFxyXFxuICAgICRlbGVtZW50LmF0dHIoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcXHJcXG5cXHJcXG4gICAgLy8gU3luY2hyb25pemUgYW55IG1vbml0b3JlZCBhdHRyaWJ1dGVzXFxyXFxuICAgIHRoaXMuX3N5bmNBdHRyaWJ1dGVzKCk7XFxyXFxuXFxyXFxuICAgICRlbGVtZW50LmRhdGEoJ3NlbGVjdDInLCB0aGlzKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBVdGlscy5FeHRlbmQoU2VsZWN0MiwgVXRpbHMuT2JzZXJ2YWJsZSk7XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS5fZ2VuZXJhdGVJZCA9IGZ1bmN0aW9uICgkZWxlbWVudCkge1xcclxcbiAgICB2YXIgaWQgPSAnJztcXHJcXG5cXHJcXG4gICAgaWYgKCRlbGVtZW50LmF0dHIoJ2lkJykgIT0gbnVsbCkge1xcclxcbiAgICAgIGlkID0gJGVsZW1lbnQuYXR0cignaWQnKTtcXHJcXG4gICAgfSBlbHNlIGlmICgkZWxlbWVudC5hdHRyKCduYW1lJykgIT0gbnVsbCkge1xcclxcbiAgICAgIGlkID0gJGVsZW1lbnQuYXR0cignbmFtZScpICsgJy0nICsgVXRpbHMuZ2VuZXJhdGVDaGFycygyKTtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICBpZCA9IFV0aWxzLmdlbmVyYXRlQ2hhcnMoNCk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWQgPSBpZC5yZXBsYWNlKC8oOnxcXFxcLnxcXFxcW3xcXFxcXXwsKS9nLCAnJyk7XFxyXFxuICAgIGlkID0gJ3NlbGVjdDItJyArIGlkO1xcclxcblxcclxcbiAgICByZXR1cm4gaWQ7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUuX3BsYWNlQ29udGFpbmVyID0gZnVuY3Rpb24gKCRjb250YWluZXIpIHtcXHJcXG4gICAgJGNvbnRhaW5lci5pbnNlcnRBZnRlcih0aGlzLiRlbGVtZW50KTtcXHJcXG5cXHJcXG4gICAgdmFyIHdpZHRoID0gdGhpcy5fcmVzb2x2ZVdpZHRoKHRoaXMuJGVsZW1lbnQsIHRoaXMub3B0aW9ucy5nZXQoJ3dpZHRoJykpO1xcclxcblxcclxcbiAgICBpZiAod2lkdGggIT0gbnVsbCkge1xcclxcbiAgICAgICRjb250YWluZXIuY3NzKCd3aWR0aCcsIHdpZHRoKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9yZXNvbHZlV2lkdGggPSBmdW5jdGlvbiAoJGVsZW1lbnQsIG1ldGhvZCkge1xcclxcbiAgICB2YXIgV0lEVEggPSAvXndpZHRoOigoWy0rXT8oWzAtOV0qXFxcXC4pP1swLTldKykocHh8ZW18ZXh8JXxpbnxjbXxtbXxwdHxwYykpL2k7XFxyXFxuXFxyXFxuICAgIGlmIChtZXRob2QgPT0gJ3Jlc29sdmUnKSB7XFxyXFxuICAgICAgdmFyIHN0eWxlV2lkdGggPSB0aGlzLl9yZXNvbHZlV2lkdGgoJGVsZW1lbnQsICdzdHlsZScpO1xcclxcblxcclxcbiAgICAgIGlmIChzdHlsZVdpZHRoICE9IG51bGwpIHtcXHJcXG4gICAgICAgIHJldHVybiBzdHlsZVdpZHRoO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICByZXR1cm4gdGhpcy5fcmVzb2x2ZVdpZHRoKCRlbGVtZW50LCAnZWxlbWVudCcpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChtZXRob2QgPT0gJ2VsZW1lbnQnKSB7XFxyXFxuICAgICAgdmFyIGVsZW1lbnRXaWR0aCA9ICRlbGVtZW50Lm91dGVyV2lkdGgoZmFsc2UpO1xcclxcblxcclxcbiAgICAgIGlmIChlbGVtZW50V2lkdGggPD0gMCkge1xcclxcbiAgICAgICAgcmV0dXJuICdhdXRvJztcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgcmV0dXJuIGVsZW1lbnRXaWR0aCArICdweCc7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKG1ldGhvZCA9PSAnc3R5bGUnKSB7XFxyXFxuICAgICAgdmFyIHN0eWxlID0gJGVsZW1lbnQuYXR0cignc3R5bGUnKTtcXHJcXG5cXHJcXG4gICAgICBpZiAodHlwZW9mKHN0eWxlKSAhPT0gJ3N0cmluZycpIHtcXHJcXG4gICAgICAgIHJldHVybiBudWxsO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB2YXIgYXR0cnMgPSBzdHlsZS5zcGxpdCgnOycpO1xcclxcblxcclxcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXR0cnMubGVuZ3RoOyBpIDwgbDsgaSA9IGkgKyAxKSB7XFxyXFxuICAgICAgICB2YXIgYXR0ciA9IGF0dHJzW2ldLnJlcGxhY2UoL1xcXFxzL2csICcnKTtcXHJcXG4gICAgICAgIHZhciBtYXRjaGVzID0gYXR0ci5tYXRjaChXSURUSCk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAobWF0Y2hlcyAhPT0gbnVsbCAmJiBtYXRjaGVzLmxlbmd0aCA+PSAxKSB7XFxyXFxuICAgICAgICAgIHJldHVybiBtYXRjaGVzWzFdO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICByZXR1cm4gbnVsbDtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICByZXR1cm4gbWV0aG9kO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9iaW5kQWRhcHRlcnMgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHRoaXMuZGF0YUFkYXB0ZXIuYmluZCh0aGlzLCB0aGlzLiRjb250YWluZXIpO1xcclxcbiAgICB0aGlzLnNlbGVjdGlvbi5iaW5kKHRoaXMsIHRoaXMuJGNvbnRhaW5lcik7XFxyXFxuXFxyXFxuICAgIHRoaXMuZHJvcGRvd24uYmluZCh0aGlzLCB0aGlzLiRjb250YWluZXIpO1xcclxcbiAgICB0aGlzLnJlc3VsdHMuYmluZCh0aGlzLCB0aGlzLiRjb250YWluZXIpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9yZWdpc3RlckRvbUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICB0aGlzLiRlbGVtZW50Lm9uKCdjaGFuZ2Uuc2VsZWN0MicsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLmRhdGFBZGFwdGVyLmN1cnJlbnQoZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgICAgIHNlbGYudHJpZ2dlcignc2VsZWN0aW9uOnVwZGF0ZScsIHtcXHJcXG4gICAgICAgICAgZGF0YTogZGF0YVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICB0aGlzLiRlbGVtZW50Lm9uKCdmb2N1cy5zZWxlY3QyJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHNlbGYudHJpZ2dlcignZm9jdXMnLCBldnQpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5fc3luY0EgPSBVdGlscy5iaW5kKHRoaXMuX3N5bmNBdHRyaWJ1dGVzLCB0aGlzKTtcXHJcXG4gICAgdGhpcy5fc3luY1MgPSBVdGlscy5iaW5kKHRoaXMuX3N5bmNTdWJ0cmVlLCB0aGlzKTtcXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMuJGVsZW1lbnRbMF0uYXR0YWNoRXZlbnQpIHtcXHJcXG4gICAgICB0aGlzLiRlbGVtZW50WzBdLmF0dGFjaEV2ZW50KCdvbnByb3BlcnR5Y2hhbmdlJywgdGhpcy5fc3luY0EpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciBvYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8XFxyXFxuICAgICAgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIgfHxcXHJcXG4gICAgICB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlclxcclxcbiAgICA7XFxyXFxuXFxyXFxuICAgIGlmIChvYnNlcnZlciAhPSBudWxsKSB7XFxyXFxuICAgICAgdGhpcy5fb2JzZXJ2ZXIgPSBuZXcgb2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xcclxcbiAgICAgICAgJC5lYWNoKG11dGF0aW9ucywgc2VsZi5fc3luY0EpO1xcclxcbiAgICAgICAgJC5lYWNoKG11dGF0aW9ucywgc2VsZi5fc3luY1MpO1xcclxcbiAgICAgIH0pO1xcclxcbiAgICAgIHRoaXMuX29ic2VydmVyLm9ic2VydmUodGhpcy4kZWxlbWVudFswXSwge1xcclxcbiAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcXHJcXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcXHJcXG4gICAgICAgIHN1YnRyZWU6IGZhbHNlXFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0gZWxzZSBpZiAodGhpcy4kZWxlbWVudFswXS5hZGRFdmVudExpc3RlbmVyKSB7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFswXS5hZGRFdmVudExpc3RlbmVyKFxcclxcbiAgICAgICAgJ0RPTUF0dHJNb2RpZmllZCcsXFxyXFxuICAgICAgICBzZWxmLl9zeW5jQSxcXHJcXG4gICAgICAgIGZhbHNlXFxyXFxuICAgICAgKTtcXHJcXG4gICAgICB0aGlzLiRlbGVtZW50WzBdLmFkZEV2ZW50TGlzdGVuZXIoXFxyXFxuICAgICAgICAnRE9NTm9kZUluc2VydGVkJyxcXHJcXG4gICAgICAgIHNlbGYuX3N5bmNTLFxcclxcbiAgICAgICAgZmFsc2VcXHJcXG4gICAgICApO1xcclxcbiAgICAgIHRoaXMuJGVsZW1lbnRbMF0uYWRkRXZlbnRMaXN0ZW5lcihcXHJcXG4gICAgICAgICdET01Ob2RlUmVtb3ZlZCcsXFxyXFxuICAgICAgICBzZWxmLl9zeW5jUyxcXHJcXG4gICAgICAgIGZhbHNlXFxyXFxuICAgICAgKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9yZWdpc3RlckRhdGFFdmVudHMgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgdGhpcy5kYXRhQWRhcHRlci5vbignKicsIGZ1bmN0aW9uIChuYW1lLCBwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIobmFtZSwgcGFyYW1zKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUuX3JlZ2lzdGVyU2VsZWN0aW9uRXZlbnRzID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuICAgIHZhciBub25SZWxheUV2ZW50cyA9IFsndG9nZ2xlJywgJ2ZvY3VzJ107XFxyXFxuXFxyXFxuICAgIHRoaXMuc2VsZWN0aW9uLm9uKCd0b2dnbGUnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgc2VsZi50b2dnbGVEcm9wZG93bigpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5zZWxlY3Rpb24ub24oJ2ZvY3VzJywgZnVuY3Rpb24gKHBhcmFtcykge1xcclxcbiAgICAgIHNlbGYuZm9jdXMocGFyYW1zKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMuc2VsZWN0aW9uLm9uKCcqJywgZnVuY3Rpb24gKG5hbWUsIHBhcmFtcykge1xcclxcbiAgICAgIGlmICgkLmluQXJyYXkobmFtZSwgbm9uUmVsYXlFdmVudHMpICE9PSAtMSkge1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBzZWxmLnRyaWdnZXIobmFtZSwgcGFyYW1zKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUuX3JlZ2lzdGVyRHJvcGRvd25FdmVudHMgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHZhciBzZWxmID0gdGhpcztcXHJcXG5cXHJcXG4gICAgdGhpcy5kcm9wZG93bi5vbignKicsIGZ1bmN0aW9uIChuYW1lLCBwYXJhbXMpIHtcXHJcXG4gICAgICBzZWxmLnRyaWdnZXIobmFtZSwgcGFyYW1zKTtcXHJcXG4gICAgfSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUuX3JlZ2lzdGVyUmVzdWx0c0V2ZW50cyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICB0aGlzLnJlc3VsdHMub24oJyonLCBmdW5jdGlvbiAobmFtZSwgcGFyYW1zKSB7XFxyXFxuICAgICAgc2VsZi50cmlnZ2VyKG5hbWUsIHBhcmFtcyk7XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9yZWdpc3RlckV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xcclxcblxcclxcbiAgICB0aGlzLm9uKCdvcGVuJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJGNvbnRhaW5lci5hZGRDbGFzcygnc2VsZWN0Mi1jb250YWluZXItLW9wZW4nKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMub24oJ2Nsb3NlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHNlbGYuJGNvbnRhaW5lci5yZW1vdmVDbGFzcygnc2VsZWN0Mi1jb250YWluZXItLW9wZW4nKTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMub24oJ2VuYWJsZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLiRjb250YWluZXIucmVtb3ZlQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1kaXNhYmxlZCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5vbignZGlzYWJsZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLiRjb250YWluZXIuYWRkQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1kaXNhYmxlZCcpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5vbignYmx1cicsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBzZWxmLiRjb250YWluZXIucmVtb3ZlQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1mb2N1cycpO1xcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgdGhpcy5vbigncXVlcnknLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgaWYgKCFzZWxmLmlzT3BlbigpKSB7XFxyXFxuICAgICAgICBzZWxmLnRyaWdnZXIoJ29wZW4nLCB7fSk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHRoaXMuZGF0YUFkYXB0ZXIucXVlcnkocGFyYW1zLCBmdW5jdGlvbiAoZGF0YSkge1xcclxcbiAgICAgICAgc2VsZi50cmlnZ2VyKCdyZXN1bHRzOmFsbCcsIHtcXHJcXG4gICAgICAgICAgZGF0YTogZGF0YSxcXHJcXG4gICAgICAgICAgcXVlcnk6IHBhcmFtc1xcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0pO1xcclxcblxcclxcbiAgICB0aGlzLm9uKCdxdWVyeTphcHBlbmQnLCBmdW5jdGlvbiAocGFyYW1zKSB7XFxyXFxuICAgICAgdGhpcy5kYXRhQWRhcHRlci5xdWVyeShwYXJhbXMsIGZ1bmN0aW9uIChkYXRhKSB7XFxyXFxuICAgICAgICBzZWxmLnRyaWdnZXIoJ3Jlc3VsdHM6YXBwZW5kJywge1xcclxcbiAgICAgICAgICBkYXRhOiBkYXRhLFxcclxcbiAgICAgICAgICBxdWVyeTogcGFyYW1zXFxyXFxuICAgICAgICB9KTtcXHJcXG4gICAgICB9KTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHRoaXMub24oJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2dCkge1xcclxcbiAgICAgIHZhciBrZXkgPSBldnQud2hpY2g7XFxyXFxuXFxyXFxuICAgICAgaWYgKHNlbGYuaXNPcGVuKCkpIHtcXHJcXG4gICAgICAgIGlmIChrZXkgPT09IEtFWVMuRVNDIHx8IGtleSA9PT0gS0VZUy5UQUIgfHxcXHJcXG4gICAgICAgICAgICAoa2V5ID09PSBLRVlTLlVQICYmIGV2dC5hbHRLZXkpKSB7XFxyXFxuICAgICAgICAgIHNlbGYuY2xvc2UoKTtcXHJcXG5cXHJcXG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS0VZUy5FTlRFUikge1xcclxcbiAgICAgICAgICBzZWxmLnRyaWdnZXIoJ3Jlc3VsdHM6c2VsZWN0Jywge30pO1xcclxcblxcclxcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgIH0gZWxzZSBpZiAoKGtleSA9PT0gS0VZUy5TUEFDRSAmJiBldnQuY3RybEtleSkpIHtcXHJcXG4gICAgICAgICAgc2VsZi50cmlnZ2VyKCdyZXN1bHRzOnRvZ2dsZScsIHt9KTtcXHJcXG5cXHJcXG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS0VZUy5VUCkge1xcclxcbiAgICAgICAgICBzZWxmLnRyaWdnZXIoJ3Jlc3VsdHM6cHJldmlvdXMnLCB7fSk7XFxyXFxuXFxyXFxuICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xcclxcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtFWVMuRE9XTikge1xcclxcbiAgICAgICAgICBzZWxmLnRyaWdnZXIoJ3Jlc3VsdHM6bmV4dCcsIHt9KTtcXHJcXG5cXHJcXG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIGlmIChrZXkgPT09IEtFWVMuRU5URVIgfHwga2V5ID09PSBLRVlTLlNQQUNFIHx8XFxyXFxuICAgICAgICAgICAgKGtleSA9PT0gS0VZUy5ET1dOICYmIGV2dC5hbHRLZXkpKSB7XFxyXFxuICAgICAgICAgIHNlbGYub3BlbigpO1xcclxcblxcclxcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuICAgIH0pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9zeW5jQXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgdGhpcy5vcHRpb25zLnNldCgnZGlzYWJsZWQnLCB0aGlzLiRlbGVtZW50LnByb3AoJ2Rpc2FibGVkJykpO1xcclxcblxcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLmdldCgnZGlzYWJsZWQnKSkge1xcclxcbiAgICAgIGlmICh0aGlzLmlzT3BlbigpKSB7XFxyXFxuICAgICAgICB0aGlzLmNsb3NlKCk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHRoaXMudHJpZ2dlcignZGlzYWJsZScsIHt9KTtcXHJcXG4gICAgfSBlbHNlIHtcXHJcXG4gICAgICB0aGlzLnRyaWdnZXIoJ2VuYWJsZScsIHt9KTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLl9zeW5jU3VidHJlZSA9IGZ1bmN0aW9uIChldnQsIG11dGF0aW9ucykge1xcclxcbiAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xcclxcbiAgICB2YXIgc2VsZiA9IHRoaXM7XFxyXFxuXFxyXFxuICAgIC8vIElnbm9yZSBhbnkgbXV0YXRpb24gZXZlbnRzIHJhaXNlZCBmb3IgZWxlbWVudHMgdGhhdCBhcmVuJ3Qgb3B0aW9ucyBvclxcclxcbiAgICAvLyBvcHRncm91cHMuIFRoaXMgaGFuZGxlcyB0aGUgY2FzZSB3aGVuIHRoZSBzZWxlY3QgZWxlbWVudCBpcyBkZXN0cm95ZWRcXHJcXG4gICAgaWYgKFxcclxcbiAgICAgIGV2dCAmJiBldnQudGFyZ2V0ICYmIChcXHJcXG4gICAgICAgIGV2dC50YXJnZXQubm9kZU5hbWUgIT09ICdPUFRJT04nICYmIGV2dC50YXJnZXQubm9kZU5hbWUgIT09ICdPUFRHUk9VUCdcXHJcXG4gICAgICApXFxyXFxuICAgICkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoIW11dGF0aW9ucykge1xcclxcbiAgICAgIC8vIElmIG11dGF0aW9uIGV2ZW50cyBhcmVuJ3Qgc3VwcG9ydGVkLCB0aGVuIHdlIGNhbiBvbmx5IGFzc3VtZSB0aGF0IHRoZVxcclxcbiAgICAgIC8vIGNoYW5nZSBhZmZlY3RlZCB0aGUgc2VsZWN0aW9uc1xcclxcbiAgICAgIGNoYW5nZWQgPSB0cnVlO1xcclxcbiAgICB9IGVsc2UgaWYgKG11dGF0aW9ucy5hZGRlZE5vZGVzICYmIG11dGF0aW9ucy5hZGRlZE5vZGVzLmxlbmd0aCA+IDApIHtcXHJcXG4gICAgICBmb3IgKHZhciBuID0gMDsgbiA8IG11dGF0aW9ucy5hZGRlZE5vZGVzLmxlbmd0aDsgbisrKSB7XFxyXFxuICAgICAgICB2YXIgbm9kZSA9IG11dGF0aW9ucy5hZGRlZE5vZGVzW25dO1xcclxcblxcclxcbiAgICAgICAgaWYgKG5vZGUuc2VsZWN0ZWQpIHtcXHJcXG4gICAgICAgICAgY2hhbmdlZCA9IHRydWU7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfVxcclxcbiAgICB9IGVsc2UgaWYgKG11dGF0aW9ucy5yZW1vdmVkTm9kZXMgJiYgbXV0YXRpb25zLnJlbW92ZWROb2Rlcy5sZW5ndGggPiAwKSB7XFxyXFxuICAgICAgY2hhbmdlZCA9IHRydWU7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgLy8gT25seSByZS1wdWxsIHRoZSBkYXRhIGlmIHdlIHRoaW5rIHRoZXJlIGlzIGEgY2hhbmdlXFxyXFxuICAgIGlmIChjaGFuZ2VkKSB7XFxyXFxuICAgICAgdGhpcy5kYXRhQWRhcHRlci5jdXJyZW50KGZ1bmN0aW9uIChjdXJyZW50RGF0YSkge1xcclxcbiAgICAgICAgc2VsZi50cmlnZ2VyKCdzZWxlY3Rpb246dXBkYXRlJywge1xcclxcbiAgICAgICAgICBkYXRhOiBjdXJyZW50RGF0YVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH1cXHJcXG4gIH07XFxyXFxuXFxyXFxuICAvKipcXHJcXG4gICAqIE92ZXJyaWRlIHRoZSB0cmlnZ2VyIG1ldGhvZCB0byBhdXRvbWF0aWNhbGx5IHRyaWdnZXIgcHJlLWV2ZW50cyB3aGVuXFxyXFxuICAgKiB0aGVyZSBhcmUgZXZlbnRzIHRoYXQgY2FuIGJlIHByZXZlbnRlZC5cXHJcXG4gICAqL1xcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uIChuYW1lLCBhcmdzKSB7XFxyXFxuICAgIHZhciBhY3R1YWxUcmlnZ2VyID0gU2VsZWN0Mi5fX3N1cGVyX18udHJpZ2dlcjtcXHJcXG4gICAgdmFyIHByZVRyaWdnZXJNYXAgPSB7XFxyXFxuICAgICAgJ29wZW4nOiAnb3BlbmluZycsXFxyXFxuICAgICAgJ2Nsb3NlJzogJ2Nsb3NpbmcnLFxcclxcbiAgICAgICdzZWxlY3QnOiAnc2VsZWN0aW5nJyxcXHJcXG4gICAgICAndW5zZWxlY3QnOiAndW5zZWxlY3RpbmcnXFxyXFxuICAgIH07XFxyXFxuXFxyXFxuICAgIGlmIChhcmdzID09PSB1bmRlZmluZWQpIHtcXHJcXG4gICAgICBhcmdzID0ge307XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKG5hbWUgaW4gcHJlVHJpZ2dlck1hcCkge1xcclxcbiAgICAgIHZhciBwcmVUcmlnZ2VyTmFtZSA9IHByZVRyaWdnZXJNYXBbbmFtZV07XFxyXFxuICAgICAgdmFyIHByZVRyaWdnZXJBcmdzID0ge1xcclxcbiAgICAgICAgcHJldmVudGVkOiBmYWxzZSxcXHJcXG4gICAgICAgIG5hbWU6IG5hbWUsXFxyXFxuICAgICAgICBhcmdzOiBhcmdzXFxyXFxuICAgICAgfTtcXHJcXG5cXHJcXG4gICAgICBhY3R1YWxUcmlnZ2VyLmNhbGwodGhpcywgcHJlVHJpZ2dlck5hbWUsIHByZVRyaWdnZXJBcmdzKTtcXHJcXG5cXHJcXG4gICAgICBpZiAocHJlVHJpZ2dlckFyZ3MucHJldmVudGVkKSB7XFxyXFxuICAgICAgICBhcmdzLnByZXZlbnRlZCA9IHRydWU7XFxyXFxuXFxyXFxuICAgICAgICByZXR1cm47XFxyXFxuICAgICAgfVxcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGFjdHVhbFRyaWdnZXIuY2FsbCh0aGlzLCBuYW1lLCBhcmdzKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS50b2dnbGVEcm9wZG93biA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgaWYgKHRoaXMub3B0aW9ucy5nZXQoJ2Rpc2FibGVkJykpIHtcXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgaWYgKHRoaXMuaXNPcGVuKCkpIHtcXHJcXG4gICAgICB0aGlzLmNsb3NlKCk7XFxyXFxuICAgIH0gZWxzZSB7XFxyXFxuICAgICAgdGhpcy5vcGVuKCk7XFxyXFxuICAgIH1cXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICBpZiAodGhpcy5pc09wZW4oKSkge1xcclxcbiAgICAgIHJldHVybjtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLnRyaWdnZXIoJ3F1ZXJ5Jywge30pO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICBpZiAoIXRoaXMuaXNPcGVuKCkpIHtcXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy50cmlnZ2VyKCdjbG9zZScsIHt9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHJldHVybiB0aGlzLiRjb250YWluZXIuaGFzQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1vcGVuJyk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUuaGFzRm9jdXMgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIHJldHVybiB0aGlzLiRjb250YWluZXIuaGFzQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS1mb2N1cycpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKGRhdGEpIHtcXHJcXG4gICAgLy8gTm8gbmVlZCB0byByZS10cmlnZ2VyIGZvY3VzIGV2ZW50cyBpZiB3ZSBhcmUgYWxyZWFkeSBmb2N1c2VkXFxyXFxuICAgIGlmICh0aGlzLmhhc0ZvY3VzKCkpIHtcXHJcXG4gICAgICByZXR1cm47XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy4kY29udGFpbmVyLmFkZENsYXNzKCdzZWxlY3QyLWNvbnRhaW5lci0tZm9jdXMnKTtcXHJcXG4gICAgdGhpcy50cmlnZ2VyKCdmb2N1cycsIHt9KTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoYXJncykge1xcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLmdldCgnZGVidWcnKSAmJiB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLndhcm4pIHtcXHJcXG4gICAgICBjb25zb2xlLndhcm4oXFxyXFxuICAgICAgICAnU2VsZWN0MjogVGhlIGBzZWxlY3QyKFxcXCJlbmFibGVcXFwiKWAgbWV0aG9kIGhhcyBiZWVuIGRlcHJlY2F0ZWQgYW5kIHdpbGwnICtcXHJcXG4gICAgICAgICcgYmUgcmVtb3ZlZCBpbiBsYXRlciBTZWxlY3QyIHZlcnNpb25zLiBVc2UgJGVsZW1lbnQucHJvcChcXFwiZGlzYWJsZWRcXFwiKScgK1xcclxcbiAgICAgICAgJyBpbnN0ZWFkLidcXHJcXG4gICAgICApO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChhcmdzID09IG51bGwgfHwgYXJncy5sZW5ndGggPT09IDApIHtcXHJcXG4gICAgICBhcmdzID0gW3RydWVdO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHZhciBkaXNhYmxlZCA9ICFhcmdzWzBdO1xcclxcblxcclxcbiAgICB0aGlzLiRlbGVtZW50LnByb3AoJ2Rpc2FibGVkJywgZGlzYWJsZWQpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgIGlmICh0aGlzLm9wdGlvbnMuZ2V0KCdkZWJ1ZycpICYmXFxyXFxuICAgICAgICBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLndhcm4pIHtcXHJcXG4gICAgICBjb25zb2xlLndhcm4oXFxyXFxuICAgICAgICAnU2VsZWN0MjogRGF0YSBjYW4gbm8gbG9uZ2VyIGJlIHNldCB1c2luZyBgc2VsZWN0MihcXFwiZGF0YVxcXCIpYC4gWW91ICcgK1xcclxcbiAgICAgICAgJ3Nob3VsZCBjb25zaWRlciBzZXR0aW5nIHRoZSB2YWx1ZSBpbnN0ZWFkIHVzaW5nIGAkZWxlbWVudC52YWwoKWAuJ1xcclxcbiAgICAgICk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdmFyIGRhdGEgPSBbXTtcXHJcXG5cXHJcXG4gICAgdGhpcy5kYXRhQWRhcHRlci5jdXJyZW50KGZ1bmN0aW9uIChjdXJyZW50RGF0YSkge1xcclxcbiAgICAgIGRhdGEgPSBjdXJyZW50RGF0YTtcXHJcXG4gICAgfSk7XFxyXFxuXFxyXFxuICAgIHJldHVybiBkYXRhO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdDIucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uIChhcmdzKSB7XFxyXFxuICAgIGlmICh0aGlzLm9wdGlvbnMuZ2V0KCdkZWJ1ZycpICYmIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUud2Fybikge1xcclxcbiAgICAgIGNvbnNvbGUud2FybihcXHJcXG4gICAgICAgICdTZWxlY3QyOiBUaGUgYHNlbGVjdDIoXFxcInZhbFxcXCIpYCBtZXRob2QgaGFzIGJlZW4gZGVwcmVjYXRlZCBhbmQgd2lsbCBiZScgK1xcclxcbiAgICAgICAgJyByZW1vdmVkIGluIGxhdGVyIFNlbGVjdDIgdmVyc2lvbnMuIFVzZSAkZWxlbWVudC52YWwoKSBpbnN0ZWFkLidcXHJcXG4gICAgICApO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIGlmIChhcmdzID09IG51bGwgfHwgYXJncy5sZW5ndGggPT09IDApIHtcXHJcXG4gICAgICByZXR1cm4gdGhpcy4kZWxlbWVudC52YWwoKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB2YXIgbmV3VmFsID0gYXJnc1swXTtcXHJcXG5cXHJcXG4gICAgaWYgKCQuaXNBcnJheShuZXdWYWwpKSB7XFxyXFxuICAgICAgbmV3VmFsID0gJC5tYXAobmV3VmFsLCBmdW5jdGlvbiAob2JqKSB7XFxyXFxuICAgICAgICByZXR1cm4gb2JqLnRvU3RyaW5nKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH1cXHJcXG5cXHJcXG4gICAgdGhpcy4kZWxlbWVudC52YWwobmV3VmFsKS50cmlnZ2VyKCdjaGFuZ2UnKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3QyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB0aGlzLiRjb250YWluZXIucmVtb3ZlKCk7XFxyXFxuXFxyXFxuICAgIGlmICh0aGlzLiRlbGVtZW50WzBdLmRldGFjaEV2ZW50KSB7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFswXS5kZXRhY2hFdmVudCgnb25wcm9wZXJ0eWNoYW5nZScsIHRoaXMuX3N5bmNBKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAodGhpcy5fb2JzZXJ2ZXIgIT0gbnVsbCkge1xcclxcbiAgICAgIHRoaXMuX29ic2VydmVyLmRpc2Nvbm5lY3QoKTtcXHJcXG4gICAgICB0aGlzLl9vYnNlcnZlciA9IG51bGw7XFxyXFxuICAgIH0gZWxzZSBpZiAodGhpcy4kZWxlbWVudFswXS5yZW1vdmVFdmVudExpc3RlbmVyKSB7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFswXVxcclxcbiAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTUF0dHJNb2RpZmllZCcsIHRoaXMuX3N5bmNBLCBmYWxzZSk7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFswXVxcclxcbiAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTU5vZGVJbnNlcnRlZCcsIHRoaXMuX3N5bmNTLCBmYWxzZSk7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFswXVxcclxcbiAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTU5vZGVSZW1vdmVkJywgdGhpcy5fc3luY1MsIGZhbHNlKTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICB0aGlzLl9zeW5jQSA9IG51bGw7XFxyXFxuICAgIHRoaXMuX3N5bmNTID0gbnVsbDtcXHJcXG5cXHJcXG4gICAgdGhpcy4kZWxlbWVudC5vZmYoJy5zZWxlY3QyJyk7XFxyXFxuICAgIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCB0aGlzLiRlbGVtZW50LmRhdGEoJ29sZC10YWJpbmRleCcpKTtcXHJcXG5cXHJcXG4gICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnc2VsZWN0Mi1oaWRkZW4tYWNjZXNzaWJsZScpO1xcclxcbiAgICB0aGlzLiRlbGVtZW50LmF0dHIoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7XFxyXFxuICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlRGF0YSgnc2VsZWN0MicpO1xcclxcblxcclxcbiAgICB0aGlzLmRhdGFBZGFwdGVyLmRlc3Ryb3koKTtcXHJcXG4gICAgdGhpcy5zZWxlY3Rpb24uZGVzdHJveSgpO1xcclxcbiAgICB0aGlzLmRyb3Bkb3duLmRlc3Ryb3koKTtcXHJcXG4gICAgdGhpcy5yZXN1bHRzLmRlc3Ryb3koKTtcXHJcXG5cXHJcXG4gICAgdGhpcy5kYXRhQWRhcHRlciA9IG51bGw7XFxyXFxuICAgIHRoaXMuc2VsZWN0aW9uID0gbnVsbDtcXHJcXG4gICAgdGhpcy5kcm9wZG93biA9IG51bGw7XFxyXFxuICAgIHRoaXMucmVzdWx0cyA9IG51bGw7XFxyXFxuICB9O1xcclxcblxcclxcbiAgU2VsZWN0Mi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xcclxcbiAgICB2YXIgJGNvbnRhaW5lciA9ICQoXFxyXFxuICAgICAgJzxzcGFuIGNsYXNzPVxcXCJzZWxlY3QyIHNlbGVjdDItY29udGFpbmVyXFxcIj4nICtcXHJcXG4gICAgICAgICc8c3BhbiBjbGFzcz1cXFwic2VsZWN0aW9uXFxcIj48L3NwYW4+JyArXFxyXFxuICAgICAgICAnPHNwYW4gY2xhc3M9XFxcImRyb3Bkb3duLXdyYXBwZXJcXFwiIGFyaWEtaGlkZGVuPVxcXCJ0cnVlXFxcIj48L3NwYW4+JyArXFxyXFxuICAgICAgJzwvc3Bhbj4nXFxyXFxuICAgICk7XFxyXFxuXFxyXFxuICAgICRjb250YWluZXIuYXR0cignZGlyJywgdGhpcy5vcHRpb25zLmdldCgnZGlyJykpO1xcclxcblxcclxcbiAgICB0aGlzLiRjb250YWluZXIgPSAkY29udGFpbmVyO1xcclxcblxcclxcbiAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3MoJ3NlbGVjdDItY29udGFpbmVyLS0nICsgdGhpcy5vcHRpb25zLmdldCgndGhlbWUnKSk7XFxyXFxuXFxyXFxuICAgICRjb250YWluZXIuZGF0YSgnZWxlbWVudCcsIHRoaXMuJGVsZW1lbnQpO1xcclxcblxcclxcbiAgICByZXR1cm4gJGNvbnRhaW5lcjtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICByZXR1cm4gU2VsZWN0MjtcXHJcXG59KTtcXHJcXG5cXG5TMi5kZWZpbmUoJ2pxdWVyeS1tb3VzZXdoZWVsJyxbXFxyXFxuICAnanF1ZXJ5J1xcclxcbl0sIGZ1bmN0aW9uICgkKSB7XFxyXFxuICAvLyBVc2VkIHRvIHNoaW0galF1ZXJ5Lm1vdXNld2hlZWwgZm9yIG5vbi1mdWxsIGJ1aWxkcy5cXHJcXG4gIHJldHVybiAkO1xcclxcbn0pO1xcclxcblxcblMyLmRlZmluZSgnanF1ZXJ5LnNlbGVjdDInLFtcXHJcXG4gICdqcXVlcnknLFxcclxcbiAgJ2pxdWVyeS1tb3VzZXdoZWVsJyxcXHJcXG5cXHJcXG4gICcuL3NlbGVjdDIvY29yZScsXFxyXFxuICAnLi9zZWxlY3QyL2RlZmF1bHRzJ1xcclxcbl0sIGZ1bmN0aW9uICgkLCBfLCBTZWxlY3QyLCBEZWZhdWx0cykge1xcclxcbiAgaWYgKCQuZm4uc2VsZWN0MiA9PSBudWxsKSB7XFxyXFxuICAgIC8vIEFsbCBtZXRob2RzIHRoYXQgc2hvdWxkIHJldHVybiB0aGUgZWxlbWVudFxcclxcbiAgICB2YXIgdGhpc01ldGhvZHMgPSBbJ29wZW4nLCAnY2xvc2UnLCAnZGVzdHJveSddO1xcclxcblxcclxcbiAgICAkLmZuLnNlbGVjdDIgPSBmdW5jdGlvbiAob3B0aW9ucykge1xcclxcbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xcclxcblxcclxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcpIHtcXHJcXG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgIHZhciBpbnN0YW5jZU9wdGlvbnMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgb3B0aW9ucyk7XFxyXFxuXFxyXFxuICAgICAgICAgIHZhciBpbnN0YW5jZSA9IG5ldyBTZWxlY3QyKCQodGhpcyksIGluc3RhbmNlT3B0aW9ucyk7XFxyXFxuICAgICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICAgIHJldHVybiB0aGlzO1xcclxcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XFxyXFxuICAgICAgICB2YXIgcmV0O1xcclxcbiAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xcclxcblxcclxcbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgICAgdmFyIGluc3RhbmNlID0gJCh0aGlzKS5kYXRhKCdzZWxlY3QyJyk7XFxyXFxuXFxyXFxuICAgICAgICAgIGlmIChpbnN0YW5jZSA9PSBudWxsICYmIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUuZXJyb3IpIHtcXHJcXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFxcclxcbiAgICAgICAgICAgICAgJ1RoZSBzZWxlY3QyKFxcXFwnJyArIG9wdGlvbnMgKyAnXFxcXCcpIG1ldGhvZCB3YXMgY2FsbGVkIG9uIGFuICcgK1xcclxcbiAgICAgICAgICAgICAgJ2VsZW1lbnQgdGhhdCBpcyBub3QgdXNpbmcgU2VsZWN0Mi4nXFxyXFxuICAgICAgICAgICAgKTtcXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICByZXQgPSBpbnN0YW5jZVtvcHRpb25zXS5hcHBseShpbnN0YW5jZSwgYXJncyk7XFxyXFxuICAgICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCBiZSByZXR1cm5pbmcgYHRoaXNgXFxyXFxuICAgICAgICBpZiAoJC5pbkFycmF5KG9wdGlvbnMsIHRoaXNNZXRob2RzKSA+IC0xKSB7XFxyXFxuICAgICAgICAgIHJldHVybiB0aGlzO1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgcmV0dXJuIHJldDtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cyBmb3IgU2VsZWN0MjogJyArIG9wdGlvbnMpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfTtcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIGlmICgkLmZuLnNlbGVjdDIuZGVmYXVsdHMgPT0gbnVsbCkge1xcclxcbiAgICAkLmZuLnNlbGVjdDIuZGVmYXVsdHMgPSBEZWZhdWx0cztcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIHJldHVybiBTZWxlY3QyO1xcclxcbn0pO1xcclxcblxcbiAgLy8gUmV0dXJuIHRoZSBBTUQgbG9hZGVyIGNvbmZpZ3VyYXRpb24gc28gaXQgY2FuIGJlIHVzZWQgb3V0c2lkZSBvZiB0aGlzIGZpbGVcXHJcXG4gIHJldHVybiB7XFxyXFxuICAgIGRlZmluZTogUzIuZGVmaW5lLFxcclxcbiAgICByZXF1aXJlOiBTMi5yZXF1aXJlXFxyXFxuICB9O1xcclxcbn0oKSk7XFxyXFxuXFxyXFxuICAvLyBBdXRvbG9hZCB0aGUgalF1ZXJ5IGJpbmRpbmdzXFxyXFxuICAvLyBXZSBrbm93IHRoYXQgYWxsIG9mIHRoZSBtb2R1bGVzIGV4aXN0IGFib3ZlIHRoaXMsIHNvIHdlJ3JlIHNhZmVcXHJcXG4gIHZhciBzZWxlY3QyID0gUzIucmVxdWlyZSgnanF1ZXJ5LnNlbGVjdDInKTtcXHJcXG5cXHJcXG4gIC8vIEhvbGQgdGhlIEFNRCBtb2R1bGUgcmVmZXJlbmNlcyBvbiB0aGUgalF1ZXJ5IGZ1bmN0aW9uIHRoYXQgd2FzIGp1c3QgbG9hZGVkXFxyXFxuICAvLyBUaGlzIGFsbG93cyBTZWxlY3QyIHRvIHVzZSB0aGUgaW50ZXJuYWwgbG9hZGVyIG91dHNpZGUgb2YgdGhpcyBmaWxlLCBzdWNoXFxyXFxuICAvLyBhcyBpbiB0aGUgbGFuZ3VhZ2UgZmlsZXMuXFxyXFxuICBqUXVlcnkuZm4uc2VsZWN0Mi5hbWQgPSBTMjtcXHJcXG5cXHJcXG4gIC8vIFJldHVybiB0aGUgU2VsZWN0MiBpbnN0YW5jZSBmb3IgYW55b25lIHdobyBpcyBpbXBvcnRpbmcgaXQuXFxyXFxuICByZXR1cm4gc2VsZWN0MjtcXHJcXG59KSk7XFxyXFxuXCJcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yYXctbG9hZGVyIS4vfi9zb3VyY2UtbWFwLWxvYWRlciEuL34vc2VsZWN0Mi9kaXN0L2pzL3NlbGVjdDIuanNcbiAqKiBtb2R1bGUgaWQgPSA4MFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwicmVxdWlyZShcIiEhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9zY3JpcHQtbG9hZGVyL2FkZFNjcmlwdC5qc1wiKShyZXF1aXJlKFwiISEvVXNlcnMvam9oYW5uZXNidXZuYXMvRGV2ZWxvcG1lbnQvUEhQL3R1dG9tdmMvbm9kZV9tb2R1bGVzL3Jhdy1sb2FkZXIvaW5kZXguanMhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9zb3VyY2UtbWFwLWxvYWRlci9pbmRleC5qcyEvVXNlcnMvam9oYW5uZXNidXZuYXMvRGV2ZWxvcG1lbnQvUEhQL3R1dG9tdmMvbm9kZV9tb2R1bGVzL2Jvb3RzdHJhcC9kaXN0L2pzL2Jvb3RzdHJhcC5qc1wiKStcIlxcblxcbi8vIFNDUklQVC1MT0FERVIgRk9PVEVSXFxuLy8jIHNvdXJjZVVSTD1zY3JpcHQ6Ly8vVXNlcnMvam9oYW5uZXNidXZuYXMvRGV2ZWxvcG1lbnQvUEhQL3R1dG9tdmMvbm9kZV9tb2R1bGVzL3NvdXJjZS1tYXAtbG9hZGVyL2luZGV4LmpzIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvYm9vdHN0cmFwL2Rpc3QvanMvYm9vdHN0cmFwLmpzXCIpXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vc2NyaXB0LWxvYWRlciEuL34vYm9vdHN0cmFwL2Rpc3QvanMvYm9vdHN0cmFwLmpzXG4gKiogbW9kdWxlIGlkID0gODFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCIvKiFcXG4gKiBCb290c3RyYXAgdjMuMy43IChodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbSlcXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcXG4gKi9cXG5cXG5pZiAodHlwZW9mIGpRdWVyeSA9PT0gJ3VuZGVmaW5lZCcpIHtcXG4gIHRocm93IG5ldyBFcnJvcignQm9vdHN0cmFwXFxcXCdzIEphdmFTY3JpcHQgcmVxdWlyZXMgalF1ZXJ5JylcXG59XFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuICB2YXIgdmVyc2lvbiA9ICQuZm4uanF1ZXJ5LnNwbGl0KCcgJylbMF0uc3BsaXQoJy4nKVxcbiAgaWYgKCh2ZXJzaW9uWzBdIDwgMiAmJiB2ZXJzaW9uWzFdIDwgOSkgfHwgKHZlcnNpb25bMF0gPT0gMSAmJiB2ZXJzaW9uWzFdID09IDkgJiYgdmVyc2lvblsyXSA8IDEpIHx8ICh2ZXJzaW9uWzBdID4gMykpIHtcXG4gICAgdGhyb3cgbmV3IEVycm9yKCdCb290c3RyYXBcXFxcJ3MgSmF2YVNjcmlwdCByZXF1aXJlcyBqUXVlcnkgdmVyc2lvbiAxLjkuMSBvciBoaWdoZXIsIGJ1dCBsb3dlciB0aGFuIHZlcnNpb24gNCcpXFxuICB9XFxufShqUXVlcnkpO1xcblxcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIEJvb3RzdHJhcDogdHJhbnNpdGlvbi5qcyB2My4zLjdcXG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyN0cmFuc2l0aW9uc1xcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBDU1MgVFJBTlNJVElPTiBTVVBQT1JUIChTaG91dG91dDogaHR0cDovL3d3dy5tb2Rlcm5penIuY29tLylcXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHtcXG4gICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYm9vdHN0cmFwJylcXG5cXG4gICAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcXG4gICAgICBXZWJraXRUcmFuc2l0aW9uIDogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxcbiAgICAgIE1velRyYW5zaXRpb24gICAgOiAndHJhbnNpdGlvbmVuZCcsXFxuICAgICAgT1RyYW5zaXRpb24gICAgICA6ICdvVHJhbnNpdGlvbkVuZCBvdHJhbnNpdGlvbmVuZCcsXFxuICAgICAgdHJhbnNpdGlvbiAgICAgICA6ICd0cmFuc2l0aW9uZW5kJ1xcbiAgICB9XFxuXFxuICAgIGZvciAodmFyIG5hbWUgaW4gdHJhbnNFbmRFdmVudE5hbWVzKSB7XFxuICAgICAgaWYgKGVsLnN0eWxlW25hbWVdICE9PSB1bmRlZmluZWQpIHtcXG4gICAgICAgIHJldHVybiB7IGVuZDogdHJhbnNFbmRFdmVudE5hbWVzW25hbWVdIH1cXG4gICAgICB9XFxuICAgIH1cXG5cXG4gICAgcmV0dXJuIGZhbHNlIC8vIGV4cGxpY2l0IGZvciBpZTggKCAgLl8uKVxcbiAgfVxcblxcbiAgLy8gaHR0cDovL2Jsb2cuYWxleG1hY2Nhdy5jb20vY3NzLXRyYW5zaXRpb25zXFxuICAkLmZuLmVtdWxhdGVUcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gKGR1cmF0aW9uKSB7XFxuICAgIHZhciBjYWxsZWQgPSBmYWxzZVxcbiAgICB2YXIgJGVsID0gdGhpc1xcbiAgICAkKHRoaXMpLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24gKCkgeyBjYWxsZWQgPSB0cnVlIH0pXFxuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsgaWYgKCFjYWxsZWQpICQoJGVsKS50cmlnZ2VyKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCkgfVxcbiAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCBkdXJhdGlvbilcXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG4gICQoZnVuY3Rpb24gKCkge1xcbiAgICAkLnN1cHBvcnQudHJhbnNpdGlvbiA9IHRyYW5zaXRpb25FbmQoKVxcblxcbiAgICBpZiAoISQuc3VwcG9ydC50cmFuc2l0aW9uKSByZXR1cm5cXG5cXG4gICAgJC5ldmVudC5zcGVjaWFsLmJzVHJhbnNpdGlvbkVuZCA9IHtcXG4gICAgICBiaW5kVHlwZTogJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLFxcbiAgICAgIGRlbGVnYXRlVHlwZTogJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLFxcbiAgICAgIGhhbmRsZTogZnVuY3Rpb24gKGUpIHtcXG4gICAgICAgIGlmICgkKGUudGFyZ2V0KS5pcyh0aGlzKSkgcmV0dXJuIGUuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKVxcbiAgICAgIH1cXG4gICAgfVxcbiAgfSlcXG5cXG59KGpRdWVyeSk7XFxuXFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuICogQm9vdHN0cmFwOiBhbGVydC5qcyB2My4zLjdcXG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNhbGVydHNcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gQUxFUlQgQ0xBU1MgREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgdmFyIGRpc21pc3MgPSAnW2RhdGEtZGlzbWlzcz1cXFwiYWxlcnRcXFwiXSdcXG4gIHZhciBBbGVydCAgID0gZnVuY3Rpb24gKGVsKSB7XFxuICAgICQoZWwpLm9uKCdjbGljaycsIGRpc21pc3MsIHRoaXMuY2xvc2UpXFxuICB9XFxuXFxuICBBbGVydC5WRVJTSU9OID0gJzMuMy43J1xcblxcbiAgQWxlcnQuVFJBTlNJVElPTl9EVVJBVElPTiA9IDE1MFxcblxcbiAgQWxlcnQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGUpIHtcXG4gICAgdmFyICR0aGlzICAgID0gJCh0aGlzKVxcbiAgICB2YXIgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdkYXRhLXRhcmdldCcpXFxuXFxuICAgIGlmICghc2VsZWN0b3IpIHtcXG4gICAgICBzZWxlY3RvciA9ICR0aGlzLmF0dHIoJ2hyZWYnKVxcbiAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgJiYgc2VsZWN0b3IucmVwbGFjZSgvLiooPz0jW15cXFxcc10qJCkvLCAnJykgLy8gc3RyaXAgZm9yIGllN1xcbiAgICB9XFxuXFxuICAgIHZhciAkcGFyZW50ID0gJChzZWxlY3RvciA9PT0gJyMnID8gW10gOiBzZWxlY3RvcilcXG5cXG4gICAgaWYgKGUpIGUucHJldmVudERlZmF1bHQoKVxcblxcbiAgICBpZiAoISRwYXJlbnQubGVuZ3RoKSB7XFxuICAgICAgJHBhcmVudCA9ICR0aGlzLmNsb3Nlc3QoJy5hbGVydCcpXFxuICAgIH1cXG5cXG4gICAgJHBhcmVudC50cmlnZ2VyKGUgPSAkLkV2ZW50KCdjbG9zZS5icy5hbGVydCcpKVxcblxcbiAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXFxuXFxuICAgICRwYXJlbnQucmVtb3ZlQ2xhc3MoJ2luJylcXG5cXG4gICAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudCgpIHtcXG4gICAgICAvLyBkZXRhY2ggZnJvbSBwYXJlbnQsIGZpcmUgZXZlbnQgdGhlbiBjbGVhbiB1cCBkYXRhXFxuICAgICAgJHBhcmVudC5kZXRhY2goKS50cmlnZ2VyKCdjbG9zZWQuYnMuYWxlcnQnKS5yZW1vdmUoKVxcbiAgICB9XFxuXFxuICAgICQuc3VwcG9ydC50cmFuc2l0aW9uICYmICRwYXJlbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/XFxuICAgICAgJHBhcmVudFxcbiAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgcmVtb3ZlRWxlbWVudClcXG4gICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChBbGVydC5UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XFxuICAgICAgcmVtb3ZlRWxlbWVudCgpXFxuICB9XFxuXFxuXFxuICAvLyBBTEVSVCBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT1cXG5cXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHtcXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICA9ICR0aGlzLmRhdGEoJ2JzLmFsZXJ0JylcXG5cXG4gICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2JzLmFsZXJ0JywgKGRhdGEgPSBuZXcgQWxlcnQodGhpcykpKVxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0uY2FsbCgkdGhpcylcXG4gICAgfSlcXG4gIH1cXG5cXG4gIHZhciBvbGQgPSAkLmZuLmFsZXJ0XFxuXFxuICAkLmZuLmFsZXJ0ICAgICAgICAgICAgID0gUGx1Z2luXFxuICAkLmZuLmFsZXJ0LkNvbnN0cnVjdG9yID0gQWxlcnRcXG5cXG5cXG4gIC8vIEFMRVJUIE5PIENPTkZMSUNUXFxuICAvLyA9PT09PT09PT09PT09PT09PVxcblxcbiAgJC5mbi5hbGVydC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLmFsZXJ0ID0gb2xkXFxuICAgIHJldHVybiB0aGlzXFxuICB9XFxuXFxuXFxuICAvLyBBTEVSVCBEQVRBLUFQSVxcbiAgLy8gPT09PT09PT09PT09PT1cXG5cXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljay5icy5hbGVydC5kYXRhLWFwaScsIGRpc21pc3MsIEFsZXJ0LnByb3RvdHlwZS5jbG9zZSlcXG5cXG59KGpRdWVyeSk7XFxuXFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuICogQm9vdHN0cmFwOiBidXR0b24uanMgdjMuMy43XFxuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jYnV0dG9uc1xcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBCVVRUT04gUFVCTElDIENMQVNTIERFRklOSVRJT05cXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgdmFyIEJ1dHRvbiA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XFxuICAgIHRoaXMuJGVsZW1lbnQgID0gJChlbGVtZW50KVxcbiAgICB0aGlzLm9wdGlvbnMgICA9ICQuZXh0ZW5kKHt9LCBCdXR0b24uREVGQVVMVFMsIG9wdGlvbnMpXFxuICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2VcXG4gIH1cXG5cXG4gIEJ1dHRvbi5WRVJTSU9OICA9ICczLjMuNydcXG5cXG4gIEJ1dHRvbi5ERUZBVUxUUyA9IHtcXG4gICAgbG9hZGluZ1RleHQ6ICdsb2FkaW5nLi4uJ1xcbiAgfVxcblxcbiAgQnV0dG9uLnByb3RvdHlwZS5zZXRTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xcbiAgICB2YXIgZCAgICA9ICdkaXNhYmxlZCdcXG4gICAgdmFyICRlbCAgPSB0aGlzLiRlbGVtZW50XFxuICAgIHZhciB2YWwgID0gJGVsLmlzKCdpbnB1dCcpID8gJ3ZhbCcgOiAnaHRtbCdcXG4gICAgdmFyIGRhdGEgPSAkZWwuZGF0YSgpXFxuXFxuICAgIHN0YXRlICs9ICdUZXh0J1xcblxcbiAgICBpZiAoZGF0YS5yZXNldFRleHQgPT0gbnVsbCkgJGVsLmRhdGEoJ3Jlc2V0VGV4dCcsICRlbFt2YWxdKCkpXFxuXFxuICAgIC8vIHB1c2ggdG8gZXZlbnQgbG9vcCB0byBhbGxvdyBmb3JtcyB0byBzdWJtaXRcXG4gICAgc2V0VGltZW91dCgkLnByb3h5KGZ1bmN0aW9uICgpIHtcXG4gICAgICAkZWxbdmFsXShkYXRhW3N0YXRlXSA9PSBudWxsID8gdGhpcy5vcHRpb25zW3N0YXRlXSA6IGRhdGFbc3RhdGVdKVxcblxcbiAgICAgIGlmIChzdGF0ZSA9PSAnbG9hZGluZ1RleHQnKSB7XFxuICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWVcXG4gICAgICAgICRlbC5hZGRDbGFzcyhkKS5hdHRyKGQsIGQpLnByb3AoZCwgdHJ1ZSlcXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXNMb2FkaW5nKSB7XFxuICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlXFxuICAgICAgICAkZWwucmVtb3ZlQ2xhc3MoZCkucmVtb3ZlQXR0cihkKS5wcm9wKGQsIGZhbHNlKVxcbiAgICAgIH1cXG4gICAgfSwgdGhpcyksIDApXFxuICB9XFxuXFxuICBCdXR0b24ucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIGNoYW5nZWQgPSB0cnVlXFxuICAgIHZhciAkcGFyZW50ID0gdGhpcy4kZWxlbWVudC5jbG9zZXN0KCdbZGF0YS10b2dnbGU9XFxcImJ1dHRvbnNcXFwiXScpXFxuXFxuICAgIGlmICgkcGFyZW50Lmxlbmd0aCkge1xcbiAgICAgIHZhciAkaW5wdXQgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ2lucHV0JylcXG4gICAgICBpZiAoJGlucHV0LnByb3AoJ3R5cGUnKSA9PSAncmFkaW8nKSB7XFxuICAgICAgICBpZiAoJGlucHV0LnByb3AoJ2NoZWNrZWQnKSkgY2hhbmdlZCA9IGZhbHNlXFxuICAgICAgICAkcGFyZW50LmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJylcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ2FjdGl2ZScpXFxuICAgICAgfSBlbHNlIGlmICgkaW5wdXQucHJvcCgndHlwZScpID09ICdjaGVja2JveCcpIHtcXG4gICAgICAgIGlmICgoJGlucHV0LnByb3AoJ2NoZWNrZWQnKSkgIT09IHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2FjdGl2ZScpKSBjaGFuZ2VkID0gZmFsc2VcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpXFxuICAgICAgfVxcbiAgICAgICRpbnB1dC5wcm9wKCdjaGVja2VkJywgdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnYWN0aXZlJykpXFxuICAgICAgaWYgKGNoYW5nZWQpICRpbnB1dC50cmlnZ2VyKCdjaGFuZ2UnKVxcbiAgICB9IGVsc2Uge1xcbiAgICAgIHRoaXMuJGVsZW1lbnQuYXR0cignYXJpYS1wcmVzc2VkJywgIXRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2FjdGl2ZScpKVxcbiAgICAgIHRoaXMuJGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpXFxuICAgIH1cXG4gIH1cXG5cXG5cXG4gIC8vIEJVVFRPTiBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XFxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuYnV0dG9uJylcXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXFxuXFxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5idXR0b24nLCAoZGF0YSA9IG5ldyBCdXR0b24odGhpcywgb3B0aW9ucykpKVxcblxcbiAgICAgIGlmIChvcHRpb24gPT0gJ3RvZ2dsZScpIGRhdGEudG9nZ2xlKClcXG4gICAgICBlbHNlIGlmIChvcHRpb24pIGRhdGEuc2V0U3RhdGUob3B0aW9uKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4uYnV0dG9uXFxuXFxuICAkLmZuLmJ1dHRvbiAgICAgICAgICAgICA9IFBsdWdpblxcbiAgJC5mbi5idXR0b24uQ29uc3RydWN0b3IgPSBCdXR0b25cXG5cXG5cXG4gIC8vIEJVVFRPTiBOTyBDT05GTElDVFxcbiAgLy8gPT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLmJ1dHRvbi5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLmJ1dHRvbiA9IG9sZFxcbiAgICByZXR1cm4gdGhpc1xcbiAgfVxcblxcblxcbiAgLy8gQlVUVE9OIERBVEEtQVBJXFxuICAvLyA9PT09PT09PT09PT09PT1cXG5cXG4gICQoZG9jdW1lbnQpXFxuICAgIC5vbignY2xpY2suYnMuYnV0dG9uLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZV49XFxcImJ1dHRvblxcXCJdJywgZnVuY3Rpb24gKGUpIHtcXG4gICAgICB2YXIgJGJ0biA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5idG4nKVxcbiAgICAgIFBsdWdpbi5jYWxsKCRidG4sICd0b2dnbGUnKVxcbiAgICAgIGlmICghKCQoZS50YXJnZXQpLmlzKCdpbnB1dFt0eXBlPVxcXCJyYWRpb1xcXCJdLCBpbnB1dFt0eXBlPVxcXCJjaGVja2JveFxcXCJdJykpKSB7XFxuICAgICAgICAvLyBQcmV2ZW50IGRvdWJsZSBjbGljayBvbiByYWRpb3MsIGFuZCB0aGUgZG91YmxlIHNlbGVjdGlvbnMgKHNvIGNhbmNlbGxhdGlvbikgb24gY2hlY2tib3hlc1xcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXFxuICAgICAgICAvLyBUaGUgdGFyZ2V0IGNvbXBvbmVudCBzdGlsbCByZWNlaXZlIHRoZSBmb2N1c1xcbiAgICAgICAgaWYgKCRidG4uaXMoJ2lucHV0LGJ1dHRvbicpKSAkYnRuLnRyaWdnZXIoJ2ZvY3VzJylcXG4gICAgICAgIGVsc2UgJGJ0bi5maW5kKCdpbnB1dDp2aXNpYmxlLGJ1dHRvbjp2aXNpYmxlJykuZmlyc3QoKS50cmlnZ2VyKCdmb2N1cycpXFxuICAgICAgfVxcbiAgICB9KVxcbiAgICAub24oJ2ZvY3VzLmJzLmJ1dHRvbi5kYXRhLWFwaSBibHVyLmJzLmJ1dHRvbi5kYXRhLWFwaScsICdbZGF0YS10b2dnbGVePVxcXCJidXR0b25cXFwiXScsIGZ1bmN0aW9uIChlKSB7XFxuICAgICAgJChlLnRhcmdldCkuY2xvc2VzdCgnLmJ0bicpLnRvZ2dsZUNsYXNzKCdmb2N1cycsIC9eZm9jdXMoaW4pPyQvLnRlc3QoZS50eXBlKSlcXG4gICAgfSlcXG5cXG59KGpRdWVyeSk7XFxuXFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuICogQm9vdHN0cmFwOiBjYXJvdXNlbC5qcyB2My4zLjdcXG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNjYXJvdXNlbFxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBDQVJPVVNFTCBDTEFTUyBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgQ2Fyb3VzZWwgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xcbiAgICB0aGlzLiRlbGVtZW50ICAgID0gJChlbGVtZW50KVxcbiAgICB0aGlzLiRpbmRpY2F0b3JzID0gdGhpcy4kZWxlbWVudC5maW5kKCcuY2Fyb3VzZWwtaW5kaWNhdG9ycycpXFxuICAgIHRoaXMub3B0aW9ucyAgICAgPSBvcHRpb25zXFxuICAgIHRoaXMucGF1c2VkICAgICAgPSBudWxsXFxuICAgIHRoaXMuc2xpZGluZyAgICAgPSBudWxsXFxuICAgIHRoaXMuaW50ZXJ2YWwgICAgPSBudWxsXFxuICAgIHRoaXMuJGFjdGl2ZSAgICAgPSBudWxsXFxuICAgIHRoaXMuJGl0ZW1zICAgICAgPSBudWxsXFxuXFxuICAgIHRoaXMub3B0aW9ucy5rZXlib2FyZCAmJiB0aGlzLiRlbGVtZW50Lm9uKCdrZXlkb3duLmJzLmNhcm91c2VsJywgJC5wcm94eSh0aGlzLmtleWRvd24sIHRoaXMpKVxcblxcbiAgICB0aGlzLm9wdGlvbnMucGF1c2UgPT0gJ2hvdmVyJyAmJiAhKCdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkgJiYgdGhpcy4kZWxlbWVudFxcbiAgICAgIC5vbignbW91c2VlbnRlci5icy5jYXJvdXNlbCcsICQucHJveHkodGhpcy5wYXVzZSwgdGhpcykpXFxuICAgICAgLm9uKCdtb3VzZWxlYXZlLmJzLmNhcm91c2VsJywgJC5wcm94eSh0aGlzLmN5Y2xlLCB0aGlzKSlcXG4gIH1cXG5cXG4gIENhcm91c2VsLlZFUlNJT04gID0gJzMuMy43J1xcblxcbiAgQ2Fyb3VzZWwuVFJBTlNJVElPTl9EVVJBVElPTiA9IDYwMFxcblxcbiAgQ2Fyb3VzZWwuREVGQVVMVFMgPSB7XFxuICAgIGludGVydmFsOiA1MDAwLFxcbiAgICBwYXVzZTogJ2hvdmVyJyxcXG4gICAgd3JhcDogdHJ1ZSxcXG4gICAga2V5Ym9hcmQ6IHRydWVcXG4gIH1cXG5cXG4gIENhcm91c2VsLnByb3RvdHlwZS5rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcXG4gICAgaWYgKC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QoZS50YXJnZXQudGFnTmFtZSkpIHJldHVyblxcbiAgICBzd2l0Y2ggKGUud2hpY2gpIHtcXG4gICAgICBjYXNlIDM3OiB0aGlzLnByZXYoKTsgYnJlYWtcXG4gICAgICBjYXNlIDM5OiB0aGlzLm5leHQoKTsgYnJlYWtcXG4gICAgICBkZWZhdWx0OiByZXR1cm5cXG4gICAgfVxcblxcbiAgICBlLnByZXZlbnREZWZhdWx0KClcXG4gIH1cXG5cXG4gIENhcm91c2VsLnByb3RvdHlwZS5jeWNsZSA9IGZ1bmN0aW9uIChlKSB7XFxuICAgIGUgfHwgKHRoaXMucGF1c2VkID0gZmFsc2UpXFxuXFxuICAgIHRoaXMuaW50ZXJ2YWwgJiYgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKVxcblxcbiAgICB0aGlzLm9wdGlvbnMuaW50ZXJ2YWxcXG4gICAgICAmJiAhdGhpcy5wYXVzZWRcXG4gICAgICAmJiAodGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCQucHJveHkodGhpcy5uZXh0LCB0aGlzKSwgdGhpcy5vcHRpb25zLmludGVydmFsKSlcXG5cXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG4gIENhcm91c2VsLnByb3RvdHlwZS5nZXRJdGVtSW5kZXggPSBmdW5jdGlvbiAoaXRlbSkge1xcbiAgICB0aGlzLiRpdGVtcyA9IGl0ZW0ucGFyZW50KCkuY2hpbGRyZW4oJy5pdGVtJylcXG4gICAgcmV0dXJuIHRoaXMuJGl0ZW1zLmluZGV4KGl0ZW0gfHwgdGhpcy4kYWN0aXZlKVxcbiAgfVxcblxcbiAgQ2Fyb3VzZWwucHJvdG90eXBlLmdldEl0ZW1Gb3JEaXJlY3Rpb24gPSBmdW5jdGlvbiAoZGlyZWN0aW9uLCBhY3RpdmUpIHtcXG4gICAgdmFyIGFjdGl2ZUluZGV4ID0gdGhpcy5nZXRJdGVtSW5kZXgoYWN0aXZlKVxcbiAgICB2YXIgd2lsbFdyYXAgPSAoZGlyZWN0aW9uID09ICdwcmV2JyAmJiBhY3RpdmVJbmRleCA9PT0gMClcXG4gICAgICAgICAgICAgICAgfHwgKGRpcmVjdGlvbiA9PSAnbmV4dCcgJiYgYWN0aXZlSW5kZXggPT0gKHRoaXMuJGl0ZW1zLmxlbmd0aCAtIDEpKVxcbiAgICBpZiAod2lsbFdyYXAgJiYgIXRoaXMub3B0aW9ucy53cmFwKSByZXR1cm4gYWN0aXZlXFxuICAgIHZhciBkZWx0YSA9IGRpcmVjdGlvbiA9PSAncHJldicgPyAtMSA6IDFcXG4gICAgdmFyIGl0ZW1JbmRleCA9IChhY3RpdmVJbmRleCArIGRlbHRhKSAlIHRoaXMuJGl0ZW1zLmxlbmd0aFxcbiAgICByZXR1cm4gdGhpcy4kaXRlbXMuZXEoaXRlbUluZGV4KVxcbiAgfVxcblxcbiAgQ2Fyb3VzZWwucHJvdG90eXBlLnRvID0gZnVuY3Rpb24gKHBvcykge1xcbiAgICB2YXIgdGhhdCAgICAgICAgPSB0aGlzXFxuICAgIHZhciBhY3RpdmVJbmRleCA9IHRoaXMuZ2V0SXRlbUluZGV4KHRoaXMuJGFjdGl2ZSA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLml0ZW0uYWN0aXZlJykpXFxuXFxuICAgIGlmIChwb3MgPiAodGhpcy4kaXRlbXMubGVuZ3RoIC0gMSkgfHwgcG9zIDwgMCkgcmV0dXJuXFxuXFxuICAgIGlmICh0aGlzLnNsaWRpbmcpICAgICAgIHJldHVybiB0aGlzLiRlbGVtZW50Lm9uZSgnc2xpZC5icy5jYXJvdXNlbCcsIGZ1bmN0aW9uICgpIHsgdGhhdC50byhwb3MpIH0pIC8vIHllcywgXFxcInNsaWRcXFwiXFxuICAgIGlmIChhY3RpdmVJbmRleCA9PSBwb3MpIHJldHVybiB0aGlzLnBhdXNlKCkuY3ljbGUoKVxcblxcbiAgICByZXR1cm4gdGhpcy5zbGlkZShwb3MgPiBhY3RpdmVJbmRleCA/ICduZXh0JyA6ICdwcmV2JywgdGhpcy4kaXRlbXMuZXEocG9zKSlcXG4gIH1cXG5cXG4gIENhcm91c2VsLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIChlKSB7XFxuICAgIGUgfHwgKHRoaXMucGF1c2VkID0gdHJ1ZSlcXG5cXG4gICAgaWYgKHRoaXMuJGVsZW1lbnQuZmluZCgnLm5leHQsIC5wcmV2JykubGVuZ3RoICYmICQuc3VwcG9ydC50cmFuc2l0aW9uKSB7XFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZClcXG4gICAgICB0aGlzLmN5Y2xlKHRydWUpXFxuICAgIH1cXG5cXG4gICAgdGhpcy5pbnRlcnZhbCA9IGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbClcXG5cXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG4gIENhcm91c2VsLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xcbiAgICBpZiAodGhpcy5zbGlkaW5nKSByZXR1cm5cXG4gICAgcmV0dXJuIHRoaXMuc2xpZGUoJ25leHQnKVxcbiAgfVxcblxcbiAgQ2Fyb3VzZWwucHJvdG90eXBlLnByZXYgPSBmdW5jdGlvbiAoKSB7XFxuICAgIGlmICh0aGlzLnNsaWRpbmcpIHJldHVyblxcbiAgICByZXR1cm4gdGhpcy5zbGlkZSgncHJldicpXFxuICB9XFxuXFxuICBDYXJvdXNlbC5wcm90b3R5cGUuc2xpZGUgPSBmdW5jdGlvbiAodHlwZSwgbmV4dCkge1xcbiAgICB2YXIgJGFjdGl2ZSAgID0gdGhpcy4kZWxlbWVudC5maW5kKCcuaXRlbS5hY3RpdmUnKVxcbiAgICB2YXIgJG5leHQgICAgID0gbmV4dCB8fCB0aGlzLmdldEl0ZW1Gb3JEaXJlY3Rpb24odHlwZSwgJGFjdGl2ZSlcXG4gICAgdmFyIGlzQ3ljbGluZyA9IHRoaXMuaW50ZXJ2YWxcXG4gICAgdmFyIGRpcmVjdGlvbiA9IHR5cGUgPT0gJ25leHQnID8gJ2xlZnQnIDogJ3JpZ2h0J1xcbiAgICB2YXIgdGhhdCAgICAgID0gdGhpc1xcblxcbiAgICBpZiAoJG5leHQuaGFzQ2xhc3MoJ2FjdGl2ZScpKSByZXR1cm4gKHRoaXMuc2xpZGluZyA9IGZhbHNlKVxcblxcbiAgICB2YXIgcmVsYXRlZFRhcmdldCA9ICRuZXh0WzBdXFxuICAgIHZhciBzbGlkZUV2ZW50ID0gJC5FdmVudCgnc2xpZGUuYnMuY2Fyb3VzZWwnLCB7XFxuICAgICAgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldCxcXG4gICAgICBkaXJlY3Rpb246IGRpcmVjdGlvblxcbiAgICB9KVxcbiAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoc2xpZGVFdmVudClcXG4gICAgaWYgKHNsaWRlRXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVyblxcblxcbiAgICB0aGlzLnNsaWRpbmcgPSB0cnVlXFxuXFxuICAgIGlzQ3ljbGluZyAmJiB0aGlzLnBhdXNlKClcXG5cXG4gICAgaWYgKHRoaXMuJGluZGljYXRvcnMubGVuZ3RoKSB7XFxuICAgICAgdGhpcy4kaW5kaWNhdG9ycy5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXFxuICAgICAgdmFyICRuZXh0SW5kaWNhdG9yID0gJCh0aGlzLiRpbmRpY2F0b3JzLmNoaWxkcmVuKClbdGhpcy5nZXRJdGVtSW5kZXgoJG5leHQpXSlcXG4gICAgICAkbmV4dEluZGljYXRvciAmJiAkbmV4dEluZGljYXRvci5hZGRDbGFzcygnYWN0aXZlJylcXG4gICAgfVxcblxcbiAgICB2YXIgc2xpZEV2ZW50ID0gJC5FdmVudCgnc2xpZC5icy5jYXJvdXNlbCcsIHsgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldCwgZGlyZWN0aW9uOiBkaXJlY3Rpb24gfSkgLy8geWVzLCBcXFwic2xpZFxcXCJcXG4gICAgaWYgKCQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ3NsaWRlJykpIHtcXG4gICAgICAkbmV4dC5hZGRDbGFzcyh0eXBlKVxcbiAgICAgICRuZXh0WzBdLm9mZnNldFdpZHRoIC8vIGZvcmNlIHJlZmxvd1xcbiAgICAgICRhY3RpdmUuYWRkQ2xhc3MoZGlyZWN0aW9uKVxcbiAgICAgICRuZXh0LmFkZENsYXNzKGRpcmVjdGlvbilcXG4gICAgICAkYWN0aXZlXFxuICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBmdW5jdGlvbiAoKSB7XFxuICAgICAgICAgICRuZXh0LnJlbW92ZUNsYXNzKFt0eXBlLCBkaXJlY3Rpb25dLmpvaW4oJyAnKSkuYWRkQ2xhc3MoJ2FjdGl2ZScpXFxuICAgICAgICAgICRhY3RpdmUucmVtb3ZlQ2xhc3MoWydhY3RpdmUnLCBkaXJlY3Rpb25dLmpvaW4oJyAnKSlcXG4gICAgICAgICAgdGhhdC5zbGlkaW5nID0gZmFsc2VcXG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XFxuICAgICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKHNsaWRFdmVudClcXG4gICAgICAgICAgfSwgMClcXG4gICAgICAgIH0pXFxuICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoQ2Fyb3VzZWwuVFJBTlNJVElPTl9EVVJBVElPTilcXG4gICAgfSBlbHNlIHtcXG4gICAgICAkYWN0aXZlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxcbiAgICAgICRuZXh0LmFkZENsYXNzKCdhY3RpdmUnKVxcbiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlXFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKHNsaWRFdmVudClcXG4gICAgfVxcblxcbiAgICBpc0N5Y2xpbmcgJiYgdGhpcy5jeWNsZSgpXFxuXFxuICAgIHJldHVybiB0aGlzXFxuICB9XFxuXFxuXFxuICAvLyBDQVJPVVNFTCBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT1cXG5cXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHtcXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyICR0aGlzICAgPSAkKHRoaXMpXFxuICAgICAgdmFyIGRhdGEgICAgPSAkdGhpcy5kYXRhKCdicy5jYXJvdXNlbCcpXFxuICAgICAgdmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgQ2Fyb3VzZWwuREVGQVVMVFMsICR0aGlzLmRhdGEoKSwgdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb24pXFxuICAgICAgdmFyIGFjdGlvbiAgPSB0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnID8gb3B0aW9uIDogb3B0aW9ucy5zbGlkZVxcblxcbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMuY2Fyb3VzZWwnLCAoZGF0YSA9IG5ldyBDYXJvdXNlbCh0aGlzLCBvcHRpb25zKSkpXFxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ251bWJlcicpIGRhdGEudG8ob3B0aW9uKVxcbiAgICAgIGVsc2UgaWYgKGFjdGlvbikgZGF0YVthY3Rpb25dKClcXG4gICAgICBlbHNlIGlmIChvcHRpb25zLmludGVydmFsKSBkYXRhLnBhdXNlKCkuY3ljbGUoKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4uY2Fyb3VzZWxcXG5cXG4gICQuZm4uY2Fyb3VzZWwgICAgICAgICAgICAgPSBQbHVnaW5cXG4gICQuZm4uY2Fyb3VzZWwuQ29uc3RydWN0b3IgPSBDYXJvdXNlbFxcblxcblxcbiAgLy8gQ0FST1VTRUwgTk8gQ09ORkxJQ1RcXG4gIC8vID09PT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLmNhcm91c2VsLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XFxuICAgICQuZm4uY2Fyb3VzZWwgPSBvbGRcXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG5cXG4gIC8vIENBUk9VU0VMIERBVEEtQVBJXFxuICAvLyA9PT09PT09PT09PT09PT09PVxcblxcbiAgdmFyIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XFxuICAgIHZhciBocmVmXFxuICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICB2YXIgJHRhcmdldCA9ICQoJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKSB8fCAoaHJlZiA9ICR0aGlzLmF0dHIoJ2hyZWYnKSkgJiYgaHJlZi5yZXBsYWNlKC8uKig/PSNbXlxcXFxzXSskKS8sICcnKSkgLy8gc3RyaXAgZm9yIGllN1xcbiAgICBpZiAoISR0YXJnZXQuaGFzQ2xhc3MoJ2Nhcm91c2VsJykpIHJldHVyblxcbiAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCAkdGFyZ2V0LmRhdGEoKSwgJHRoaXMuZGF0YSgpKVxcbiAgICB2YXIgc2xpZGVJbmRleCA9ICR0aGlzLmF0dHIoJ2RhdGEtc2xpZGUtdG8nKVxcbiAgICBpZiAoc2xpZGVJbmRleCkgb3B0aW9ucy5pbnRlcnZhbCA9IGZhbHNlXFxuXFxuICAgIFBsdWdpbi5jYWxsKCR0YXJnZXQsIG9wdGlvbnMpXFxuXFxuICAgIGlmIChzbGlkZUluZGV4KSB7XFxuICAgICAgJHRhcmdldC5kYXRhKCdicy5jYXJvdXNlbCcpLnRvKHNsaWRlSW5kZXgpXFxuICAgIH1cXG5cXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXFxuICB9XFxuXFxuICAkKGRvY3VtZW50KVxcbiAgICAub24oJ2NsaWNrLmJzLmNhcm91c2VsLmRhdGEtYXBpJywgJ1tkYXRhLXNsaWRlXScsIGNsaWNrSGFuZGxlcilcXG4gICAgLm9uKCdjbGljay5icy5jYXJvdXNlbC5kYXRhLWFwaScsICdbZGF0YS1zbGlkZS10b10nLCBjbGlja0hhbmRsZXIpXFxuXFxuICAkKHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XFxuICAgICQoJ1tkYXRhLXJpZGU9XFxcImNhcm91c2VsXFxcIl0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICB2YXIgJGNhcm91c2VsID0gJCh0aGlzKVxcbiAgICAgIFBsdWdpbi5jYWxsKCRjYXJvdXNlbCwgJGNhcm91c2VsLmRhdGEoKSlcXG4gICAgfSlcXG4gIH0pXFxuXFxufShqUXVlcnkpO1xcblxcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIEJvb3RzdHJhcDogY29sbGFwc2UuanMgdjMuMy43XFxuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jY29sbGFwc2VcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcbi8qIGpzaGludCBsYXRlZGVmOiBmYWxzZSAqL1xcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gQ09MTEFQU0UgUFVCTElDIENMQVNTIERFRklOSVRJT05cXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgQ29sbGFwc2UgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xcbiAgICB0aGlzLiRlbGVtZW50ICAgICAgPSAkKGVsZW1lbnQpXFxuICAgIHRoaXMub3B0aW9ucyAgICAgICA9ICQuZXh0ZW5kKHt9LCBDb2xsYXBzZS5ERUZBVUxUUywgb3B0aW9ucylcXG4gICAgdGhpcy4kdHJpZ2dlciAgICAgID0gJCgnW2RhdGEtdG9nZ2xlPVxcXCJjb2xsYXBzZVxcXCJdW2hyZWY9XFxcIiMnICsgZWxlbWVudC5pZCArICdcXFwiXSwnICtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAnW2RhdGEtdG9nZ2xlPVxcXCJjb2xsYXBzZVxcXCJdW2RhdGEtdGFyZ2V0PVxcXCIjJyArIGVsZW1lbnQuaWQgKyAnXFxcIl0nKVxcbiAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSBudWxsXFxuXFxuICAgIGlmICh0aGlzLm9wdGlvbnMucGFyZW50KSB7XFxuICAgICAgdGhpcy4kcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKVxcbiAgICB9IGVsc2Uge1xcbiAgICAgIHRoaXMuYWRkQXJpYUFuZENvbGxhcHNlZENsYXNzKHRoaXMuJGVsZW1lbnQsIHRoaXMuJHRyaWdnZXIpXFxuICAgIH1cXG5cXG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2dnbGUpIHRoaXMudG9nZ2xlKClcXG4gIH1cXG5cXG4gIENvbGxhcHNlLlZFUlNJT04gID0gJzMuMy43J1xcblxcbiAgQ29sbGFwc2UuVFJBTlNJVElPTl9EVVJBVElPTiA9IDM1MFxcblxcbiAgQ29sbGFwc2UuREVGQVVMVFMgPSB7XFxuICAgIHRvZ2dsZTogdHJ1ZVxcbiAgfVxcblxcbiAgQ29sbGFwc2UucHJvdG90eXBlLmRpbWVuc2lvbiA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIGhhc1dpZHRoID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnd2lkdGgnKVxcbiAgICByZXR1cm4gaGFzV2lkdGggPyAnd2lkdGgnIDogJ2hlaWdodCdcXG4gIH1cXG5cXG4gIENvbGxhcHNlLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xcbiAgICBpZiAodGhpcy50cmFuc2l0aW9uaW5nIHx8IHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2luJykpIHJldHVyblxcblxcbiAgICB2YXIgYWN0aXZlc0RhdGFcXG4gICAgdmFyIGFjdGl2ZXMgPSB0aGlzLiRwYXJlbnQgJiYgdGhpcy4kcGFyZW50LmNoaWxkcmVuKCcucGFuZWwnKS5jaGlsZHJlbignLmluLCAuY29sbGFwc2luZycpXFxuXFxuICAgIGlmIChhY3RpdmVzICYmIGFjdGl2ZXMubGVuZ3RoKSB7XFxuICAgICAgYWN0aXZlc0RhdGEgPSBhY3RpdmVzLmRhdGEoJ2JzLmNvbGxhcHNlJylcXG4gICAgICBpZiAoYWN0aXZlc0RhdGEgJiYgYWN0aXZlc0RhdGEudHJhbnNpdGlvbmluZykgcmV0dXJuXFxuICAgIH1cXG5cXG4gICAgdmFyIHN0YXJ0RXZlbnQgPSAkLkV2ZW50KCdzaG93LmJzLmNvbGxhcHNlJylcXG4gICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKHN0YXJ0RXZlbnQpXFxuICAgIGlmIChzdGFydEV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cXG5cXG4gICAgaWYgKGFjdGl2ZXMgJiYgYWN0aXZlcy5sZW5ndGgpIHtcXG4gICAgICBQbHVnaW4uY2FsbChhY3RpdmVzLCAnaGlkZScpXFxuICAgICAgYWN0aXZlc0RhdGEgfHwgYWN0aXZlcy5kYXRhKCdicy5jb2xsYXBzZScsIG51bGwpXFxuICAgIH1cXG5cXG4gICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZGltZW5zaW9uKClcXG5cXG4gICAgdGhpcy4kZWxlbWVudFxcbiAgICAgIC5yZW1vdmVDbGFzcygnY29sbGFwc2UnKVxcbiAgICAgIC5hZGRDbGFzcygnY29sbGFwc2luZycpW2RpbWVuc2lvbl0oMClcXG4gICAgICAuYXR0cignYXJpYS1leHBhbmRlZCcsIHRydWUpXFxuXFxuICAgIHRoaXMuJHRyaWdnZXJcXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpXFxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCB0cnVlKVxcblxcbiAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSAxXFxuXFxuICAgIHZhciBjb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgICB0aGlzLiRlbGVtZW50XFxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNpbmcnKVxcbiAgICAgICAgLmFkZENsYXNzKCdjb2xsYXBzZSBpbicpW2RpbWVuc2lvbl0oJycpXFxuICAgICAgdGhpcy50cmFuc2l0aW9uaW5nID0gMFxcbiAgICAgIHRoaXMuJGVsZW1lbnRcXG4gICAgICAgIC50cmlnZ2VyKCdzaG93bi5icy5jb2xsYXBzZScpXFxuICAgIH1cXG5cXG4gICAgaWYgKCEkLnN1cHBvcnQudHJhbnNpdGlvbikgcmV0dXJuIGNvbXBsZXRlLmNhbGwodGhpcylcXG5cXG4gICAgdmFyIHNjcm9sbFNpemUgPSAkLmNhbWVsQ2FzZShbJ3Njcm9sbCcsIGRpbWVuc2lvbl0uam9pbignLScpKVxcblxcbiAgICB0aGlzLiRlbGVtZW50XFxuICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgJC5wcm94eShjb21wbGV0ZSwgdGhpcykpXFxuICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKENvbGxhcHNlLlRSQU5TSVRJT05fRFVSQVRJT04pW2RpbWVuc2lvbl0odGhpcy4kZWxlbWVudFswXVtzY3JvbGxTaXplXSlcXG4gIH1cXG5cXG4gIENvbGxhcHNlLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gKCkge1xcbiAgICBpZiAodGhpcy50cmFuc2l0aW9uaW5nIHx8ICF0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdpbicpKSByZXR1cm5cXG5cXG4gICAgdmFyIHN0YXJ0RXZlbnQgPSAkLkV2ZW50KCdoaWRlLmJzLmNvbGxhcHNlJylcXG4gICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKHN0YXJ0RXZlbnQpXFxuICAgIGlmIChzdGFydEV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cXG5cXG4gICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZGltZW5zaW9uKClcXG5cXG4gICAgdGhpcy4kZWxlbWVudFtkaW1lbnNpb25dKHRoaXMuJGVsZW1lbnRbZGltZW5zaW9uXSgpKVswXS5vZmZzZXRIZWlnaHRcXG5cXG4gICAgdGhpcy4kZWxlbWVudFxcbiAgICAgIC5hZGRDbGFzcygnY29sbGFwc2luZycpXFxuICAgICAgLnJlbW92ZUNsYXNzKCdjb2xsYXBzZSBpbicpXFxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSlcXG5cXG4gICAgdGhpcy4kdHJpZ2dlclxcbiAgICAgIC5hZGRDbGFzcygnY29sbGFwc2VkJylcXG4gICAgICAuYXR0cignYXJpYS1leHBhbmRlZCcsIGZhbHNlKVxcblxcbiAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSAxXFxuXFxuICAgIHZhciBjb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSAwXFxuICAgICAgdGhpcy4kZWxlbWVudFxcbiAgICAgICAgLnJlbW92ZUNsYXNzKCdjb2xsYXBzaW5nJylcXG4gICAgICAgIC5hZGRDbGFzcygnY29sbGFwc2UnKVxcbiAgICAgICAgLnRyaWdnZXIoJ2hpZGRlbi5icy5jb2xsYXBzZScpXFxuICAgIH1cXG5cXG4gICAgaWYgKCEkLnN1cHBvcnQudHJhbnNpdGlvbikgcmV0dXJuIGNvbXBsZXRlLmNhbGwodGhpcylcXG5cXG4gICAgdGhpcy4kZWxlbWVudFxcbiAgICAgIFtkaW1lbnNpb25dKDApXFxuICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgJC5wcm94eShjb21wbGV0ZSwgdGhpcykpXFxuICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKENvbGxhcHNlLlRSQU5TSVRJT05fRFVSQVRJT04pXFxuICB9XFxuXFxuICBDb2xsYXBzZS5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKCkge1xcbiAgICB0aGlzW3RoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2luJykgPyAnaGlkZScgOiAnc2hvdyddKClcXG4gIH1cXG5cXG4gIENvbGxhcHNlLnByb3RvdHlwZS5nZXRQYXJlbnQgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHJldHVybiAkKHRoaXMub3B0aW9ucy5wYXJlbnQpXFxuICAgICAgLmZpbmQoJ1tkYXRhLXRvZ2dsZT1cXFwiY29sbGFwc2VcXFwiXVtkYXRhLXBhcmVudD1cXFwiJyArIHRoaXMub3B0aW9ucy5wYXJlbnQgKyAnXFxcIl0nKVxcbiAgICAgIC5lYWNoKCQucHJveHkoZnVuY3Rpb24gKGksIGVsZW1lbnQpIHtcXG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudClcXG4gICAgICAgIHRoaXMuYWRkQXJpYUFuZENvbGxhcHNlZENsYXNzKGdldFRhcmdldEZyb21UcmlnZ2VyKCRlbGVtZW50KSwgJGVsZW1lbnQpXFxuICAgICAgfSwgdGhpcykpXFxuICAgICAgLmVuZCgpXFxuICB9XFxuXFxuICBDb2xsYXBzZS5wcm90b3R5cGUuYWRkQXJpYUFuZENvbGxhcHNlZENsYXNzID0gZnVuY3Rpb24gKCRlbGVtZW50LCAkdHJpZ2dlcikge1xcbiAgICB2YXIgaXNPcGVuID0gJGVsZW1lbnQuaGFzQ2xhc3MoJ2luJylcXG5cXG4gICAgJGVsZW1lbnQuYXR0cignYXJpYS1leHBhbmRlZCcsIGlzT3BlbilcXG4gICAgJHRyaWdnZXJcXG4gICAgICAudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcsICFpc09wZW4pXFxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBpc09wZW4pXFxuICB9XFxuXFxuICBmdW5jdGlvbiBnZXRUYXJnZXRGcm9tVHJpZ2dlcigkdHJpZ2dlcikge1xcbiAgICB2YXIgaHJlZlxcbiAgICB2YXIgdGFyZ2V0ID0gJHRyaWdnZXIuYXR0cignZGF0YS10YXJnZXQnKVxcbiAgICAgIHx8IChocmVmID0gJHRyaWdnZXIuYXR0cignaHJlZicpKSAmJiBocmVmLnJlcGxhY2UoLy4qKD89I1teXFxcXHNdKyQpLywgJycpIC8vIHN0cmlwIGZvciBpZTdcXG5cXG4gICAgcmV0dXJuICQodGFyZ2V0KVxcbiAgfVxcblxcblxcbiAgLy8gQ09MTEFQU0UgUExVR0lOIERFRklOSVRJT05cXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XFxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuY29sbGFwc2UnKVxcbiAgICAgIHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sIENvbGxhcHNlLkRFRkFVTFRTLCAkdGhpcy5kYXRhKCksIHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uKVxcblxcbiAgICAgIGlmICghZGF0YSAmJiBvcHRpb25zLnRvZ2dsZSAmJiAvc2hvd3xoaWRlLy50ZXN0KG9wdGlvbikpIG9wdGlvbnMudG9nZ2xlID0gZmFsc2VcXG4gICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2JzLmNvbGxhcHNlJywgKGRhdGEgPSBuZXcgQ29sbGFwc2UodGhpcywgb3B0aW9ucykpKVxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4uY29sbGFwc2VcXG5cXG4gICQuZm4uY29sbGFwc2UgICAgICAgICAgICAgPSBQbHVnaW5cXG4gICQuZm4uY29sbGFwc2UuQ29uc3RydWN0b3IgPSBDb2xsYXBzZVxcblxcblxcbiAgLy8gQ09MTEFQU0UgTk8gQ09ORkxJQ1RcXG4gIC8vID09PT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLmNvbGxhcHNlLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XFxuICAgICQuZm4uY29sbGFwc2UgPSBvbGRcXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG5cXG4gIC8vIENPTExBUFNFIERBVEEtQVBJXFxuICAvLyA9PT09PT09PT09PT09PT09PVxcblxcbiAgJChkb2N1bWVudCkub24oJ2NsaWNrLmJzLmNvbGxhcHNlLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT1cXFwiY29sbGFwc2VcXFwiXScsIGZ1bmN0aW9uIChlKSB7XFxuICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcblxcbiAgICBpZiAoISR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JykpIGUucHJldmVudERlZmF1bHQoKVxcblxcbiAgICB2YXIgJHRhcmdldCA9IGdldFRhcmdldEZyb21UcmlnZ2VyKCR0aGlzKVxcbiAgICB2YXIgZGF0YSAgICA9ICR0YXJnZXQuZGF0YSgnYnMuY29sbGFwc2UnKVxcbiAgICB2YXIgb3B0aW9uICA9IGRhdGEgPyAndG9nZ2xlJyA6ICR0aGlzLmRhdGEoKVxcblxcbiAgICBQbHVnaW4uY2FsbCgkdGFyZ2V0LCBvcHRpb24pXFxuICB9KVxcblxcbn0oalF1ZXJ5KTtcXG5cXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBCb290c3RyYXA6IGRyb3Bkb3duLmpzIHYzLjMuN1xcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI2Ryb3Bkb3duc1xcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBEUk9QRE9XTiBDTEFTUyBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgYmFja2Ryb3AgPSAnLmRyb3Bkb3duLWJhY2tkcm9wJ1xcbiAgdmFyIHRvZ2dsZSAgID0gJ1tkYXRhLXRvZ2dsZT1cXFwiZHJvcGRvd25cXFwiXSdcXG4gIHZhciBEcm9wZG93biA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XFxuICAgICQoZWxlbWVudCkub24oJ2NsaWNrLmJzLmRyb3Bkb3duJywgdGhpcy50b2dnbGUpXFxuICB9XFxuXFxuICBEcm9wZG93bi5WRVJTSU9OID0gJzMuMy43J1xcblxcbiAgZnVuY3Rpb24gZ2V0UGFyZW50KCR0aGlzKSB7XFxuICAgIHZhciBzZWxlY3RvciA9ICR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JylcXG5cXG4gICAgaWYgKCFzZWxlY3Rvcikge1xcbiAgICAgIHNlbGVjdG9yID0gJHRoaXMuYXR0cignaHJlZicpXFxuICAgICAgc2VsZWN0b3IgPSBzZWxlY3RvciAmJiAvI1tBLVphLXpdLy50ZXN0KHNlbGVjdG9yKSAmJiBzZWxlY3Rvci5yZXBsYWNlKC8uKig/PSNbXlxcXFxzXSokKS8sICcnKSAvLyBzdHJpcCBmb3IgaWU3XFxuICAgIH1cXG5cXG4gICAgdmFyICRwYXJlbnQgPSBzZWxlY3RvciAmJiAkKHNlbGVjdG9yKVxcblxcbiAgICByZXR1cm4gJHBhcmVudCAmJiAkcGFyZW50Lmxlbmd0aCA/ICRwYXJlbnQgOiAkdGhpcy5wYXJlbnQoKVxcbiAgfVxcblxcbiAgZnVuY3Rpb24gY2xlYXJNZW51cyhlKSB7XFxuICAgIGlmIChlICYmIGUud2hpY2ggPT09IDMpIHJldHVyblxcbiAgICAkKGJhY2tkcm9wKS5yZW1vdmUoKVxcbiAgICAkKHRvZ2dsZSkuZWFjaChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyICR0aGlzICAgICAgICAgPSAkKHRoaXMpXFxuICAgICAgdmFyICRwYXJlbnQgICAgICAgPSBnZXRQYXJlbnQoJHRoaXMpXFxuICAgICAgdmFyIHJlbGF0ZWRUYXJnZXQgPSB7IHJlbGF0ZWRUYXJnZXQ6IHRoaXMgfVxcblxcbiAgICAgIGlmICghJHBhcmVudC5oYXNDbGFzcygnb3BlbicpKSByZXR1cm5cXG5cXG4gICAgICBpZiAoZSAmJiBlLnR5cGUgPT0gJ2NsaWNrJyAmJiAvaW5wdXR8dGV4dGFyZWEvaS50ZXN0KGUudGFyZ2V0LnRhZ05hbWUpICYmICQuY29udGFpbnMoJHBhcmVudFswXSwgZS50YXJnZXQpKSByZXR1cm5cXG5cXG4gICAgICAkcGFyZW50LnRyaWdnZXIoZSA9ICQuRXZlbnQoJ2hpZGUuYnMuZHJvcGRvd24nLCByZWxhdGVkVGFyZ2V0KSlcXG5cXG4gICAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXFxuXFxuICAgICAgJHRoaXMuYXR0cignYXJpYS1leHBhbmRlZCcsICdmYWxzZScpXFxuICAgICAgJHBhcmVudC5yZW1vdmVDbGFzcygnb3BlbicpLnRyaWdnZXIoJC5FdmVudCgnaGlkZGVuLmJzLmRyb3Bkb3duJywgcmVsYXRlZFRhcmdldCkpXFxuICAgIH0pXFxuICB9XFxuXFxuICBEcm9wZG93bi5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKGUpIHtcXG4gICAgdmFyICR0aGlzID0gJCh0aGlzKVxcblxcbiAgICBpZiAoJHRoaXMuaXMoJy5kaXNhYmxlZCwgOmRpc2FibGVkJykpIHJldHVyblxcblxcbiAgICB2YXIgJHBhcmVudCAgPSBnZXRQYXJlbnQoJHRoaXMpXFxuICAgIHZhciBpc0FjdGl2ZSA9ICRwYXJlbnQuaGFzQ2xhc3MoJ29wZW4nKVxcblxcbiAgICBjbGVhck1lbnVzKClcXG5cXG4gICAgaWYgKCFpc0FjdGl2ZSkge1xcbiAgICAgIGlmICgnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgISRwYXJlbnQuY2xvc2VzdCgnLm5hdmJhci1uYXYnKS5sZW5ndGgpIHtcXG4gICAgICAgIC8vIGlmIG1vYmlsZSB3ZSB1c2UgYSBiYWNrZHJvcCBiZWNhdXNlIGNsaWNrIGV2ZW50cyBkb24ndCBkZWxlZ2F0ZVxcbiAgICAgICAgJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcXG4gICAgICAgICAgLmFkZENsYXNzKCdkcm9wZG93bi1iYWNrZHJvcCcpXFxuICAgICAgICAgIC5pbnNlcnRBZnRlcigkKHRoaXMpKVxcbiAgICAgICAgICAub24oJ2NsaWNrJywgY2xlYXJNZW51cylcXG4gICAgICB9XFxuXFxuICAgICAgdmFyIHJlbGF0ZWRUYXJnZXQgPSB7IHJlbGF0ZWRUYXJnZXQ6IHRoaXMgfVxcbiAgICAgICRwYXJlbnQudHJpZ2dlcihlID0gJC5FdmVudCgnc2hvdy5icy5kcm9wZG93bicsIHJlbGF0ZWRUYXJnZXQpKVxcblxcbiAgICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cXG5cXG4gICAgICAkdGhpc1xcbiAgICAgICAgLnRyaWdnZXIoJ2ZvY3VzJylcXG4gICAgICAgIC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKVxcblxcbiAgICAgICRwYXJlbnRcXG4gICAgICAgIC50b2dnbGVDbGFzcygnb3BlbicpXFxuICAgICAgICAudHJpZ2dlcigkLkV2ZW50KCdzaG93bi5icy5kcm9wZG93bicsIHJlbGF0ZWRUYXJnZXQpKVxcbiAgICB9XFxuXFxuICAgIHJldHVybiBmYWxzZVxcbiAgfVxcblxcbiAgRHJvcGRvd24ucHJvdG90eXBlLmtleWRvd24gPSBmdW5jdGlvbiAoZSkge1xcbiAgICBpZiAoIS8oMzh8NDB8Mjd8MzIpLy50ZXN0KGUud2hpY2gpIHx8IC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QoZS50YXJnZXQudGFnTmFtZSkpIHJldHVyblxcblxcbiAgICB2YXIgJHRoaXMgPSAkKHRoaXMpXFxuXFxuICAgIGUucHJldmVudERlZmF1bHQoKVxcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpXFxuXFxuICAgIGlmICgkdGhpcy5pcygnLmRpc2FibGVkLCA6ZGlzYWJsZWQnKSkgcmV0dXJuXFxuXFxuICAgIHZhciAkcGFyZW50ICA9IGdldFBhcmVudCgkdGhpcylcXG4gICAgdmFyIGlzQWN0aXZlID0gJHBhcmVudC5oYXNDbGFzcygnb3BlbicpXFxuXFxuICAgIGlmICghaXNBY3RpdmUgJiYgZS53aGljaCAhPSAyNyB8fCBpc0FjdGl2ZSAmJiBlLndoaWNoID09IDI3KSB7XFxuICAgICAgaWYgKGUud2hpY2ggPT0gMjcpICRwYXJlbnQuZmluZCh0b2dnbGUpLnRyaWdnZXIoJ2ZvY3VzJylcXG4gICAgICByZXR1cm4gJHRoaXMudHJpZ2dlcignY2xpY2snKVxcbiAgICB9XFxuXFxuICAgIHZhciBkZXNjID0gJyBsaTpub3QoLmRpc2FibGVkKTp2aXNpYmxlIGEnXFxuICAgIHZhciAkaXRlbXMgPSAkcGFyZW50LmZpbmQoJy5kcm9wZG93bi1tZW51JyArIGRlc2MpXFxuXFxuICAgIGlmICghJGl0ZW1zLmxlbmd0aCkgcmV0dXJuXFxuXFxuICAgIHZhciBpbmRleCA9ICRpdGVtcy5pbmRleChlLnRhcmdldClcXG5cXG4gICAgaWYgKGUud2hpY2ggPT0gMzggJiYgaW5kZXggPiAwKSAgICAgICAgICAgICAgICAgaW5kZXgtLSAgICAgICAgIC8vIHVwXFxuICAgIGlmIChlLndoaWNoID09IDQwICYmIGluZGV4IDwgJGl0ZW1zLmxlbmd0aCAtIDEpIGluZGV4KysgICAgICAgICAvLyBkb3duXFxuICAgIGlmICghfmluZGV4KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMFxcblxcbiAgICAkaXRlbXMuZXEoaW5kZXgpLnRyaWdnZXIoJ2ZvY3VzJylcXG4gIH1cXG5cXG5cXG4gIC8vIERST1BET1dOIFBMVUdJTiBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbikge1xcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpXFxuICAgICAgdmFyIGRhdGEgID0gJHRoaXMuZGF0YSgnYnMuZHJvcGRvd24nKVxcblxcbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMuZHJvcGRvd24nLCAoZGF0YSA9IG5ldyBEcm9wZG93bih0aGlzKSkpXFxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXS5jYWxsKCR0aGlzKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4uZHJvcGRvd25cXG5cXG4gICQuZm4uZHJvcGRvd24gICAgICAgICAgICAgPSBQbHVnaW5cXG4gICQuZm4uZHJvcGRvd24uQ29uc3RydWN0b3IgPSBEcm9wZG93blxcblxcblxcbiAgLy8gRFJPUERPV04gTk8gQ09ORkxJQ1RcXG4gIC8vID09PT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLmRyb3Bkb3duLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XFxuICAgICQuZm4uZHJvcGRvd24gPSBvbGRcXG4gICAgcmV0dXJuIHRoaXNcXG4gIH1cXG5cXG5cXG4gIC8vIEFQUExZIFRPIFNUQU5EQVJEIERST1BET1dOIEVMRU1FTlRTXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgJChkb2N1bWVudClcXG4gICAgLm9uKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaScsIGNsZWFyTWVudXMpXFxuICAgIC5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknLCAnLmRyb3Bkb3duIGZvcm0nLCBmdW5jdGlvbiAoZSkgeyBlLnN0b3BQcm9wYWdhdGlvbigpIH0pXFxuICAgIC5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknLCB0b2dnbGUsIERyb3Bkb3duLnByb3RvdHlwZS50b2dnbGUpXFxuICAgIC5vbigna2V5ZG93bi5icy5kcm9wZG93bi5kYXRhLWFwaScsIHRvZ2dsZSwgRHJvcGRvd24ucHJvdG90eXBlLmtleWRvd24pXFxuICAgIC5vbigna2V5ZG93bi5icy5kcm9wZG93bi5kYXRhLWFwaScsICcuZHJvcGRvd24tbWVudScsIERyb3Bkb3duLnByb3RvdHlwZS5rZXlkb3duKVxcblxcbn0oalF1ZXJ5KTtcXG5cXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBCb290c3RyYXA6IG1vZGFsLmpzIHYzLjMuN1xcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI21vZGFsc1xcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBNT0RBTCBDTEFTUyBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgTW9kYWwgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xcbiAgICB0aGlzLm9wdGlvbnMgICAgICAgICAgICAgPSBvcHRpb25zXFxuICAgIHRoaXMuJGJvZHkgICAgICAgICAgICAgICA9ICQoZG9jdW1lbnQuYm9keSlcXG4gICAgdGhpcy4kZWxlbWVudCAgICAgICAgICAgID0gJChlbGVtZW50KVxcbiAgICB0aGlzLiRkaWFsb2cgICAgICAgICAgICAgPSB0aGlzLiRlbGVtZW50LmZpbmQoJy5tb2RhbC1kaWFsb2cnKVxcbiAgICB0aGlzLiRiYWNrZHJvcCAgICAgICAgICAgPSBudWxsXFxuICAgIHRoaXMuaXNTaG93biAgICAgICAgICAgICA9IG51bGxcXG4gICAgdGhpcy5vcmlnaW5hbEJvZHlQYWQgICAgID0gbnVsbFxcbiAgICB0aGlzLnNjcm9sbGJhcldpZHRoICAgICAgPSAwXFxuICAgIHRoaXMuaWdub3JlQmFja2Ryb3BDbGljayA9IGZhbHNlXFxuXFxuICAgIGlmICh0aGlzLm9wdGlvbnMucmVtb3RlKSB7XFxuICAgICAgdGhpcy4kZWxlbWVudFxcbiAgICAgICAgLmZpbmQoJy5tb2RhbC1jb250ZW50JylcXG4gICAgICAgIC5sb2FkKHRoaXMub3B0aW9ucy5yZW1vdGUsICQucHJveHkoZnVuY3Rpb24gKCkge1xcbiAgICAgICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoJ2xvYWRlZC5icy5tb2RhbCcpXFxuICAgICAgICB9LCB0aGlzKSlcXG4gICAgfVxcbiAgfVxcblxcbiAgTW9kYWwuVkVSU0lPTiAgPSAnMy4zLjcnXFxuXFxuICBNb2RhbC5UUkFOU0lUSU9OX0RVUkFUSU9OID0gMzAwXFxuICBNb2RhbC5CQUNLRFJPUF9UUkFOU0lUSU9OX0RVUkFUSU9OID0gMTUwXFxuXFxuICBNb2RhbC5ERUZBVUxUUyA9IHtcXG4gICAgYmFja2Ryb3A6IHRydWUsXFxuICAgIGtleWJvYXJkOiB0cnVlLFxcbiAgICBzaG93OiB0cnVlXFxuICB9XFxuXFxuICBNb2RhbC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKF9yZWxhdGVkVGFyZ2V0KSB7XFxuICAgIHJldHVybiB0aGlzLmlzU2hvd24gPyB0aGlzLmhpZGUoKSA6IHRoaXMuc2hvdyhfcmVsYXRlZFRhcmdldClcXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKF9yZWxhdGVkVGFyZ2V0KSB7XFxuICAgIHZhciB0aGF0ID0gdGhpc1xcbiAgICB2YXIgZSAgICA9ICQuRXZlbnQoJ3Nob3cuYnMubW9kYWwnLCB7IHJlbGF0ZWRUYXJnZXQ6IF9yZWxhdGVkVGFyZ2V0IH0pXFxuXFxuICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxcblxcbiAgICBpZiAodGhpcy5pc1Nob3duIHx8IGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVyblxcblxcbiAgICB0aGlzLmlzU2hvd24gPSB0cnVlXFxuXFxuICAgIHRoaXMuY2hlY2tTY3JvbGxiYXIoKVxcbiAgICB0aGlzLnNldFNjcm9sbGJhcigpXFxuICAgIHRoaXMuJGJvZHkuYWRkQ2xhc3MoJ21vZGFsLW9wZW4nKVxcblxcbiAgICB0aGlzLmVzY2FwZSgpXFxuICAgIHRoaXMucmVzaXplKClcXG5cXG4gICAgdGhpcy4kZWxlbWVudC5vbignY2xpY2suZGlzbWlzcy5icy5tb2RhbCcsICdbZGF0YS1kaXNtaXNzPVxcXCJtb2RhbFxcXCJdJywgJC5wcm94eSh0aGlzLmhpZGUsIHRoaXMpKVxcblxcbiAgICB0aGlzLiRkaWFsb2cub24oJ21vdXNlZG93bi5kaXNtaXNzLmJzLm1vZGFsJywgZnVuY3Rpb24gKCkge1xcbiAgICAgIHRoYXQuJGVsZW1lbnQub25lKCdtb3VzZXVwLmRpc21pc3MuYnMubW9kYWwnLCBmdW5jdGlvbiAoZSkge1xcbiAgICAgICAgaWYgKCQoZS50YXJnZXQpLmlzKHRoYXQuJGVsZW1lbnQpKSB0aGF0Lmlnbm9yZUJhY2tkcm9wQ2xpY2sgPSB0cnVlXFxuICAgICAgfSlcXG4gICAgfSlcXG5cXG4gICAgdGhpcy5iYWNrZHJvcChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyIHRyYW5zaXRpb24gPSAkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiB0aGF0LiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJylcXG5cXG4gICAgICBpZiAoIXRoYXQuJGVsZW1lbnQucGFyZW50KCkubGVuZ3RoKSB7XFxuICAgICAgICB0aGF0LiRlbGVtZW50LmFwcGVuZFRvKHRoYXQuJGJvZHkpIC8vIGRvbid0IG1vdmUgbW9kYWxzIGRvbSBwb3NpdGlvblxcbiAgICAgIH1cXG5cXG4gICAgICB0aGF0LiRlbGVtZW50XFxuICAgICAgICAuc2hvdygpXFxuICAgICAgICAuc2Nyb2xsVG9wKDApXFxuXFxuICAgICAgdGhhdC5hZGp1c3REaWFsb2coKVxcblxcbiAgICAgIGlmICh0cmFuc2l0aW9uKSB7XFxuICAgICAgICB0aGF0LiRlbGVtZW50WzBdLm9mZnNldFdpZHRoIC8vIGZvcmNlIHJlZmxvd1xcbiAgICAgIH1cXG5cXG4gICAgICB0aGF0LiRlbGVtZW50LmFkZENsYXNzKCdpbicpXFxuXFxuICAgICAgdGhhdC5lbmZvcmNlRm9jdXMoKVxcblxcbiAgICAgIHZhciBlID0gJC5FdmVudCgnc2hvd24uYnMubW9kYWwnLCB7IHJlbGF0ZWRUYXJnZXQ6IF9yZWxhdGVkVGFyZ2V0IH0pXFxuXFxuICAgICAgdHJhbnNpdGlvbiA/XFxuICAgICAgICB0aGF0LiRkaWFsb2cgLy8gd2FpdCBmb3IgbW9kYWwgdG8gc2xpZGUgaW5cXG4gICAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24gKCkge1xcbiAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignZm9jdXMnKS50cmlnZ2VyKGUpXFxuICAgICAgICAgIH0pXFxuICAgICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChNb2RhbC5UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XFxuICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2ZvY3VzJykudHJpZ2dlcihlKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgTW9kYWwucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoZSkge1xcbiAgICBpZiAoZSkgZS5wcmV2ZW50RGVmYXVsdCgpXFxuXFxuICAgIGUgPSAkLkV2ZW50KCdoaWRlLmJzLm1vZGFsJylcXG5cXG4gICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKGUpXFxuXFxuICAgIGlmICghdGhpcy5pc1Nob3duIHx8IGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVyblxcblxcbiAgICB0aGlzLmlzU2hvd24gPSBmYWxzZVxcblxcbiAgICB0aGlzLmVzY2FwZSgpXFxuICAgIHRoaXMucmVzaXplKClcXG5cXG4gICAgJChkb2N1bWVudCkub2ZmKCdmb2N1c2luLmJzLm1vZGFsJylcXG5cXG4gICAgdGhpcy4kZWxlbWVudFxcbiAgICAgIC5yZW1vdmVDbGFzcygnaW4nKVxcbiAgICAgIC5vZmYoJ2NsaWNrLmRpc21pc3MuYnMubW9kYWwnKVxcbiAgICAgIC5vZmYoJ21vdXNldXAuZGlzbWlzcy5icy5tb2RhbCcpXFxuXFxuICAgIHRoaXMuJGRpYWxvZy5vZmYoJ21vdXNlZG93bi5kaXNtaXNzLmJzLm1vZGFsJylcXG5cXG4gICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpID9cXG4gICAgICB0aGlzLiRlbGVtZW50XFxuICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCAkLnByb3h5KHRoaXMuaGlkZU1vZGFsLCB0aGlzKSlcXG4gICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChNb2RhbC5UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XFxuICAgICAgdGhpcy5oaWRlTW9kYWwoKVxcbiAgfVxcblxcbiAgTW9kYWwucHJvdG90eXBlLmVuZm9yY2VGb2N1cyA9IGZ1bmN0aW9uICgpIHtcXG4gICAgJChkb2N1bWVudClcXG4gICAgICAub2ZmKCdmb2N1c2luLmJzLm1vZGFsJykgLy8gZ3VhcmQgYWdhaW5zdCBpbmZpbml0ZSBmb2N1cyBsb29wXFxuICAgICAgLm9uKCdmb2N1c2luLmJzLm1vZGFsJywgJC5wcm94eShmdW5jdGlvbiAoZSkge1xcbiAgICAgICAgaWYgKGRvY3VtZW50ICE9PSBlLnRhcmdldCAmJlxcbiAgICAgICAgICAgIHRoaXMuJGVsZW1lbnRbMF0gIT09IGUudGFyZ2V0ICYmXFxuICAgICAgICAgICAgIXRoaXMuJGVsZW1lbnQuaGFzKGUudGFyZ2V0KS5sZW5ndGgpIHtcXG4gICAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdmb2N1cycpXFxuICAgICAgICB9XFxuICAgICAgfSwgdGhpcykpXFxuICB9XFxuXFxuICBNb2RhbC5wcm90b3R5cGUuZXNjYXBlID0gZnVuY3Rpb24gKCkge1xcbiAgICBpZiAodGhpcy5pc1Nob3duICYmIHRoaXMub3B0aW9ucy5rZXlib2FyZCkge1xcbiAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2tleWRvd24uZGlzbWlzcy5icy5tb2RhbCcsICQucHJveHkoZnVuY3Rpb24gKGUpIHtcXG4gICAgICAgIGUud2hpY2ggPT0gMjcgJiYgdGhpcy5oaWRlKClcXG4gICAgICB9LCB0aGlzKSlcXG4gICAgfSBlbHNlIGlmICghdGhpcy5pc1Nob3duKSB7XFxuICAgICAgdGhpcy4kZWxlbWVudC5vZmYoJ2tleWRvd24uZGlzbWlzcy5icy5tb2RhbCcpXFxuICAgIH1cXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbiAoKSB7XFxuICAgIGlmICh0aGlzLmlzU2hvd24pIHtcXG4gICAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZS5icy5tb2RhbCcsICQucHJveHkodGhpcy5oYW5kbGVVcGRhdGUsIHRoaXMpKVxcbiAgICB9IGVsc2Uge1xcbiAgICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZS5icy5tb2RhbCcpXFxuICAgIH1cXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5oaWRlTW9kYWwgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciB0aGF0ID0gdGhpc1xcbiAgICB0aGlzLiRlbGVtZW50LmhpZGUoKVxcbiAgICB0aGlzLmJhY2tkcm9wKGZ1bmN0aW9uICgpIHtcXG4gICAgICB0aGF0LiRib2R5LnJlbW92ZUNsYXNzKCdtb2RhbC1vcGVuJylcXG4gICAgICB0aGF0LnJlc2V0QWRqdXN0bWVudHMoKVxcbiAgICAgIHRoYXQucmVzZXRTY3JvbGxiYXIoKVxcbiAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignaGlkZGVuLmJzLm1vZGFsJylcXG4gICAgfSlcXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5yZW1vdmVCYWNrZHJvcCA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdGhpcy4kYmFja2Ryb3AgJiYgdGhpcy4kYmFja2Ryb3AucmVtb3ZlKClcXG4gICAgdGhpcy4kYmFja2Ryb3AgPSBudWxsXFxuICB9XFxuXFxuICBNb2RhbC5wcm90b3R5cGUuYmFja2Ryb3AgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcXG4gICAgdmFyIHRoYXQgPSB0aGlzXFxuICAgIHZhciBhbmltYXRlID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpID8gJ2ZhZGUnIDogJydcXG5cXG4gICAgaWYgKHRoaXMuaXNTaG93biAmJiB0aGlzLm9wdGlvbnMuYmFja2Ryb3ApIHtcXG4gICAgICB2YXIgZG9BbmltYXRlID0gJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgYW5pbWF0ZVxcblxcbiAgICAgIHRoaXMuJGJhY2tkcm9wID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcXG4gICAgICAgIC5hZGRDbGFzcygnbW9kYWwtYmFja2Ryb3AgJyArIGFuaW1hdGUpXFxuICAgICAgICAuYXBwZW5kVG8odGhpcy4kYm9keSlcXG5cXG4gICAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljay5kaXNtaXNzLmJzLm1vZGFsJywgJC5wcm94eShmdW5jdGlvbiAoZSkge1xcbiAgICAgICAgaWYgKHRoaXMuaWdub3JlQmFja2Ryb3BDbGljaykge1xcbiAgICAgICAgICB0aGlzLmlnbm9yZUJhY2tkcm9wQ2xpY2sgPSBmYWxzZVxcbiAgICAgICAgICByZXR1cm5cXG4gICAgICAgIH1cXG4gICAgICAgIGlmIChlLnRhcmdldCAhPT0gZS5jdXJyZW50VGFyZ2V0KSByZXR1cm5cXG4gICAgICAgIHRoaXMub3B0aW9ucy5iYWNrZHJvcCA9PSAnc3RhdGljJ1xcbiAgICAgICAgICA/IHRoaXMuJGVsZW1lbnRbMF0uZm9jdXMoKVxcbiAgICAgICAgICA6IHRoaXMuaGlkZSgpXFxuICAgICAgfSwgdGhpcykpXFxuXFxuICAgICAgaWYgKGRvQW5pbWF0ZSkgdGhpcy4kYmFja2Ryb3BbMF0ub2Zmc2V0V2lkdGggLy8gZm9yY2UgcmVmbG93XFxuXFxuICAgICAgdGhpcy4kYmFja2Ryb3AuYWRkQ2xhc3MoJ2luJylcXG5cXG4gICAgICBpZiAoIWNhbGxiYWNrKSByZXR1cm5cXG5cXG4gICAgICBkb0FuaW1hdGUgP1xcbiAgICAgICAgdGhpcy4kYmFja2Ryb3BcXG4gICAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgY2FsbGJhY2spXFxuICAgICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChNb2RhbC5CQUNLRFJPUF9UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XFxuICAgICAgICBjYWxsYmFjaygpXFxuXFxuICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNTaG93biAmJiB0aGlzLiRiYWNrZHJvcCkge1xcbiAgICAgIHRoaXMuJGJhY2tkcm9wLnJlbW92ZUNsYXNzKCdpbicpXFxuXFxuICAgICAgdmFyIGNhbGxiYWNrUmVtb3ZlID0gZnVuY3Rpb24gKCkge1xcbiAgICAgICAgdGhhdC5yZW1vdmVCYWNrZHJvcCgpXFxuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpXFxuICAgICAgfVxcbiAgICAgICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/XFxuICAgICAgICB0aGlzLiRiYWNrZHJvcFxcbiAgICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBjYWxsYmFja1JlbW92ZSlcXG4gICAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKE1vZGFsLkJBQ0tEUk9QX1RSQU5TSVRJT05fRFVSQVRJT04pIDpcXG4gICAgICAgIGNhbGxiYWNrUmVtb3ZlKClcXG5cXG4gICAgfSBlbHNlIGlmIChjYWxsYmFjaykge1xcbiAgICAgIGNhbGxiYWNrKClcXG4gICAgfVxcbiAgfVxcblxcbiAgLy8gdGhlc2UgZm9sbG93aW5nIG1ldGhvZHMgYXJlIHVzZWQgdG8gaGFuZGxlIG92ZXJmbG93aW5nIG1vZGFsc1xcblxcbiAgTW9kYWwucHJvdG90eXBlLmhhbmRsZVVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdGhpcy5hZGp1c3REaWFsb2coKVxcbiAgfVxcblxcbiAgTW9kYWwucHJvdG90eXBlLmFkanVzdERpYWxvZyA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIG1vZGFsSXNPdmVyZmxvd2luZyA9IHRoaXMuJGVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0ID4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxcblxcbiAgICB0aGlzLiRlbGVtZW50LmNzcyh7XFxuICAgICAgcGFkZGluZ0xlZnQ6ICAhdGhpcy5ib2R5SXNPdmVyZmxvd2luZyAmJiBtb2RhbElzT3ZlcmZsb3dpbmcgPyB0aGlzLnNjcm9sbGJhcldpZHRoIDogJycsXFxuICAgICAgcGFkZGluZ1JpZ2h0OiB0aGlzLmJvZHlJc092ZXJmbG93aW5nICYmICFtb2RhbElzT3ZlcmZsb3dpbmcgPyB0aGlzLnNjcm9sbGJhcldpZHRoIDogJydcXG4gICAgfSlcXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5yZXNldEFkanVzdG1lbnRzID0gZnVuY3Rpb24gKCkge1xcbiAgICB0aGlzLiRlbGVtZW50LmNzcyh7XFxuICAgICAgcGFkZGluZ0xlZnQ6ICcnLFxcbiAgICAgIHBhZGRpbmdSaWdodDogJydcXG4gICAgfSlcXG4gIH1cXG5cXG4gIE1vZGFsLnByb3RvdHlwZS5jaGVja1Njcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIGZ1bGxXaW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoXFxuICAgIGlmICghZnVsbFdpbmRvd1dpZHRoKSB7IC8vIHdvcmthcm91bmQgZm9yIG1pc3Npbmcgd2luZG93LmlubmVyV2lkdGggaW4gSUU4XFxuICAgICAgdmFyIGRvY3VtZW50RWxlbWVudFJlY3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcXG4gICAgICBmdWxsV2luZG93V2lkdGggPSBkb2N1bWVudEVsZW1lbnRSZWN0LnJpZ2h0IC0gTWF0aC5hYnMoZG9jdW1lbnRFbGVtZW50UmVjdC5sZWZ0KVxcbiAgICB9XFxuICAgIHRoaXMuYm9keUlzT3ZlcmZsb3dpbmcgPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoIDwgZnVsbFdpbmRvd1dpZHRoXFxuICAgIHRoaXMuc2Nyb2xsYmFyV2lkdGggPSB0aGlzLm1lYXN1cmVTY3JvbGxiYXIoKVxcbiAgfVxcblxcbiAgTW9kYWwucHJvdG90eXBlLnNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIGJvZHlQYWQgPSBwYXJzZUludCgodGhpcy4kYm9keS5jc3MoJ3BhZGRpbmctcmlnaHQnKSB8fCAwKSwgMTApXFxuICAgIHRoaXMub3JpZ2luYWxCb2R5UGFkID0gZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nUmlnaHQgfHwgJydcXG4gICAgaWYgKHRoaXMuYm9keUlzT3ZlcmZsb3dpbmcpIHRoaXMuJGJvZHkuY3NzKCdwYWRkaW5nLXJpZ2h0JywgYm9keVBhZCArIHRoaXMuc2Nyb2xsYmFyV2lkdGgpXFxuICB9XFxuXFxuICBNb2RhbC5wcm90b3R5cGUucmVzZXRTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHRoaXMuJGJvZHkuY3NzKCdwYWRkaW5nLXJpZ2h0JywgdGhpcy5vcmlnaW5hbEJvZHlQYWQpXFxuICB9XFxuXFxuICBNb2RhbC5wcm90b3R5cGUubWVhc3VyZVNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHsgLy8gdGh4IHdhbHNoXFxuICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxcbiAgICBzY3JvbGxEaXYuY2xhc3NOYW1lID0gJ21vZGFsLXNjcm9sbGJhci1tZWFzdXJlJ1xcbiAgICB0aGlzLiRib2R5LmFwcGVuZChzY3JvbGxEaXYpXFxuICAgIHZhciBzY3JvbGxiYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aFxcbiAgICB0aGlzLiRib2R5WzBdLnJlbW92ZUNoaWxkKHNjcm9sbERpdilcXG4gICAgcmV0dXJuIHNjcm9sbGJhcldpZHRoXFxuICB9XFxuXFxuXFxuICAvLyBNT0RBTCBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT1cXG5cXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24sIF9yZWxhdGVkVGFyZ2V0KSB7XFxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMubW9kYWwnKVxcbiAgICAgIHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sIE1vZGFsLkRFRkFVTFRTLCAkdGhpcy5kYXRhKCksIHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uKVxcblxcbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMubW9kYWwnLCAoZGF0YSA9IG5ldyBNb2RhbCh0aGlzLCBvcHRpb25zKSkpXFxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXShfcmVsYXRlZFRhcmdldClcXG4gICAgICBlbHNlIGlmIChvcHRpb25zLnNob3cpIGRhdGEuc2hvdyhfcmVsYXRlZFRhcmdldClcXG4gICAgfSlcXG4gIH1cXG5cXG4gIHZhciBvbGQgPSAkLmZuLm1vZGFsXFxuXFxuICAkLmZuLm1vZGFsICAgICAgICAgICAgID0gUGx1Z2luXFxuICAkLmZuLm1vZGFsLkNvbnN0cnVjdG9yID0gTW9kYWxcXG5cXG5cXG4gIC8vIE1PREFMIE5PIENPTkZMSUNUXFxuICAvLyA9PT09PT09PT09PT09PT09PVxcblxcbiAgJC5mbi5tb2RhbC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLm1vZGFsID0gb2xkXFxuICAgIHJldHVybiB0aGlzXFxuICB9XFxuXFxuXFxuICAvLyBNT0RBTCBEQVRBLUFQSVxcbiAgLy8gPT09PT09PT09PT09PT1cXG5cXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljay5icy5tb2RhbC5kYXRhLWFwaScsICdbZGF0YS10b2dnbGU9XFxcIm1vZGFsXFxcIl0nLCBmdW5jdGlvbiAoZSkge1xcbiAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcXG4gICAgdmFyIGhyZWYgICAgPSAkdGhpcy5hdHRyKCdocmVmJylcXG4gICAgdmFyICR0YXJnZXQgPSAkKCR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JykgfHwgKGhyZWYgJiYgaHJlZi5yZXBsYWNlKC8uKig/PSNbXlxcXFxzXSskKS8sICcnKSkpIC8vIHN0cmlwIGZvciBpZTdcXG4gICAgdmFyIG9wdGlvbiAgPSAkdGFyZ2V0LmRhdGEoJ2JzLm1vZGFsJykgPyAndG9nZ2xlJyA6ICQuZXh0ZW5kKHsgcmVtb3RlOiAhLyMvLnRlc3QoaHJlZikgJiYgaHJlZiB9LCAkdGFyZ2V0LmRhdGEoKSwgJHRoaXMuZGF0YSgpKVxcblxcbiAgICBpZiAoJHRoaXMuaXMoJ2EnKSkgZS5wcmV2ZW50RGVmYXVsdCgpXFxuXFxuICAgICR0YXJnZXQub25lKCdzaG93LmJzLm1vZGFsJywgZnVuY3Rpb24gKHNob3dFdmVudCkge1xcbiAgICAgIGlmIChzaG93RXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVybiAvLyBvbmx5IHJlZ2lzdGVyIGZvY3VzIHJlc3RvcmVyIGlmIG1vZGFsIHdpbGwgYWN0dWFsbHkgZ2V0IHNob3duXFxuICAgICAgJHRhcmdldC5vbmUoJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHtcXG4gICAgICAgICR0aGlzLmlzKCc6dmlzaWJsZScpICYmICR0aGlzLnRyaWdnZXIoJ2ZvY3VzJylcXG4gICAgICB9KVxcbiAgICB9KVxcbiAgICBQbHVnaW4uY2FsbCgkdGFyZ2V0LCBvcHRpb24sIHRoaXMpXFxuICB9KVxcblxcbn0oalF1ZXJ5KTtcXG5cXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBCb290c3RyYXA6IHRvb2x0aXAuanMgdjMuMy43XFxuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jdG9vbHRpcFxcbiAqIEluc3BpcmVkIGJ5IHRoZSBvcmlnaW5hbCBqUXVlcnkudGlwc3kgYnkgSmFzb24gRnJhbWVcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gVE9PTFRJUCBQVUJMSUMgQ0xBU1MgREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgdmFyIFRvb2x0aXAgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xcbiAgICB0aGlzLnR5cGUgICAgICAgPSBudWxsXFxuICAgIHRoaXMub3B0aW9ucyAgICA9IG51bGxcXG4gICAgdGhpcy5lbmFibGVkICAgID0gbnVsbFxcbiAgICB0aGlzLnRpbWVvdXQgICAgPSBudWxsXFxuICAgIHRoaXMuaG92ZXJTdGF0ZSA9IG51bGxcXG4gICAgdGhpcy4kZWxlbWVudCAgID0gbnVsbFxcbiAgICB0aGlzLmluU3RhdGUgICAgPSBudWxsXFxuXFxuICAgIHRoaXMuaW5pdCgndG9vbHRpcCcsIGVsZW1lbnQsIG9wdGlvbnMpXFxuICB9XFxuXFxuICBUb29sdGlwLlZFUlNJT04gID0gJzMuMy43J1xcblxcbiAgVG9vbHRpcC5UUkFOU0lUSU9OX0RVUkFUSU9OID0gMTUwXFxuXFxuICBUb29sdGlwLkRFRkFVTFRTID0ge1xcbiAgICBhbmltYXRpb246IHRydWUsXFxuICAgIHBsYWNlbWVudDogJ3RvcCcsXFxuICAgIHNlbGVjdG9yOiBmYWxzZSxcXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVxcXCJ0b29sdGlwXFxcIiByb2xlPVxcXCJ0b29sdGlwXFxcIj48ZGl2IGNsYXNzPVxcXCJ0b29sdGlwLWFycm93XFxcIj48L2Rpdj48ZGl2IGNsYXNzPVxcXCJ0b29sdGlwLWlubmVyXFxcIj48L2Rpdj48L2Rpdj4nLFxcbiAgICB0cmlnZ2VyOiAnaG92ZXIgZm9jdXMnLFxcbiAgICB0aXRsZTogJycsXFxuICAgIGRlbGF5OiAwLFxcbiAgICBodG1sOiBmYWxzZSxcXG4gICAgY29udGFpbmVyOiBmYWxzZSxcXG4gICAgdmlld3BvcnQ6IHtcXG4gICAgICBzZWxlY3RvcjogJ2JvZHknLFxcbiAgICAgIHBhZGRpbmc6IDBcXG4gICAgfVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICh0eXBlLCBlbGVtZW50LCBvcHRpb25zKSB7XFxuICAgIHRoaXMuZW5hYmxlZCAgID0gdHJ1ZVxcbiAgICB0aGlzLnR5cGUgICAgICA9IHR5cGVcXG4gICAgdGhpcy4kZWxlbWVudCAgPSAkKGVsZW1lbnQpXFxuICAgIHRoaXMub3B0aW9ucyAgID0gdGhpcy5nZXRPcHRpb25zKG9wdGlvbnMpXFxuICAgIHRoaXMuJHZpZXdwb3J0ID0gdGhpcy5vcHRpb25zLnZpZXdwb3J0ICYmICQoJC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy52aWV3cG9ydCkgPyB0aGlzLm9wdGlvbnMudmlld3BvcnQuY2FsbCh0aGlzLCB0aGlzLiRlbGVtZW50KSA6ICh0aGlzLm9wdGlvbnMudmlld3BvcnQuc2VsZWN0b3IgfHwgdGhpcy5vcHRpb25zLnZpZXdwb3J0KSlcXG4gICAgdGhpcy5pblN0YXRlICAgPSB7IGNsaWNrOiBmYWxzZSwgaG92ZXI6IGZhbHNlLCBmb2N1czogZmFsc2UgfVxcblxcbiAgICBpZiAodGhpcy4kZWxlbWVudFswXSBpbnN0YW5jZW9mIGRvY3VtZW50LmNvbnN0cnVjdG9yICYmICF0aGlzLm9wdGlvbnMuc2VsZWN0b3IpIHtcXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2BzZWxlY3RvcmAgb3B0aW9uIG11c3QgYmUgc3BlY2lmaWVkIHdoZW4gaW5pdGlhbGl6aW5nICcgKyB0aGlzLnR5cGUgKyAnIG9uIHRoZSB3aW5kb3cuZG9jdW1lbnQgb2JqZWN0IScpXFxuICAgIH1cXG5cXG4gICAgdmFyIHRyaWdnZXJzID0gdGhpcy5vcHRpb25zLnRyaWdnZXIuc3BsaXQoJyAnKVxcblxcbiAgICBmb3IgKHZhciBpID0gdHJpZ2dlcnMubGVuZ3RoOyBpLS07KSB7XFxuICAgICAgdmFyIHRyaWdnZXIgPSB0cmlnZ2Vyc1tpXVxcblxcbiAgICAgIGlmICh0cmlnZ2VyID09ICdjbGljaycpIHtcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2NsaWNrLicgKyB0aGlzLnR5cGUsIHRoaXMub3B0aW9ucy5zZWxlY3RvciwgJC5wcm94eSh0aGlzLnRvZ2dsZSwgdGhpcykpXFxuICAgICAgfSBlbHNlIGlmICh0cmlnZ2VyICE9ICdtYW51YWwnKSB7XFxuICAgICAgICB2YXIgZXZlbnRJbiAgPSB0cmlnZ2VyID09ICdob3ZlcicgPyAnbW91c2VlbnRlcicgOiAnZm9jdXNpbidcXG4gICAgICAgIHZhciBldmVudE91dCA9IHRyaWdnZXIgPT0gJ2hvdmVyJyA/ICdtb3VzZWxlYXZlJyA6ICdmb2N1c291dCdcXG5cXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oZXZlbnRJbiAgKyAnLicgKyB0aGlzLnR5cGUsIHRoaXMub3B0aW9ucy5zZWxlY3RvciwgJC5wcm94eSh0aGlzLmVudGVyLCB0aGlzKSlcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oZXZlbnRPdXQgKyAnLicgKyB0aGlzLnR5cGUsIHRoaXMub3B0aW9ucy5zZWxlY3RvciwgJC5wcm94eSh0aGlzLmxlYXZlLCB0aGlzKSlcXG4gICAgICB9XFxuICAgIH1cXG5cXG4gICAgdGhpcy5vcHRpb25zLnNlbGVjdG9yID9cXG4gICAgICAodGhpcy5fb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMsIHsgdHJpZ2dlcjogJ21hbnVhbCcsIHNlbGVjdG9yOiAnJyB9KSkgOlxcbiAgICAgIHRoaXMuZml4VGl0bGUoKVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHJldHVybiBUb29sdGlwLkRFRkFVTFRTXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5nZXRPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcXG4gICAgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLmdldERlZmF1bHRzKCksIHRoaXMuJGVsZW1lbnQuZGF0YSgpLCBvcHRpb25zKVxcblxcbiAgICBpZiAob3B0aW9ucy5kZWxheSAmJiB0eXBlb2Ygb3B0aW9ucy5kZWxheSA9PSAnbnVtYmVyJykge1xcbiAgICAgIG9wdGlvbnMuZGVsYXkgPSB7XFxuICAgICAgICBzaG93OiBvcHRpb25zLmRlbGF5LFxcbiAgICAgICAgaGlkZTogb3B0aW9ucy5kZWxheVxcbiAgICAgIH1cXG4gICAgfVxcblxcbiAgICByZXR1cm4gb3B0aW9uc1xcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0RGVsZWdhdGVPcHRpb25zID0gZnVuY3Rpb24gKCkge1xcbiAgICB2YXIgb3B0aW9ucyAgPSB7fVxcbiAgICB2YXIgZGVmYXVsdHMgPSB0aGlzLmdldERlZmF1bHRzKClcXG5cXG4gICAgdGhpcy5fb3B0aW9ucyAmJiAkLmVhY2godGhpcy5fb3B0aW9ucywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcXG4gICAgICBpZiAoZGVmYXVsdHNba2V5XSAhPSB2YWx1ZSkgb3B0aW9uc1trZXldID0gdmFsdWVcXG4gICAgfSlcXG5cXG4gICAgcmV0dXJuIG9wdGlvbnNcXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLmVudGVyID0gZnVuY3Rpb24gKG9iaikge1xcbiAgICB2YXIgc2VsZiA9IG9iaiBpbnN0YW5jZW9mIHRoaXMuY29uc3RydWN0b3IgP1xcbiAgICAgIG9iaiA6ICQob2JqLmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2JzLicgKyB0aGlzLnR5cGUpXFxuXFxuICAgIGlmICghc2VsZikge1xcbiAgICAgIHNlbGYgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihvYmouY3VycmVudFRhcmdldCwgdGhpcy5nZXREZWxlZ2F0ZU9wdGlvbnMoKSlcXG4gICAgICAkKG9iai5jdXJyZW50VGFyZ2V0KS5kYXRhKCdicy4nICsgdGhpcy50eXBlLCBzZWxmKVxcbiAgICB9XFxuXFxuICAgIGlmIChvYmogaW5zdGFuY2VvZiAkLkV2ZW50KSB7XFxuICAgICAgc2VsZi5pblN0YXRlW29iai50eXBlID09ICdmb2N1c2luJyA/ICdmb2N1cycgOiAnaG92ZXInXSA9IHRydWVcXG4gICAgfVxcblxcbiAgICBpZiAoc2VsZi50aXAoKS5oYXNDbGFzcygnaW4nKSB8fCBzZWxmLmhvdmVyU3RhdGUgPT0gJ2luJykge1xcbiAgICAgIHNlbGYuaG92ZXJTdGF0ZSA9ICdpbidcXG4gICAgICByZXR1cm5cXG4gICAgfVxcblxcbiAgICBjbGVhclRpbWVvdXQoc2VsZi50aW1lb3V0KVxcblxcbiAgICBzZWxmLmhvdmVyU3RhdGUgPSAnaW4nXFxuXFxuICAgIGlmICghc2VsZi5vcHRpb25zLmRlbGF5IHx8ICFzZWxmLm9wdGlvbnMuZGVsYXkuc2hvdykgcmV0dXJuIHNlbGYuc2hvdygpXFxuXFxuICAgIHNlbGYudGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xcbiAgICAgIGlmIChzZWxmLmhvdmVyU3RhdGUgPT0gJ2luJykgc2VsZi5zaG93KClcXG4gICAgfSwgc2VsZi5vcHRpb25zLmRlbGF5LnNob3cpXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5pc0luU3RhdGVUcnVlID0gZnVuY3Rpb24gKCkge1xcbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5pblN0YXRlKSB7XFxuICAgICAgaWYgKHRoaXMuaW5TdGF0ZVtrZXldKSByZXR1cm4gdHJ1ZVxcbiAgICB9XFxuXFxuICAgIHJldHVybiBmYWxzZVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUubGVhdmUgPSBmdW5jdGlvbiAob2JqKSB7XFxuICAgIHZhciBzZWxmID0gb2JqIGluc3RhbmNlb2YgdGhpcy5jb25zdHJ1Y3RvciA/XFxuICAgICAgb2JqIDogJChvYmouY3VycmVudFRhcmdldCkuZGF0YSgnYnMuJyArIHRoaXMudHlwZSlcXG5cXG4gICAgaWYgKCFzZWxmKSB7XFxuICAgICAgc2VsZiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG9iai5jdXJyZW50VGFyZ2V0LCB0aGlzLmdldERlbGVnYXRlT3B0aW9ucygpKVxcbiAgICAgICQob2JqLmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2JzLicgKyB0aGlzLnR5cGUsIHNlbGYpXFxuICAgIH1cXG5cXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mICQuRXZlbnQpIHtcXG4gICAgICBzZWxmLmluU3RhdGVbb2JqLnR5cGUgPT0gJ2ZvY3Vzb3V0JyA/ICdmb2N1cycgOiAnaG92ZXInXSA9IGZhbHNlXFxuICAgIH1cXG5cXG4gICAgaWYgKHNlbGYuaXNJblN0YXRlVHJ1ZSgpKSByZXR1cm5cXG5cXG4gICAgY2xlYXJUaW1lb3V0KHNlbGYudGltZW91dClcXG5cXG4gICAgc2VsZi5ob3ZlclN0YXRlID0gJ291dCdcXG5cXG4gICAgaWYgKCFzZWxmLm9wdGlvbnMuZGVsYXkgfHwgIXNlbGYub3B0aW9ucy5kZWxheS5oaWRlKSByZXR1cm4gc2VsZi5oaWRlKClcXG5cXG4gICAgc2VsZi50aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XFxuICAgICAgaWYgKHNlbGYuaG92ZXJTdGF0ZSA9PSAnb3V0Jykgc2VsZi5oaWRlKClcXG4gICAgfSwgc2VsZi5vcHRpb25zLmRlbGF5LmhpZGUpXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xcbiAgICB2YXIgZSA9ICQuRXZlbnQoJ3Nob3cuYnMuJyArIHRoaXMudHlwZSlcXG5cXG4gICAgaWYgKHRoaXMuaGFzQ29udGVudCgpICYmIHRoaXMuZW5hYmxlZCkge1xcbiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxcblxcbiAgICAgIHZhciBpbkRvbSA9ICQuY29udGFpbnModGhpcy4kZWxlbWVudFswXS5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgdGhpcy4kZWxlbWVudFswXSlcXG4gICAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSB8fCAhaW5Eb20pIHJldHVyblxcbiAgICAgIHZhciB0aGF0ID0gdGhpc1xcblxcbiAgICAgIHZhciAkdGlwID0gdGhpcy50aXAoKVxcblxcbiAgICAgIHZhciB0aXBJZCA9IHRoaXMuZ2V0VUlEKHRoaXMudHlwZSlcXG5cXG4gICAgICB0aGlzLnNldENvbnRlbnQoKVxcbiAgICAgICR0aXAuYXR0cignaWQnLCB0aXBJZClcXG4gICAgICB0aGlzLiRlbGVtZW50LmF0dHIoJ2FyaWEtZGVzY3JpYmVkYnknLCB0aXBJZClcXG5cXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmFuaW1hdGlvbikgJHRpcC5hZGRDbGFzcygnZmFkZScpXFxuXFxuICAgICAgdmFyIHBsYWNlbWVudCA9IHR5cGVvZiB0aGlzLm9wdGlvbnMucGxhY2VtZW50ID09ICdmdW5jdGlvbicgP1xcbiAgICAgICAgdGhpcy5vcHRpb25zLnBsYWNlbWVudC5jYWxsKHRoaXMsICR0aXBbMF0sIHRoaXMuJGVsZW1lbnRbMF0pIDpcXG4gICAgICAgIHRoaXMub3B0aW9ucy5wbGFjZW1lbnRcXG5cXG4gICAgICB2YXIgYXV0b1Rva2VuID0gL1xcXFxzP2F1dG8/XFxcXHM/L2lcXG4gICAgICB2YXIgYXV0b1BsYWNlID0gYXV0b1Rva2VuLnRlc3QocGxhY2VtZW50KVxcbiAgICAgIGlmIChhdXRvUGxhY2UpIHBsYWNlbWVudCA9IHBsYWNlbWVudC5yZXBsYWNlKGF1dG9Ub2tlbiwgJycpIHx8ICd0b3AnXFxuXFxuICAgICAgJHRpcFxcbiAgICAgICAgLmRldGFjaCgpXFxuICAgICAgICAuY3NzKHsgdG9wOiAwLCBsZWZ0OiAwLCBkaXNwbGF5OiAnYmxvY2snIH0pXFxuICAgICAgICAuYWRkQ2xhc3MocGxhY2VtZW50KVxcbiAgICAgICAgLmRhdGEoJ2JzLicgKyB0aGlzLnR5cGUsIHRoaXMpXFxuXFxuICAgICAgdGhpcy5vcHRpb25zLmNvbnRhaW5lciA/ICR0aXAuYXBwZW5kVG8odGhpcy5vcHRpb25zLmNvbnRhaW5lcikgOiAkdGlwLmluc2VydEFmdGVyKHRoaXMuJGVsZW1lbnQpXFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdpbnNlcnRlZC5icy4nICsgdGhpcy50eXBlKVxcblxcbiAgICAgIHZhciBwb3MgICAgICAgICAgPSB0aGlzLmdldFBvc2l0aW9uKClcXG4gICAgICB2YXIgYWN0dWFsV2lkdGggID0gJHRpcFswXS5vZmZzZXRXaWR0aFxcbiAgICAgIHZhciBhY3R1YWxIZWlnaHQgPSAkdGlwWzBdLm9mZnNldEhlaWdodFxcblxcbiAgICAgIGlmIChhdXRvUGxhY2UpIHtcXG4gICAgICAgIHZhciBvcmdQbGFjZW1lbnQgPSBwbGFjZW1lbnRcXG4gICAgICAgIHZhciB2aWV3cG9ydERpbSA9IHRoaXMuZ2V0UG9zaXRpb24odGhpcy4kdmlld3BvcnQpXFxuXFxuICAgICAgICBwbGFjZW1lbnQgPSBwbGFjZW1lbnQgPT0gJ2JvdHRvbScgJiYgcG9zLmJvdHRvbSArIGFjdHVhbEhlaWdodCA+IHZpZXdwb3J0RGltLmJvdHRvbSA/ICd0b3AnICAgIDpcXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudCA9PSAndG9wJyAgICAmJiBwb3MudG9wICAgIC0gYWN0dWFsSGVpZ2h0IDwgdmlld3BvcnREaW0udG9wICAgID8gJ2JvdHRvbScgOlxcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50ID09ICdyaWdodCcgICYmIHBvcy5yaWdodCAgKyBhY3R1YWxXaWR0aCAgPiB2aWV3cG9ydERpbS53aWR0aCAgPyAnbGVmdCcgICA6XFxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQgPT0gJ2xlZnQnICAgJiYgcG9zLmxlZnQgICAtIGFjdHVhbFdpZHRoICA8IHZpZXdwb3J0RGltLmxlZnQgICA/ICdyaWdodCcgIDpcXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudFxcblxcbiAgICAgICAgJHRpcFxcbiAgICAgICAgICAucmVtb3ZlQ2xhc3Mob3JnUGxhY2VtZW50KVxcbiAgICAgICAgICAuYWRkQ2xhc3MocGxhY2VtZW50KVxcbiAgICAgIH1cXG5cXG4gICAgICB2YXIgY2FsY3VsYXRlZE9mZnNldCA9IHRoaXMuZ2V0Q2FsY3VsYXRlZE9mZnNldChwbGFjZW1lbnQsIHBvcywgYWN0dWFsV2lkdGgsIGFjdHVhbEhlaWdodClcXG5cXG4gICAgICB0aGlzLmFwcGx5UGxhY2VtZW50KGNhbGN1bGF0ZWRPZmZzZXQsIHBsYWNlbWVudClcXG5cXG4gICAgICB2YXIgY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XFxuICAgICAgICB2YXIgcHJldkhvdmVyU3RhdGUgPSB0aGF0LmhvdmVyU3RhdGVcXG4gICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignc2hvd24uYnMuJyArIHRoYXQudHlwZSlcXG4gICAgICAgIHRoYXQuaG92ZXJTdGF0ZSA9IG51bGxcXG5cXG4gICAgICAgIGlmIChwcmV2SG92ZXJTdGF0ZSA9PSAnb3V0JykgdGhhdC5sZWF2ZSh0aGF0KVxcbiAgICAgIH1cXG5cXG4gICAgICAkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiB0aGlzLiR0aXAuaGFzQ2xhc3MoJ2ZhZGUnKSA/XFxuICAgICAgICAkdGlwXFxuICAgICAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIGNvbXBsZXRlKVxcbiAgICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoVG9vbHRpcC5UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XFxuICAgICAgICBjb21wbGV0ZSgpXFxuICAgIH1cXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLmFwcGx5UGxhY2VtZW50ID0gZnVuY3Rpb24gKG9mZnNldCwgcGxhY2VtZW50KSB7XFxuICAgIHZhciAkdGlwICAgPSB0aGlzLnRpcCgpXFxuICAgIHZhciB3aWR0aCAgPSAkdGlwWzBdLm9mZnNldFdpZHRoXFxuICAgIHZhciBoZWlnaHQgPSAkdGlwWzBdLm9mZnNldEhlaWdodFxcblxcbiAgICAvLyBtYW51YWxseSByZWFkIG1hcmdpbnMgYmVjYXVzZSBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaW5jbHVkZXMgZGlmZmVyZW5jZVxcbiAgICB2YXIgbWFyZ2luVG9wID0gcGFyc2VJbnQoJHRpcC5jc3MoJ21hcmdpbi10b3AnKSwgMTApXFxuICAgIHZhciBtYXJnaW5MZWZ0ID0gcGFyc2VJbnQoJHRpcC5jc3MoJ21hcmdpbi1sZWZ0JyksIDEwKVxcblxcbiAgICAvLyB3ZSBtdXN0IGNoZWNrIGZvciBOYU4gZm9yIGllIDgvOVxcbiAgICBpZiAoaXNOYU4obWFyZ2luVG9wKSkgIG1hcmdpblRvcCAgPSAwXFxuICAgIGlmIChpc05hTihtYXJnaW5MZWZ0KSkgbWFyZ2luTGVmdCA9IDBcXG5cXG4gICAgb2Zmc2V0LnRvcCAgKz0gbWFyZ2luVG9wXFxuICAgIG9mZnNldC5sZWZ0ICs9IG1hcmdpbkxlZnRcXG5cXG4gICAgLy8gJC5mbi5vZmZzZXQgZG9lc24ndCByb3VuZCBwaXhlbCB2YWx1ZXNcXG4gICAgLy8gc28gd2UgdXNlIHNldE9mZnNldCBkaXJlY3RseSB3aXRoIG91ciBvd24gZnVuY3Rpb24gQi0wXFxuICAgICQub2Zmc2V0LnNldE9mZnNldCgkdGlwWzBdLCAkLmV4dGVuZCh7XFxuICAgICAgdXNpbmc6IGZ1bmN0aW9uIChwcm9wcykge1xcbiAgICAgICAgJHRpcC5jc3Moe1xcbiAgICAgICAgICB0b3A6IE1hdGgucm91bmQocHJvcHMudG9wKSxcXG4gICAgICAgICAgbGVmdDogTWF0aC5yb3VuZChwcm9wcy5sZWZ0KVxcbiAgICAgICAgfSlcXG4gICAgICB9XFxuICAgIH0sIG9mZnNldCksIDApXFxuXFxuICAgICR0aXAuYWRkQ2xhc3MoJ2luJylcXG5cXG4gICAgLy8gY2hlY2sgdG8gc2VlIGlmIHBsYWNpbmcgdGlwIGluIG5ldyBvZmZzZXQgY2F1c2VkIHRoZSB0aXAgdG8gcmVzaXplIGl0c2VsZlxcbiAgICB2YXIgYWN0dWFsV2lkdGggID0gJHRpcFswXS5vZmZzZXRXaWR0aFxcbiAgICB2YXIgYWN0dWFsSGVpZ2h0ID0gJHRpcFswXS5vZmZzZXRIZWlnaHRcXG5cXG4gICAgaWYgKHBsYWNlbWVudCA9PSAndG9wJyAmJiBhY3R1YWxIZWlnaHQgIT0gaGVpZ2h0KSB7XFxuICAgICAgb2Zmc2V0LnRvcCA9IG9mZnNldC50b3AgKyBoZWlnaHQgLSBhY3R1YWxIZWlnaHRcXG4gICAgfVxcblxcbiAgICB2YXIgZGVsdGEgPSB0aGlzLmdldFZpZXdwb3J0QWRqdXN0ZWREZWx0YShwbGFjZW1lbnQsIG9mZnNldCwgYWN0dWFsV2lkdGgsIGFjdHVhbEhlaWdodClcXG5cXG4gICAgaWYgKGRlbHRhLmxlZnQpIG9mZnNldC5sZWZ0ICs9IGRlbHRhLmxlZnRcXG4gICAgZWxzZSBvZmZzZXQudG9wICs9IGRlbHRhLnRvcFxcblxcbiAgICB2YXIgaXNWZXJ0aWNhbCAgICAgICAgICA9IC90b3B8Ym90dG9tLy50ZXN0KHBsYWNlbWVudClcXG4gICAgdmFyIGFycm93RGVsdGEgICAgICAgICAgPSBpc1ZlcnRpY2FsID8gZGVsdGEubGVmdCAqIDIgLSB3aWR0aCArIGFjdHVhbFdpZHRoIDogZGVsdGEudG9wICogMiAtIGhlaWdodCArIGFjdHVhbEhlaWdodFxcbiAgICB2YXIgYXJyb3dPZmZzZXRQb3NpdGlvbiA9IGlzVmVydGljYWwgPyAnb2Zmc2V0V2lkdGgnIDogJ29mZnNldEhlaWdodCdcXG5cXG4gICAgJHRpcC5vZmZzZXQob2Zmc2V0KVxcbiAgICB0aGlzLnJlcGxhY2VBcnJvdyhhcnJvd0RlbHRhLCAkdGlwWzBdW2Fycm93T2Zmc2V0UG9zaXRpb25dLCBpc1ZlcnRpY2FsKVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUucmVwbGFjZUFycm93ID0gZnVuY3Rpb24gKGRlbHRhLCBkaW1lbnNpb24sIGlzVmVydGljYWwpIHtcXG4gICAgdGhpcy5hcnJvdygpXFxuICAgICAgLmNzcyhpc1ZlcnRpY2FsID8gJ2xlZnQnIDogJ3RvcCcsIDUwICogKDEgLSBkZWx0YSAvIGRpbWVuc2lvbikgKyAnJScpXFxuICAgICAgLmNzcyhpc1ZlcnRpY2FsID8gJ3RvcCcgOiAnbGVmdCcsICcnKVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuc2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyICR0aXAgID0gdGhpcy50aXAoKVxcbiAgICB2YXIgdGl0bGUgPSB0aGlzLmdldFRpdGxlKClcXG5cXG4gICAgJHRpcC5maW5kKCcudG9vbHRpcC1pbm5lcicpW3RoaXMub3B0aW9ucy5odG1sID8gJ2h0bWwnIDogJ3RleHQnXSh0aXRsZSlcXG4gICAgJHRpcC5yZW1vdmVDbGFzcygnZmFkZSBpbiB0b3AgYm90dG9tIGxlZnQgcmlnaHQnKVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xcbiAgICB2YXIgdGhhdCA9IHRoaXNcXG4gICAgdmFyICR0aXAgPSAkKHRoaXMuJHRpcClcXG4gICAgdmFyIGUgICAgPSAkLkV2ZW50KCdoaWRlLmJzLicgKyB0aGlzLnR5cGUpXFxuXFxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlKCkge1xcbiAgICAgIGlmICh0aGF0LmhvdmVyU3RhdGUgIT0gJ2luJykgJHRpcC5kZXRhY2goKVxcbiAgICAgIGlmICh0aGF0LiRlbGVtZW50KSB7IC8vIFRPRE86IENoZWNrIHdoZXRoZXIgZ3VhcmRpbmcgdGhpcyBjb2RlIHdpdGggdGhpcyBgaWZgIGlzIHJlYWxseSBuZWNlc3NhcnkuXFxuICAgICAgICB0aGF0LiRlbGVtZW50XFxuICAgICAgICAgIC5yZW1vdmVBdHRyKCdhcmlhLWRlc2NyaWJlZGJ5JylcXG4gICAgICAgICAgLnRyaWdnZXIoJ2hpZGRlbi5icy4nICsgdGhhdC50eXBlKVxcbiAgICAgIH1cXG4gICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpXFxuICAgIH1cXG5cXG4gICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKGUpXFxuXFxuICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cXG5cXG4gICAgJHRpcC5yZW1vdmVDbGFzcygnaW4nKVxcblxcbiAgICAkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiAkdGlwLmhhc0NsYXNzKCdmYWRlJykgP1xcbiAgICAgICR0aXBcXG4gICAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIGNvbXBsZXRlKVxcbiAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKFRvb2x0aXAuVFJBTlNJVElPTl9EVVJBVElPTikgOlxcbiAgICAgIGNvbXBsZXRlKClcXG5cXG4gICAgdGhpcy5ob3ZlclN0YXRlID0gbnVsbFxcblxcbiAgICByZXR1cm4gdGhpc1xcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZml4VGl0bGUgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciAkZSA9IHRoaXMuJGVsZW1lbnRcXG4gICAgaWYgKCRlLmF0dHIoJ3RpdGxlJykgfHwgdHlwZW9mICRlLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKSAhPSAnc3RyaW5nJykge1xcbiAgICAgICRlLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLCAkZS5hdHRyKCd0aXRsZScpIHx8ICcnKS5hdHRyKCd0aXRsZScsICcnKVxcbiAgICB9XFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5oYXNDb250ZW50ID0gZnVuY3Rpb24gKCkge1xcbiAgICByZXR1cm4gdGhpcy5nZXRUaXRsZSgpXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgkZWxlbWVudCkge1xcbiAgICAkZWxlbWVudCAgID0gJGVsZW1lbnQgfHwgdGhpcy4kZWxlbWVudFxcblxcbiAgICB2YXIgZWwgICAgID0gJGVsZW1lbnRbMF1cXG4gICAgdmFyIGlzQm9keSA9IGVsLnRhZ05hbWUgPT0gJ0JPRFknXFxuXFxuICAgIHZhciBlbFJlY3QgICAgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxcbiAgICBpZiAoZWxSZWN0LndpZHRoID09IG51bGwpIHtcXG4gICAgICAvLyB3aWR0aCBhbmQgaGVpZ2h0IGFyZSBtaXNzaW5nIGluIElFOCwgc28gY29tcHV0ZSB0aGVtIG1hbnVhbGx5OyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2lzc3Vlcy8xNDA5M1xcbiAgICAgIGVsUmVjdCA9ICQuZXh0ZW5kKHt9LCBlbFJlY3QsIHsgd2lkdGg6IGVsUmVjdC5yaWdodCAtIGVsUmVjdC5sZWZ0LCBoZWlnaHQ6IGVsUmVjdC5ib3R0b20gLSBlbFJlY3QudG9wIH0pXFxuICAgIH1cXG4gICAgdmFyIGlzU3ZnID0gd2luZG93LlNWR0VsZW1lbnQgJiYgZWwgaW5zdGFuY2VvZiB3aW5kb3cuU1ZHRWxlbWVudFxcbiAgICAvLyBBdm9pZCB1c2luZyAkLm9mZnNldCgpIG9uIFNWR3Mgc2luY2UgaXQgZ2l2ZXMgaW5jb3JyZWN0IHJlc3VsdHMgaW4galF1ZXJ5IDMuXFxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvaXNzdWVzLzIwMjgwXFxuICAgIHZhciBlbE9mZnNldCAgPSBpc0JvZHkgPyB7IHRvcDogMCwgbGVmdDogMCB9IDogKGlzU3ZnID8gbnVsbCA6ICRlbGVtZW50Lm9mZnNldCgpKVxcbiAgICB2YXIgc2Nyb2xsICAgID0geyBzY3JvbGw6IGlzQm9keSA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgOiAkZWxlbWVudC5zY3JvbGxUb3AoKSB9XFxuICAgIHZhciBvdXRlckRpbXMgPSBpc0JvZHkgPyB7IHdpZHRoOiAkKHdpbmRvdykud2lkdGgoKSwgaGVpZ2h0OiAkKHdpbmRvdykuaGVpZ2h0KCkgfSA6IG51bGxcXG5cXG4gICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBlbFJlY3QsIHNjcm9sbCwgb3V0ZXJEaW1zLCBlbE9mZnNldClcXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLmdldENhbGN1bGF0ZWRPZmZzZXQgPSBmdW5jdGlvbiAocGxhY2VtZW50LCBwb3MsIGFjdHVhbFdpZHRoLCBhY3R1YWxIZWlnaHQpIHtcXG4gICAgcmV0dXJuIHBsYWNlbWVudCA9PSAnYm90dG9tJyA/IHsgdG9wOiBwb3MudG9wICsgcG9zLmhlaWdodCwgICBsZWZ0OiBwb3MubGVmdCArIHBvcy53aWR0aCAvIDIgLSBhY3R1YWxXaWR0aCAvIDIgfSA6XFxuICAgICAgICAgICBwbGFjZW1lbnQgPT0gJ3RvcCcgICAgPyB7IHRvcDogcG9zLnRvcCAtIGFjdHVhbEhlaWdodCwgbGVmdDogcG9zLmxlZnQgKyBwb3Mud2lkdGggLyAyIC0gYWN0dWFsV2lkdGggLyAyIH0gOlxcbiAgICAgICAgICAgcGxhY2VtZW50ID09ICdsZWZ0JyAgID8geyB0b3A6IHBvcy50b3AgKyBwb3MuaGVpZ2h0IC8gMiAtIGFjdHVhbEhlaWdodCAvIDIsIGxlZnQ6IHBvcy5sZWZ0IC0gYWN0dWFsV2lkdGggfSA6XFxuICAgICAgICAvKiBwbGFjZW1lbnQgPT0gJ3JpZ2h0JyAqLyB7IHRvcDogcG9zLnRvcCArIHBvcy5oZWlnaHQgLyAyIC0gYWN0dWFsSGVpZ2h0IC8gMiwgbGVmdDogcG9zLmxlZnQgKyBwb3Mud2lkdGggfVxcblxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0Vmlld3BvcnRBZGp1c3RlZERlbHRhID0gZnVuY3Rpb24gKHBsYWNlbWVudCwgcG9zLCBhY3R1YWxXaWR0aCwgYWN0dWFsSGVpZ2h0KSB7XFxuICAgIHZhciBkZWx0YSA9IHsgdG9wOiAwLCBsZWZ0OiAwIH1cXG4gICAgaWYgKCF0aGlzLiR2aWV3cG9ydCkgcmV0dXJuIGRlbHRhXFxuXFxuICAgIHZhciB2aWV3cG9ydFBhZGRpbmcgPSB0aGlzLm9wdGlvbnMudmlld3BvcnQgJiYgdGhpcy5vcHRpb25zLnZpZXdwb3J0LnBhZGRpbmcgfHwgMFxcbiAgICB2YXIgdmlld3BvcnREaW1lbnNpb25zID0gdGhpcy5nZXRQb3NpdGlvbih0aGlzLiR2aWV3cG9ydClcXG5cXG4gICAgaWYgKC9yaWdodHxsZWZ0Ly50ZXN0KHBsYWNlbWVudCkpIHtcXG4gICAgICB2YXIgdG9wRWRnZU9mZnNldCAgICA9IHBvcy50b3AgLSB2aWV3cG9ydFBhZGRpbmcgLSB2aWV3cG9ydERpbWVuc2lvbnMuc2Nyb2xsXFxuICAgICAgdmFyIGJvdHRvbUVkZ2VPZmZzZXQgPSBwb3MudG9wICsgdmlld3BvcnRQYWRkaW5nIC0gdmlld3BvcnREaW1lbnNpb25zLnNjcm9sbCArIGFjdHVhbEhlaWdodFxcbiAgICAgIGlmICh0b3BFZGdlT2Zmc2V0IDwgdmlld3BvcnREaW1lbnNpb25zLnRvcCkgeyAvLyB0b3Agb3ZlcmZsb3dcXG4gICAgICAgIGRlbHRhLnRvcCA9IHZpZXdwb3J0RGltZW5zaW9ucy50b3AgLSB0b3BFZGdlT2Zmc2V0XFxuICAgICAgfSBlbHNlIGlmIChib3R0b21FZGdlT2Zmc2V0ID4gdmlld3BvcnREaW1lbnNpb25zLnRvcCArIHZpZXdwb3J0RGltZW5zaW9ucy5oZWlnaHQpIHsgLy8gYm90dG9tIG92ZXJmbG93XFxuICAgICAgICBkZWx0YS50b3AgPSB2aWV3cG9ydERpbWVuc2lvbnMudG9wICsgdmlld3BvcnREaW1lbnNpb25zLmhlaWdodCAtIGJvdHRvbUVkZ2VPZmZzZXRcXG4gICAgICB9XFxuICAgIH0gZWxzZSB7XFxuICAgICAgdmFyIGxlZnRFZGdlT2Zmc2V0ICA9IHBvcy5sZWZ0IC0gdmlld3BvcnRQYWRkaW5nXFxuICAgICAgdmFyIHJpZ2h0RWRnZU9mZnNldCA9IHBvcy5sZWZ0ICsgdmlld3BvcnRQYWRkaW5nICsgYWN0dWFsV2lkdGhcXG4gICAgICBpZiAobGVmdEVkZ2VPZmZzZXQgPCB2aWV3cG9ydERpbWVuc2lvbnMubGVmdCkgeyAvLyBsZWZ0IG92ZXJmbG93XFxuICAgICAgICBkZWx0YS5sZWZ0ID0gdmlld3BvcnREaW1lbnNpb25zLmxlZnQgLSBsZWZ0RWRnZU9mZnNldFxcbiAgICAgIH0gZWxzZSBpZiAocmlnaHRFZGdlT2Zmc2V0ID4gdmlld3BvcnREaW1lbnNpb25zLnJpZ2h0KSB7IC8vIHJpZ2h0IG92ZXJmbG93XFxuICAgICAgICBkZWx0YS5sZWZ0ID0gdmlld3BvcnREaW1lbnNpb25zLmxlZnQgKyB2aWV3cG9ydERpbWVuc2lvbnMud2lkdGggLSByaWdodEVkZ2VPZmZzZXRcXG4gICAgICB9XFxuICAgIH1cXG5cXG4gICAgcmV0dXJuIGRlbHRhXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5nZXRUaXRsZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyIHRpdGxlXFxuICAgIHZhciAkZSA9IHRoaXMuJGVsZW1lbnRcXG4gICAgdmFyIG8gID0gdGhpcy5vcHRpb25zXFxuXFxuICAgIHRpdGxlID0gJGUuYXR0cignZGF0YS1vcmlnaW5hbC10aXRsZScpXFxuICAgICAgfHwgKHR5cGVvZiBvLnRpdGxlID09ICdmdW5jdGlvbicgPyBvLnRpdGxlLmNhbGwoJGVbMF0pIDogIG8udGl0bGUpXFxuXFxuICAgIHJldHVybiB0aXRsZVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0VUlEID0gZnVuY3Rpb24gKHByZWZpeCkge1xcbiAgICBkbyBwcmVmaXggKz0gfn4oTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApXFxuICAgIHdoaWxlIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcmVmaXgpKVxcbiAgICByZXR1cm4gcHJlZml4XFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS50aXAgPSBmdW5jdGlvbiAoKSB7XFxuICAgIGlmICghdGhpcy4kdGlwKSB7XFxuICAgICAgdGhpcy4kdGlwID0gJCh0aGlzLm9wdGlvbnMudGVtcGxhdGUpXFxuICAgICAgaWYgKHRoaXMuJHRpcC5sZW5ndGggIT0gMSkge1xcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMudHlwZSArICcgYHRlbXBsYXRlYCBvcHRpb24gbXVzdCBjb25zaXN0IG9mIGV4YWN0bHkgMSB0b3AtbGV2ZWwgZWxlbWVudCEnKVxcbiAgICAgIH1cXG4gICAgfVxcbiAgICByZXR1cm4gdGhpcy4kdGlwXFxuICB9XFxuXFxuICBUb29sdGlwLnByb3RvdHlwZS5hcnJvdyA9IGZ1bmN0aW9uICgpIHtcXG4gICAgcmV0dXJuICh0aGlzLiRhcnJvdyA9IHRoaXMuJGFycm93IHx8IHRoaXMudGlwKCkuZmluZCgnLnRvb2x0aXAtYXJyb3cnKSlcXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdGhpcy5lbmFibGVkID0gdHJ1ZVxcbiAgfVxcblxcbiAgVG9vbHRpcC5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2VcXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLnRvZ2dsZUVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHRoaXMuZW5hYmxlZCA9ICF0aGlzLmVuYWJsZWRcXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIChlKSB7XFxuICAgIHZhciBzZWxmID0gdGhpc1xcbiAgICBpZiAoZSkge1xcbiAgICAgIHNlbGYgPSAkKGUuY3VycmVudFRhcmdldCkuZGF0YSgnYnMuJyArIHRoaXMudHlwZSlcXG4gICAgICBpZiAoIXNlbGYpIHtcXG4gICAgICAgIHNlbGYgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihlLmN1cnJlbnRUYXJnZXQsIHRoaXMuZ2V0RGVsZWdhdGVPcHRpb25zKCkpXFxuICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuZGF0YSgnYnMuJyArIHRoaXMudHlwZSwgc2VsZilcXG4gICAgICB9XFxuICAgIH1cXG5cXG4gICAgaWYgKGUpIHtcXG4gICAgICBzZWxmLmluU3RhdGUuY2xpY2sgPSAhc2VsZi5pblN0YXRlLmNsaWNrXFxuICAgICAgaWYgKHNlbGYuaXNJblN0YXRlVHJ1ZSgpKSBzZWxmLmVudGVyKHNlbGYpXFxuICAgICAgZWxzZSBzZWxmLmxlYXZlKHNlbGYpXFxuICAgIH0gZWxzZSB7XFxuICAgICAgc2VsZi50aXAoKS5oYXNDbGFzcygnaW4nKSA/IHNlbGYubGVhdmUoc2VsZikgOiBzZWxmLmVudGVyKHNlbGYpXFxuICAgIH1cXG4gIH1cXG5cXG4gIFRvb2x0aXAucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciB0aGF0ID0gdGhpc1xcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KVxcbiAgICB0aGlzLmhpZGUoZnVuY3Rpb24gKCkge1xcbiAgICAgIHRoYXQuJGVsZW1lbnQub2ZmKCcuJyArIHRoYXQudHlwZSkucmVtb3ZlRGF0YSgnYnMuJyArIHRoYXQudHlwZSlcXG4gICAgICBpZiAodGhhdC4kdGlwKSB7XFxuICAgICAgICB0aGF0LiR0aXAuZGV0YWNoKClcXG4gICAgICB9XFxuICAgICAgdGhhdC4kdGlwID0gbnVsbFxcbiAgICAgIHRoYXQuJGFycm93ID0gbnVsbFxcbiAgICAgIHRoYXQuJHZpZXdwb3J0ID0gbnVsbFxcbiAgICAgIHRoYXQuJGVsZW1lbnQgPSBudWxsXFxuICAgIH0pXFxuICB9XFxuXFxuXFxuICAvLyBUT09MVElQIFBMVUdJTiBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XFxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMudG9vbHRpcCcpXFxuICAgICAgdmFyIG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9uID09ICdvYmplY3QnICYmIG9wdGlvblxcblxcbiAgICAgIGlmICghZGF0YSAmJiAvZGVzdHJveXxoaWRlLy50ZXN0KG9wdGlvbikpIHJldHVyblxcbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMudG9vbHRpcCcsIChkYXRhID0gbmV3IFRvb2x0aXAodGhpcywgb3B0aW9ucykpKVxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4udG9vbHRpcFxcblxcbiAgJC5mbi50b29sdGlwICAgICAgICAgICAgID0gUGx1Z2luXFxuICAkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IgPSBUb29sdGlwXFxuXFxuXFxuICAvLyBUT09MVElQIE5PIENPTkZMSUNUXFxuICAvLyA9PT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLnRvb2x0aXAubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcXG4gICAgJC5mbi50b29sdGlwID0gb2xkXFxuICAgIHJldHVybiB0aGlzXFxuICB9XFxuXFxufShqUXVlcnkpO1xcblxcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIEJvb3RzdHJhcDogcG9wb3Zlci5qcyB2My4zLjdcXG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNwb3BvdmVyc1xcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXFxuXFxuXFxuK2Z1bmN0aW9uICgkKSB7XFxuICAndXNlIHN0cmljdCc7XFxuXFxuICAvLyBQT1BPVkVSIFBVQkxJQyBDTEFTUyBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgUG9wb3ZlciA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XFxuICAgIHRoaXMuaW5pdCgncG9wb3ZlcicsIGVsZW1lbnQsIG9wdGlvbnMpXFxuICB9XFxuXFxuICBpZiAoISQuZm4udG9vbHRpcCkgdGhyb3cgbmV3IEVycm9yKCdQb3BvdmVyIHJlcXVpcmVzIHRvb2x0aXAuanMnKVxcblxcbiAgUG9wb3Zlci5WRVJTSU9OICA9ICczLjMuNydcXG5cXG4gIFBvcG92ZXIuREVGQVVMVFMgPSAkLmV4dGVuZCh7fSwgJC5mbi50b29sdGlwLkNvbnN0cnVjdG9yLkRFRkFVTFRTLCB7XFxuICAgIHBsYWNlbWVudDogJ3JpZ2h0JyxcXG4gICAgdHJpZ2dlcjogJ2NsaWNrJyxcXG4gICAgY29udGVudDogJycsXFxuICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cXFwicG9wb3ZlclxcXCIgcm9sZT1cXFwidG9vbHRpcFxcXCI+PGRpdiBjbGFzcz1cXFwiYXJyb3dcXFwiPjwvZGl2PjxoMyBjbGFzcz1cXFwicG9wb3Zlci10aXRsZVxcXCI+PC9oMz48ZGl2IGNsYXNzPVxcXCJwb3BvdmVyLWNvbnRlbnRcXFwiPjwvZGl2PjwvZGl2PidcXG4gIH0pXFxuXFxuXFxuICAvLyBOT1RFOiBQT1BPVkVSIEVYVEVORFMgdG9vbHRpcC5qc1xcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG5cXG4gIFBvcG92ZXIucHJvdG90eXBlID0gJC5leHRlbmQoe30sICQuZm4udG9vbHRpcC5Db25zdHJ1Y3Rvci5wcm90b3R5cGUpXFxuXFxuICBQb3BvdmVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBvcG92ZXJcXG5cXG4gIFBvcG92ZXIucHJvdG90eXBlLmdldERlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xcbiAgICByZXR1cm4gUG9wb3Zlci5ERUZBVUxUU1xcbiAgfVxcblxcbiAgUG9wb3Zlci5wcm90b3R5cGUuc2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyICR0aXAgICAgPSB0aGlzLnRpcCgpXFxuICAgIHZhciB0aXRsZSAgID0gdGhpcy5nZXRUaXRsZSgpXFxuICAgIHZhciBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50KClcXG5cXG4gICAgJHRpcC5maW5kKCcucG9wb3Zlci10aXRsZScpW3RoaXMub3B0aW9ucy5odG1sID8gJ2h0bWwnIDogJ3RleHQnXSh0aXRsZSlcXG4gICAgJHRpcC5maW5kKCcucG9wb3Zlci1jb250ZW50JykuY2hpbGRyZW4oKS5kZXRhY2goKS5lbmQoKVsgLy8gd2UgdXNlIGFwcGVuZCBmb3IgaHRtbCBvYmplY3RzIHRvIG1haW50YWluIGpzIGV2ZW50c1xcbiAgICAgIHRoaXMub3B0aW9ucy5odG1sID8gKHR5cGVvZiBjb250ZW50ID09ICdzdHJpbmcnID8gJ2h0bWwnIDogJ2FwcGVuZCcpIDogJ3RleHQnXFxuICAgIF0oY29udGVudClcXG5cXG4gICAgJHRpcC5yZW1vdmVDbGFzcygnZmFkZSB0b3AgYm90dG9tIGxlZnQgcmlnaHQgaW4nKVxcblxcbiAgICAvLyBJRTggZG9lc24ndCBhY2NlcHQgaGlkaW5nIHZpYSB0aGUgYDplbXB0eWAgcHNldWRvIHNlbGVjdG9yLCB3ZSBoYXZlIHRvIGRvXFxuICAgIC8vIHRoaXMgbWFudWFsbHkgYnkgY2hlY2tpbmcgdGhlIGNvbnRlbnRzLlxcbiAgICBpZiAoISR0aXAuZmluZCgnLnBvcG92ZXItdGl0bGUnKS5odG1sKCkpICR0aXAuZmluZCgnLnBvcG92ZXItdGl0bGUnKS5oaWRlKClcXG4gIH1cXG5cXG4gIFBvcG92ZXIucHJvdG90eXBlLmhhc0NvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHJldHVybiB0aGlzLmdldFRpdGxlKCkgfHwgdGhpcy5nZXRDb250ZW50KClcXG4gIH1cXG5cXG4gIFBvcG92ZXIucHJvdG90eXBlLmdldENvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciAkZSA9IHRoaXMuJGVsZW1lbnRcXG4gICAgdmFyIG8gID0gdGhpcy5vcHRpb25zXFxuXFxuICAgIHJldHVybiAkZS5hdHRyKCdkYXRhLWNvbnRlbnQnKVxcbiAgICAgIHx8ICh0eXBlb2Ygby5jb250ZW50ID09ICdmdW5jdGlvbicgP1xcbiAgICAgICAgICAgIG8uY29udGVudC5jYWxsKCRlWzBdKSA6XFxuICAgICAgICAgICAgby5jb250ZW50KVxcbiAgfVxcblxcbiAgUG9wb3Zlci5wcm90b3R5cGUuYXJyb3cgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHJldHVybiAodGhpcy4kYXJyb3cgPSB0aGlzLiRhcnJvdyB8fCB0aGlzLnRpcCgpLmZpbmQoJy5hcnJvdycpKVxcbiAgfVxcblxcblxcbiAgLy8gUE9QT1ZFUiBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbikge1xcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcXG4gICAgICB2YXIgZGF0YSAgICA9ICR0aGlzLmRhdGEoJ2JzLnBvcG92ZXInKVxcbiAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb25cXG5cXG4gICAgICBpZiAoIWRhdGEgJiYgL2Rlc3Ryb3l8aGlkZS8udGVzdChvcHRpb24pKSByZXR1cm5cXG4gICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2JzLnBvcG92ZXInLCAoZGF0YSA9IG5ldyBQb3BvdmVyKHRoaXMsIG9wdGlvbnMpKSlcXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcXG4gICAgfSlcXG4gIH1cXG5cXG4gIHZhciBvbGQgPSAkLmZuLnBvcG92ZXJcXG5cXG4gICQuZm4ucG9wb3ZlciAgICAgICAgICAgICA9IFBsdWdpblxcbiAgJC5mbi5wb3BvdmVyLkNvbnN0cnVjdG9yID0gUG9wb3ZlclxcblxcblxcbiAgLy8gUE9QT1ZFUiBOTyBDT05GTElDVFxcbiAgLy8gPT09PT09PT09PT09PT09PT09PVxcblxcbiAgJC5mbi5wb3BvdmVyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XFxuICAgICQuZm4ucG9wb3ZlciA9IG9sZFxcbiAgICByZXR1cm4gdGhpc1xcbiAgfVxcblxcbn0oalF1ZXJ5KTtcXG5cXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBCb290c3RyYXA6IHNjcm9sbHNweS5qcyB2My4zLjdcXG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNzY3JvbGxzcHlcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gU0NST0xMU1BZIENMQVNTIERFRklOSVRJT05cXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICBmdW5jdGlvbiBTY3JvbGxTcHkoZWxlbWVudCwgb3B0aW9ucykge1xcbiAgICB0aGlzLiRib2R5ICAgICAgICAgID0gJChkb2N1bWVudC5ib2R5KVxcbiAgICB0aGlzLiRzY3JvbGxFbGVtZW50ID0gJChlbGVtZW50KS5pcyhkb2N1bWVudC5ib2R5KSA/ICQod2luZG93KSA6ICQoZWxlbWVudClcXG4gICAgdGhpcy5vcHRpb25zICAgICAgICA9ICQuZXh0ZW5kKHt9LCBTY3JvbGxTcHkuREVGQVVMVFMsIG9wdGlvbnMpXFxuICAgIHRoaXMuc2VsZWN0b3IgICAgICAgPSAodGhpcy5vcHRpb25zLnRhcmdldCB8fCAnJykgKyAnIC5uYXYgbGkgPiBhJ1xcbiAgICB0aGlzLm9mZnNldHMgICAgICAgID0gW11cXG4gICAgdGhpcy50YXJnZXRzICAgICAgICA9IFtdXFxuICAgIHRoaXMuYWN0aXZlVGFyZ2V0ICAgPSBudWxsXFxuICAgIHRoaXMuc2Nyb2xsSGVpZ2h0ICAgPSAwXFxuXFxuICAgIHRoaXMuJHNjcm9sbEVsZW1lbnQub24oJ3Njcm9sbC5icy5zY3JvbGxzcHknLCAkLnByb3h5KHRoaXMucHJvY2VzcywgdGhpcykpXFxuICAgIHRoaXMucmVmcmVzaCgpXFxuICAgIHRoaXMucHJvY2VzcygpXFxuICB9XFxuXFxuICBTY3JvbGxTcHkuVkVSU0lPTiAgPSAnMy4zLjcnXFxuXFxuICBTY3JvbGxTcHkuREVGQVVMVFMgPSB7XFxuICAgIG9mZnNldDogMTBcXG4gIH1cXG5cXG4gIFNjcm9sbFNweS5wcm90b3R5cGUuZ2V0U2Nyb2xsSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xcbiAgICByZXR1cm4gdGhpcy4kc2Nyb2xsRWxlbWVudFswXS5zY3JvbGxIZWlnaHQgfHwgTWF0aC5tYXgodGhpcy4kYm9keVswXS5zY3JvbGxIZWlnaHQsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQpXFxuICB9XFxuXFxuICBTY3JvbGxTcHkucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciB0aGF0ICAgICAgICAgID0gdGhpc1xcbiAgICB2YXIgb2Zmc2V0TWV0aG9kICA9ICdvZmZzZXQnXFxuICAgIHZhciBvZmZzZXRCYXNlICAgID0gMFxcblxcbiAgICB0aGlzLm9mZnNldHMgICAgICA9IFtdXFxuICAgIHRoaXMudGFyZ2V0cyAgICAgID0gW11cXG4gICAgdGhpcy5zY3JvbGxIZWlnaHQgPSB0aGlzLmdldFNjcm9sbEhlaWdodCgpXFxuXFxuICAgIGlmICghJC5pc1dpbmRvdyh0aGlzLiRzY3JvbGxFbGVtZW50WzBdKSkge1xcbiAgICAgIG9mZnNldE1ldGhvZCA9ICdwb3NpdGlvbidcXG4gICAgICBvZmZzZXRCYXNlICAgPSB0aGlzLiRzY3JvbGxFbGVtZW50LnNjcm9sbFRvcCgpXFxuICAgIH1cXG5cXG4gICAgdGhpcy4kYm9keVxcbiAgICAgIC5maW5kKHRoaXMuc2VsZWN0b3IpXFxuICAgICAgLm1hcChmdW5jdGlvbiAoKSB7XFxuICAgICAgICB2YXIgJGVsICAgPSAkKHRoaXMpXFxuICAgICAgICB2YXIgaHJlZiAgPSAkZWwuZGF0YSgndGFyZ2V0JykgfHwgJGVsLmF0dHIoJ2hyZWYnKVxcbiAgICAgICAgdmFyICRocmVmID0gL14jLi8udGVzdChocmVmKSAmJiAkKGhyZWYpXFxuXFxuICAgICAgICByZXR1cm4gKCRocmVmXFxuICAgICAgICAgICYmICRocmVmLmxlbmd0aFxcbiAgICAgICAgICAmJiAkaHJlZi5pcygnOnZpc2libGUnKVxcbiAgICAgICAgICAmJiBbWyRocmVmW29mZnNldE1ldGhvZF0oKS50b3AgKyBvZmZzZXRCYXNlLCBocmVmXV0pIHx8IG51bGxcXG4gICAgICB9KVxcbiAgICAgIC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhWzBdIC0gYlswXSB9KVxcbiAgICAgIC5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICAgIHRoYXQub2Zmc2V0cy5wdXNoKHRoaXNbMF0pXFxuICAgICAgICB0aGF0LnRhcmdldHMucHVzaCh0aGlzWzFdKVxcbiAgICAgIH0pXFxuICB9XFxuXFxuICBTY3JvbGxTcHkucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoKSB7XFxuICAgIHZhciBzY3JvbGxUb3AgICAgPSB0aGlzLiRzY3JvbGxFbGVtZW50LnNjcm9sbFRvcCgpICsgdGhpcy5vcHRpb25zLm9mZnNldFxcbiAgICB2YXIgc2Nyb2xsSGVpZ2h0ID0gdGhpcy5nZXRTY3JvbGxIZWlnaHQoKVxcbiAgICB2YXIgbWF4U2Nyb2xsICAgID0gdGhpcy5vcHRpb25zLm9mZnNldCArIHNjcm9sbEhlaWdodCAtIHRoaXMuJHNjcm9sbEVsZW1lbnQuaGVpZ2h0KClcXG4gICAgdmFyIG9mZnNldHMgICAgICA9IHRoaXMub2Zmc2V0c1xcbiAgICB2YXIgdGFyZ2V0cyAgICAgID0gdGhpcy50YXJnZXRzXFxuICAgIHZhciBhY3RpdmVUYXJnZXQgPSB0aGlzLmFjdGl2ZVRhcmdldFxcbiAgICB2YXIgaVxcblxcbiAgICBpZiAodGhpcy5zY3JvbGxIZWlnaHQgIT0gc2Nyb2xsSGVpZ2h0KSB7XFxuICAgICAgdGhpcy5yZWZyZXNoKClcXG4gICAgfVxcblxcbiAgICBpZiAoc2Nyb2xsVG9wID49IG1heFNjcm9sbCkge1xcbiAgICAgIHJldHVybiBhY3RpdmVUYXJnZXQgIT0gKGkgPSB0YXJnZXRzW3RhcmdldHMubGVuZ3RoIC0gMV0pICYmIHRoaXMuYWN0aXZhdGUoaSlcXG4gICAgfVxcblxcbiAgICBpZiAoYWN0aXZlVGFyZ2V0ICYmIHNjcm9sbFRvcCA8IG9mZnNldHNbMF0pIHtcXG4gICAgICB0aGlzLmFjdGl2ZVRhcmdldCA9IG51bGxcXG4gICAgICByZXR1cm4gdGhpcy5jbGVhcigpXFxuICAgIH1cXG5cXG4gICAgZm9yIChpID0gb2Zmc2V0cy5sZW5ndGg7IGktLTspIHtcXG4gICAgICBhY3RpdmVUYXJnZXQgIT0gdGFyZ2V0c1tpXVxcbiAgICAgICAgJiYgc2Nyb2xsVG9wID49IG9mZnNldHNbaV1cXG4gICAgICAgICYmIChvZmZzZXRzW2kgKyAxXSA9PT0gdW5kZWZpbmVkIHx8IHNjcm9sbFRvcCA8IG9mZnNldHNbaSArIDFdKVxcbiAgICAgICAgJiYgdGhpcy5hY3RpdmF0ZSh0YXJnZXRzW2ldKVxcbiAgICB9XFxuICB9XFxuXFxuICBTY3JvbGxTcHkucHJvdG90eXBlLmFjdGl2YXRlID0gZnVuY3Rpb24gKHRhcmdldCkge1xcbiAgICB0aGlzLmFjdGl2ZVRhcmdldCA9IHRhcmdldFxcblxcbiAgICB0aGlzLmNsZWFyKClcXG5cXG4gICAgdmFyIHNlbGVjdG9yID0gdGhpcy5zZWxlY3RvciArXFxuICAgICAgJ1tkYXRhLXRhcmdldD1cXFwiJyArIHRhcmdldCArICdcXFwiXSwnICtcXG4gICAgICB0aGlzLnNlbGVjdG9yICsgJ1tocmVmPVxcXCInICsgdGFyZ2V0ICsgJ1xcXCJdJ1xcblxcbiAgICB2YXIgYWN0aXZlID0gJChzZWxlY3RvcilcXG4gICAgICAucGFyZW50cygnbGknKVxcbiAgICAgIC5hZGRDbGFzcygnYWN0aXZlJylcXG5cXG4gICAgaWYgKGFjdGl2ZS5wYXJlbnQoJy5kcm9wZG93bi1tZW51JykubGVuZ3RoKSB7XFxuICAgICAgYWN0aXZlID0gYWN0aXZlXFxuICAgICAgICAuY2xvc2VzdCgnbGkuZHJvcGRvd24nKVxcbiAgICAgICAgLmFkZENsYXNzKCdhY3RpdmUnKVxcbiAgICB9XFxuXFxuICAgIGFjdGl2ZS50cmlnZ2VyKCdhY3RpdmF0ZS5icy5zY3JvbGxzcHknKVxcbiAgfVxcblxcbiAgU2Nyb2xsU3B5LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcXG4gICAgJCh0aGlzLnNlbGVjdG9yKVxcbiAgICAgIC5wYXJlbnRzVW50aWwodGhpcy5vcHRpb25zLnRhcmdldCwgJy5hY3RpdmUnKVxcbiAgICAgIC5yZW1vdmVDbGFzcygnYWN0aXZlJylcXG4gIH1cXG5cXG5cXG4gIC8vIFNDUk9MTFNQWSBQTFVHSU4gREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuXFxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XFxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuc2Nyb2xsc3B5JylcXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXFxuXFxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5zY3JvbGxzcHknLCAoZGF0YSA9IG5ldyBTY3JvbGxTcHkodGhpcywgb3B0aW9ucykpKVxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4uc2Nyb2xsc3B5XFxuXFxuICAkLmZuLnNjcm9sbHNweSAgICAgICAgICAgICA9IFBsdWdpblxcbiAgJC5mbi5zY3JvbGxzcHkuQ29uc3RydWN0b3IgPSBTY3JvbGxTcHlcXG5cXG5cXG4gIC8vIFNDUk9MTFNQWSBOTyBDT05GTElDVFxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLnNjcm9sbHNweS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLnNjcm9sbHNweSA9IG9sZFxcbiAgICByZXR1cm4gdGhpc1xcbiAgfVxcblxcblxcbiAgLy8gU0NST0xMU1BZIERBVEEtQVBJXFxuICAvLyA9PT09PT09PT09PT09PT09PT1cXG5cXG4gICQod2luZG93KS5vbignbG9hZC5icy5zY3JvbGxzcHkuZGF0YS1hcGknLCBmdW5jdGlvbiAoKSB7XFxuICAgICQoJ1tkYXRhLXNweT1cXFwic2Nyb2xsXFxcIl0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICB2YXIgJHNweSA9ICQodGhpcylcXG4gICAgICBQbHVnaW4uY2FsbCgkc3B5LCAkc3B5LmRhdGEoKSlcXG4gICAgfSlcXG4gIH0pXFxuXFxufShqUXVlcnkpO1xcblxcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIEJvb3RzdHJhcDogdGFiLmpzIHYzLjMuN1xcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI3RhYnNcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gVEFCIENMQVNTIERFRklOSVRJT05cXG4gIC8vID09PT09PT09PT09PT09PT09PT09XFxuXFxuICB2YXIgVGFiID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcXG4gICAgLy8ganNjczpkaXNhYmxlIHJlcXVpcmVEb2xsYXJCZWZvcmVqUXVlcnlBc3NpZ25tZW50XFxuICAgIHRoaXMuZWxlbWVudCA9ICQoZWxlbWVudClcXG4gICAgLy8ganNjczplbmFibGUgcmVxdWlyZURvbGxhckJlZm9yZWpRdWVyeUFzc2lnbm1lbnRcXG4gIH1cXG5cXG4gIFRhYi5WRVJTSU9OID0gJzMuMy43J1xcblxcbiAgVGFiLlRSQU5TSVRJT05fRFVSQVRJT04gPSAxNTBcXG5cXG4gIFRhYi5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcXG4gICAgdmFyICR0aGlzICAgID0gdGhpcy5lbGVtZW50XFxuICAgIHZhciAkdWwgICAgICA9ICR0aGlzLmNsb3Nlc3QoJ3VsOm5vdCguZHJvcGRvd24tbWVudSknKVxcbiAgICB2YXIgc2VsZWN0b3IgPSAkdGhpcy5kYXRhKCd0YXJnZXQnKVxcblxcbiAgICBpZiAoIXNlbGVjdG9yKSB7XFxuICAgICAgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdocmVmJylcXG4gICAgICBzZWxlY3RvciA9IHNlbGVjdG9yICYmIHNlbGVjdG9yLnJlcGxhY2UoLy4qKD89I1teXFxcXHNdKiQpLywgJycpIC8vIHN0cmlwIGZvciBpZTdcXG4gICAgfVxcblxcbiAgICBpZiAoJHRoaXMucGFyZW50KCdsaScpLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuXFxuXFxuICAgIHZhciAkcHJldmlvdXMgPSAkdWwuZmluZCgnLmFjdGl2ZTpsYXN0IGEnKVxcbiAgICB2YXIgaGlkZUV2ZW50ID0gJC5FdmVudCgnaGlkZS5icy50YWInLCB7XFxuICAgICAgcmVsYXRlZFRhcmdldDogJHRoaXNbMF1cXG4gICAgfSlcXG4gICAgdmFyIHNob3dFdmVudCA9ICQuRXZlbnQoJ3Nob3cuYnMudGFiJywge1xcbiAgICAgIHJlbGF0ZWRUYXJnZXQ6ICRwcmV2aW91c1swXVxcbiAgICB9KVxcblxcbiAgICAkcHJldmlvdXMudHJpZ2dlcihoaWRlRXZlbnQpXFxuICAgICR0aGlzLnRyaWdnZXIoc2hvd0V2ZW50KVxcblxcbiAgICBpZiAoc2hvd0V2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpIHx8IGhpZGVFdmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXFxuXFxuICAgIHZhciAkdGFyZ2V0ID0gJChzZWxlY3RvcilcXG5cXG4gICAgdGhpcy5hY3RpdmF0ZSgkdGhpcy5jbG9zZXN0KCdsaScpLCAkdWwpXFxuICAgIHRoaXMuYWN0aXZhdGUoJHRhcmdldCwgJHRhcmdldC5wYXJlbnQoKSwgZnVuY3Rpb24gKCkge1xcbiAgICAgICRwcmV2aW91cy50cmlnZ2VyKHtcXG4gICAgICAgIHR5cGU6ICdoaWRkZW4uYnMudGFiJyxcXG4gICAgICAgIHJlbGF0ZWRUYXJnZXQ6ICR0aGlzWzBdXFxuICAgICAgfSlcXG4gICAgICAkdGhpcy50cmlnZ2VyKHtcXG4gICAgICAgIHR5cGU6ICdzaG93bi5icy50YWInLFxcbiAgICAgICAgcmVsYXRlZFRhcmdldDogJHByZXZpb3VzWzBdXFxuICAgICAgfSlcXG4gICAgfSlcXG4gIH1cXG5cXG4gIFRhYi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29udGFpbmVyLCBjYWxsYmFjaykge1xcbiAgICB2YXIgJGFjdGl2ZSAgICA9IGNvbnRhaW5lci5maW5kKCc+IC5hY3RpdmUnKVxcbiAgICB2YXIgdHJhbnNpdGlvbiA9IGNhbGxiYWNrXFxuICAgICAgJiYgJC5zdXBwb3J0LnRyYW5zaXRpb25cXG4gICAgICAmJiAoJGFjdGl2ZS5sZW5ndGggJiYgJGFjdGl2ZS5oYXNDbGFzcygnZmFkZScpIHx8ICEhY29udGFpbmVyLmZpbmQoJz4gLmZhZGUnKS5sZW5ndGgpXFxuXFxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XFxuICAgICAgJGFjdGl2ZVxcbiAgICAgICAgLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxcbiAgICAgICAgLmZpbmQoJz4gLmRyb3Bkb3duLW1lbnUgPiAuYWN0aXZlJylcXG4gICAgICAgICAgLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxcbiAgICAgICAgLmVuZCgpXFxuICAgICAgICAuZmluZCgnW2RhdGEtdG9nZ2xlPVxcXCJ0YWJcXFwiXScpXFxuICAgICAgICAgIC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpXFxuXFxuICAgICAgZWxlbWVudFxcbiAgICAgICAgLmFkZENsYXNzKCdhY3RpdmUnKVxcbiAgICAgICAgLmZpbmQoJ1tkYXRhLXRvZ2dsZT1cXFwidGFiXFxcIl0nKVxcbiAgICAgICAgICAuYXR0cignYXJpYS1leHBhbmRlZCcsIHRydWUpXFxuXFxuICAgICAgaWYgKHRyYW5zaXRpb24pIHtcXG4gICAgICAgIGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGggLy8gcmVmbG93IGZvciB0cmFuc2l0aW9uXFxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdpbicpXFxuICAgICAgfSBlbHNlIHtcXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZhZGUnKVxcbiAgICAgIH1cXG5cXG4gICAgICBpZiAoZWxlbWVudC5wYXJlbnQoJy5kcm9wZG93bi1tZW51JykubGVuZ3RoKSB7XFxuICAgICAgICBlbGVtZW50XFxuICAgICAgICAgIC5jbG9zZXN0KCdsaS5kcm9wZG93bicpXFxuICAgICAgICAgICAgLmFkZENsYXNzKCdhY3RpdmUnKVxcbiAgICAgICAgICAuZW5kKClcXG4gICAgICAgICAgLmZpbmQoJ1tkYXRhLXRvZ2dsZT1cXFwidGFiXFxcIl0nKVxcbiAgICAgICAgICAgIC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSlcXG4gICAgICB9XFxuXFxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKVxcbiAgICB9XFxuXFxuICAgICRhY3RpdmUubGVuZ3RoICYmIHRyYW5zaXRpb24gP1xcbiAgICAgICRhY3RpdmVcXG4gICAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIG5leHQpXFxuICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoVGFiLlRSQU5TSVRJT05fRFVSQVRJT04pIDpcXG4gICAgICBuZXh0KClcXG5cXG4gICAgJGFjdGl2ZS5yZW1vdmVDbGFzcygnaW4nKVxcbiAgfVxcblxcblxcbiAgLy8gVEFCIFBMVUdJTiBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT1cXG5cXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHtcXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKVxcbiAgICAgIHZhciBkYXRhICA9ICR0aGlzLmRhdGEoJ2JzLnRhYicpXFxuXFxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy50YWInLCAoZGF0YSA9IG5ldyBUYWIodGhpcykpKVxcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKVxcbiAgICB9KVxcbiAgfVxcblxcbiAgdmFyIG9sZCA9ICQuZm4udGFiXFxuXFxuICAkLmZuLnRhYiAgICAgICAgICAgICA9IFBsdWdpblxcbiAgJC5mbi50YWIuQ29uc3RydWN0b3IgPSBUYWJcXG5cXG5cXG4gIC8vIFRBQiBOTyBDT05GTElDVFxcbiAgLy8gPT09PT09PT09PT09PT09XFxuXFxuICAkLmZuLnRhYi5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLnRhYiA9IG9sZFxcbiAgICByZXR1cm4gdGhpc1xcbiAgfVxcblxcblxcbiAgLy8gVEFCIERBVEEtQVBJXFxuICAvLyA9PT09PT09PT09PT1cXG5cXG4gIHZhciBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xcbiAgICBlLnByZXZlbnREZWZhdWx0KClcXG4gICAgUGx1Z2luLmNhbGwoJCh0aGlzKSwgJ3Nob3cnKVxcbiAgfVxcblxcbiAgJChkb2N1bWVudClcXG4gICAgLm9uKCdjbGljay5icy50YWIuZGF0YS1hcGknLCAnW2RhdGEtdG9nZ2xlPVxcXCJ0YWJcXFwiXScsIGNsaWNrSGFuZGxlcilcXG4gICAgLm9uKCdjbGljay5icy50YWIuZGF0YS1hcGknLCAnW2RhdGEtdG9nZ2xlPVxcXCJwaWxsXFxcIl0nLCBjbGlja0hhbmRsZXIpXFxuXFxufShqUXVlcnkpO1xcblxcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcbiAqIEJvb3RzdHJhcDogYWZmaXguanMgdjMuMy43XFxuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jYWZmaXhcXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xcblxcblxcbitmdW5jdGlvbiAoJCkge1xcbiAgJ3VzZSBzdHJpY3QnO1xcblxcbiAgLy8gQUZGSVggQ0xBU1MgREVGSU5JVElPTlxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgdmFyIEFmZml4ID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcXG4gICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIEFmZml4LkRFRkFVTFRTLCBvcHRpb25zKVxcblxcbiAgICB0aGlzLiR0YXJnZXQgPSAkKHRoaXMub3B0aW9ucy50YXJnZXQpXFxuICAgICAgLm9uKCdzY3JvbGwuYnMuYWZmaXguZGF0YS1hcGknLCAkLnByb3h5KHRoaXMuY2hlY2tQb3NpdGlvbiwgdGhpcykpXFxuICAgICAgLm9uKCdjbGljay5icy5hZmZpeC5kYXRhLWFwaScsICAkLnByb3h5KHRoaXMuY2hlY2tQb3NpdGlvbldpdGhFdmVudExvb3AsIHRoaXMpKVxcblxcbiAgICB0aGlzLiRlbGVtZW50ICAgICA9ICQoZWxlbWVudClcXG4gICAgdGhpcy5hZmZpeGVkICAgICAgPSBudWxsXFxuICAgIHRoaXMudW5waW4gICAgICAgID0gbnVsbFxcbiAgICB0aGlzLnBpbm5lZE9mZnNldCA9IG51bGxcXG5cXG4gICAgdGhpcy5jaGVja1Bvc2l0aW9uKClcXG4gIH1cXG5cXG4gIEFmZml4LlZFUlNJT04gID0gJzMuMy43J1xcblxcbiAgQWZmaXguUkVTRVQgICAgPSAnYWZmaXggYWZmaXgtdG9wIGFmZml4LWJvdHRvbSdcXG5cXG4gIEFmZml4LkRFRkFVTFRTID0ge1xcbiAgICBvZmZzZXQ6IDAsXFxuICAgIHRhcmdldDogd2luZG93XFxuICB9XFxuXFxuICBBZmZpeC5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiAoc2Nyb2xsSGVpZ2h0LCBoZWlnaHQsIG9mZnNldFRvcCwgb2Zmc2V0Qm90dG9tKSB7XFxuICAgIHZhciBzY3JvbGxUb3AgICAgPSB0aGlzLiR0YXJnZXQuc2Nyb2xsVG9wKClcXG4gICAgdmFyIHBvc2l0aW9uICAgICA9IHRoaXMuJGVsZW1lbnQub2Zmc2V0KClcXG4gICAgdmFyIHRhcmdldEhlaWdodCA9IHRoaXMuJHRhcmdldC5oZWlnaHQoKVxcblxcbiAgICBpZiAob2Zmc2V0VG9wICE9IG51bGwgJiYgdGhpcy5hZmZpeGVkID09ICd0b3AnKSByZXR1cm4gc2Nyb2xsVG9wIDwgb2Zmc2V0VG9wID8gJ3RvcCcgOiBmYWxzZVxcblxcbiAgICBpZiAodGhpcy5hZmZpeGVkID09ICdib3R0b20nKSB7XFxuICAgICAgaWYgKG9mZnNldFRvcCAhPSBudWxsKSByZXR1cm4gKHNjcm9sbFRvcCArIHRoaXMudW5waW4gPD0gcG9zaXRpb24udG9wKSA/IGZhbHNlIDogJ2JvdHRvbSdcXG4gICAgICByZXR1cm4gKHNjcm9sbFRvcCArIHRhcmdldEhlaWdodCA8PSBzY3JvbGxIZWlnaHQgLSBvZmZzZXRCb3R0b20pID8gZmFsc2UgOiAnYm90dG9tJ1xcbiAgICB9XFxuXFxuICAgIHZhciBpbml0aWFsaXppbmcgICA9IHRoaXMuYWZmaXhlZCA9PSBudWxsXFxuICAgIHZhciBjb2xsaWRlclRvcCAgICA9IGluaXRpYWxpemluZyA/IHNjcm9sbFRvcCA6IHBvc2l0aW9uLnRvcFxcbiAgICB2YXIgY29sbGlkZXJIZWlnaHQgPSBpbml0aWFsaXppbmcgPyB0YXJnZXRIZWlnaHQgOiBoZWlnaHRcXG5cXG4gICAgaWYgKG9mZnNldFRvcCAhPSBudWxsICYmIHNjcm9sbFRvcCA8PSBvZmZzZXRUb3ApIHJldHVybiAndG9wJ1xcbiAgICBpZiAob2Zmc2V0Qm90dG9tICE9IG51bGwgJiYgKGNvbGxpZGVyVG9wICsgY29sbGlkZXJIZWlnaHQgPj0gc2Nyb2xsSGVpZ2h0IC0gb2Zmc2V0Qm90dG9tKSkgcmV0dXJuICdib3R0b20nXFxuXFxuICAgIHJldHVybiBmYWxzZVxcbiAgfVxcblxcbiAgQWZmaXgucHJvdG90eXBlLmdldFBpbm5lZE9mZnNldCA9IGZ1bmN0aW9uICgpIHtcXG4gICAgaWYgKHRoaXMucGlubmVkT2Zmc2V0KSByZXR1cm4gdGhpcy5waW5uZWRPZmZzZXRcXG4gICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcyhBZmZpeC5SRVNFVCkuYWRkQ2xhc3MoJ2FmZml4JylcXG4gICAgdmFyIHNjcm9sbFRvcCA9IHRoaXMuJHRhcmdldC5zY3JvbGxUb3AoKVxcbiAgICB2YXIgcG9zaXRpb24gID0gdGhpcy4kZWxlbWVudC5vZmZzZXQoKVxcbiAgICByZXR1cm4gKHRoaXMucGlubmVkT2Zmc2V0ID0gcG9zaXRpb24udG9wIC0gc2Nyb2xsVG9wKVxcbiAgfVxcblxcbiAgQWZmaXgucHJvdG90eXBlLmNoZWNrUG9zaXRpb25XaXRoRXZlbnRMb29wID0gZnVuY3Rpb24gKCkge1xcbiAgICBzZXRUaW1lb3V0KCQucHJveHkodGhpcy5jaGVja1Bvc2l0aW9uLCB0aGlzKSwgMSlcXG4gIH1cXG5cXG4gIEFmZml4LnByb3RvdHlwZS5jaGVja1Bvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xcbiAgICBpZiAoIXRoaXMuJGVsZW1lbnQuaXMoJzp2aXNpYmxlJykpIHJldHVyblxcblxcbiAgICB2YXIgaGVpZ2h0ICAgICAgID0gdGhpcy4kZWxlbWVudC5oZWlnaHQoKVxcbiAgICB2YXIgb2Zmc2V0ICAgICAgID0gdGhpcy5vcHRpb25zLm9mZnNldFxcbiAgICB2YXIgb2Zmc2V0VG9wICAgID0gb2Zmc2V0LnRvcFxcbiAgICB2YXIgb2Zmc2V0Qm90dG9tID0gb2Zmc2V0LmJvdHRvbVxcbiAgICB2YXIgc2Nyb2xsSGVpZ2h0ID0gTWF0aC5tYXgoJChkb2N1bWVudCkuaGVpZ2h0KCksICQoZG9jdW1lbnQuYm9keSkuaGVpZ2h0KCkpXFxuXFxuICAgIGlmICh0eXBlb2Ygb2Zmc2V0ICE9ICdvYmplY3QnKSAgICAgICAgIG9mZnNldEJvdHRvbSA9IG9mZnNldFRvcCA9IG9mZnNldFxcbiAgICBpZiAodHlwZW9mIG9mZnNldFRvcCA9PSAnZnVuY3Rpb24nKSAgICBvZmZzZXRUb3AgICAgPSBvZmZzZXQudG9wKHRoaXMuJGVsZW1lbnQpXFxuICAgIGlmICh0eXBlb2Ygb2Zmc2V0Qm90dG9tID09ICdmdW5jdGlvbicpIG9mZnNldEJvdHRvbSA9IG9mZnNldC5ib3R0b20odGhpcy4kZWxlbWVudClcXG5cXG4gICAgdmFyIGFmZml4ID0gdGhpcy5nZXRTdGF0ZShzY3JvbGxIZWlnaHQsIGhlaWdodCwgb2Zmc2V0VG9wLCBvZmZzZXRCb3R0b20pXFxuXFxuICAgIGlmICh0aGlzLmFmZml4ZWQgIT0gYWZmaXgpIHtcXG4gICAgICBpZiAodGhpcy51bnBpbiAhPSBudWxsKSB0aGlzLiRlbGVtZW50LmNzcygndG9wJywgJycpXFxuXFxuICAgICAgdmFyIGFmZml4VHlwZSA9ICdhZmZpeCcgKyAoYWZmaXggPyAnLScgKyBhZmZpeCA6ICcnKVxcbiAgICAgIHZhciBlICAgICAgICAgPSAkLkV2ZW50KGFmZml4VHlwZSArICcuYnMuYWZmaXgnKVxcblxcbiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxcblxcbiAgICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cXG5cXG4gICAgICB0aGlzLmFmZml4ZWQgPSBhZmZpeFxcbiAgICAgIHRoaXMudW5waW4gPSBhZmZpeCA9PSAnYm90dG9tJyA/IHRoaXMuZ2V0UGlubmVkT2Zmc2V0KCkgOiBudWxsXFxuXFxuICAgICAgdGhpcy4kZWxlbWVudFxcbiAgICAgICAgLnJlbW92ZUNsYXNzKEFmZml4LlJFU0VUKVxcbiAgICAgICAgLmFkZENsYXNzKGFmZml4VHlwZSlcXG4gICAgICAgIC50cmlnZ2VyKGFmZml4VHlwZS5yZXBsYWNlKCdhZmZpeCcsICdhZmZpeGVkJykgKyAnLmJzLmFmZml4JylcXG4gICAgfVxcblxcbiAgICBpZiAoYWZmaXggPT0gJ2JvdHRvbScpIHtcXG4gICAgICB0aGlzLiRlbGVtZW50Lm9mZnNldCh7XFxuICAgICAgICB0b3A6IHNjcm9sbEhlaWdodCAtIGhlaWdodCAtIG9mZnNldEJvdHRvbVxcbiAgICAgIH0pXFxuICAgIH1cXG4gIH1cXG5cXG5cXG4gIC8vIEFGRklYIFBMVUdJTiBERUZJTklUSU9OXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PVxcblxcbiAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbikge1xcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcXG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcXG4gICAgICB2YXIgZGF0YSAgICA9ICR0aGlzLmRhdGEoJ2JzLmFmZml4JylcXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXFxuXFxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5hZmZpeCcsIChkYXRhID0gbmV3IEFmZml4KHRoaXMsIG9wdGlvbnMpKSlcXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcXG4gICAgfSlcXG4gIH1cXG5cXG4gIHZhciBvbGQgPSAkLmZuLmFmZml4XFxuXFxuICAkLmZuLmFmZml4ICAgICAgICAgICAgID0gUGx1Z2luXFxuICAkLmZuLmFmZml4LkNvbnN0cnVjdG9yID0gQWZmaXhcXG5cXG5cXG4gIC8vIEFGRklYIE5PIENPTkZMSUNUXFxuICAvLyA9PT09PT09PT09PT09PT09PVxcblxcbiAgJC5mbi5hZmZpeC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xcbiAgICAkLmZuLmFmZml4ID0gb2xkXFxuICAgIHJldHVybiB0aGlzXFxuICB9XFxuXFxuXFxuICAvLyBBRkZJWCBEQVRBLUFQSVxcbiAgLy8gPT09PT09PT09PT09PT1cXG5cXG4gICQod2luZG93KS5vbignbG9hZCcsIGZ1bmN0aW9uICgpIHtcXG4gICAgJCgnW2RhdGEtc3B5PVxcXCJhZmZpeFxcXCJdJykuZWFjaChmdW5jdGlvbiAoKSB7XFxuICAgICAgdmFyICRzcHkgPSAkKHRoaXMpXFxuICAgICAgdmFyIGRhdGEgPSAkc3B5LmRhdGEoKVxcblxcbiAgICAgIGRhdGEub2Zmc2V0ID0gZGF0YS5vZmZzZXQgfHwge31cXG5cXG4gICAgICBpZiAoZGF0YS5vZmZzZXRCb3R0b20gIT0gbnVsbCkgZGF0YS5vZmZzZXQuYm90dG9tID0gZGF0YS5vZmZzZXRCb3R0b21cXG4gICAgICBpZiAoZGF0YS5vZmZzZXRUb3AgICAgIT0gbnVsbCkgZGF0YS5vZmZzZXQudG9wICAgID0gZGF0YS5vZmZzZXRUb3BcXG5cXG4gICAgICBQbHVnaW4uY2FsbCgkc3B5LCBkYXRhKVxcbiAgICB9KVxcbiAgfSlcXG5cXG59KGpRdWVyeSk7XFxuXCJcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yYXctbG9hZGVyIS4vfi9zb3VyY2UtbWFwLWxvYWRlciEuL34vYm9vdHN0cmFwL2Rpc3QvanMvYm9vdHN0cmFwLmpzXG4gKiogbW9kdWxlIGlkID0gODJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoXCIhIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvc2NyaXB0LWxvYWRlci9hZGRTY3JpcHQuanNcIikocmVxdWlyZShcIiEhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9yYXctbG9hZGVyL2luZGV4LmpzIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvc291cmNlLW1hcC1sb2FkZXIvaW5kZXguanMhL1VzZXJzL2pvaGFubmVzYnV2bmFzL0RldmVsb3BtZW50L1BIUC90dXRvbXZjL25vZGVfbW9kdWxlcy9ib290c3RyYXAtc2VsZWN0L2Rpc3QvanMvYm9vdHN0cmFwLXNlbGVjdC5qc1wiKStcIlxcblxcbi8vIFNDUklQVC1MT0FERVIgRk9PVEVSXFxuLy8jIHNvdXJjZVVSTD1zY3JpcHQ6Ly8vVXNlcnMvam9oYW5uZXNidXZuYXMvRGV2ZWxvcG1lbnQvUEhQL3R1dG9tdmMvbm9kZV9tb2R1bGVzL3NvdXJjZS1tYXAtbG9hZGVyL2luZGV4LmpzIS9Vc2Vycy9qb2hhbm5lc2J1dm5hcy9EZXZlbG9wbWVudC9QSFAvdHV0b212Yy9ub2RlX21vZHVsZXMvYm9vdHN0cmFwLXNlbGVjdC9kaXN0L2pzL2Jvb3RzdHJhcC1zZWxlY3QuanNcIilcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9zY3JpcHQtbG9hZGVyIS4vfi9ib290c3RyYXAtc2VsZWN0L2Rpc3QvanMvYm9vdHN0cmFwLXNlbGVjdC5qc1xuICoqIG1vZHVsZSBpZCA9IDgzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiLyohXFxyXFxuICogQm9vdHN0cmFwLXNlbGVjdCB2MS4xMS4yIChodHRwOi8vc2lsdmlvbW9yZXRvLmdpdGh1Yi5pby9ib290c3RyYXAtc2VsZWN0KVxcclxcbiAqXFxyXFxuICogQ29weXJpZ2h0IDIwMTMtMjAxNiBib290c3RyYXAtc2VsZWN0XFxyXFxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vc2lsdmlvbW9yZXRvL2Jvb3RzdHJhcC1zZWxlY3QvYmxvYi9tYXN0ZXIvTElDRU5TRSlcXHJcXG4gKi9cXHJcXG5cXHJcXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcXG4gICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlIHVubGVzcyBhbWRNb2R1bGVJZCBpcyBzZXRcXG4gICAgZGVmaW5lKFtcXFwianF1ZXJ5XFxcIl0sIGZ1bmN0aW9uIChhMCkge1xcbiAgICAgIHJldHVybiAoZmFjdG9yeShhMCkpO1xcbiAgICB9KTtcXG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XFxuICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxcbiAgICAvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcXG4gICAgLy8gbGlrZSBOb2RlLlxcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcXFwianF1ZXJ5XFxcIikpO1xcbiAgfSBlbHNlIHtcXG4gICAgZmFjdG9yeShqUXVlcnkpO1xcbiAgfVxcbn0odGhpcywgZnVuY3Rpb24gKGpRdWVyeSkge1xcblxcbihmdW5jdGlvbiAoJCkge1xcclxcbiAgJ3VzZSBzdHJpY3QnO1xcclxcblxcclxcbiAgLy88ZWRpdG9yLWZvbGQgZGVzYz1cXFwiU2hpbXNcXFwiPlxcclxcbiAgaWYgKCFTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzKSB7XFxyXFxuICAgIChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgJ3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxcclxcbiAgICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xcclxcbiAgICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAvLyBJRSA4IG9ubHkgc3VwcG9ydHMgYE9iamVjdC5kZWZpbmVQcm9wZXJ0eWAgb24gRE9NIGVsZW1lbnRzXFxyXFxuICAgICAgICB0cnkge1xcclxcbiAgICAgICAgICB2YXIgb2JqZWN0ID0ge307XFxyXFxuICAgICAgICAgIHZhciAkZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XFxyXFxuICAgICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xcclxcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIHJldHVybiByZXN1bHQ7XFxyXFxuICAgICAgfSgpKTtcXHJcXG4gICAgICB2YXIgaW5kZXhPZiA9ICcnLmluZGV4T2Y7XFxyXFxuICAgICAgdmFyIGluY2x1ZGVzID0gZnVuY3Rpb24gKHNlYXJjaCkge1xcclxcbiAgICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xcclxcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgICB2YXIgc3RyaW5nID0gU3RyaW5nKHRoaXMpO1xcclxcbiAgICAgICAgaWYgKHNlYXJjaCAmJiB0b1N0cmluZy5jYWxsKHNlYXJjaCkgPT0gJ1tvYmplY3QgUmVnRXhwXScpIHtcXHJcXG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XFxyXFxuICAgICAgICB2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XFxyXFxuICAgICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcXHJcXG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xcclxcbiAgICAgICAgLy8gYFRvSW50ZWdlcmBcXHJcXG4gICAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xcclxcbiAgICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcXHJcXG4gICAgICAgICAgcG9zID0gMDtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XFxyXFxuICAgICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcXHJcXG4gICAgICAgIGlmIChzZWFyY2hMZW5ndGggKyBzdGFydCA+IHN0cmluZ0xlbmd0aCkge1xcclxcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgICByZXR1cm4gaW5kZXhPZi5jYWxsKHN0cmluZywgc2VhcmNoU3RyaW5nLCBwb3MpICE9IC0xO1xcclxcbiAgICAgIH07XFxyXFxuICAgICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XFxyXFxuICAgICAgICBkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnaW5jbHVkZXMnLCB7XFxyXFxuICAgICAgICAgICd2YWx1ZSc6IGluY2x1ZGVzLFxcclxcbiAgICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSxcXHJcXG4gICAgICAgICAgJ3dyaXRhYmxlJzogdHJ1ZVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUuaW5jbHVkZXMgPSBpbmNsdWRlcztcXHJcXG4gICAgICB9XFxyXFxuICAgIH0oKSk7XFxyXFxuICB9XFxyXFxuXFxyXFxuICBpZiAoIVN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCkge1xcclxcbiAgICAoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcXHJcXG4gICAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgLy8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xcclxcbiAgICAgICAgdHJ5IHtcXHJcXG4gICAgICAgICAgdmFyIG9iamVjdCA9IHt9O1xcclxcbiAgICAgICAgICB2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xcclxcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gJGRlZmluZVByb3BlcnR5KG9iamVjdCwgb2JqZWN0LCBvYmplY3QpICYmICRkZWZpbmVQcm9wZXJ0eTtcXHJcXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xcclxcbiAgICAgIH0oKSk7XFxyXFxuICAgICAgdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XFxyXFxuICAgICAgdmFyIHN0YXJ0c1dpdGggPSBmdW5jdGlvbiAoc2VhcmNoKSB7XFxyXFxuICAgICAgICBpZiAodGhpcyA9PSBudWxsKSB7XFxyXFxuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XFxyXFxuICAgICAgICBpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xcclxcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgICB2YXIgc3RyaW5nTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcXHJcXG4gICAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSBTdHJpbmcoc2VhcmNoKTtcXHJcXG4gICAgICAgIHZhciBzZWFyY2hMZW5ndGggPSBzZWFyY2hTdHJpbmcubGVuZ3RoO1xcclxcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XFxyXFxuICAgICAgICAvLyBgVG9JbnRlZ2VyYFxcclxcbiAgICAgICAgdmFyIHBvcyA9IHBvc2l0aW9uID8gTnVtYmVyKHBvc2l0aW9uKSA6IDA7XFxyXFxuICAgICAgICBpZiAocG9zICE9IHBvcykgeyAvLyBiZXR0ZXIgYGlzTmFOYFxcclxcbiAgICAgICAgICBwb3MgPSAwO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTtcXHJcXG4gICAgICAgIC8vIEF2b2lkIHRoZSBgaW5kZXhPZmAgY2FsbCBpZiBubyBtYXRjaCBpcyBwb3NzaWJsZVxcclxcbiAgICAgICAgaWYgKHNlYXJjaExlbmd0aCArIHN0YXJ0ID4gc3RyaW5nTGVuZ3RoKSB7XFxyXFxuICAgICAgICAgIHJldHVybiBmYWxzZTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xcclxcbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBzZWFyY2hMZW5ndGgpIHtcXHJcXG4gICAgICAgICAgaWYgKHN0cmluZy5jaGFyQ29kZUF0KHN0YXJ0ICsgaW5kZXgpICE9IHNlYXJjaFN0cmluZy5jaGFyQ29kZUF0KGluZGV4KSkge1xcclxcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcXHJcXG4gICAgICAgICAgfVxcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgcmV0dXJuIHRydWU7XFxyXFxuICAgICAgfTtcXHJcXG4gICAgICBpZiAoZGVmaW5lUHJvcGVydHkpIHtcXHJcXG4gICAgICAgIGRlZmluZVByb3BlcnR5KFN0cmluZy5wcm90b3R5cGUsICdzdGFydHNXaXRoJywge1xcclxcbiAgICAgICAgICAndmFsdWUnOiBzdGFydHNXaXRoLFxcclxcbiAgICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSxcXHJcXG4gICAgICAgICAgJ3dyaXRhYmxlJzogdHJ1ZVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCA9IHN0YXJ0c1dpdGg7XFxyXFxuICAgICAgfVxcclxcbiAgICB9KCkpO1xcclxcbiAgfVxcclxcblxcclxcbiAgaWYgKCFPYmplY3Qua2V5cykge1xcclxcbiAgICBPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIChcXHJcXG4gICAgICBvLCAvLyBvYmplY3RcXHJcXG4gICAgICBrLCAvLyBrZXlcXHJcXG4gICAgICByICAvLyByZXN1bHQgYXJyYXlcXHJcXG4gICAgICApe1xcclxcbiAgICAgIC8vIGluaXRpYWxpemUgb2JqZWN0IGFuZCByZXN1bHRcXHJcXG4gICAgICByPVtdO1xcclxcbiAgICAgIC8vIGl0ZXJhdGUgb3ZlciBvYmplY3Qga2V5c1xcclxcbiAgICAgIGZvciAoayBpbiBvKVxcclxcbiAgICAgICAgICAvLyBmaWxsIHJlc3VsdCBhcnJheSB3aXRoIG5vbi1wcm90b3R5cGljYWwga2V5c1xcclxcbiAgICAgICAgci5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspICYmIHIucHVzaChrKTtcXHJcXG4gICAgICAvLyByZXR1cm4gcmVzdWx0XFxyXFxuICAgICAgcmV0dXJuIHI7XFxyXFxuICAgIH07XFxyXFxuICB9XFxyXFxuXFxyXFxuICAvLyBzZXQgZGF0YS1zZWxlY3RlZCBvbiBzZWxlY3QgZWxlbWVudCBpZiB0aGUgdmFsdWUgaGFzIGJlZW4gcHJvZ3JhbW1hdGljYWxseSBzZWxlY3RlZFxcclxcbiAgLy8gcHJpb3IgdG8gaW5pdGlhbGl6YXRpb24gb2YgYm9vdHN0cmFwLXNlbGVjdFxcclxcbiAgLy8gKiBjb25zaWRlciByZW1vdmluZyBvciByZXBsYWNpbmcgYW4gYWx0ZXJuYXRpdmUgbWV0aG9kICpcXHJcXG4gIHZhciB2YWxIb29rcyA9IHtcXHJcXG4gICAgdXNlRGVmYXVsdDogZmFsc2UsXFxyXFxuICAgIF9zZXQ6ICQudmFsSG9va3Muc2VsZWN0LnNldFxcclxcbiAgfTtcXHJcXG5cXHJcXG4gICQudmFsSG9va3Muc2VsZWN0LnNldCA9IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XFxyXFxuICAgIGlmICh2YWx1ZSAmJiAhdmFsSG9va3MudXNlRGVmYXVsdCkgJChlbGVtKS5kYXRhKCdzZWxlY3RlZCcsIHRydWUpO1xcclxcblxcclxcbiAgICByZXR1cm4gdmFsSG9va3MuX3NldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xcclxcbiAgfTtcXHJcXG5cXHJcXG4gIHZhciBjaGFuZ2VkX2FyZ3VtZW50cyA9IG51bGw7XFxyXFxuICAkLmZuLnRyaWdnZXJOYXRpdmUgPSBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XFxyXFxuICAgIHZhciBlbCA9IHRoaXNbMF0sXFxyXFxuICAgICAgICBldmVudDtcXHJcXG5cXHJcXG4gICAgaWYgKGVsLmRpc3BhdGNoRXZlbnQpIHsgLy8gZm9yIG1vZGVybiBicm93c2VycyAmIElFOStcXHJcXG4gICAgICBpZiAodHlwZW9mIEV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XFxyXFxuICAgICAgICAvLyBGb3IgbW9kZXJuIGJyb3dzZXJzXFxyXFxuICAgICAgICBldmVudCA9IG5ldyBFdmVudChldmVudE5hbWUsIHtcXHJcXG4gICAgICAgICAgYnViYmxlczogdHJ1ZVxcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIC8vIEZvciBJRSBzaW5jZSBpdCBkb2Vzbid0IHN1cHBvcnQgRXZlbnQgY29uc3RydWN0b3JcXHJcXG4gICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XFxyXFxuICAgICAgICBldmVudC5pbml0RXZlbnQoZXZlbnROYW1lLCB0cnVlLCBmYWxzZSk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIGVsLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xcclxcbiAgICB9IGVsc2UgaWYgKGVsLmZpcmVFdmVudCkgeyAvLyBmb3IgSUU4XFxyXFxuICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xcclxcbiAgICAgIGV2ZW50LmV2ZW50VHlwZSA9IGV2ZW50TmFtZTtcXHJcXG4gICAgICBlbC5maXJlRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgZXZlbnQpO1xcclxcbiAgICB9IGVsc2Uge1xcclxcbiAgICAgIC8vIGZhbGwgYmFjayB0byBqUXVlcnkudHJpZ2dlclxcclxcbiAgICAgIHRoaXMudHJpZ2dlcihldmVudE5hbWUpO1xcclxcbiAgICB9XFxyXFxuICB9O1xcclxcbiAgLy88L2VkaXRvci1mb2xkPlxcclxcblxcclxcbiAgLy8gQ2FzZSBpbnNlbnNpdGl2ZSBjb250YWlucyBzZWFyY2hcXHJcXG4gICQuZXhwci5wc2V1ZG9zLmljb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGluZGV4LCBtZXRhKSB7XFxyXFxuICAgIHZhciAkb2JqID0gJChvYmopO1xcclxcbiAgICB2YXIgaGF5c3RhY2sgPSAoJG9iai5kYXRhKCd0b2tlbnMnKSB8fCAkb2JqLnRleHQoKSkudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpO1xcclxcbiAgICByZXR1cm4gaGF5c3RhY2suaW5jbHVkZXMobWV0YVszXS50b1VwcGVyQ2FzZSgpKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICAvLyBDYXNlIGluc2Vuc2l0aXZlIGJlZ2lucyBzZWFyY2hcXHJcXG4gICQuZXhwci5wc2V1ZG9zLmliZWdpbnMgPSBmdW5jdGlvbiAob2JqLCBpbmRleCwgbWV0YSkge1xcclxcbiAgICB2YXIgJG9iaiA9ICQob2JqKTtcXHJcXG4gICAgdmFyIGhheXN0YWNrID0gKCRvYmouZGF0YSgndG9rZW5zJykgfHwgJG9iai50ZXh0KCkpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcXHJcXG4gICAgcmV0dXJuIGhheXN0YWNrLnN0YXJ0c1dpdGgobWV0YVszXS50b1VwcGVyQ2FzZSgpKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICAvLyBDYXNlIGFuZCBhY2NlbnQgaW5zZW5zaXRpdmUgY29udGFpbnMgc2VhcmNoXFxyXFxuICAkLmV4cHIucHNldWRvcy5haWNvbnRhaW5zID0gZnVuY3Rpb24gKG9iaiwgaW5kZXgsIG1ldGEpIHtcXHJcXG4gICAgdmFyICRvYmogPSAkKG9iaik7XFxyXFxuICAgIHZhciBoYXlzdGFjayA9ICgkb2JqLmRhdGEoJ3Rva2VucycpIHx8ICRvYmouZGF0YSgnbm9ybWFsaXplZFRleHQnKSB8fCAkb2JqLnRleHQoKSkudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpO1xcclxcbiAgICByZXR1cm4gaGF5c3RhY2suaW5jbHVkZXMobWV0YVszXS50b1VwcGVyQ2FzZSgpKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICAvLyBDYXNlIGFuZCBhY2NlbnQgaW5zZW5zaXRpdmUgYmVnaW5zIHNlYXJjaFxcclxcbiAgJC5leHByLnBzZXVkb3MuYWliZWdpbnMgPSBmdW5jdGlvbiAob2JqLCBpbmRleCwgbWV0YSkge1xcclxcbiAgICB2YXIgJG9iaiA9ICQob2JqKTtcXHJcXG4gICAgdmFyIGhheXN0YWNrID0gKCRvYmouZGF0YSgndG9rZW5zJykgfHwgJG9iai5kYXRhKCdub3JtYWxpemVkVGV4dCcpIHx8ICRvYmoudGV4dCgpKS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XFxyXFxuICAgIHJldHVybiBoYXlzdGFjay5zdGFydHNXaXRoKG1ldGFbM10udG9VcHBlckNhc2UoKSk7XFxyXFxuICB9O1xcclxcblxcclxcbiAgLyoqXFxyXFxuICAgKiBSZW1vdmUgYWxsIGRpYXRyaWNzIGZyb20gdGhlIGdpdmVuIHRleHQuXFxyXFxuICAgKiBAYWNjZXNzIHByaXZhdGVcXHJcXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0XFxyXFxuICAgKiBAcmV0dXJucyB7U3RyaW5nfVxcclxcbiAgICovXFxyXFxuICBmdW5jdGlvbiBub3JtYWxpemVUb0Jhc2UodGV4dCkge1xcclxcbiAgICB2YXIgckV4cHMgPSBbXFxyXFxuICAgICAge3JlOiAvW1xcXFx4QzAtXFxcXHhDNl0vZywgY2g6IFxcXCJBXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RTAtXFxcXHhFNl0vZywgY2g6IFxcXCJhXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4QzgtXFxcXHhDQl0vZywgY2g6IFxcXCJFXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RTgtXFxcXHhFQl0vZywgY2g6IFxcXCJlXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4Q0MtXFxcXHhDRl0vZywgY2g6IFxcXCJJXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RUMtXFxcXHhFRl0vZywgY2g6IFxcXCJpXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RDItXFxcXHhENl0vZywgY2g6IFxcXCJPXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RjItXFxcXHhGNl0vZywgY2g6IFxcXCJvXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RDktXFxcXHhEQ10vZywgY2g6IFxcXCJVXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RjktXFxcXHhGQ10vZywgY2g6IFxcXCJ1XFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4QzctXFxcXHhFN10vZywgY2g6IFxcXCJjXFxcIn0sXFxyXFxuICAgICAge3JlOiAvW1xcXFx4RDFdL2csIGNoOiBcXFwiTlxcXCJ9LFxcclxcbiAgICAgIHtyZTogL1tcXFxceEYxXS9nLCBjaDogXFxcIm5cXFwifVxcclxcbiAgICBdO1xcclxcbiAgICAkLmVhY2gockV4cHMsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKHRoaXMucmUsIHRoaXMuY2gpO1xcclxcbiAgICB9KTtcXHJcXG4gICAgcmV0dXJuIHRleHQ7XFxyXFxuICB9XFxyXFxuXFxyXFxuXFxyXFxuICBmdW5jdGlvbiBodG1sRXNjYXBlKGh0bWwpIHtcXHJcXG4gICAgdmFyIGVzY2FwZU1hcCA9IHtcXHJcXG4gICAgICAnJic6ICcmYW1wOycsXFxyXFxuICAgICAgJzwnOiAnJmx0OycsXFxyXFxuICAgICAgJz4nOiAnJmd0OycsXFxyXFxuICAgICAgJ1xcXCInOiAnJnF1b3Q7JyxcXHJcXG4gICAgICBcXFwiJ1xcXCI6ICcmI3gyNzsnLFxcclxcbiAgICAgICdgJzogJyYjeDYwOydcXHJcXG4gICAgfTtcXHJcXG4gICAgdmFyIHNvdXJjZSA9ICcoPzonICsgT2JqZWN0LmtleXMoZXNjYXBlTWFwKS5qb2luKCd8JykgKyAnKScsXFxyXFxuICAgICAgICB0ZXN0UmVnZXhwID0gbmV3IFJlZ0V4cChzb3VyY2UpLFxcclxcbiAgICAgICAgcmVwbGFjZVJlZ2V4cCA9IG5ldyBSZWdFeHAoc291cmNlLCAnZycpLFxcclxcbiAgICAgICAgc3RyaW5nID0gaHRtbCA9PSBudWxsID8gJycgOiAnJyArIGh0bWw7XFxyXFxuICAgIHJldHVybiB0ZXN0UmVnZXhwLnRlc3Qoc3RyaW5nKSA/IHN0cmluZy5yZXBsYWNlKHJlcGxhY2VSZWdleHAsIGZ1bmN0aW9uIChtYXRjaCkge1xcclxcbiAgICAgIHJldHVybiBlc2NhcGVNYXBbbWF0Y2hdO1xcclxcbiAgICB9KSA6IHN0cmluZztcXHJcXG4gIH1cXHJcXG5cXHJcXG4gIHZhciBTZWxlY3RwaWNrZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucywgZSkge1xcclxcbiAgICAvLyBib290c3RyYXAtc2VsZWN0IGhhcyBiZWVuIGluaXRpYWxpemVkIC0gcmV2ZXJ0IHZhbEhvb2tzLnNlbGVjdC5zZXQgYmFjayB0byBpdHMgb3JpZ2luYWwgZnVuY3Rpb25cXHJcXG4gICAgaWYgKCF2YWxIb29rcy51c2VEZWZhdWx0KSB7XFxyXFxuICAgICAgJC52YWxIb29rcy5zZWxlY3Quc2V0ID0gdmFsSG9va3MuX3NldDtcXHJcXG4gICAgICB2YWxIb29rcy51c2VEZWZhdWx0ID0gdHJ1ZTtcXHJcXG4gICAgfVxcclxcblxcclxcbiAgICBpZiAoZSkge1xcclxcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIHRoaXMuJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xcclxcbiAgICB0aGlzLiRuZXdFbGVtZW50ID0gbnVsbDtcXHJcXG4gICAgdGhpcy4kYnV0dG9uID0gbnVsbDtcXHJcXG4gICAgdGhpcy4kbWVudSA9IG51bGw7XFxyXFxuICAgIHRoaXMuJGxpcyA9IG51bGw7XFxyXFxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XFxyXFxuXFxyXFxuICAgIC8vIElmIHdlIGhhdmUgbm8gdGl0bGUgeWV0LCB0cnkgdG8gcHVsbCBpdCBmcm9tIHRoZSBodG1sIHRpdGxlIGF0dHJpYnV0ZSAoalF1ZXJ5IGRvZXNudCcgcGljayBpdCB1cCBhcyBpdCdzIG5vdCBhXFxyXFxuICAgIC8vIGRhdGEtYXR0cmlidXRlKVxcclxcbiAgICBpZiAodGhpcy5vcHRpb25zLnRpdGxlID09PSBudWxsKSB7XFxyXFxuICAgICAgdGhpcy5vcHRpb25zLnRpdGxlID0gdGhpcy4kZWxlbWVudC5hdHRyKCd0aXRsZScpO1xcclxcbiAgICB9XFxyXFxuXFxyXFxuICAgIC8vRXhwb3NlIHB1YmxpYyBtZXRob2RzXFxyXFxuICAgIHRoaXMudmFsID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS52YWw7XFxyXFxuICAgIHRoaXMucmVuZGVyID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZW5kZXI7XFxyXFxuICAgIHRoaXMucmVmcmVzaCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVmcmVzaDtcXHJcXG4gICAgdGhpcy5zZXRTdHlsZSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2V0U3R5bGU7XFxyXFxuICAgIHRoaXMuc2VsZWN0QWxsID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5zZWxlY3RBbGw7XFxyXFxuICAgIHRoaXMuZGVzZWxlY3RBbGwgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmRlc2VsZWN0QWxsO1xcclxcbiAgICB0aGlzLmRlc3Ryb3kgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmRlc3Ryb3k7XFxyXFxuICAgIHRoaXMucmVtb3ZlID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZW1vdmU7XFxyXFxuICAgIHRoaXMuc2hvdyA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2hvdztcXHJcXG4gICAgdGhpcy5oaWRlID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5oaWRlO1xcclxcblxcclxcbiAgICB0aGlzLmluaXQoKTtcXHJcXG4gIH07XFxyXFxuXFxyXFxuICBTZWxlY3RwaWNrZXIuVkVSU0lPTiA9ICcxLjExLjInO1xcclxcblxcclxcbiAgLy8gcGFydCBvZiB0aGlzIGlzIGR1cGxpY2F0ZWQgaW4gaTE4bi9kZWZhdWx0cy1lbl9VUy5qcy4gTWFrZSBzdXJlIHRvIHVwZGF0ZSBib3RoLlxcclxcbiAgU2VsZWN0cGlja2VyLkRFRkFVTFRTID0ge1xcclxcbiAgICBub25lU2VsZWN0ZWRUZXh0OiAnTm90aGluZyBzZWxlY3RlZCcsXFxyXFxuICAgIG5vbmVSZXN1bHRzVGV4dDogJ05vIHJlc3VsdHMgbWF0Y2hlZCB7MH0nLFxcclxcbiAgICBjb3VudFNlbGVjdGVkVGV4dDogZnVuY3Rpb24gKG51bVNlbGVjdGVkLCBudW1Ub3RhbCkge1xcclxcbiAgICAgIHJldHVybiAobnVtU2VsZWN0ZWQgPT0gMSkgPyBcXFwiezB9IGl0ZW0gc2VsZWN0ZWRcXFwiIDogXFxcInswfSBpdGVtcyBzZWxlY3RlZFxcXCI7XFxyXFxuICAgIH0sXFxyXFxuICAgIG1heE9wdGlvbnNUZXh0OiBmdW5jdGlvbiAobnVtQWxsLCBudW1Hcm91cCkge1xcclxcbiAgICAgIHJldHVybiBbXFxyXFxuICAgICAgICAobnVtQWxsID09IDEpID8gJ0xpbWl0IHJlYWNoZWQgKHtufSBpdGVtIG1heCknIDogJ0xpbWl0IHJlYWNoZWQgKHtufSBpdGVtcyBtYXgpJyxcXHJcXG4gICAgICAgIChudW1Hcm91cCA9PSAxKSA/ICdHcm91cCBsaW1pdCByZWFjaGVkICh7bn0gaXRlbSBtYXgpJyA6ICdHcm91cCBsaW1pdCByZWFjaGVkICh7bn0gaXRlbXMgbWF4KSdcXHJcXG4gICAgICBdO1xcclxcbiAgICB9LFxcclxcbiAgICBzZWxlY3RBbGxUZXh0OiAnU2VsZWN0IEFsbCcsXFxyXFxuICAgIGRlc2VsZWN0QWxsVGV4dDogJ0Rlc2VsZWN0IEFsbCcsXFxyXFxuICAgIGRvbmVCdXR0b246IGZhbHNlLFxcclxcbiAgICBkb25lQnV0dG9uVGV4dDogJ0Nsb3NlJyxcXHJcXG4gICAgbXVsdGlwbGVTZXBhcmF0b3I6ICcsICcsXFxyXFxuICAgIHN0eWxlQmFzZTogJ2J0bicsXFxyXFxuICAgIHN0eWxlOiAnYnRuLWRlZmF1bHQnLFxcclxcbiAgICBzaXplOiAnYXV0bycsXFxyXFxuICAgIHRpdGxlOiBudWxsLFxcclxcbiAgICBzZWxlY3RlZFRleHRGb3JtYXQ6ICd2YWx1ZXMnLFxcclxcbiAgICB3aWR0aDogZmFsc2UsXFxyXFxuICAgIGNvbnRhaW5lcjogZmFsc2UsXFxyXFxuICAgIGhpZGVEaXNhYmxlZDogZmFsc2UsXFxyXFxuICAgIHNob3dTdWJ0ZXh0OiBmYWxzZSxcXHJcXG4gICAgc2hvd0ljb246IHRydWUsXFxyXFxuICAgIHNob3dDb250ZW50OiB0cnVlLFxcclxcbiAgICBkcm9wdXBBdXRvOiB0cnVlLFxcclxcbiAgICBoZWFkZXI6IGZhbHNlLFxcclxcbiAgICBsaXZlU2VhcmNoOiBmYWxzZSxcXHJcXG4gICAgbGl2ZVNlYXJjaFBsYWNlaG9sZGVyOiBudWxsLFxcclxcbiAgICBsaXZlU2VhcmNoTm9ybWFsaXplOiBmYWxzZSxcXHJcXG4gICAgbGl2ZVNlYXJjaFN0eWxlOiAnY29udGFpbnMnLFxcclxcbiAgICBhY3Rpb25zQm94OiBmYWxzZSxcXHJcXG4gICAgaWNvbkJhc2U6ICdnbHlwaGljb24nLFxcclxcbiAgICB0aWNrSWNvbjogJ2dseXBoaWNvbi1vaycsXFxyXFxuICAgIHNob3dUaWNrOiBmYWxzZSxcXHJcXG4gICAgdGVtcGxhdGU6IHtcXHJcXG4gICAgICBjYXJldDogJzxzcGFuIGNsYXNzPVxcXCJjYXJldFxcXCI+PC9zcGFuPidcXHJcXG4gICAgfSxcXHJcXG4gICAgbWF4T3B0aW9uczogZmFsc2UsXFxyXFxuICAgIG1vYmlsZTogZmFsc2UsXFxyXFxuICAgIHNlbGVjdE9uVGFiOiBmYWxzZSxcXHJcXG4gICAgZHJvcGRvd25BbGlnblJpZ2h0OiBmYWxzZVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIFNlbGVjdHBpY2tlci5wcm90b3R5cGUgPSB7XFxyXFxuXFxyXFxuICAgIGNvbnN0cnVjdG9yOiBTZWxlY3RwaWNrZXIsXFxyXFxuXFxyXFxuICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgdGhhdCA9IHRoaXMsXFxyXFxuICAgICAgICAgIGlkID0gdGhpcy4kZWxlbWVudC5hdHRyKCdpZCcpO1xcclxcblxcclxcbiAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ2JzLXNlbGVjdC1oaWRkZW4nKTtcXHJcXG5cXHJcXG4gICAgICAvLyBzdG9yZSBvcmlnaW5hbEluZGV4IChrZXkpIGFuZCBuZXdJbmRleCAodmFsdWUpIGluIHRoaXMubGlPYmogZm9yIGZhc3QgYWNjZXNzaWJpbGl0eVxcclxcbiAgICAgIC8vIGFsbG93cyB1cyB0byBkbyB0aGlzLiRsaXMuZXEodGhhdC5saU9ialtpbmRleF0pIGluc3RlYWQgb2YgdGhpcy4kbGlzLmZpbHRlcignW2RhdGEtb3JpZ2luYWwtaW5kZXg9XFxcIicgKyBpbmRleCArICdcXFwiXScpXFxyXFxuICAgICAgdGhpcy5saU9iaiA9IHt9O1xcclxcbiAgICAgIHRoaXMubXVsdGlwbGUgPSB0aGlzLiRlbGVtZW50LnByb3AoJ211bHRpcGxlJyk7XFxyXFxuICAgICAgdGhpcy5hdXRvZm9jdXMgPSB0aGlzLiRlbGVtZW50LnByb3AoJ2F1dG9mb2N1cycpO1xcclxcbiAgICAgIHRoaXMuJG5ld0VsZW1lbnQgPSB0aGlzLmNyZWF0ZVZpZXcoKTtcXHJcXG4gICAgICB0aGlzLiRlbGVtZW50XFxyXFxuICAgICAgICAuYWZ0ZXIodGhpcy4kbmV3RWxlbWVudClcXHJcXG4gICAgICAgIC5hcHBlbmRUbyh0aGlzLiRuZXdFbGVtZW50KTtcXHJcXG4gICAgICB0aGlzLiRidXR0b24gPSB0aGlzLiRuZXdFbGVtZW50LmNoaWxkcmVuKCdidXR0b24nKTtcXHJcXG4gICAgICB0aGlzLiRtZW51ID0gdGhpcy4kbmV3RWxlbWVudC5jaGlsZHJlbignLmRyb3Bkb3duLW1lbnUnKTtcXHJcXG4gICAgICB0aGlzLiRtZW51SW5uZXIgPSB0aGlzLiRtZW51LmNoaWxkcmVuKCcuaW5uZXInKTtcXHJcXG4gICAgICB0aGlzLiRzZWFyY2hib3ggPSB0aGlzLiRtZW51LmZpbmQoJ2lucHV0Jyk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbicpO1xcclxcblxcclxcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHJvcGRvd25BbGlnblJpZ2h0ID09PSB0cnVlKSB0aGlzLiRtZW51LmFkZENsYXNzKCdkcm9wZG93bi1tZW51LXJpZ2h0Jyk7XFxyXFxuXFxyXFxuICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gJ3VuZGVmaW5lZCcpIHtcXHJcXG4gICAgICAgIHRoaXMuJGJ1dHRvbi5hdHRyKCdkYXRhLWlkJywgaWQpO1xcclxcbiAgICAgICAgJCgnbGFiZWxbZm9yPVxcXCInICsgaWQgKyAnXFxcIl0nKS5jbGljayhmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpO1xcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHRoaXMuY2hlY2tEaXNhYmxlZCgpO1xcclxcbiAgICAgIHRoaXMuY2xpY2tMaXN0ZW5lcigpO1xcclxcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCkgdGhpcy5saXZlU2VhcmNoTGlzdGVuZXIoKTtcXHJcXG4gICAgICB0aGlzLnJlbmRlcigpO1xcclxcbiAgICAgIHRoaXMuc2V0U3R5bGUoKTtcXHJcXG4gICAgICB0aGlzLnNldFdpZHRoKCk7XFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb250YWluZXIpIHRoaXMuc2VsZWN0UG9zaXRpb24oKTtcXHJcXG4gICAgICB0aGlzLiRtZW51LmRhdGEoJ3RoaXMnLCB0aGlzKTtcXHJcXG4gICAgICB0aGlzLiRuZXdFbGVtZW50LmRhdGEoJ3RoaXMnLCB0aGlzKTtcXHJcXG4gICAgICBpZiAodGhpcy5vcHRpb25zLm1vYmlsZSkgdGhpcy5tb2JpbGUoKTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRuZXdFbGVtZW50Lm9uKHtcXHJcXG4gICAgICAgICdoaWRlLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICAgICAgdGhhdC4kbWVudUlubmVyLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSk7XFxyXFxuICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignaGlkZS5icy5zZWxlY3QnLCBlKTtcXHJcXG4gICAgICAgIH0sXFxyXFxuICAgICAgICAnaGlkZGVuLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdoaWRkZW4uYnMuc2VsZWN0JywgZSk7XFxyXFxuICAgICAgICB9LFxcclxcbiAgICAgICAgJ3Nob3cuYnMuZHJvcGRvd24nOiBmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuYXR0cignYXJpYS1leHBhbmRlZCcsIHRydWUpO1xcclxcbiAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ3Nob3cuYnMuc2VsZWN0JywgZSk7XFxyXFxuICAgICAgICB9LFxcclxcbiAgICAgICAgJ3Nob3duLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdzaG93bi5icy5zZWxlY3QnLCBlKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICBpZiAodGhhdC4kZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ3JlcXVpcmVkJykpIHtcXHJcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2ludmFsaWQnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgIHRoYXQuJGJ1dHRvblxcclxcbiAgICAgICAgICAgIC5hZGRDbGFzcygnYnMtaW52YWxpZCcpXFxyXFxuICAgICAgICAgICAgLmZvY3VzKCk7XFxyXFxuXFxyXFxuICAgICAgICAgIHRoYXQuJGVsZW1lbnQub24oe1xcclxcbiAgICAgICAgICAgICdmb2N1cy5icy5zZWxlY3QnOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcXHJcXG4gICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQub2ZmKCdmb2N1cy5icy5zZWxlY3QnKTtcXHJcXG4gICAgICAgICAgICB9LFxcclxcbiAgICAgICAgICAgICdzaG93bi5icy5zZWxlY3QnOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50XFxyXFxuICAgICAgICAgICAgICAgIC52YWwodGhhdC4kZWxlbWVudC52YWwoKSkgLy8gc2V0IHRoZSB2YWx1ZSB0byBoaWRlIHRoZSB2YWxpZGF0aW9uIG1lc3NhZ2UgaW4gQ2hyb21lIHdoZW4gbWVudSBpcyBvcGVuZWRcXHJcXG4gICAgICAgICAgICAgICAgLm9mZignc2hvd24uYnMuc2VsZWN0Jyk7XFxyXFxuICAgICAgICAgICAgfSxcXHJcXG4gICAgICAgICAgICAncmVuZGVyZWQuYnMuc2VsZWN0JzogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgICAgICAgLy8gaWYgc2VsZWN0IGlzIG5vIGxvbmdlciBpbnZhbGlkLCByZW1vdmUgdGhlIGJzLWludmFsaWQgY2xhc3NcXHJcXG4gICAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkaXR5LnZhbGlkKSB0aGF0LiRidXR0b24ucmVtb3ZlQ2xhc3MoJ2JzLWludmFsaWQnKTtcXHJcXG4gICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQub2ZmKCdyZW5kZXJlZC5icy5zZWxlY3QnKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgIH0pO1xcclxcbiAgICAgICAgfSk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdsb2FkZWQuYnMuc2VsZWN0Jyk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIGNyZWF0ZURyb3Bkb3duOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgLy8gT3B0aW9uc1xcclxcbiAgICAgIC8vIElmIHdlIGFyZSBtdWx0aXBsZSBvciBzaG93VGljayBvcHRpb24gaXMgc2V0LCB0aGVuIGFkZCB0aGUgc2hvdy10aWNrIGNsYXNzXFxyXFxuICAgICAgdmFyIHNob3dUaWNrID0gKHRoaXMubXVsdGlwbGUgfHwgdGhpcy5vcHRpb25zLnNob3dUaWNrKSA/ICcgc2hvdy10aWNrJyA6ICcnLFxcclxcbiAgICAgICAgICBpbnB1dEdyb3VwID0gdGhpcy4kZWxlbWVudC5wYXJlbnQoKS5oYXNDbGFzcygnaW5wdXQtZ3JvdXAnKSA/ICcgaW5wdXQtZ3JvdXAtYnRuJyA6ICcnLFxcclxcbiAgICAgICAgICBhdXRvZm9jdXMgPSB0aGlzLmF1dG9mb2N1cyA/ICcgYXV0b2ZvY3VzJyA6ICcnO1xcclxcbiAgICAgIC8vIEVsZW1lbnRzXFxyXFxuICAgICAgdmFyIGhlYWRlciA9IHRoaXMub3B0aW9ucy5oZWFkZXIgPyAnPGRpdiBjbGFzcz1cXFwicG9wb3Zlci10aXRsZVxcXCI+PGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgYXJpYS1oaWRkZW49XFxcInRydWVcXFwiPiZ0aW1lczs8L2J1dHRvbj4nICsgdGhpcy5vcHRpb25zLmhlYWRlciArICc8L2Rpdj4nIDogJyc7XFxyXFxuICAgICAgdmFyIHNlYXJjaGJveCA9IHRoaXMub3B0aW9ucy5saXZlU2VhcmNoID9cXHJcXG4gICAgICAnPGRpdiBjbGFzcz1cXFwiYnMtc2VhcmNoYm94XFxcIj4nICtcXHJcXG4gICAgICAnPGlucHV0IHR5cGU9XFxcInRleHRcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGF1dG9jb21wbGV0ZT1cXFwib2ZmXFxcIicgK1xcclxcbiAgICAgIChudWxsID09PSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFBsYWNlaG9sZGVyID8gJycgOiAnIHBsYWNlaG9sZGVyPVxcXCInICsgaHRtbEVzY2FwZSh0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFBsYWNlaG9sZGVyKSArICdcXFwiJykgKyAnIHJvbGU9XFxcInRleHRib3hcXFwiIGFyaWEtbGFiZWw9XFxcIlNlYXJjaFxcXCI+JyArXFxyXFxuICAgICAgJzwvZGl2PidcXHJcXG4gICAgICAgICAgOiAnJztcXHJcXG4gICAgICB2YXIgYWN0aW9uc2JveCA9IHRoaXMubXVsdGlwbGUgJiYgdGhpcy5vcHRpb25zLmFjdGlvbnNCb3ggP1xcclxcbiAgICAgICc8ZGl2IGNsYXNzPVxcXCJicy1hY3Rpb25zYm94XFxcIj4nICtcXHJcXG4gICAgICAnPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1zbSBidG4tYmxvY2tcXFwiPicgK1xcclxcbiAgICAgICc8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImFjdGlvbnMtYnRuIGJzLXNlbGVjdC1hbGwgYnRuIGJ0bi1kZWZhdWx0XFxcIj4nICtcXHJcXG4gICAgICB0aGlzLm9wdGlvbnMuc2VsZWN0QWxsVGV4dCArXFxyXFxuICAgICAgJzwvYnV0dG9uPicgK1xcclxcbiAgICAgICc8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImFjdGlvbnMtYnRuIGJzLWRlc2VsZWN0LWFsbCBidG4gYnRuLWRlZmF1bHRcXFwiPicgK1xcclxcbiAgICAgIHRoaXMub3B0aW9ucy5kZXNlbGVjdEFsbFRleHQgK1xcclxcbiAgICAgICc8L2J1dHRvbj4nICtcXHJcXG4gICAgICAnPC9kaXY+JyArXFxyXFxuICAgICAgJzwvZGl2PidcXHJcXG4gICAgICAgICAgOiAnJztcXHJcXG4gICAgICB2YXIgZG9uZWJ1dHRvbiA9IHRoaXMubXVsdGlwbGUgJiYgdGhpcy5vcHRpb25zLmRvbmVCdXR0b24gP1xcclxcbiAgICAgICc8ZGl2IGNsYXNzPVxcXCJicy1kb25lYnV0dG9uXFxcIj4nICtcXHJcXG4gICAgICAnPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ibG9ja1xcXCI+JyArXFxyXFxuICAgICAgJzxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdFxcXCI+JyArXFxyXFxuICAgICAgdGhpcy5vcHRpb25zLmRvbmVCdXR0b25UZXh0ICtcXHJcXG4gICAgICAnPC9idXR0b24+JyArXFxyXFxuICAgICAgJzwvZGl2PicgK1xcclxcbiAgICAgICc8L2Rpdj4nXFxyXFxuICAgICAgICAgIDogJyc7XFxyXFxuICAgICAgdmFyIGRyb3AgPVxcclxcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJvb3RzdHJhcC1zZWxlY3QnICsgc2hvd1RpY2sgKyBpbnB1dEdyb3VwICsgJ1xcXCI+JyArXFxyXFxuICAgICAgICAgICc8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcIicgKyB0aGlzLm9wdGlvbnMuc3R5bGVCYXNlICsgJyBkcm9wZG93bi10b2dnbGVcXFwiIGRhdGEtdG9nZ2xlPVxcXCJkcm9wZG93blxcXCInICsgYXV0b2ZvY3VzICsgJyByb2xlPVxcXCJidXR0b25cXFwiPicgK1xcclxcbiAgICAgICAgICAnPHNwYW4gY2xhc3M9XFxcImZpbHRlci1vcHRpb24gcHVsbC1sZWZ0XFxcIj48L3NwYW4+Jm5ic3A7JyArXFxyXFxuICAgICAgICAgICc8c3BhbiBjbGFzcz1cXFwiYnMtY2FyZXRcXFwiPicgK1xcclxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMudGVtcGxhdGUuY2FyZXQgK1xcclxcbiAgICAgICAgICAnPC9zcGFuPicgK1xcclxcbiAgICAgICAgICAnPC9idXR0b24+JyArXFxyXFxuICAgICAgICAgICc8ZGl2IGNsYXNzPVxcXCJkcm9wZG93bi1tZW51IG9wZW5cXFwiIHJvbGU9XFxcImNvbWJvYm94XFxcIj4nICtcXHJcXG4gICAgICAgICAgaGVhZGVyICtcXHJcXG4gICAgICAgICAgc2VhcmNoYm94ICtcXHJcXG4gICAgICAgICAgYWN0aW9uc2JveCArXFxyXFxuICAgICAgICAgICc8dWwgY2xhc3M9XFxcImRyb3Bkb3duLW1lbnUgaW5uZXJcXFwiIHJvbGU9XFxcImxpc3Rib3hcXFwiIGFyaWEtZXhwYW5kZWQ9XFxcImZhbHNlXFxcIj4nICtcXHJcXG4gICAgICAgICAgJzwvdWw+JyArXFxyXFxuICAgICAgICAgIGRvbmVidXR0b24gK1xcclxcbiAgICAgICAgICAnPC9kaXY+JyArXFxyXFxuICAgICAgICAgICc8L2Rpdj4nO1xcclxcblxcclxcbiAgICAgIHJldHVybiAkKGRyb3ApO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBjcmVhdGVWaWV3OiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyICRkcm9wID0gdGhpcy5jcmVhdGVEcm9wZG93bigpLFxcclxcbiAgICAgICAgICBsaSA9IHRoaXMuY3JlYXRlTGkoKTtcXHJcXG5cXHJcXG4gICAgICAkZHJvcC5maW5kKCd1bCcpWzBdLmlubmVySFRNTCA9IGxpO1xcclxcbiAgICAgIHJldHVybiAkZHJvcDtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgcmVsb2FkTGk6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAvL1JlbW92ZSBhbGwgY2hpbGRyZW4uXFxyXFxuICAgICAgdGhpcy5kZXN0cm95TGkoKTtcXHJcXG4gICAgICAvL1JlIGJ1aWxkXFxyXFxuICAgICAgdmFyIGxpID0gdGhpcy5jcmVhdGVMaSgpO1xcclxcbiAgICAgIHRoaXMuJG1lbnVJbm5lclswXS5pbm5lckhUTUwgPSBsaTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgZGVzdHJveUxpOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kbWVudS5maW5kKCdsaScpLnJlbW92ZSgpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBjcmVhdGVMaTogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHZhciB0aGF0ID0gdGhpcyxcXHJcXG4gICAgICAgICAgX2xpID0gW10sXFxyXFxuICAgICAgICAgIG9wdElEID0gMCxcXHJcXG4gICAgICAgICAgdGl0bGVPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKSxcXHJcXG4gICAgICAgICAgbGlJbmRleCA9IC0xOyAvLyBpbmNyZW1lbnQgbGlJbmRleCB3aGVuZXZlciBhIG5ldyA8bGk+IGVsZW1lbnQgaXMgY3JlYXRlZCB0byBlbnN1cmUgbGlPYmogaXMgY29ycmVjdFxcclxcblxcclxcbiAgICAgIC8vIEhlbHBlciBmdW5jdGlvbnNcXHJcXG4gICAgICAvKipcXHJcXG4gICAgICAgKiBAcGFyYW0gY29udGVudFxcclxcbiAgICAgICAqIEBwYXJhbSBbaW5kZXhdXFxyXFxuICAgICAgICogQHBhcmFtIFtjbGFzc2VzXVxcclxcbiAgICAgICAqIEBwYXJhbSBbb3B0Z3JvdXBdXFxyXFxuICAgICAgICogQHJldHVybnMge3N0cmluZ31cXHJcXG4gICAgICAgKi9cXHJcXG4gICAgICB2YXIgZ2VuZXJhdGVMSSA9IGZ1bmN0aW9uIChjb250ZW50LCBpbmRleCwgY2xhc3Nlcywgb3B0Z3JvdXApIHtcXHJcXG4gICAgICAgIHJldHVybiAnPGxpJyArXFxyXFxuICAgICAgICAgICAgKCh0eXBlb2YgY2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcgJiAnJyAhPT0gY2xhc3NlcykgPyAnIGNsYXNzPVxcXCInICsgY2xhc3NlcyArICdcXFwiJyA6ICcnKSArXFxyXFxuICAgICAgICAgICAgKCh0eXBlb2YgaW5kZXggIT09ICd1bmRlZmluZWQnICYgbnVsbCAhPT0gaW5kZXgpID8gJyBkYXRhLW9yaWdpbmFsLWluZGV4PVxcXCInICsgaW5kZXggKyAnXFxcIicgOiAnJykgK1xcclxcbiAgICAgICAgICAgICgodHlwZW9mIG9wdGdyb3VwICE9PSAndW5kZWZpbmVkJyAmIG51bGwgIT09IG9wdGdyb3VwKSA/ICdkYXRhLW9wdGdyb3VwPVxcXCInICsgb3B0Z3JvdXAgKyAnXFxcIicgOiAnJykgK1xcclxcbiAgICAgICAgICAgICc+JyArIGNvbnRlbnQgKyAnPC9saT4nO1xcclxcbiAgICAgIH07XFxyXFxuXFxyXFxuICAgICAgLyoqXFxyXFxuICAgICAgICogQHBhcmFtIHRleHRcXHJcXG4gICAgICAgKiBAcGFyYW0gW2NsYXNzZXNdXFxyXFxuICAgICAgICogQHBhcmFtIFtpbmxpbmVdXFxyXFxuICAgICAgICogQHBhcmFtIFt0b2tlbnNdXFxyXFxuICAgICAgICogQHJldHVybnMge3N0cmluZ31cXHJcXG4gICAgICAgKi9cXHJcXG4gICAgICB2YXIgZ2VuZXJhdGVBID0gZnVuY3Rpb24gKHRleHQsIGNsYXNzZXMsIGlubGluZSwgdG9rZW5zKSB7XFxyXFxuICAgICAgICByZXR1cm4gJzxhIHRhYmluZGV4PVxcXCIwXFxcIicgK1xcclxcbiAgICAgICAgICAgICh0eXBlb2YgY2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcgPyAnIGNsYXNzPVxcXCInICsgY2xhc3NlcyArICdcXFwiJyA6ICcnKSArXFxyXFxuICAgICAgICAgICAgKHR5cGVvZiBpbmxpbmUgIT09ICd1bmRlZmluZWQnID8gJyBzdHlsZT1cXFwiJyArIGlubGluZSArICdcXFwiJyA6ICcnKSArXFxyXFxuICAgICAgICAgICAgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoTm9ybWFsaXplID8gJyBkYXRhLW5vcm1hbGl6ZWQtdGV4dD1cXFwiJyArIG5vcm1hbGl6ZVRvQmFzZShodG1sRXNjYXBlKHRleHQpKSArICdcXFwiJyA6ICcnKSArXFxyXFxuICAgICAgICAgICAgKHR5cGVvZiB0b2tlbnMgIT09ICd1bmRlZmluZWQnIHx8IHRva2VucyAhPT0gbnVsbCA/ICcgZGF0YS10b2tlbnM9XFxcIicgKyB0b2tlbnMgKyAnXFxcIicgOiAnJykgK1xcclxcbiAgICAgICAgICAgICcgcm9sZT1cXFwib3B0aW9uXFxcIj4nICsgdGV4dCArXFxyXFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVxcXCInICsgdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgdGhhdC5vcHRpb25zLnRpY2tJY29uICsgJyBjaGVjay1tYXJrXFxcIj48L3NwYW4+JyArXFxyXFxuICAgICAgICAgICAgJzwvYT4nO1xcclxcbiAgICAgIH07XFxyXFxuXFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50aXRsZSAmJiAhdGhpcy5tdWx0aXBsZSkge1xcclxcbiAgICAgICAgLy8gdGhpcyBvcHRpb24gZG9lc24ndCBjcmVhdGUgYSBuZXcgPGxpPiBlbGVtZW50LCBidXQgZG9lcyBhZGQgYSBuZXcgb3B0aW9uLCBzbyBsaUluZGV4IGlzIGRlY3JlYXNlZFxcclxcbiAgICAgICAgLy8gc2luY2UgbGlPYmogaXMgcmVjYWxjdWxhdGVkIG9uIGV2ZXJ5IHJlZnJlc2gsIGxpSW5kZXggbmVlZHMgdG8gYmUgZGVjcmVhc2VkIGV2ZW4gaWYgdGhlIHRpdGxlT3B0aW9uIGlzIGFscmVhZHkgYXBwZW5kZWRcXHJcXG4gICAgICAgIGxpSW5kZXgtLTtcXHJcXG5cXHJcXG4gICAgICAgIGlmICghdGhpcy4kZWxlbWVudC5maW5kKCcuYnMtdGl0bGUtb3B0aW9uJykubGVuZ3RoKSB7XFxyXFxuICAgICAgICAgIC8vIFVzZSBuYXRpdmUgSlMgdG8gcHJlcGVuZCBvcHRpb24gKGZhc3RlcilcXHJcXG4gICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLiRlbGVtZW50WzBdO1xcclxcbiAgICAgICAgICB0aXRsZU9wdGlvbi5jbGFzc05hbWUgPSAnYnMtdGl0bGUtb3B0aW9uJztcXHJcXG4gICAgICAgICAgdGl0bGVPcHRpb24uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5vcHRpb25zLnRpdGxlKSk7XFxyXFxuICAgICAgICAgIHRpdGxlT3B0aW9uLnZhbHVlID0gJyc7XFxyXFxuICAgICAgICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRpdGxlT3B0aW9uLCBlbGVtZW50LmZpcnN0Q2hpbGQpO1xcclxcbiAgICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3RlZCBvciBkYXRhLXNlbGVjdGVkIGF0dHJpYnV0ZSBpcyBhbHJlYWR5IHNldCBvbiBhbiBvcHRpb24uIElmIG5vdCwgc2VsZWN0IHRoZSB0aXRsZU9wdGlvbiBvcHRpb24uXFxyXFxuICAgICAgICAgIC8vIHRoZSBzZWxlY3RlZCBpdGVtIG1heSBoYXZlIGJlZW4gY2hhbmdlZCBieSB1c2VyIG9yIHByb2dyYW1tYXRpY2FsbHkgYmVmb3JlIHRoZSBib290c3RyYXAgc2VsZWN0IHBsdWdpbiBydW5zLFxcclxcbiAgICAgICAgICAvLyBpZiBzbywgdGhlIHNlbGVjdCB3aWxsIGhhdmUgdGhlIGRhdGEtc2VsZWN0ZWQgYXR0cmlidXRlXFxyXFxuICAgICAgICAgIHZhciAkb3B0ID0gJChlbGVtZW50Lm9wdGlvbnNbZWxlbWVudC5zZWxlY3RlZEluZGV4XSk7XFxyXFxuICAgICAgICAgIGlmICgkb3B0LmF0dHIoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZCAmJiB0aGlzLiRlbGVtZW50LmRhdGEoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZCkge1xcclxcbiAgICAgICAgICAgIHRpdGxlT3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcXHJcXG4gICAgICAgICAgfVxcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB0aGlzLiRlbGVtZW50LmZpbmQoJ29wdGlvbicpLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7XFxyXFxuICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xcclxcblxcclxcbiAgICAgICAgbGlJbmRleCsrO1xcclxcblxcclxcbiAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdicy10aXRsZS1vcHRpb24nKSkgcmV0dXJuO1xcclxcblxcclxcbiAgICAgICAgLy8gR2V0IHRoZSBjbGFzcyBhbmQgdGV4dCBmb3IgdGhlIG9wdGlvblxcclxcbiAgICAgICAgdmFyIG9wdGlvbkNsYXNzID0gdGhpcy5jbGFzc05hbWUgfHwgJycsXFxyXFxuICAgICAgICAgICAgaW5saW5lID0gdGhpcy5zdHlsZS5jc3NUZXh0LFxcclxcbiAgICAgICAgICAgIHRleHQgPSAkdGhpcy5kYXRhKCdjb250ZW50JykgPyAkdGhpcy5kYXRhKCdjb250ZW50JykgOiAkdGhpcy5odG1sKCksXFxyXFxuICAgICAgICAgICAgdG9rZW5zID0gJHRoaXMuZGF0YSgndG9rZW5zJykgPyAkdGhpcy5kYXRhKCd0b2tlbnMnKSA6IG51bGwsXFxyXFxuICAgICAgICAgICAgc3VidGV4dCA9IHR5cGVvZiAkdGhpcy5kYXRhKCdzdWJ0ZXh0JykgIT09ICd1bmRlZmluZWQnID8gJzxzbWFsbCBjbGFzcz1cXFwidGV4dC1tdXRlZFxcXCI+JyArICR0aGlzLmRhdGEoJ3N1YnRleHQnKSArICc8L3NtYWxsPicgOiAnJyxcXHJcXG4gICAgICAgICAgICBpY29uID0gdHlwZW9mICR0aGlzLmRhdGEoJ2ljb24nKSAhPT0gJ3VuZGVmaW5lZCcgPyAnPHNwYW4gY2xhc3M9XFxcIicgKyB0aGF0Lm9wdGlvbnMuaWNvbkJhc2UgKyAnICcgKyAkdGhpcy5kYXRhKCdpY29uJykgKyAnXFxcIj48L3NwYW4+ICcgOiAnJyxcXHJcXG4gICAgICAgICAgICAkcGFyZW50ID0gJHRoaXMucGFyZW50KCksXFxyXFxuICAgICAgICAgICAgaXNPcHRncm91cCA9ICRwYXJlbnRbMF0udGFnTmFtZSA9PT0gJ09QVEdST1VQJyxcXHJcXG4gICAgICAgICAgICBpc09wdGdyb3VwRGlzYWJsZWQgPSBpc09wdGdyb3VwICYmICRwYXJlbnRbMF0uZGlzYWJsZWQsXFxyXFxuICAgICAgICAgICAgaXNEaXNhYmxlZCA9IHRoaXMuZGlzYWJsZWQgfHwgaXNPcHRncm91cERpc2FibGVkO1xcclxcblxcclxcbiAgICAgICAgaWYgKGljb24gIT09ICcnICYmIGlzRGlzYWJsZWQpIHtcXHJcXG4gICAgICAgICAgaWNvbiA9ICc8c3Bhbj4nICsgaWNvbiArICc8L3NwYW4+JztcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmIChpc0Rpc2FibGVkICYmICFpc09wdGdyb3VwIHx8IGlzT3B0Z3JvdXBEaXNhYmxlZCkpIHtcXHJcXG4gICAgICAgICAgbGlJbmRleC0tO1xcclxcbiAgICAgICAgICByZXR1cm47XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBpZiAoISR0aGlzLmRhdGEoJ2NvbnRlbnQnKSkge1xcclxcbiAgICAgICAgICAvLyBQcmVwZW5kIGFueSBpY29uIGFuZCBhcHBlbmQgYW55IHN1YnRleHQgdG8gdGhlIG1haW4gdGV4dC5cXHJcXG4gICAgICAgICAgdGV4dCA9IGljb24gKyAnPHNwYW4gY2xhc3M9XFxcInRleHRcXFwiPicgKyB0ZXh0ICsgc3VidGV4dCArICc8L3NwYW4+JztcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGlmIChpc09wdGdyb3VwICYmICR0aGlzLmRhdGEoJ2RpdmlkZXInKSAhPT0gdHJ1ZSkge1xcclxcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiBpc0Rpc2FibGVkKSB7XFxyXFxuICAgICAgICAgICAgaWYgKCRwYXJlbnQuZGF0YSgnYWxsT3B0aW9uc0Rpc2FibGVkJykgPT09IHVuZGVmaW5lZCkge1xcclxcbiAgICAgICAgICAgICAgdmFyICRvcHRpb25zID0gJHBhcmVudC5jaGlsZHJlbigpO1xcclxcbiAgICAgICAgICAgICAgJHBhcmVudC5kYXRhKCdhbGxPcHRpb25zRGlzYWJsZWQnLCAkb3B0aW9ucy5maWx0ZXIoJzpkaXNhYmxlZCcpLmxlbmd0aCA9PT0gJG9wdGlvbnMubGVuZ3RoKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgICAgaWYgKCRwYXJlbnQuZGF0YSgnYWxsT3B0aW9uc0Rpc2FibGVkJykpIHtcXHJcXG4gICAgICAgICAgICAgIGxpSW5kZXgtLTtcXHJcXG4gICAgICAgICAgICAgIHJldHVybjtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICAgdmFyIG9wdEdyb3VwQ2xhc3MgPSAnICcgKyAkcGFyZW50WzBdLmNsYXNzTmFtZSB8fCAnJztcXHJcXG5cXHJcXG4gICAgICAgICAgaWYgKCR0aGlzLmluZGV4KCkgPT09IDApIHsgLy8gSXMgaXQgdGhlIGZpcnN0IG9wdGlvbiBvZiB0aGUgb3B0Z3JvdXA/XFxyXFxuICAgICAgICAgICAgb3B0SUQgKz0gMTtcXHJcXG5cXHJcXG4gICAgICAgICAgICAvLyBHZXQgdGhlIG9wdCBncm91cCBsYWJlbFxcclxcbiAgICAgICAgICAgIHZhciBsYWJlbCA9ICRwYXJlbnRbMF0ubGFiZWwsXFxyXFxuICAgICAgICAgICAgICAgIGxhYmVsU3VidGV4dCA9IHR5cGVvZiAkcGFyZW50LmRhdGEoJ3N1YnRleHQnKSAhPT0gJ3VuZGVmaW5lZCcgPyAnPHNtYWxsIGNsYXNzPVxcXCJ0ZXh0LW11dGVkXFxcIj4nICsgJHBhcmVudC5kYXRhKCdzdWJ0ZXh0JykgKyAnPC9zbWFsbD4nIDogJycsXFxyXFxuICAgICAgICAgICAgICAgIGxhYmVsSWNvbiA9ICRwYXJlbnQuZGF0YSgnaWNvbicpID8gJzxzcGFuIGNsYXNzPVxcXCInICsgdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgJHBhcmVudC5kYXRhKCdpY29uJykgKyAnXFxcIj48L3NwYW4+ICcgOiAnJztcXHJcXG5cXHJcXG4gICAgICAgICAgICBsYWJlbCA9IGxhYmVsSWNvbiArICc8c3BhbiBjbGFzcz1cXFwidGV4dFxcXCI+JyArIGxhYmVsICsgbGFiZWxTdWJ0ZXh0ICsgJzwvc3Bhbj4nO1xcclxcblxcclxcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gMCAmJiBfbGkubGVuZ3RoID4gMCkgeyAvLyBJcyBpdCBOT1QgdGhlIGZpcnN0IG9wdGlvbiBvZiB0aGUgc2VsZWN0ICYmIGFyZSB0aGVyZSBlbGVtZW50cyBpbiB0aGUgZHJvcGRvd24/XFxyXFxuICAgICAgICAgICAgICBsaUluZGV4Kys7XFxyXFxuICAgICAgICAgICAgICBfbGkucHVzaChnZW5lcmF0ZUxJKCcnLCBudWxsLCAnZGl2aWRlcicsIG9wdElEICsgJ2RpdicpKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgICAgbGlJbmRleCsrO1xcclxcbiAgICAgICAgICAgIF9saS5wdXNoKGdlbmVyYXRlTEkobGFiZWwsIG51bGwsICdkcm9wZG93bi1oZWFkZXInICsgb3B0R3JvdXBDbGFzcywgb3B0SUQpKTtcXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiBpc0Rpc2FibGVkKSB7XFxyXFxuICAgICAgICAgICAgbGlJbmRleC0tO1xcclxcbiAgICAgICAgICAgIHJldHVybjtcXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICBfbGkucHVzaChnZW5lcmF0ZUxJKGdlbmVyYXRlQSh0ZXh0LCAnb3B0ICcgKyBvcHRpb25DbGFzcyArIG9wdEdyb3VwQ2xhc3MsIGlubGluZSwgdG9rZW5zKSwgaW5kZXgsICcnLCBvcHRJRCkpO1xcclxcbiAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5kYXRhKCdkaXZpZGVyJykgPT09IHRydWUpIHtcXHJcXG4gICAgICAgICAgX2xpLnB1c2goZ2VuZXJhdGVMSSgnJywgaW5kZXgsICdkaXZpZGVyJykpO1xcclxcbiAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5kYXRhKCdoaWRkZW4nKSA9PT0gdHJ1ZSkge1xcclxcbiAgICAgICAgICBfbGkucHVzaChnZW5lcmF0ZUxJKGdlbmVyYXRlQSh0ZXh0LCBvcHRpb25DbGFzcywgaW5saW5lLCB0b2tlbnMpLCBpbmRleCwgJ2hpZGRlbiBpcy1oaWRkZW4nKSk7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICB2YXIgc2hvd0RpdmlkZXIgPSB0aGlzLnByZXZpb3VzRWxlbWVudFNpYmxpbmcgJiYgdGhpcy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnRhZ05hbWUgPT09ICdPUFRHUk9VUCc7XFxyXFxuXFxyXFxuICAgICAgICAgIC8vIGlmIHByZXZpb3VzIGVsZW1lbnQgaXMgbm90IGFuIG9wdGdyb3VwIGFuZCBoaWRlRGlzYWJsZWQgaXMgdHJ1ZVxcclxcbiAgICAgICAgICBpZiAoIXNob3dEaXZpZGVyICYmIHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQpIHtcXHJcXG4gICAgICAgICAgICAvLyBnZXQgcHJldmlvdXMgZWxlbWVudHNcXHJcXG4gICAgICAgICAgICB2YXIgJHByZXYgPSAkKHRoaXMpLnByZXZBbGwoKTtcXHJcXG5cXHJcXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRwcmV2Lmxlbmd0aDsgaSsrKSB7XFxyXFxuICAgICAgICAgICAgICAvLyBmaW5kIHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBwcmV2aW91cyBlbGVtZW50cyB0aGF0IGlzIGFuIG9wdGdyb3VwXFxyXFxuICAgICAgICAgICAgICBpZiAoJHByZXZbaV0udGFnTmFtZSA9PT0gJ09QVEdST1VQJykge1xcclxcbiAgICAgICAgICAgICAgICB2YXIgb3B0R3JvdXBEaXN0YW5jZSA9IDA7XFxyXFxuXFxyXFxuICAgICAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCB0aGUgb3B0aW9ucyBpbiBiZXR3ZWVuIHRoZSBjdXJyZW50IG9wdGlvbiBhbmQgdGhlIG9wdGdyb3VwXFxyXFxuICAgICAgICAgICAgICAgIC8vIGFuZCBjaGVjayBpZiB0aGV5IGFyZSBoaWRkZW4gb3IgZGlzYWJsZWRcXHJcXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBpOyBkKyspIHtcXHJcXG4gICAgICAgICAgICAgICAgICB2YXIgcHJldk9wdGlvbiA9ICRwcmV2W2RdO1xcclxcbiAgICAgICAgICAgICAgICAgIGlmIChwcmV2T3B0aW9uLmRpc2FibGVkIHx8ICQocHJldk9wdGlvbikuZGF0YSgnaGlkZGVuJykgPT09IHRydWUpIG9wdEdyb3VwRGlzdGFuY2UrKztcXHJcXG4gICAgICAgICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICAgICAgICAvLyBpZiBhbGwgb2YgdGhlIG9wdGlvbnMgYmV0d2VlbiB0aGUgY3VycmVudCBvcHRpb24gYW5kIHRoZSBvcHRncm91cCBhcmUgaGlkZGVuIG9yIGRpc2FibGVkLCBzaG93IHRoZSBkaXZpZGVyXFxyXFxuICAgICAgICAgICAgICAgIGlmIChvcHRHcm91cERpc3RhbmNlID09PSBpKSBzaG93RGl2aWRlciA9IHRydWU7XFxyXFxuXFxyXFxuICAgICAgICAgICAgICAgIGJyZWFrO1xcclxcbiAgICAgICAgICAgICAgfVxcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICBpZiAoc2hvd0RpdmlkZXIpIHtcXHJcXG4gICAgICAgICAgICBsaUluZGV4Kys7XFxyXFxuICAgICAgICAgICAgX2xpLnB1c2goZ2VuZXJhdGVMSSgnJywgbnVsbCwgJ2RpdmlkZXInLCBvcHRJRCArICdkaXYnKSk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgX2xpLnB1c2goZ2VuZXJhdGVMSShnZW5lcmF0ZUEodGV4dCwgb3B0aW9uQ2xhc3MsIGlubGluZSwgdG9rZW5zKSwgaW5kZXgpKTtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIHRoYXQubGlPYmpbaW5kZXhdID0gbGlJbmRleDtcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICAvL0lmIHdlIGFyZSBub3QgbXVsdGlwbGUsIHdlIGRvbid0IGhhdmUgYSBzZWxlY3RlZCBpdGVtLCBhbmQgd2UgZG9uJ3QgaGF2ZSBhIHRpdGxlLCBzZWxlY3QgdGhlIGZpcnN0IGVsZW1lbnQgc28gc29tZXRoaW5nIGlzIHNldCBpbiB0aGUgYnV0dG9uXFxyXFxuICAgICAgaWYgKCF0aGlzLm11bHRpcGxlICYmIHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykubGVuZ3RoID09PSAwICYmICF0aGlzLm9wdGlvbnMudGl0bGUpIHtcXHJcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykuZXEoMCkucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKS5hdHRyKCdzZWxlY3RlZCcsICdzZWxlY3RlZCcpO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICByZXR1cm4gX2xpLmpvaW4oJycpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBmaW5kTGlzOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgaWYgKHRoaXMuJGxpcyA9PSBudWxsKSB0aGlzLiRsaXMgPSB0aGlzLiRtZW51LmZpbmQoJ2xpJyk7XFxyXFxuICAgICAgcmV0dXJuIHRoaXMuJGxpcztcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgLyoqXFxyXFxuICAgICAqIEBwYXJhbSBbdXBkYXRlTGldIGRlZmF1bHRzIHRvIHRydWVcXHJcXG4gICAgICovXFxyXFxuICAgIHJlbmRlcjogZnVuY3Rpb24gKHVwZGF0ZUxpKSB7XFxyXFxuICAgICAgdmFyIHRoYXQgPSB0aGlzLFxcclxcbiAgICAgICAgICBub3REaXNhYmxlZDtcXHJcXG5cXHJcXG4gICAgICAvL1VwZGF0ZSB0aGUgTEkgdG8gbWF0Y2ggdGhlIFNFTEVDVFxcclxcbiAgICAgIGlmICh1cGRhdGVMaSAhPT0gZmFsc2UpIHtcXHJcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcXHJcXG4gICAgICAgICAgdmFyICRsaXMgPSB0aGF0LmZpbmRMaXMoKS5lcSh0aGF0LmxpT2JqW2luZGV4XSk7XFxyXFxuXFxyXFxuICAgICAgICAgIHRoYXQuc2V0RGlzYWJsZWQoaW5kZXgsIHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgdGhpcy5wYXJlbnROb2RlLmRpc2FibGVkLCAkbGlzKTtcXHJcXG4gICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChpbmRleCwgdGhpcy5zZWxlY3RlZCwgJGxpcyk7XFxyXFxuICAgICAgICB9KTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdGhpcy50b2dnbGVQbGFjZWhvbGRlcigpO1xcclxcblxcclxcbiAgICAgIHRoaXMudGFiSW5kZXgoKTtcXHJcXG5cXHJcXG4gICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykubWFwKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkKSB7XFxyXFxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucGFyZW50Tm9kZS50YWdOYW1lID09PSAnT1BUR1JPVVAnICYmIHRoaXMucGFyZW50Tm9kZS5kaXNhYmxlZCkpIHJldHVybjtcXHJcXG5cXHJcXG4gICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcXHJcXG4gICAgICAgICAgICAgIGljb24gPSAkdGhpcy5kYXRhKCdpY29uJykgJiYgdGhhdC5vcHRpb25zLnNob3dJY29uID8gJzxpIGNsYXNzPVxcXCInICsgdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgJHRoaXMuZGF0YSgnaWNvbicpICsgJ1xcXCI+PC9pPiAnIDogJycsXFxyXFxuICAgICAgICAgICAgICBzdWJ0ZXh0O1xcclxcblxcclxcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLnNob3dTdWJ0ZXh0ICYmICR0aGlzLmRhdGEoJ3N1YnRleHQnKSAmJiAhdGhhdC5tdWx0aXBsZSkge1xcclxcbiAgICAgICAgICAgIHN1YnRleHQgPSAnIDxzbWFsbCBjbGFzcz1cXFwidGV4dC1tdXRlZFxcXCI+JyArICR0aGlzLmRhdGEoJ3N1YnRleHQnKSArICc8L3NtYWxsPic7XFxyXFxuICAgICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgICAgc3VidGV4dCA9ICcnO1xcclxcbiAgICAgICAgICB9XFxyXFxuICAgICAgICAgIGlmICh0eXBlb2YgJHRoaXMuYXR0cigndGl0bGUnKSAhPT0gJ3VuZGVmaW5lZCcpIHtcXHJcXG4gICAgICAgICAgICByZXR1cm4gJHRoaXMuYXR0cigndGl0bGUnKTtcXHJcXG4gICAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5kYXRhKCdjb250ZW50JykgJiYgdGhhdC5vcHRpb25zLnNob3dDb250ZW50KSB7XFxyXFxuICAgICAgICAgICAgcmV0dXJuICR0aGlzLmRhdGEoJ2NvbnRlbnQnKTtcXHJcXG4gICAgICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICAgICByZXR1cm4gaWNvbiArICR0aGlzLmh0bWwoKSArIHN1YnRleHQ7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9KS50b0FycmF5KCk7XFxyXFxuXFxyXFxuICAgICAgLy9GaXhlcyBpc3N1ZSBpbiBJRTEwIG9jY3VycmluZyB3aGVuIG5vIGRlZmF1bHQgb3B0aW9uIGlzIHNlbGVjdGVkIGFuZCBhdCBsZWFzdCBvbmUgb3B0aW9uIGlzIGRpc2FibGVkXFxyXFxuICAgICAgLy9Db252ZXJ0IGFsbCB0aGUgdmFsdWVzIGludG8gYSBjb21tYSBkZWxpbWl0ZWQgc3RyaW5nXFxyXFxuICAgICAgdmFyIHRpdGxlID0gIXRoaXMubXVsdGlwbGUgPyBzZWxlY3RlZEl0ZW1zWzBdIDogc2VsZWN0ZWRJdGVtcy5qb2luKHRoaXMub3B0aW9ucy5tdWx0aXBsZVNlcGFyYXRvcik7XFxyXFxuXFxyXFxuICAgICAgLy9JZiB0aGlzIGlzIG11bHRpIHNlbGVjdCwgYW5kIHRoZSBzZWxlY3RUZXh0IHR5cGUgaXMgY291bnQsIHRoZSBzaG93IDEgb2YgMiBzZWxlY3RlZCBldGMuLlxcclxcbiAgICAgIGlmICh0aGlzLm11bHRpcGxlICYmIHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQuaW5kZXhPZignY291bnQnKSA+IC0xKSB7XFxyXFxuICAgICAgICB2YXIgbWF4ID0gdGhpcy5vcHRpb25zLnNlbGVjdGVkVGV4dEZvcm1hdC5zcGxpdCgnPicpO1xcclxcbiAgICAgICAgaWYgKChtYXgubGVuZ3RoID4gMSAmJiBzZWxlY3RlZEl0ZW1zLmxlbmd0aCA+IG1heFsxXSkgfHwgKG1heC5sZW5ndGggPT0gMSAmJiBzZWxlY3RlZEl0ZW1zLmxlbmd0aCA+PSAyKSkge1xcclxcbiAgICAgICAgICBub3REaXNhYmxlZCA9IHRoaXMub3B0aW9ucy5oaWRlRGlzYWJsZWQgPyAnLCBbZGlzYWJsZWRdJyA6ICcnO1xcclxcbiAgICAgICAgICB2YXIgdG90YWxDb3VudCA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykubm90KCdbZGF0YS1kaXZpZGVyPVxcXCJ0cnVlXFxcIl0sIFtkYXRhLWhpZGRlbj1cXFwidHJ1ZVxcXCJdJyArIG5vdERpc2FibGVkKS5sZW5ndGgsXFxyXFxuICAgICAgICAgICAgICB0cjhuVGV4dCA9ICh0eXBlb2YgdGhpcy5vcHRpb25zLmNvdW50U2VsZWN0ZWRUZXh0ID09PSAnZnVuY3Rpb24nKSA/IHRoaXMub3B0aW9ucy5jb3VudFNlbGVjdGVkVGV4dChzZWxlY3RlZEl0ZW1zLmxlbmd0aCwgdG90YWxDb3VudCkgOiB0aGlzLm9wdGlvbnMuY291bnRTZWxlY3RlZFRleHQ7XFxyXFxuICAgICAgICAgIHRpdGxlID0gdHI4blRleHQucmVwbGFjZSgnezB9Jywgc2VsZWN0ZWRJdGVtcy5sZW5ndGgudG9TdHJpbmcoKSkucmVwbGFjZSgnezF9JywgdG90YWxDb3VudC50b1N0cmluZygpKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50aXRsZSA9PSB1bmRlZmluZWQpIHtcXHJcXG4gICAgICAgIHRoaXMub3B0aW9ucy50aXRsZSA9IHRoaXMuJGVsZW1lbnQuYXR0cigndGl0bGUnKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQgPT0gJ3N0YXRpYycpIHtcXHJcXG4gICAgICAgIHRpdGxlID0gdGhpcy5vcHRpb25zLnRpdGxlO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAvL0lmIHdlIGRvbnQgaGF2ZSBhIHRpdGxlLCB0aGVuIHVzZSB0aGUgZGVmYXVsdCwgb3IgaWYgbm90aGluZyBpcyBzZXQgYXQgYWxsLCB1c2UgdGhlIG5vdCBzZWxlY3RlZCB0ZXh0XFxyXFxuICAgICAgaWYgKCF0aXRsZSkge1xcclxcbiAgICAgICAgdGl0bGUgPSB0eXBlb2YgdGhpcy5vcHRpb25zLnRpdGxlICE9PSAndW5kZWZpbmVkJyA/IHRoaXMub3B0aW9ucy50aXRsZSA6IHRoaXMub3B0aW9ucy5ub25lU2VsZWN0ZWRUZXh0O1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAvL3N0cmlwIGFsbCBodG1sLXRhZ3MgYW5kIHRyaW0gdGhlIHJlc3VsdFxcclxcbiAgICAgIHRoaXMuJGJ1dHRvbi5hdHRyKCd0aXRsZScsICQudHJpbSh0aXRsZS5yZXBsYWNlKC88W14+XSo+Py9nLCAnJykpKTtcXHJcXG4gICAgICB0aGlzLiRidXR0b24uY2hpbGRyZW4oJy5maWx0ZXItb3B0aW9uJykuaHRtbCh0aXRsZSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdyZW5kZXJlZC5icy5zZWxlY3QnKTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgLyoqXFxyXFxuICAgICAqIEBwYXJhbSBbc3R5bGVdXFxyXFxuICAgICAqIEBwYXJhbSBbc3RhdHVzXVxcclxcbiAgICAgKi9cXHJcXG4gICAgc2V0U3R5bGU6IGZ1bmN0aW9uIChzdHlsZSwgc3RhdHVzKSB7XFxyXFxuICAgICAgaWYgKHRoaXMuJGVsZW1lbnQuYXR0cignY2xhc3MnKSkge1xcclxcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5hZGRDbGFzcyh0aGlzLiRlbGVtZW50LmF0dHIoJ2NsYXNzJykucmVwbGFjZSgvc2VsZWN0cGlja2VyfG1vYmlsZS1kZXZpY2V8YnMtc2VsZWN0LWhpZGRlbnx2YWxpZGF0ZVxcXFxbLipcXFxcXS9naSwgJycpKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdmFyIGJ1dHRvbkNsYXNzID0gc3R5bGUgPyBzdHlsZSA6IHRoaXMub3B0aW9ucy5zdHlsZTtcXHJcXG5cXHJcXG4gICAgICBpZiAoc3RhdHVzID09ICdhZGQnKSB7XFxyXFxuICAgICAgICB0aGlzLiRidXR0b24uYWRkQ2xhc3MoYnV0dG9uQ2xhc3MpO1xcclxcbiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09ICdyZW1vdmUnKSB7XFxyXFxuICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3MoYnV0dG9uQ2xhc3MpO1xcclxcbiAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnN0eWxlKTtcXHJcXG4gICAgICAgIHRoaXMuJGJ1dHRvbi5hZGRDbGFzcyhidXR0b25DbGFzcyk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBsaUhlaWdodDogZnVuY3Rpb24gKHJlZnJlc2gpIHtcXHJcXG4gICAgICBpZiAoIXJlZnJlc2ggJiYgKHRoaXMub3B0aW9ucy5zaXplID09PSBmYWxzZSB8fCB0aGlzLnNpemVJbmZvKSkgcmV0dXJuO1xcclxcblxcclxcbiAgICAgIHZhciBuZXdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXFxyXFxuICAgICAgICAgIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcXHJcXG4gICAgICAgICAgbWVudUlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKSxcXHJcXG4gICAgICAgICAgZGl2aWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyksXFxyXFxuICAgICAgICAgIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSxcXHJcXG4gICAgICAgICAgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSxcXHJcXG4gICAgICAgICAgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSxcXHJcXG4gICAgICAgICAgaGVhZGVyID0gdGhpcy5vcHRpb25zLmhlYWRlciAmJiB0aGlzLiRtZW51LmZpbmQoJy5wb3BvdmVyLXRpdGxlJykubGVuZ3RoID4gMCA/IHRoaXMuJG1lbnUuZmluZCgnLnBvcG92ZXItdGl0bGUnKVswXS5jbG9uZU5vZGUodHJ1ZSkgOiBudWxsLFxcclxcbiAgICAgICAgICBzZWFyY2ggPSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpIDogbnVsbCxcXHJcXG4gICAgICAgICAgYWN0aW9ucyA9IHRoaXMub3B0aW9ucy5hY3Rpb25zQm94ICYmIHRoaXMubXVsdGlwbGUgJiYgdGhpcy4kbWVudS5maW5kKCcuYnMtYWN0aW9uc2JveCcpLmxlbmd0aCA+IDAgPyB0aGlzLiRtZW51LmZpbmQoJy5icy1hY3Rpb25zYm94JylbMF0uY2xvbmVOb2RlKHRydWUpIDogbnVsbCxcXHJcXG4gICAgICAgICAgZG9uZUJ1dHRvbiA9IHRoaXMub3B0aW9ucy5kb25lQnV0dG9uICYmIHRoaXMubXVsdGlwbGUgJiYgdGhpcy4kbWVudS5maW5kKCcuYnMtZG9uZWJ1dHRvbicpLmxlbmd0aCA+IDAgPyB0aGlzLiRtZW51LmZpbmQoJy5icy1kb25lYnV0dG9uJylbMF0uY2xvbmVOb2RlKHRydWUpIDogbnVsbDtcXHJcXG5cXHJcXG4gICAgICB0ZXh0LmNsYXNzTmFtZSA9ICd0ZXh0JztcXHJcXG4gICAgICBuZXdFbGVtZW50LmNsYXNzTmFtZSA9IHRoaXMuJG1lbnVbMF0ucGFyZW50Tm9kZS5jbGFzc05hbWUgKyAnIG9wZW4nO1xcclxcbiAgICAgIG1lbnUuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLW1lbnUgb3Blbic7XFxyXFxuICAgICAgbWVudUlubmVyLmNsYXNzTmFtZSA9ICdkcm9wZG93bi1tZW51IGlubmVyJztcXHJcXG4gICAgICBkaXZpZGVyLmNsYXNzTmFtZSA9ICdkaXZpZGVyJztcXHJcXG5cXHJcXG4gICAgICB0ZXh0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdJbm5lciB0ZXh0JykpO1xcclxcbiAgICAgIGEuYXBwZW5kQ2hpbGQodGV4dCk7XFxyXFxuICAgICAgbGkuYXBwZW5kQ2hpbGQoYSk7XFxyXFxuICAgICAgbWVudUlubmVyLmFwcGVuZENoaWxkKGxpKTtcXHJcXG4gICAgICBtZW51SW5uZXIuYXBwZW5kQ2hpbGQoZGl2aWRlcik7XFxyXFxuICAgICAgaWYgKGhlYWRlcikgbWVudS5hcHBlbmRDaGlsZChoZWFkZXIpO1xcclxcbiAgICAgIGlmIChzZWFyY2gpIHtcXHJcXG4gICAgICAgIC8vIGNyZWF0ZSBhIHNwYW4gaW5zdGVhZCBvZiBpbnB1dCBhcyBjcmVhdGluZyBhbiBpbnB1dCBlbGVtZW50IGlzIHNsb3dlclxcclxcbiAgICAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xcclxcbiAgICAgICAgc2VhcmNoLmNsYXNzTmFtZSA9ICdicy1zZWFyY2hib3gnO1xcclxcbiAgICAgICAgaW5wdXQuY2xhc3NOYW1lID0gJ2Zvcm0tY29udHJvbCc7XFxyXFxuICAgICAgICBzZWFyY2guYXBwZW5kQ2hpbGQoaW5wdXQpO1xcclxcbiAgICAgICAgbWVudS5hcHBlbmRDaGlsZChzZWFyY2gpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgICBpZiAoYWN0aW9ucykgbWVudS5hcHBlbmRDaGlsZChhY3Rpb25zKTtcXHJcXG4gICAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJbm5lcik7XFxyXFxuICAgICAgaWYgKGRvbmVCdXR0b24pIG1lbnUuYXBwZW5kQ2hpbGQoZG9uZUJ1dHRvbik7XFxyXFxuICAgICAgbmV3RWxlbWVudC5hcHBlbmRDaGlsZChtZW51KTtcXHJcXG5cXHJcXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5ld0VsZW1lbnQpO1xcclxcblxcclxcbiAgICAgIHZhciBsaUhlaWdodCA9IGEub2Zmc2V0SGVpZ2h0LFxcclxcbiAgICAgICAgICBoZWFkZXJIZWlnaHQgPSBoZWFkZXIgPyBoZWFkZXIub2Zmc2V0SGVpZ2h0IDogMCxcXHJcXG4gICAgICAgICAgc2VhcmNoSGVpZ2h0ID0gc2VhcmNoID8gc2VhcmNoLm9mZnNldEhlaWdodCA6IDAsXFxyXFxuICAgICAgICAgIGFjdGlvbnNIZWlnaHQgPSBhY3Rpb25zID8gYWN0aW9ucy5vZmZzZXRIZWlnaHQgOiAwLFxcclxcbiAgICAgICAgICBkb25lQnV0dG9uSGVpZ2h0ID0gZG9uZUJ1dHRvbiA/IGRvbmVCdXR0b24ub2Zmc2V0SGVpZ2h0IDogMCxcXHJcXG4gICAgICAgICAgZGl2aWRlckhlaWdodCA9ICQoZGl2aWRlcikub3V0ZXJIZWlnaHQodHJ1ZSksXFxyXFxuICAgICAgICAgIC8vIGZhbGwgYmFjayB0byBqUXVlcnkgaWYgZ2V0Q29tcHV0ZWRTdHlsZSBpcyBub3Qgc3VwcG9ydGVkXFxyXFxuICAgICAgICAgIG1lbnVTdHlsZSA9IHR5cGVvZiBnZXRDb21wdXRlZFN0eWxlID09PSAnZnVuY3Rpb24nID8gZ2V0Q29tcHV0ZWRTdHlsZShtZW51KSA6IGZhbHNlLFxcclxcbiAgICAgICAgICAkbWVudSA9IG1lbnVTdHlsZSA/IG51bGwgOiAkKG1lbnUpLFxcclxcbiAgICAgICAgICBtZW51UGFkZGluZyA9IHtcXHJcXG4gICAgICAgICAgICB2ZXJ0OiBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUucGFkZGluZ1RvcCA6ICRtZW51LmNzcygncGFkZGluZ1RvcCcpKSArXFxyXFxuICAgICAgICAgICAgICAgICAgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdCb3R0b20gOiAkbWVudS5jc3MoJ3BhZGRpbmdCb3R0b20nKSkgK1xcclxcbiAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJUb3BXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyVG9wV2lkdGgnKSkgK1xcclxcbiAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyQm90dG9tV2lkdGgnKSksXFxyXFxuICAgICAgICAgICAgaG9yaXo6IHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nTGVmdCA6ICRtZW51LmNzcygncGFkZGluZ0xlZnQnKSkgK1xcclxcbiAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nUmlnaHQgOiAkbWVudS5jc3MoJ3BhZGRpbmdSaWdodCcpKSArXFxyXFxuICAgICAgICAgICAgICAgICAgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLmJvcmRlckxlZnRXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyTGVmdFdpZHRoJykpICtcXHJcXG4gICAgICAgICAgICAgICAgICBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyUmlnaHRXaWR0aCcpKVxcclxcbiAgICAgICAgICB9LFxcclxcbiAgICAgICAgICBtZW51RXh0cmFzID0gIHtcXHJcXG4gICAgICAgICAgICB2ZXJ0OiBtZW51UGFkZGluZy52ZXJ0ICtcXHJcXG4gICAgICAgICAgICAgICAgICBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luVG9wIDogJG1lbnUuY3NzKCdtYXJnaW5Ub3AnKSkgK1xcclxcbiAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5Cb3R0b20gOiAkbWVudS5jc3MoJ21hcmdpbkJvdHRvbScpKSArIDIsXFxyXFxuICAgICAgICAgICAgaG9yaXo6IG1lbnVQYWRkaW5nLmhvcml6ICtcXHJcXG4gICAgICAgICAgICAgICAgICBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luTGVmdCA6ICRtZW51LmNzcygnbWFyZ2luTGVmdCcpKSArXFxyXFxuICAgICAgICAgICAgICAgICAgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLm1hcmdpblJpZ2h0IDogJG1lbnUuY3NzKCdtYXJnaW5SaWdodCcpKSArIDJcXHJcXG4gICAgICAgICAgfVxcclxcblxcclxcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobmV3RWxlbWVudCk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy5zaXplSW5mbyA9IHtcXHJcXG4gICAgICAgIGxpSGVpZ2h0OiBsaUhlaWdodCxcXHJcXG4gICAgICAgIGhlYWRlckhlaWdodDogaGVhZGVySGVpZ2h0LFxcclxcbiAgICAgICAgc2VhcmNoSGVpZ2h0OiBzZWFyY2hIZWlnaHQsXFxyXFxuICAgICAgICBhY3Rpb25zSGVpZ2h0OiBhY3Rpb25zSGVpZ2h0LFxcclxcbiAgICAgICAgZG9uZUJ1dHRvbkhlaWdodDogZG9uZUJ1dHRvbkhlaWdodCxcXHJcXG4gICAgICAgIGRpdmlkZXJIZWlnaHQ6IGRpdmlkZXJIZWlnaHQsXFxyXFxuICAgICAgICBtZW51UGFkZGluZzogbWVudVBhZGRpbmcsXFxyXFxuICAgICAgICBtZW51RXh0cmFzOiBtZW51RXh0cmFzXFxyXFxuICAgICAgfTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgc2V0U2l6ZTogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHRoaXMuZmluZExpcygpO1xcclxcbiAgICAgIHRoaXMubGlIZWlnaHQoKTtcXHJcXG5cXHJcXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmhlYWRlcikgdGhpcy4kbWVudS5jc3MoJ3BhZGRpbmctdG9wJywgMCk7XFxyXFxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaXplID09PSBmYWxzZSkgcmV0dXJuO1xcclxcblxcclxcbiAgICAgIHZhciB0aGF0ID0gdGhpcyxcXHJcXG4gICAgICAgICAgJG1lbnUgPSB0aGlzLiRtZW51LFxcclxcbiAgICAgICAgICAkbWVudUlubmVyID0gdGhpcy4kbWVudUlubmVyLFxcclxcbiAgICAgICAgICAkd2luZG93ID0gJCh3aW5kb3cpLFxcclxcbiAgICAgICAgICBzZWxlY3RIZWlnaHQgPSB0aGlzLiRuZXdFbGVtZW50WzBdLm9mZnNldEhlaWdodCxcXHJcXG4gICAgICAgICAgc2VsZWN0V2lkdGggPSB0aGlzLiRuZXdFbGVtZW50WzBdLm9mZnNldFdpZHRoLFxcclxcbiAgICAgICAgICBsaUhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2xpSGVpZ2h0J10sXFxyXFxuICAgICAgICAgIGhlYWRlckhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2hlYWRlckhlaWdodCddLFxcclxcbiAgICAgICAgICBzZWFyY2hIZWlnaHQgPSB0aGlzLnNpemVJbmZvWydzZWFyY2hIZWlnaHQnXSxcXHJcXG4gICAgICAgICAgYWN0aW9uc0hlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2FjdGlvbnNIZWlnaHQnXSxcXHJcXG4gICAgICAgICAgZG9uZUJ1dHRvbkhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2RvbmVCdXR0b25IZWlnaHQnXSxcXHJcXG4gICAgICAgICAgZGl2SGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snZGl2aWRlckhlaWdodCddLFxcclxcbiAgICAgICAgICBtZW51UGFkZGluZyA9IHRoaXMuc2l6ZUluZm9bJ21lbnVQYWRkaW5nJ10sXFxyXFxuICAgICAgICAgIG1lbnVFeHRyYXMgPSB0aGlzLnNpemVJbmZvWydtZW51RXh0cmFzJ10sXFxyXFxuICAgICAgICAgIG5vdERpc2FibGVkID0gdGhpcy5vcHRpb25zLmhpZGVEaXNhYmxlZCA/ICcuZGlzYWJsZWQnIDogJycsXFxyXFxuICAgICAgICAgIG1lbnVIZWlnaHQsXFxyXFxuICAgICAgICAgIG1lbnVXaWR0aCxcXHJcXG4gICAgICAgICAgZ2V0SGVpZ2h0LFxcclxcbiAgICAgICAgICBnZXRXaWR0aCxcXHJcXG4gICAgICAgICAgc2VsZWN0T2Zmc2V0VG9wLFxcclxcbiAgICAgICAgICBzZWxlY3RPZmZzZXRCb3QsXFxyXFxuICAgICAgICAgIHNlbGVjdE9mZnNldExlZnQsXFxyXFxuICAgICAgICAgIHNlbGVjdE9mZnNldFJpZ2h0LFxcclxcbiAgICAgICAgICBnZXRQb3MgPSBmdW5jdGlvbigpIHtcXHJcXG4gICAgICAgICAgICB2YXIgcG9zID0gdGhhdC4kbmV3RWxlbWVudC5vZmZzZXQoKSxcXHJcXG4gICAgICAgICAgICAgICAgJGNvbnRhaW5lciA9ICQodGhhdC5vcHRpb25zLmNvbnRhaW5lciksXFxyXFxuICAgICAgICAgICAgICAgIGNvbnRhaW5lclBvcztcXHJcXG5cXHJcXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmNvbnRhaW5lciAmJiAhJGNvbnRhaW5lci5pcygnYm9keScpKSB7XFxyXFxuICAgICAgICAgICAgICBjb250YWluZXJQb3MgPSAkY29udGFpbmVyLm9mZnNldCgpO1xcclxcbiAgICAgICAgICAgICAgY29udGFpbmVyUG9zLnRvcCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyVG9wV2lkdGgnKSk7XFxyXFxuICAgICAgICAgICAgICBjb250YWluZXJQb3MubGVmdCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyTGVmdFdpZHRoJykpO1xcclxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgICAgICBjb250YWluZXJQb3MgPSB7IHRvcDogMCwgbGVmdDogMCB9O1xcclxcbiAgICAgICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICAgICBzZWxlY3RPZmZzZXRUb3AgPSBwb3MudG9wIC0gY29udGFpbmVyUG9zLnRvcCAtICR3aW5kb3cuc2Nyb2xsVG9wKCk7XFxyXFxuICAgICAgICAgICAgc2VsZWN0T2Zmc2V0Qm90ID0gJHdpbmRvdy5oZWlnaHQoKSAtIHNlbGVjdE9mZnNldFRvcCAtIHNlbGVjdEhlaWdodCAtIGNvbnRhaW5lclBvcy50b3A7XFxyXFxuICAgICAgICAgICAgc2VsZWN0T2Zmc2V0TGVmdCA9IHBvcy5sZWZ0IC0gY29udGFpbmVyUG9zLmxlZnQgLSAkd2luZG93LnNjcm9sbExlZnQoKTtcXHJcXG4gICAgICAgICAgICBzZWxlY3RPZmZzZXRSaWdodCA9ICR3aW5kb3cud2lkdGgoKSAtIHNlbGVjdE9mZnNldExlZnQgLSBzZWxlY3RXaWR0aCAtIGNvbnRhaW5lclBvcy5sZWZ0O1xcclxcbiAgICAgICAgICB9O1xcclxcblxcclxcbiAgICAgIGdldFBvcygpO1xcclxcblxcclxcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSA9PT0gJ2F1dG8nKSB7XFxyXFxuICAgICAgICB2YXIgZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgICAgdmFyIG1pbkhlaWdodCxcXHJcXG4gICAgICAgICAgICAgIGhhc0NsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSwgaW5jbHVkZSkge1xcclxcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW1lbnQpIHtcXHJcXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlKSB7XFxyXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChlbGVtZW50LmNsYXNzTGlzdCA/IGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSkgOiAkKGVsZW1lbnQpLmhhc0NsYXNzKGNsYXNzTmFtZSkpO1xcclxcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShlbGVtZW50LmNsYXNzTGlzdCA/IGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSkgOiAkKGVsZW1lbnQpLmhhc0NsYXNzKGNsYXNzTmFtZSkpO1xcclxcbiAgICAgICAgICAgICAgICAgICAgfVxcclxcbiAgICAgICAgICAgICAgICB9O1xcclxcbiAgICAgICAgICAgICAgfSxcXHJcXG4gICAgICAgICAgICAgIGxpcyA9IHRoYXQuJG1lbnVJbm5lclswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGknKSxcXHJcXG4gICAgICAgICAgICAgIGxpc1Zpc2libGUgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyID8gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGxpcywgaGFzQ2xhc3MoJ2hpZGRlbicsIGZhbHNlKSkgOiB0aGF0LiRsaXMubm90KCcuaGlkZGVuJyksXFxyXFxuICAgICAgICAgICAgICBvcHRHcm91cCA9IEFycmF5LnByb3RvdHlwZS5maWx0ZXIgPyBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwobGlzVmlzaWJsZSwgaGFzQ2xhc3MoJ2Ryb3Bkb3duLWhlYWRlcicsIHRydWUpKSA6IGxpc1Zpc2libGUuZmlsdGVyKCcuZHJvcGRvd24taGVhZGVyJyk7XFxyXFxuXFxyXFxuICAgICAgICAgIGdldFBvcygpO1xcclxcbiAgICAgICAgICBtZW51SGVpZ2h0ID0gc2VsZWN0T2Zmc2V0Qm90IC0gbWVudUV4dHJhcy52ZXJ0O1xcclxcbiAgICAgICAgICBtZW51V2lkdGggPSBzZWxlY3RPZmZzZXRSaWdodCAtIG1lbnVFeHRyYXMuaG9yaXo7XFxyXFxuXFxyXFxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuY29udGFpbmVyKSB7XFxyXFxuICAgICAgICAgICAgaWYgKCEkbWVudS5kYXRhKCdoZWlnaHQnKSkgJG1lbnUuZGF0YSgnaGVpZ2h0JywgJG1lbnUuaGVpZ2h0KCkpO1xcclxcbiAgICAgICAgICAgIGdldEhlaWdodCA9ICRtZW51LmRhdGEoJ2hlaWdodCcpO1xcclxcblxcclxcbiAgICAgICAgICAgIGlmICghJG1lbnUuZGF0YSgnd2lkdGgnKSkgJG1lbnUuZGF0YSgnd2lkdGgnLCAkbWVudS53aWR0aCgpKTtcXHJcXG4gICAgICAgICAgICBnZXRXaWR0aCA9ICRtZW51LmRhdGEoJ3dpZHRoJyk7XFxyXFxuICAgICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgICAgZ2V0SGVpZ2h0ID0gJG1lbnUuaGVpZ2h0KCk7XFxyXFxuICAgICAgICAgICAgZ2V0V2lkdGggPSAkbWVudS53aWR0aCgpO1xcclxcbiAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuZHJvcHVwQXV0bykge1xcclxcbiAgICAgICAgICAgIHRoYXQuJG5ld0VsZW1lbnQudG9nZ2xlQ2xhc3MoJ2Ryb3B1cCcsIHNlbGVjdE9mZnNldFRvcCA+IHNlbGVjdE9mZnNldEJvdCAmJiAobWVudUhlaWdodCAtIG1lbnVFeHRyYXMudmVydCkgPCBnZXRIZWlnaHQpO1xcclxcbiAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgIGlmICh0aGF0LiRuZXdFbGVtZW50Lmhhc0NsYXNzKCdkcm9wdXAnKSkge1xcclxcbiAgICAgICAgICAgIG1lbnVIZWlnaHQgPSBzZWxlY3RPZmZzZXRUb3AgLSBtZW51RXh0cmFzLnZlcnQ7XFxyXFxuICAgICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5kcm9wZG93bkFsaWduUmlnaHQgPT09ICdhdXRvJykge1xcclxcbiAgICAgICAgICAgICRtZW51LnRvZ2dsZUNsYXNzKCdkcm9wZG93bi1tZW51LXJpZ2h0Jywgc2VsZWN0T2Zmc2V0TGVmdCA+IHNlbGVjdE9mZnNldFJpZ2h0ICYmIChtZW51V2lkdGggLSBtZW51RXh0cmFzLmhvcml6KSA8IChnZXRXaWR0aCAtIHNlbGVjdFdpZHRoKSk7XFxyXFxuICAgICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICAgaWYgKChsaXNWaXNpYmxlLmxlbmd0aCArIG9wdEdyb3VwLmxlbmd0aCkgPiAzKSB7XFxyXFxuICAgICAgICAgICAgbWluSGVpZ2h0ID0gbGlIZWlnaHQgKiAzICsgbWVudUV4dHJhcy52ZXJ0IC0gMjtcXHJcXG4gICAgICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICAgICBtaW5IZWlnaHQgPSAwO1xcclxcbiAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgICRtZW51LmNzcyh7XFxyXFxuICAgICAgICAgICAgJ21heC1oZWlnaHQnOiBtZW51SGVpZ2h0ICsgJ3B4JyxcXHJcXG4gICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcXHJcXG4gICAgICAgICAgICAnbWluLWhlaWdodCc6IG1pbkhlaWdodCArIGhlYWRlckhlaWdodCArIHNlYXJjaEhlaWdodCArIGFjdGlvbnNIZWlnaHQgKyBkb25lQnV0dG9uSGVpZ2h0ICsgJ3B4J1xcclxcbiAgICAgICAgICB9KTtcXHJcXG4gICAgICAgICAgJG1lbnVJbm5lci5jc3Moe1xcclxcbiAgICAgICAgICAgICdtYXgtaGVpZ2h0JzogbWVudUhlaWdodCAtIGhlYWRlckhlaWdodCAtIHNlYXJjaEhlaWdodCAtIGFjdGlvbnNIZWlnaHQgLSBkb25lQnV0dG9uSGVpZ2h0IC0gbWVudVBhZGRpbmcudmVydCArICdweCcsXFxyXFxuICAgICAgICAgICAgJ292ZXJmbG93LXknOiAnYXV0bycsXFxyXFxuICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiBNYXRoLm1heChtaW5IZWlnaHQgLSBtZW51UGFkZGluZy52ZXJ0LCAwKSArICdweCdcXHJcXG4gICAgICAgICAgfSk7XFxyXFxuICAgICAgICB9O1xcclxcbiAgICAgICAgZ2V0U2l6ZSgpO1xcclxcbiAgICAgICAgdGhpcy4kc2VhcmNoYm94Lm9mZignaW5wdXQuZ2V0U2l6ZSBwcm9wZXJ0eWNoYW5nZS5nZXRTaXplJykub24oJ2lucHV0LmdldFNpemUgcHJvcGVydHljaGFuZ2UuZ2V0U2l6ZScsIGdldFNpemUpO1xcclxcbiAgICAgICAgJHdpbmRvdy5vZmYoJ3Jlc2l6ZS5nZXRTaXplIHNjcm9sbC5nZXRTaXplJykub24oJ3Jlc2l6ZS5nZXRTaXplIHNjcm9sbC5nZXRTaXplJywgZ2V0U2l6ZSk7XFxyXFxuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSAmJiB0aGlzLm9wdGlvbnMuc2l6ZSAhPSAnYXV0bycgJiYgdGhpcy4kbGlzLm5vdChub3REaXNhYmxlZCkubGVuZ3RoID4gdGhpcy5vcHRpb25zLnNpemUpIHtcXHJcXG4gICAgICAgIHZhciBvcHRJbmRleCA9IHRoaXMuJGxpcy5ub3QoJy5kaXZpZGVyJykubm90KG5vdERpc2FibGVkKS5jaGlsZHJlbigpLnNsaWNlKDAsIHRoaXMub3B0aW9ucy5zaXplKS5sYXN0KCkucGFyZW50KCkuaW5kZXgoKSxcXHJcXG4gICAgICAgICAgICBkaXZMZW5ndGggPSB0aGlzLiRsaXMuc2xpY2UoMCwgb3B0SW5kZXggKyAxKS5maWx0ZXIoJy5kaXZpZGVyJykubGVuZ3RoO1xcclxcbiAgICAgICAgbWVudUhlaWdodCA9IGxpSGVpZ2h0ICogdGhpcy5vcHRpb25zLnNpemUgKyBkaXZMZW5ndGggKiBkaXZIZWlnaHQgKyBtZW51UGFkZGluZy52ZXJ0O1xcclxcblxcclxcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIpIHtcXHJcXG4gICAgICAgICAgaWYgKCEkbWVudS5kYXRhKCdoZWlnaHQnKSkgJG1lbnUuZGF0YSgnaGVpZ2h0JywgJG1lbnUuaGVpZ2h0KCkpO1xcclxcbiAgICAgICAgICBnZXRIZWlnaHQgPSAkbWVudS5kYXRhKCdoZWlnaHQnKTtcXHJcXG4gICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgIGdldEhlaWdodCA9ICRtZW51LmhlaWdodCgpO1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5kcm9wdXBBdXRvKSB7XFxyXFxuICAgICAgICAgIC8vbm9pbnNwZWN0aW9uIEpTVW51c2VkQXNzaWdubWVudFxcclxcbiAgICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnRvZ2dsZUNsYXNzKCdkcm9wdXAnLCBzZWxlY3RPZmZzZXRUb3AgPiBzZWxlY3RPZmZzZXRCb3QgJiYgKG1lbnVIZWlnaHQgLSBtZW51RXh0cmFzLnZlcnQpIDwgZ2V0SGVpZ2h0KTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgICRtZW51LmNzcyh7XFxyXFxuICAgICAgICAgICdtYXgtaGVpZ2h0JzogbWVudUhlaWdodCArIGhlYWRlckhlaWdodCArIHNlYXJjaEhlaWdodCArIGFjdGlvbnNIZWlnaHQgKyBkb25lQnV0dG9uSGVpZ2h0ICsgJ3B4JyxcXHJcXG4gICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXFxyXFxuICAgICAgICAgICdtaW4taGVpZ2h0JzogJydcXHJcXG4gICAgICAgIH0pO1xcclxcbiAgICAgICAgJG1lbnVJbm5lci5jc3Moe1xcclxcbiAgICAgICAgICAnbWF4LWhlaWdodCc6IG1lbnVIZWlnaHQgLSBtZW51UGFkZGluZy52ZXJ0ICsgJ3B4JyxcXHJcXG4gICAgICAgICAgJ292ZXJmbG93LXknOiAnYXV0bycsXFxyXFxuICAgICAgICAgICdtaW4taGVpZ2h0JzogJydcXHJcXG4gICAgICAgIH0pO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgc2V0V2lkdGg6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBpZiAodGhpcy5vcHRpb25zLndpZHRoID09PSAnYXV0bycpIHtcXHJcXG4gICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnMCcpO1xcclxcblxcclxcbiAgICAgICAgLy8gR2V0IGNvcnJlY3Qgd2lkdGggaWYgZWxlbWVudCBpcyBoaWRkZW5cXHJcXG4gICAgICAgIHZhciAkc2VsZWN0Q2xvbmUgPSB0aGlzLiRtZW51LnBhcmVudCgpLmNsb25lKCkuYXBwZW5kVG8oJ2JvZHknKSxcXHJcXG4gICAgICAgICAgICAkc2VsZWN0Q2xvbmUyID0gdGhpcy5vcHRpb25zLmNvbnRhaW5lciA/IHRoaXMuJG5ld0VsZW1lbnQuY2xvbmUoKS5hcHBlbmRUbygnYm9keScpIDogJHNlbGVjdENsb25lLFxcclxcbiAgICAgICAgICAgIHVsV2lkdGggPSAkc2VsZWN0Q2xvbmUuY2hpbGRyZW4oJy5kcm9wZG93bi1tZW51Jykub3V0ZXJXaWR0aCgpLFxcclxcbiAgICAgICAgICAgIGJ0bldpZHRoID0gJHNlbGVjdENsb25lMi5jc3MoJ3dpZHRoJywgJ2F1dG8nKS5jaGlsZHJlbignYnV0dG9uJykub3V0ZXJXaWR0aCgpO1xcclxcblxcclxcbiAgICAgICAgJHNlbGVjdENsb25lLnJlbW92ZSgpO1xcclxcbiAgICAgICAgJHNlbGVjdENsb25lMi5yZW1vdmUoKTtcXHJcXG5cXHJcXG4gICAgICAgIC8vIFNldCB3aWR0aCB0byB3aGF0ZXZlcidzIGxhcmdlciwgYnV0dG9uIHRpdGxlIG9yIGxvbmdlc3Qgb3B0aW9uXFxyXFxuICAgICAgICB0aGlzLiRuZXdFbGVtZW50LmNzcygnd2lkdGgnLCBNYXRoLm1heCh1bFdpZHRoLCBidG5XaWR0aCkgKyAncHgnKTtcXHJcXG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy53aWR0aCA9PT0gJ2ZpdCcpIHtcXHJcXG4gICAgICAgIC8vIFJlbW92ZSBpbmxpbmUgbWluLXdpZHRoIHNvIHdpZHRoIGNhbiBiZSBjaGFuZ2VkIGZyb20gJ2F1dG8nXFxyXFxuICAgICAgICB0aGlzLiRtZW51LmNzcygnbWluLXdpZHRoJywgJycpO1xcclxcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgJycpLmFkZENsYXNzKCdmaXQtd2lkdGgnKTtcXHJcXG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy53aWR0aCkge1xcclxcbiAgICAgICAgLy8gUmVtb3ZlIGlubGluZSBtaW4td2lkdGggc28gd2lkdGggY2FuIGJlIGNoYW5nZWQgZnJvbSAnYXV0bydcXHJcXG4gICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7XFxyXFxuICAgICAgICB0aGlzLiRuZXdFbGVtZW50LmNzcygnd2lkdGgnLCB0aGlzLm9wdGlvbnMud2lkdGgpO1xcclxcbiAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aC93aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZFxcclxcbiAgICAgICAgdGhpcy4kbWVudS5jc3MoJ21pbi13aWR0aCcsICcnKTtcXHJcXG4gICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuY3NzKCd3aWR0aCcsICcnKTtcXHJcXG4gICAgICB9XFxyXFxuICAgICAgLy8gUmVtb3ZlIGZpdC13aWR0aCBjbGFzcyBpZiB3aWR0aCBpcyBjaGFuZ2VkIHByb2dyYW1tYXRpY2FsbHlcXHJcXG4gICAgICBpZiAodGhpcy4kbmV3RWxlbWVudC5oYXNDbGFzcygnZml0LXdpZHRoJykgJiYgdGhpcy5vcHRpb25zLndpZHRoICE9PSAnZml0Jykge1xcclxcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmVDbGFzcygnZml0LXdpZHRoJyk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBzZWxlY3RQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHRoaXMuJGJzQ29udGFpbmVyID0gJCgnPGRpdiBjbGFzcz1cXFwiYnMtY29udGFpbmVyXFxcIiAvPicpO1xcclxcblxcclxcbiAgICAgIHZhciB0aGF0ID0gdGhpcyxcXHJcXG4gICAgICAgICAgJGNvbnRhaW5lciA9ICQodGhpcy5vcHRpb25zLmNvbnRhaW5lciksXFxyXFxuICAgICAgICAgIHBvcyxcXHJcXG4gICAgICAgICAgY29udGFpbmVyUG9zLFxcclxcbiAgICAgICAgICBhY3R1YWxIZWlnaHQsXFxyXFxuICAgICAgICAgIGdldFBsYWNlbWVudCA9IGZ1bmN0aW9uICgkZWxlbWVudCkge1xcclxcbiAgICAgICAgICAgIHRoYXQuJGJzQ29udGFpbmVyLmFkZENsYXNzKCRlbGVtZW50LmF0dHIoJ2NsYXNzJykucmVwbGFjZSgvZm9ybS1jb250cm9sfGZpdC13aWR0aC9naSwgJycpKS50b2dnbGVDbGFzcygnZHJvcHVwJywgJGVsZW1lbnQuaGFzQ2xhc3MoJ2Ryb3B1cCcpKTtcXHJcXG4gICAgICAgICAgICBwb3MgPSAkZWxlbWVudC5vZmZzZXQoKTtcXHJcXG5cXHJcXG4gICAgICAgICAgICBpZiAoISRjb250YWluZXIuaXMoJ2JvZHknKSkge1xcclxcbiAgICAgICAgICAgICAgY29udGFpbmVyUG9zID0gJGNvbnRhaW5lci5vZmZzZXQoKTtcXHJcXG4gICAgICAgICAgICAgIGNvbnRhaW5lclBvcy50b3AgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlclRvcFdpZHRoJykpIC0gJGNvbnRhaW5lci5zY3JvbGxUb3AoKTtcXHJcXG4gICAgICAgICAgICAgIGNvbnRhaW5lclBvcy5sZWZ0ICs9IHBhcnNlSW50KCRjb250YWluZXIuY3NzKCdib3JkZXJMZWZ0V2lkdGgnKSkgLSAkY29udGFpbmVyLnNjcm9sbExlZnQoKTtcXHJcXG4gICAgICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAgICAgY29udGFpbmVyUG9zID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgICAgYWN0dWFsSGVpZ2h0ID0gJGVsZW1lbnQuaGFzQ2xhc3MoJ2Ryb3B1cCcpID8gMCA6ICRlbGVtZW50WzBdLm9mZnNldEhlaWdodDtcXHJcXG5cXHJcXG4gICAgICAgICAgICB0aGF0LiRic0NvbnRhaW5lci5jc3Moe1xcclxcbiAgICAgICAgICAgICAgJ3RvcCc6IHBvcy50b3AgLSBjb250YWluZXJQb3MudG9wICsgYWN0dWFsSGVpZ2h0LFxcclxcbiAgICAgICAgICAgICAgJ2xlZnQnOiBwb3MubGVmdCAtIGNvbnRhaW5lclBvcy5sZWZ0LFxcclxcbiAgICAgICAgICAgICAgJ3dpZHRoJzogJGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGhcXHJcXG4gICAgICAgICAgICB9KTtcXHJcXG4gICAgICAgICAgfTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRidXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcXHJcXG5cXHJcXG4gICAgICAgIGlmICh0aGF0LmlzRGlzYWJsZWQoKSkge1xcclxcbiAgICAgICAgICByZXR1cm47XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBnZXRQbGFjZW1lbnQodGhhdC4kbmV3RWxlbWVudCk7XFxyXFxuXFxyXFxuICAgICAgICB0aGF0LiRic0NvbnRhaW5lclxcclxcbiAgICAgICAgICAuYXBwZW5kVG8odGhhdC5vcHRpb25zLmNvbnRhaW5lcilcXHJcXG4gICAgICAgICAgLnRvZ2dsZUNsYXNzKCdvcGVuJywgISR0aGlzLmhhc0NsYXNzKCdvcGVuJykpXFxyXFxuICAgICAgICAgIC5hcHBlbmQodGhhdC4kbWVudSk7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgJCh3aW5kb3cpLm9uKCdyZXNpemUgc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgZ2V0UGxhY2VtZW50KHRoYXQuJG5ld0VsZW1lbnQpO1xcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2hpZGUuYnMuc2VsZWN0JywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdGhhdC4kbWVudS5kYXRhKCdoZWlnaHQnLCB0aGF0LiRtZW51LmhlaWdodCgpKTtcXHJcXG4gICAgICAgIHRoYXQuJGJzQ29udGFpbmVyLmRldGFjaCgpO1xcclxcbiAgICAgIH0pO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICAvKipcXHJcXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gdGhlIGluZGV4IG9mIHRoZSBvcHRpb24gdGhhdCBpcyBiZWluZyBjaGFuZ2VkXFxyXFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2VsZWN0ZWQgLSB0cnVlIGlmIHRoZSBvcHRpb24gaXMgYmVpbmcgc2VsZWN0ZWQsIGZhbHNlIGlmIGJlaW5nIGRlc2VsZWN0ZWRcXHJcXG4gICAgICogQHBhcmFtIHtKUXVlcnl9ICRsaXMgLSB0aGUgJ2xpJyBlbGVtZW50IHRoYXQgaXMgYmVpbmcgbW9kaWZpZWRcXHJcXG4gICAgICovXFxyXFxuICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbiAoaW5kZXgsIHNlbGVjdGVkLCAkbGlzKSB7XFxyXFxuICAgICAgaWYgKCEkbGlzKSB7XFxyXFxuICAgICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKCk7IC8vIGNoZWNrIGlmIHNldFNlbGVjdGVkIGlzIGJlaW5nIGNhbGxlZCBieSBjaGFuZ2luZyB0aGUgdmFsdWUgb2YgdGhlIHNlbGVjdFxcclxcbiAgICAgICAgJGxpcyA9IHRoaXMuZmluZExpcygpLmVxKHRoaXMubGlPYmpbaW5kZXhdKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgJGxpcy50b2dnbGVDbGFzcygnc2VsZWN0ZWQnLCBzZWxlY3RlZCkuZmluZCgnYScpLmF0dHIoJ2FyaWEtc2VsZWN0ZWQnLCBzZWxlY3RlZCk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIC8qKlxcclxcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSB0aGUgaW5kZXggb2YgdGhlIG9wdGlvbiB0aGF0IGlzIGJlaW5nIGRpc2FibGVkXFxyXFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzYWJsZWQgLSB0cnVlIGlmIHRoZSBvcHRpb24gaXMgYmVpbmcgZGlzYWJsZWQsIGZhbHNlIGlmIGJlaW5nIGVuYWJsZWRcXHJcXG4gICAgICogQHBhcmFtIHtKUXVlcnl9ICRsaXMgLSB0aGUgJ2xpJyBlbGVtZW50IHRoYXQgaXMgYmVpbmcgbW9kaWZpZWRcXHJcXG4gICAgICovXFxyXFxuICAgIHNldERpc2FibGVkOiBmdW5jdGlvbiAoaW5kZXgsIGRpc2FibGVkLCAkbGlzKSB7XFxyXFxuICAgICAgaWYgKCEkbGlzKSB7XFxyXFxuICAgICAgICAkbGlzID0gdGhpcy5maW5kTGlzKCkuZXEodGhpcy5saU9ialtpbmRleF0pO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAoZGlzYWJsZWQpIHtcXHJcXG4gICAgICAgICRsaXMuYWRkQ2xhc3MoJ2Rpc2FibGVkJykuY2hpbGRyZW4oJ2EnKS5hdHRyKCdocmVmJywgJyMnKS5hdHRyKCd0YWJpbmRleCcsIC0xKS5hdHRyKCdhcmlhLWRpc2FibGVkJywgdHJ1ZSk7XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICRsaXMucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJykuY2hpbGRyZW4oJ2EnKS5yZW1vdmVBdHRyKCdocmVmJykuYXR0cigndGFiaW5kZXgnLCAwKS5hdHRyKCdhcmlhLWRpc2FibGVkJywgZmFsc2UpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgaXNEaXNhYmxlZDogZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHJldHVybiB0aGlzLiRlbGVtZW50WzBdLmRpc2FibGVkO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBjaGVja0Rpc2FibGVkOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyIHRoYXQgPSB0aGlzO1xcclxcblxcclxcbiAgICAgIGlmICh0aGlzLmlzRGlzYWJsZWQoKSkge1xcclxcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcXHJcXG4gICAgICAgIHRoaXMuJGJ1dHRvbi5hZGRDbGFzcygnZGlzYWJsZWQnKS5hdHRyKCd0YWJpbmRleCcsIC0xKTtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgaWYgKHRoaXMuJGJ1dHRvbi5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xcclxcbiAgICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xcclxcbiAgICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBpZiAodGhpcy4kYnV0dG9uLmF0dHIoJ3RhYmluZGV4JykgPT0gLTEgJiYgIXRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnKSkge1xcclxcbiAgICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQXR0cigndGFiaW5kZXgnKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kYnV0dG9uLmNsaWNrKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIHJldHVybiAhdGhhdC5pc0Rpc2FibGVkKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIHRvZ2dsZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyIHZhbHVlID0gdGhpcy4kZWxlbWVudC52YWwoKTtcXHJcXG4gICAgICB0aGlzLiRidXR0b24udG9nZ2xlQ2xhc3MoJ2JzLXBsYWNlaG9sZGVyJywgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgdGFiSW5kZXg6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICBpZiAodGhpcy4kZWxlbWVudC5kYXRhKCd0YWJpbmRleCcpICE9PSB0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JykgJiYgXFxyXFxuICAgICAgICAodGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICE9PSAtOTggJiYgdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICE9PSAnLTk4JykpIHtcXHJcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnLCB0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JykpO1xcclxcbiAgICAgICAgdGhpcy4kYnV0dG9uLmF0dHIoJ3RhYmluZGV4JywgdGhpcy4kZWxlbWVudC5kYXRhKCd0YWJpbmRleCcpKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIC05OCk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIGNsaWNrTGlzdGVuZXI6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgdGhhdCA9IHRoaXMsXFxyXFxuICAgICAgICAgICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xcclxcblxcclxcbiAgICAgIHRoaXMuJG5ld0VsZW1lbnQub24oJ3RvdWNoc3RhcnQuZHJvcGRvd24nLCAnLmRyb3Bkb3duLW1lbnUnLCBmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICAkZG9jdW1lbnQuZGF0YSgnc3BhY2VTZWxlY3QnLCBmYWxzZSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kYnV0dG9uLm9uKCdrZXl1cCcsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgICBpZiAoLygzMikvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgJGRvY3VtZW50LmRhdGEoJ3NwYWNlU2VsZWN0JykpIHtcXHJcXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICAgICAgJGRvY3VtZW50LmRhdGEoJ3NwYWNlU2VsZWN0JywgZmFsc2UpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgIHRoaXMuJGJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICB0aGF0LnNldFNpemUoKTtcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRlbGVtZW50Lm9uKCdzaG93bi5icy5zZWxlY3QnLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5saXZlU2VhcmNoICYmICF0aGF0Lm11bHRpcGxlKSB7XFxyXFxuICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuc2VsZWN0ZWQgYScpLmZvY3VzKCk7XFxyXFxuICAgICAgICB9IGVsc2UgaWYgKCF0aGF0Lm11bHRpcGxlKSB7XFxyXFxuICAgICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhhdC5saU9ialt0aGF0LiRlbGVtZW50WzBdLnNlbGVjdGVkSW5kZXhdO1xcclxcblxcclxcbiAgICAgICAgICBpZiAodHlwZW9mIHNlbGVjdGVkSW5kZXggIT09ICdudW1iZXInIHx8IHRoYXQub3B0aW9ucy5zaXplID09PSBmYWxzZSkgcmV0dXJuO1xcclxcblxcclxcbiAgICAgICAgICAvLyBzY3JvbGwgdG8gc2VsZWN0ZWQgb3B0aW9uXFxyXFxuICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGF0LiRsaXMuZXEoc2VsZWN0ZWRJbmRleClbMF0ub2Zmc2V0VG9wIC0gdGhhdC4kbWVudUlubmVyWzBdLm9mZnNldFRvcDtcXHJcXG4gICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IC0gdGhhdC4kbWVudUlubmVyWzBdLm9mZnNldEhlaWdodC8yICsgdGhhdC5zaXplSW5mby5saUhlaWdodC8yO1xcclxcbiAgICAgICAgICB0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsVG9wID0gb2Zmc2V0O1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgIHRoaXMuJG1lbnVJbm5lci5vbignY2xpY2snLCAnbGkgYScsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxcclxcbiAgICAgICAgICAgIGNsaWNrZWRJbmRleCA9ICR0aGlzLnBhcmVudCgpLmRhdGEoJ29yaWdpbmFsSW5kZXgnKSxcXHJcXG4gICAgICAgICAgICBwcmV2VmFsdWUgPSB0aGF0LiRlbGVtZW50LnZhbCgpLFxcclxcbiAgICAgICAgICAgIHByZXZJbmRleCA9IHRoYXQuJGVsZW1lbnQucHJvcCgnc2VsZWN0ZWRJbmRleCcpLFxcclxcbiAgICAgICAgICAgIHRyaWdnZXJDaGFuZ2UgPSB0cnVlO1xcclxcblxcclxcbiAgICAgICAgLy8gRG9uJ3QgY2xvc2Ugb24gbXVsdGkgY2hvaWNlIG1lbnVcXHJcXG4gICAgICAgIGlmICh0aGF0Lm11bHRpcGxlICYmIHRoYXQub3B0aW9ucy5tYXhPcHRpb25zICE9PSAxKSB7XFxyXFxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XFxyXFxuXFxyXFxuICAgICAgICAvL0Rvbid0IHJ1biBpZiB3ZSBoYXZlIGJlZW4gZGlzYWJsZWRcXHJcXG4gICAgICAgIGlmICghdGhhdC5pc0Rpc2FibGVkKCkgJiYgISR0aGlzLnBhcmVudCgpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XFxyXFxuICAgICAgICAgIHZhciAkb3B0aW9ucyA9IHRoYXQuJGVsZW1lbnQuZmluZCgnb3B0aW9uJyksXFxyXFxuICAgICAgICAgICAgICAkb3B0aW9uID0gJG9wdGlvbnMuZXEoY2xpY2tlZEluZGV4KSxcXHJcXG4gICAgICAgICAgICAgIHN0YXRlID0gJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcpLFxcclxcbiAgICAgICAgICAgICAgJG9wdGdyb3VwID0gJG9wdGlvbi5wYXJlbnQoJ29wdGdyb3VwJyksXFxyXFxuICAgICAgICAgICAgICBtYXhPcHRpb25zID0gdGhhdC5vcHRpb25zLm1heE9wdGlvbnMsXFxyXFxuICAgICAgICAgICAgICBtYXhPcHRpb25zR3JwID0gJG9wdGdyb3VwLmRhdGEoJ21heE9wdGlvbnMnKSB8fCBmYWxzZTtcXHJcXG5cXHJcXG4gICAgICAgICAgaWYgKCF0aGF0Lm11bHRpcGxlKSB7IC8vIERlc2VsZWN0IGFsbCBvdGhlcnMgaWYgbm90IG11bHRpIHNlbGVjdCBib3hcXHJcXG4gICAgICAgICAgICAkb3B0aW9ucy5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTtcXHJcXG4gICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XFxyXFxuICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZpbmQoJy5zZWxlY3RlZCcpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpLmZpbmQoJ2EnKS5hdHRyKCdhcmlhLXNlbGVjdGVkJywgZmFsc2UpO1xcclxcbiAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCB0cnVlKTtcXHJcXG4gICAgICAgICAgfSBlbHNlIHsgLy8gVG9nZ2xlIHRoZSBvbmUgd2UgaGF2ZSBjaG9zZW4gaWYgd2UgYXJlIG11bHRpIHNlbGVjdC5cXHJcXG4gICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgIXN0YXRlKTtcXHJcXG4gICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgIXN0YXRlKTtcXHJcXG4gICAgICAgICAgICAkdGhpcy5ibHVyKCk7XFxyXFxuXFxyXFxuICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgIT09IGZhbHNlIHx8IG1heE9wdGlvbnNHcnAgIT09IGZhbHNlKSB7XFxyXFxuICAgICAgICAgICAgICB2YXIgbWF4UmVhY2hlZCA9IG1heE9wdGlvbnMgPCAkb3B0aW9ucy5maWx0ZXIoJzpzZWxlY3RlZCcpLmxlbmd0aCxcXHJcXG4gICAgICAgICAgICAgICAgICBtYXhSZWFjaGVkR3JwID0gbWF4T3B0aW9uc0dycCA8ICRvcHRncm91cC5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS5sZW5ndGg7XFxyXFxuXFxyXFxuICAgICAgICAgICAgICBpZiAoKG1heE9wdGlvbnMgJiYgbWF4UmVhY2hlZCkgfHwgKG1heE9wdGlvbnNHcnAgJiYgbWF4UmVhY2hlZEdycCkpIHtcXHJcXG4gICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgJiYgbWF4T3B0aW9ucyA9PSAxKSB7XFxyXFxuICAgICAgICAgICAgICAgICAgJG9wdGlvbnMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XFxyXFxuICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xcclxcbiAgICAgICAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuc2VsZWN0ZWQnKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcXHJcXG4gICAgICAgICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgdHJ1ZSk7XFxyXFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF4T3B0aW9uc0dycCAmJiBtYXhPcHRpb25zR3JwID09IDEpIHtcXHJcXG4gICAgICAgICAgICAgICAgICAkb3B0Z3JvdXAuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XFxyXFxuICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xcclxcbiAgICAgICAgICAgICAgICAgIHZhciBvcHRncm91cElEID0gJHRoaXMucGFyZW50KCkuZGF0YSgnb3B0Z3JvdXAnKTtcXHJcXG4gICAgICAgICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnW2RhdGEtb3B0Z3JvdXA9XFxcIicgKyBvcHRncm91cElEICsgJ1xcXCJdJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XFxyXFxuICAgICAgICAgICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChjbGlja2VkSW5kZXgsIHRydWUpO1xcclxcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAgICAgICAgIHZhciBtYXhPcHRpb25zVGV4dCA9IHR5cGVvZiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9uc1RleHQgPT09ICdzdHJpbmcnID8gW3RoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCwgdGhhdC5vcHRpb25zLm1heE9wdGlvbnNUZXh0XSA6IHRoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCxcXHJcXG4gICAgICAgICAgICAgICAgICAgICAgbWF4T3B0aW9uc0FyciA9IHR5cGVvZiBtYXhPcHRpb25zVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IG1heE9wdGlvbnNUZXh0KG1heE9wdGlvbnMsIG1heE9wdGlvbnNHcnApIDogbWF4T3B0aW9uc1RleHQsXFxyXFxuICAgICAgICAgICAgICAgICAgICAgIG1heFR4dCA9IG1heE9wdGlvbnNBcnJbMF0ucmVwbGFjZSgne259JywgbWF4T3B0aW9ucyksXFxyXFxuICAgICAgICAgICAgICAgICAgICAgIG1heFR4dEdycCA9IG1heE9wdGlvbnNBcnJbMV0ucmVwbGFjZSgne259JywgbWF4T3B0aW9uc0dycCksXFxyXFxuICAgICAgICAgICAgICAgICAgICAgICRub3RpZnkgPSAkKCc8ZGl2IGNsYXNzPVxcXCJub3RpZnlcXFwiPjwvZGl2PicpO1xcclxcbiAgICAgICAgICAgICAgICAgIC8vIElmIHt2YXJ9IGlzIHNldCBpbiBhcnJheSwgcmVwbGFjZSBpdFxcclxcbiAgICAgICAgICAgICAgICAgIC8qKiBAZGVwcmVjYXRlZCAqL1xcclxcbiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zQXJyWzJdKSB7XFxyXFxuICAgICAgICAgICAgICAgICAgICBtYXhUeHQgPSBtYXhUeHQucmVwbGFjZSgne3Zhcn0nLCBtYXhPcHRpb25zQXJyWzJdW21heE9wdGlvbnMgPiAxID8gMCA6IDFdKTtcXHJcXG4gICAgICAgICAgICAgICAgICAgIG1heFR4dEdycCA9IG1heFR4dEdycC5yZXBsYWNlKCd7dmFyfScsIG1heE9wdGlvbnNBcnJbMl1bbWF4T3B0aW9uc0dycCA+IDEgPyAwIDogMV0pO1xcclxcbiAgICAgICAgICAgICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpO1xcclxcblxcclxcbiAgICAgICAgICAgICAgICAgIHRoYXQuJG1lbnUuYXBwZW5kKCRub3RpZnkpO1xcclxcblxcclxcbiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zICYmIG1heFJlYWNoZWQpIHtcXHJcXG4gICAgICAgICAgICAgICAgICAgICRub3RpZnkuYXBwZW5kKCQoJzxkaXY+JyArIG1heFR4dCArICc8L2Rpdj4nKSk7XFxyXFxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7XFxyXFxuICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ21heFJlYWNoZWQuYnMuc2VsZWN0Jyk7XFxyXFxuICAgICAgICAgICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zR3JwICYmIG1heFJlYWNoZWRHcnApIHtcXHJcXG4gICAgICAgICAgICAgICAgICAgICRub3RpZnkuYXBwZW5kKCQoJzxkaXY+JyArIG1heFR4dEdycCArICc8L2Rpdj4nKSk7XFxyXFxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7XFxyXFxuICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ21heFJlYWNoZWRHcnAuYnMuc2VsZWN0Jyk7XFxyXFxuICAgICAgICAgICAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChjbGlja2VkSW5kZXgsIGZhbHNlKTtcXHJcXG4gICAgICAgICAgICAgICAgICB9LCAxMCk7XFxyXFxuXFxyXFxuICAgICAgICAgICAgICAgICAgJG5vdGlmeS5kZWxheSg3NTApLmZhZGVPdXQoMzAwLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpO1xcclxcbiAgICAgICAgICAgICAgICAgIH0pO1xcclxcbiAgICAgICAgICAgICAgICB9XFxyXFxuICAgICAgICAgICAgICB9XFxyXFxuICAgICAgICAgICAgfVxcclxcbiAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgIGlmICghdGhhdC5tdWx0aXBsZSB8fCAodGhhdC5tdWx0aXBsZSAmJiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucyA9PT0gMSkpIHtcXHJcXG4gICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcXHJcXG4gICAgICAgICAgfSBlbHNlIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkge1xcclxcbiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xcclxcbiAgICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICAgIC8vIFRyaWdnZXIgc2VsZWN0ICdjaGFuZ2UnXFxyXFxuICAgICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlKSB7XFxyXFxuICAgICAgICAgICAgaWYgKChwcmV2VmFsdWUgIT0gdGhhdC4kZWxlbWVudC52YWwoKSAmJiB0aGF0Lm11bHRpcGxlKSB8fCAocHJldkluZGV4ICE9IHRoYXQuJGVsZW1lbnQucHJvcCgnc2VsZWN0ZWRJbmRleCcpICYmICF0aGF0Lm11bHRpcGxlKSkge1xcclxcbiAgICAgICAgICAgICAgLy8gJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcpIGlzIGN1cnJlbnQgb3B0aW9uIHN0YXRlIChzZWxlY3RlZC91bnNlbGVjdGVkKS4gc3RhdGUgaXMgcHJldmlvdXMgb3B0aW9uIHN0YXRlLlxcclxcbiAgICAgICAgICAgICAgY2hhbmdlZF9hcmd1bWVudHMgPSBbY2xpY2tlZEluZGV4LCAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJyksIHN0YXRlXTtcXHJcXG4gICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnRcXHJcXG4gICAgICAgICAgICAgICAgLnRyaWdnZXJOYXRpdmUoJ2NoYW5nZScpO1xcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgfVxcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgIHRoaXMuJG1lbnUub24oJ2NsaWNrJywgJ2xpLmRpc2FibGVkIGEsIC5wb3BvdmVyLXRpdGxlLCAucG9wb3Zlci10aXRsZSA6bm90KC5jbG9zZSknLCBmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgICAgaWYgKGUuY3VycmVudFRhcmdldCA9PSB0aGlzKSB7XFxyXFxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcXHJcXG4gICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoICYmICEkKGUudGFyZ2V0KS5oYXNDbGFzcygnY2xvc2UnKSkge1xcclxcbiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xcclxcbiAgICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpO1xcclxcbiAgICAgICAgICB9XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kbWVudUlubmVyLm9uKCdjbGljaycsICcuZGl2aWRlciwgLmRyb3Bkb3duLWhlYWRlcicsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XFxyXFxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xcclxcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7XFxyXFxuICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xcclxcbiAgICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgICAgdGhhdC4kYnV0dG9uLmZvY3VzKCk7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kbWVudS5vbignY2xpY2snLCAnLnBvcG92ZXItdGl0bGUgLmNsb3NlJywgZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdGhhdC4kYnV0dG9uLmNsaWNrKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xcclxcbiAgICAgIH0pO1xcclxcblxcclxcbiAgICAgIHRoaXMuJG1lbnUub24oJ2NsaWNrJywgJy5hY3Rpb25zLWJ0bicsIGZ1bmN0aW9uIChlKSB7XFxyXFxuICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcXHJcXG4gICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuXFxyXFxuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYnMtc2VsZWN0LWFsbCcpKSB7XFxyXFxuICAgICAgICAgIHRoYXQuc2VsZWN0QWxsKCk7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICB0aGF0LmRlc2VsZWN0QWxsKCk7XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC5jaGFuZ2UoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgdGhhdC5yZW5kZXIoZmFsc2UpO1xcclxcbiAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdjaGFuZ2VkLmJzLnNlbGVjdCcsIGNoYW5nZWRfYXJndW1lbnRzKTtcXHJcXG4gICAgICAgIGNoYW5nZWRfYXJndW1lbnRzID0gbnVsbDtcXHJcXG4gICAgICB9KTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgbGl2ZVNlYXJjaExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyIHRoYXQgPSB0aGlzLFxcclxcbiAgICAgICAgICAkbm9fcmVzdWx0cyA9ICQoJzxsaSBjbGFzcz1cXFwibm8tcmVzdWx0c1xcXCI+PC9saT4nKTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRidXR0b24ub24oJ2NsaWNrLmRyb3Bkb3duLmRhdGEtYXBpIHRvdWNoc3RhcnQuZHJvcGRvd24uZGF0YS1hcGknLCBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcXHJcXG4gICAgICAgIGlmICghIXRoYXQuJHNlYXJjaGJveC52YWwoKSkge1xcclxcbiAgICAgICAgICB0aGF0LiRzZWFyY2hib3gudmFsKCcnKTtcXHJcXG4gICAgICAgICAgdGhhdC4kbGlzLm5vdCgnLmlzLWhpZGRlbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcXHJcXG4gICAgICAgICAgaWYgKCEhJG5vX3Jlc3VsdHMucGFyZW50KCkubGVuZ3RoKSAkbm9fcmVzdWx0cy5yZW1vdmUoKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIGlmICghdGhhdC5tdWx0aXBsZSkgdGhhdC4kbWVudUlubmVyLmZpbmQoJy5zZWxlY3RlZCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcXHJcXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xcclxcbiAgICAgICAgICB0aGF0LiRzZWFyY2hib3guZm9jdXMoKTtcXHJcXG4gICAgICAgIH0sIDEwKTtcXHJcXG4gICAgICB9KTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRzZWFyY2hib3gub24oJ2NsaWNrLmRyb3Bkb3duLmRhdGEtYXBpIGZvY3VzLmRyb3Bkb3duLmRhdGEtYXBpIHRvdWNoZW5kLmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdpbnB1dCBwcm9wZXJ0eWNoYW5nZScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgIGlmICh0aGF0LiRzZWFyY2hib3gudmFsKCkpIHtcXHJcXG4gICAgICAgICAgdmFyICRzZWFyY2hCYXNlID0gdGhhdC4kbGlzLm5vdCgnLmlzLWhpZGRlbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5jaGlsZHJlbignYScpO1xcclxcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2hOb3JtYWxpemUpIHtcXHJcXG4gICAgICAgICAgICAkc2VhcmNoQmFzZSA9ICRzZWFyY2hCYXNlLm5vdCgnOmEnICsgdGhhdC5fc2VhcmNoU3R5bGUoKSArICcoXFxcIicgKyBub3JtYWxpemVUb0Jhc2UodGhhdC4kc2VhcmNoYm94LnZhbCgpKSArICdcXFwiKScpO1xcclxcbiAgICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAgICRzZWFyY2hCYXNlID0gJHNlYXJjaEJhc2Uubm90KCc6JyArIHRoYXQuX3NlYXJjaFN0eWxlKCkgKyAnKFxcXCInICsgdGhhdC4kc2VhcmNoYm94LnZhbCgpICsgJ1xcXCIpJyk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgJHNlYXJjaEJhc2UucGFyZW50KCkuYWRkQ2xhc3MoJ2hpZGRlbicpO1xcclxcblxcclxcbiAgICAgICAgICB0aGF0LiRsaXMuZmlsdGVyKCcuZHJvcGRvd24taGVhZGVyJykuZWFjaChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcXHJcXG4gICAgICAgICAgICAgICAgb3B0Z3JvdXAgPSAkdGhpcy5kYXRhKCdvcHRncm91cCcpO1xcclxcblxcclxcbiAgICAgICAgICAgIGlmICh0aGF0LiRsaXMuZmlsdGVyKCdbZGF0YS1vcHRncm91cD0nICsgb3B0Z3JvdXAgKyAnXScpLm5vdCgkdGhpcykubm90KCcuaGlkZGVuJykubGVuZ3RoID09PSAwKSB7XFxyXFxuICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcygnaGlkZGVuJyk7XFxyXFxuICAgICAgICAgICAgICB0aGF0LiRsaXMuZmlsdGVyKCdbZGF0YS1vcHRncm91cD0nICsgb3B0Z3JvdXAgKyAnZGl2XScpLmFkZENsYXNzKCdoaWRkZW4nKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgIH0pO1xcclxcblxcclxcbiAgICAgICAgICB2YXIgJGxpc1Zpc2libGUgPSB0aGF0LiRsaXMubm90KCcuaGlkZGVuJyk7XFxyXFxuXFxyXFxuICAgICAgICAgIC8vIGhpZGUgZGl2aWRlciBpZiBmaXJzdCBvciBsYXN0IHZpc2libGUsIG9yIGlmIGZvbGxvd2VkIGJ5IGFub3RoZXIgZGl2aWRlclxcclxcbiAgICAgICAgICAkbGlzVmlzaWJsZS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xcclxcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XFxyXFxuXFxyXFxuICAgICAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdkaXZpZGVyJykgJiYgKFxcclxcbiAgICAgICAgICAgICAgJHRoaXMuaW5kZXgoKSA9PT0gJGxpc1Zpc2libGUuZmlyc3QoKS5pbmRleCgpIHx8XFxyXFxuICAgICAgICAgICAgICAkdGhpcy5pbmRleCgpID09PSAkbGlzVmlzaWJsZS5sYXN0KCkuaW5kZXgoKSB8fFxcclxcbiAgICAgICAgICAgICAgJGxpc1Zpc2libGUuZXEoaW5kZXggKyAxKS5oYXNDbGFzcygnZGl2aWRlcicpKSkge1xcclxcbiAgICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoJ2hpZGRlbicpO1xcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgfSk7XFxyXFxuXFxyXFxuICAgICAgICAgIGlmICghdGhhdC4kbGlzLm5vdCgnLmhpZGRlbiwgLm5vLXJlc3VsdHMnKS5sZW5ndGgpIHtcXHJcXG4gICAgICAgICAgICBpZiAoISEkbm9fcmVzdWx0cy5wYXJlbnQoKS5sZW5ndGgpIHtcXHJcXG4gICAgICAgICAgICAgICRub19yZXN1bHRzLnJlbW92ZSgpO1xcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgICAkbm9fcmVzdWx0cy5odG1sKHRoYXQub3B0aW9ucy5ub25lUmVzdWx0c1RleHQucmVwbGFjZSgnezB9JywgJ1xcXCInICsgaHRtbEVzY2FwZSh0aGF0LiRzZWFyY2hib3gudmFsKCkpICsgJ1xcXCInKSkuc2hvdygpO1xcclxcbiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5hcHBlbmQoJG5vX3Jlc3VsdHMpO1xcclxcbiAgICAgICAgICB9IGVsc2UgaWYgKCEhJG5vX3Jlc3VsdHMucGFyZW50KCkubGVuZ3RoKSB7XFxyXFxuICAgICAgICAgICAgJG5vX3Jlc3VsdHMucmVtb3ZlKCk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgIHRoYXQuJGxpcy5ub3QoJy5pcy1oaWRkZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XFxyXFxuICAgICAgICAgIGlmICghISRub19yZXN1bHRzLnBhcmVudCgpLmxlbmd0aCkge1xcclxcbiAgICAgICAgICAgICRub19yZXN1bHRzLnJlbW92ZSgpO1xcclxcbiAgICAgICAgICB9XFxyXFxuICAgICAgICB9XFxyXFxuXFxyXFxuICAgICAgICB0aGF0LiRsaXMuZmlsdGVyKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xcclxcbiAgICAgICAgaWYgKHRoYXQuJHNlYXJjaGJveC52YWwoKSkgdGhhdC4kbGlzLm5vdCgnLmhpZGRlbiwgLmRpdmlkZXIsIC5kcm9wZG93bi1oZWFkZXInKS5lcSgwKS5hZGRDbGFzcygnYWN0aXZlJykuY2hpbGRyZW4oJ2EnKS5mb2N1cygpO1xcclxcbiAgICAgICAgJCh0aGlzKS5mb2N1cygpO1xcclxcbiAgICAgIH0pO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBfc2VhcmNoU3R5bGU6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB2YXIgc3R5bGVzID0ge1xcclxcbiAgICAgICAgYmVnaW5zOiAnaWJlZ2lucycsXFxyXFxuICAgICAgICBzdGFydHNXaXRoOiAnaWJlZ2lucydcXHJcXG4gICAgICB9O1xcclxcblxcclxcbiAgICAgIHJldHVybiBzdHlsZXNbdGhpcy5vcHRpb25zLmxpdmVTZWFyY2hTdHlsZV0gfHwgJ2ljb250YWlucyc7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIHZhbDogZnVuY3Rpb24gKHZhbHVlKSB7XFxyXFxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcXHJcXG4gICAgICAgIHRoaXMuJGVsZW1lbnQudmFsKHZhbHVlKTtcXHJcXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XFxyXFxuXFxyXFxuICAgICAgICByZXR1cm4gdGhpcy4kZWxlbWVudDtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQudmFsKCk7XFxyXFxuICAgICAgfVxcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBjaGFuZ2VBbGw6IGZ1bmN0aW9uIChzdGF0dXMpIHtcXHJcXG4gICAgICBpZiAoIXRoaXMubXVsdGlwbGUpIHJldHVybjtcXHJcXG4gICAgICBpZiAodHlwZW9mIHN0YXR1cyA9PT0gJ3VuZGVmaW5lZCcpIHN0YXR1cyA9IHRydWU7XFxyXFxuXFxyXFxuICAgICAgdGhpcy5maW5kTGlzKCk7XFxyXFxuXFxyXFxuICAgICAgdmFyICRvcHRpb25zID0gdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKSxcXHJcXG4gICAgICAgICAgJGxpc1Zpc2libGUgPSB0aGlzLiRsaXMubm90KCcuZGl2aWRlciwgLmRyb3Bkb3duLWhlYWRlciwgLmRpc2FibGVkLCAuaGlkZGVuJyksXFxyXFxuICAgICAgICAgIGxpc1Zpc0xlbiA9ICRsaXNWaXNpYmxlLmxlbmd0aCxcXHJcXG4gICAgICAgICAgc2VsZWN0ZWRPcHRpb25zID0gW107XFxyXFxuICAgICAgICAgIFxcclxcbiAgICAgIGlmIChzdGF0dXMpIHtcXHJcXG4gICAgICAgIGlmICgkbGlzVmlzaWJsZS5maWx0ZXIoJy5zZWxlY3RlZCcpLmxlbmd0aCA9PT0gJGxpc1Zpc2libGUubGVuZ3RoKSByZXR1cm47XFxyXFxuICAgICAgfSBlbHNlIHtcXHJcXG4gICAgICAgIGlmICgkbGlzVmlzaWJsZS5maWx0ZXIoJy5zZWxlY3RlZCcpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG4gICAgICAgICAgXFxyXFxuICAgICAgJGxpc1Zpc2libGUudG9nZ2xlQ2xhc3MoJ3NlbGVjdGVkJywgc3RhdHVzKTtcXHJcXG5cXHJcXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc1Zpc0xlbjsgaSsrKSB7XFxyXFxuICAgICAgICB2YXIgb3JpZ0luZGV4ID0gJGxpc1Zpc2libGVbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLWluZGV4Jyk7XFxyXFxuICAgICAgICBzZWxlY3RlZE9wdGlvbnNbc2VsZWN0ZWRPcHRpb25zLmxlbmd0aF0gPSAkb3B0aW9ucy5lcShvcmlnSW5kZXgpWzBdO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAkKHNlbGVjdGVkT3B0aW9ucykucHJvcCgnc2VsZWN0ZWQnLCBzdGF0dXMpO1xcclxcblxcclxcbiAgICAgIHRoaXMucmVuZGVyKGZhbHNlKTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKCk7XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFxcclxcbiAgICAgICAgLnRyaWdnZXJOYXRpdmUoJ2NoYW5nZScpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBzZWxlY3RBbGw6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICByZXR1cm4gdGhpcy5jaGFuZ2VBbGwodHJ1ZSk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIGRlc2VsZWN0QWxsOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlQWxsKGZhbHNlKTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgdG9nZ2xlOiBmdW5jdGlvbiAoZSkge1xcclxcbiAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcXHJcXG5cXHJcXG4gICAgICBpZiAoZSkgZS5zdG9wUHJvcGFnYXRpb24oKTtcXHJcXG5cXHJcXG4gICAgICB0aGlzLiRidXR0b24udHJpZ2dlcignY2xpY2snKTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAga2V5ZG93bjogZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxcclxcbiAgICAgICAgICAkcGFyZW50ID0gJHRoaXMuaXMoJ2lucHV0JykgPyAkdGhpcy5wYXJlbnQoKS5wYXJlbnQoKSA6ICR0aGlzLnBhcmVudCgpLFxcclxcbiAgICAgICAgICAkaXRlbXMsXFxyXFxuICAgICAgICAgIHRoYXQgPSAkcGFyZW50LmRhdGEoJ3RoaXMnKSxcXHJcXG4gICAgICAgICAgaW5kZXgsXFxyXFxuICAgICAgICAgIG5leHQsXFxyXFxuICAgICAgICAgIGZpcnN0LFxcclxcbiAgICAgICAgICBsYXN0LFxcclxcbiAgICAgICAgICBwcmV2LFxcclxcbiAgICAgICAgICBuZXh0UHJldixcXHJcXG4gICAgICAgICAgcHJldkluZGV4LFxcclxcbiAgICAgICAgICBpc0FjdGl2ZSxcXHJcXG4gICAgICAgICAgc2VsZWN0b3IgPSAnOm5vdCguZGlzYWJsZWQsIC5oaWRkZW4sIC5kcm9wZG93bi1oZWFkZXIsIC5kaXZpZGVyKScsXFxyXFxuICAgICAgICAgIGtleUNvZGVNYXAgPSB7XFxyXFxuICAgICAgICAgICAgMzI6ICcgJyxcXHJcXG4gICAgICAgICAgICA0ODogJzAnLFxcclxcbiAgICAgICAgICAgIDQ5OiAnMScsXFxyXFxuICAgICAgICAgICAgNTA6ICcyJyxcXHJcXG4gICAgICAgICAgICA1MTogJzMnLFxcclxcbiAgICAgICAgICAgIDUyOiAnNCcsXFxyXFxuICAgICAgICAgICAgNTM6ICc1JyxcXHJcXG4gICAgICAgICAgICA1NDogJzYnLFxcclxcbiAgICAgICAgICAgIDU1OiAnNycsXFxyXFxuICAgICAgICAgICAgNTY6ICc4JyxcXHJcXG4gICAgICAgICAgICA1NzogJzknLFxcclxcbiAgICAgICAgICAgIDU5OiAnOycsXFxyXFxuICAgICAgICAgICAgNjU6ICdhJyxcXHJcXG4gICAgICAgICAgICA2NjogJ2InLFxcclxcbiAgICAgICAgICAgIDY3OiAnYycsXFxyXFxuICAgICAgICAgICAgNjg6ICdkJyxcXHJcXG4gICAgICAgICAgICA2OTogJ2UnLFxcclxcbiAgICAgICAgICAgIDcwOiAnZicsXFxyXFxuICAgICAgICAgICAgNzE6ICdnJyxcXHJcXG4gICAgICAgICAgICA3MjogJ2gnLFxcclxcbiAgICAgICAgICAgIDczOiAnaScsXFxyXFxuICAgICAgICAgICAgNzQ6ICdqJyxcXHJcXG4gICAgICAgICAgICA3NTogJ2snLFxcclxcbiAgICAgICAgICAgIDc2OiAnbCcsXFxyXFxuICAgICAgICAgICAgNzc6ICdtJyxcXHJcXG4gICAgICAgICAgICA3ODogJ24nLFxcclxcbiAgICAgICAgICAgIDc5OiAnbycsXFxyXFxuICAgICAgICAgICAgODA6ICdwJyxcXHJcXG4gICAgICAgICAgICA4MTogJ3EnLFxcclxcbiAgICAgICAgICAgIDgyOiAncicsXFxyXFxuICAgICAgICAgICAgODM6ICdzJyxcXHJcXG4gICAgICAgICAgICA4NDogJ3QnLFxcclxcbiAgICAgICAgICAgIDg1OiAndScsXFxyXFxuICAgICAgICAgICAgODY6ICd2JyxcXHJcXG4gICAgICAgICAgICA4NzogJ3cnLFxcclxcbiAgICAgICAgICAgIDg4OiAneCcsXFxyXFxuICAgICAgICAgICAgODk6ICd5JyxcXHJcXG4gICAgICAgICAgICA5MDogJ3onLFxcclxcbiAgICAgICAgICAgIDk2OiAnMCcsXFxyXFxuICAgICAgICAgICAgOTc6ICcxJyxcXHJcXG4gICAgICAgICAgICA5ODogJzInLFxcclxcbiAgICAgICAgICAgIDk5OiAnMycsXFxyXFxuICAgICAgICAgICAgMTAwOiAnNCcsXFxyXFxuICAgICAgICAgICAgMTAxOiAnNScsXFxyXFxuICAgICAgICAgICAgMTAyOiAnNicsXFxyXFxuICAgICAgICAgICAgMTAzOiAnNycsXFxyXFxuICAgICAgICAgICAgMTA0OiAnOCcsXFxyXFxuICAgICAgICAgICAgMTA1OiAnOSdcXHJcXG4gICAgICAgICAgfTtcXHJcXG5cXHJcXG4gICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpICRwYXJlbnQgPSAkdGhpcy5wYXJlbnQoKS5wYXJlbnQoKTtcXHJcXG5cXHJcXG4gICAgICBpZiAodGhhdC5vcHRpb25zLmNvbnRhaW5lcikgJHBhcmVudCA9IHRoYXQuJG1lbnU7XFxyXFxuXFxyXFxuICAgICAgJGl0ZW1zID0gJCgnW3JvbGU9XFxcImxpc3Rib3hcXFwiXSBsaScsICRwYXJlbnQpO1xcclxcblxcclxcbiAgICAgIGlzQWN0aXZlID0gdGhhdC4kbmV3RWxlbWVudC5oYXNDbGFzcygnb3BlbicpO1xcclxcblxcclxcbiAgICAgIGlmICghaXNBY3RpdmUgJiYgKGUua2V5Q29kZSA+PSA0OCAmJiBlLmtleUNvZGUgPD0gNTcgfHwgZS5rZXlDb2RlID49IDk2ICYmIGUua2V5Q29kZSA8PSAxMDUgfHwgZS5rZXlDb2RlID49IDY1ICYmIGUua2V5Q29kZSA8PSA5MCkpIHtcXHJcXG4gICAgICAgIGlmICghdGhhdC5vcHRpb25zLmNvbnRhaW5lcikge1xcclxcbiAgICAgICAgICB0aGF0LnNldFNpemUoKTtcXHJcXG4gICAgICAgICAgdGhhdC4kbWVudS5wYXJlbnQoKS5hZGRDbGFzcygnb3BlbicpO1xcclxcbiAgICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XFxyXFxuICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICB0aGF0LiRidXR0b24udHJpZ2dlcignY2xpY2snKTtcXHJcXG4gICAgICAgIH1cXHJcXG4gICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xcclxcbiAgICAgICAgcmV0dXJuO1xcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcXHJcXG4gICAgICAgIGlmICgvKF45JHwyNykvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgaXNBY3RpdmUpIHtcXHJcXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xcclxcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xcclxcbiAgICAgICAgICB0aGF0LiRidXR0b24uY2xpY2soKS5mb2N1cygpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgLy8gJGl0ZW1zIGNvbnRhaW5zIGxpIGVsZW1lbnRzIHdoZW4gbGl2ZVNlYXJjaCBpcyBlbmFibGVkXFxyXFxuICAgICAgICAkaXRlbXMgPSAkKCdbcm9sZT1cXFwibGlzdGJveFxcXCJdIGxpJyArIHNlbGVjdG9yLCAkcGFyZW50KTtcXHJcXG4gICAgICAgIGlmICghJHRoaXMudmFsKCkgJiYgIS8oMzh8NDApLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpKSB7XFxyXFxuICAgICAgICAgIGlmICgkaXRlbXMuZmlsdGVyKCcuYWN0aXZlJykubGVuZ3RoID09PSAwKSB7XFxyXFxuICAgICAgICAgICAgJGl0ZW1zID0gdGhhdC4kbWVudUlubmVyLmZpbmQoJ2xpJyk7XFxyXFxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoTm9ybWFsaXplKSB7XFxyXFxuICAgICAgICAgICAgICAkaXRlbXMgPSAkaXRlbXMuZmlsdGVyKCc6YScgKyB0aGF0Ll9zZWFyY2hTdHlsZSgpICsgJygnICsgbm9ybWFsaXplVG9CYXNlKGtleUNvZGVNYXBbZS5rZXlDb2RlXSkgKyAnKScpO1xcclxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgICAgICAkaXRlbXMgPSAkaXRlbXMuZmlsdGVyKCc6JyArIHRoYXQuX3NlYXJjaFN0eWxlKCkgKyAnKCcgKyBrZXlDb2RlTWFwW2Uua2V5Q29kZV0gKyAnKScpO1xcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgfVxcclxcbiAgICAgICAgfVxcclxcbiAgICAgIH1cXHJcXG5cXHJcXG4gICAgICBpZiAoISRpdGVtcy5sZW5ndGgpIHJldHVybjtcXHJcXG5cXHJcXG4gICAgICBpZiAoLygzOHw0MCkvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkpIHtcXHJcXG4gICAgICAgIGluZGV4ID0gJGl0ZW1zLmluZGV4KCRpdGVtcy5maW5kKCdhJykuZmlsdGVyKCc6Zm9jdXMnKS5wYXJlbnQoKSk7XFxyXFxuICAgICAgICBmaXJzdCA9ICRpdGVtcy5maWx0ZXIoc2VsZWN0b3IpLmZpcnN0KCkuaW5kZXgoKTtcXHJcXG4gICAgICAgIGxhc3QgPSAkaXRlbXMuZmlsdGVyKHNlbGVjdG9yKS5sYXN0KCkuaW5kZXgoKTtcXHJcXG4gICAgICAgIG5leHQgPSAkaXRlbXMuZXEoaW5kZXgpLm5leHRBbGwoc2VsZWN0b3IpLmVxKDApLmluZGV4KCk7XFxyXFxuICAgICAgICBwcmV2ID0gJGl0ZW1zLmVxKGluZGV4KS5wcmV2QWxsKHNlbGVjdG9yKS5lcSgwKS5pbmRleCgpO1xcclxcbiAgICAgICAgbmV4dFByZXYgPSAkaXRlbXMuZXEobmV4dCkucHJldkFsbChzZWxlY3RvcikuZXEoMCkuaW5kZXgoKTtcXHJcXG5cXHJcXG4gICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkge1xcclxcbiAgICAgICAgICAkaXRlbXMuZWFjaChmdW5jdGlvbiAoaSkge1xcclxcbiAgICAgICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xcclxcbiAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCdpbmRleCcsIGkpO1xcclxcbiAgICAgICAgICAgIH1cXHJcXG4gICAgICAgICAgfSk7XFxyXFxuICAgICAgICAgIGluZGV4ID0gJGl0ZW1zLmluZGV4KCRpdGVtcy5maWx0ZXIoJy5hY3RpdmUnKSk7XFxyXFxuICAgICAgICAgIGZpcnN0ID0gJGl0ZW1zLmZpcnN0KCkuZGF0YSgnaW5kZXgnKTtcXHJcXG4gICAgICAgICAgbGFzdCA9ICRpdGVtcy5sYXN0KCkuZGF0YSgnaW5kZXgnKTtcXHJcXG4gICAgICAgICAgbmV4dCA9ICRpdGVtcy5lcShpbmRleCkubmV4dEFsbCgpLmVxKDApLmRhdGEoJ2luZGV4Jyk7XFxyXFxuICAgICAgICAgIHByZXYgPSAkaXRlbXMuZXEoaW5kZXgpLnByZXZBbGwoKS5lcSgwKS5kYXRhKCdpbmRleCcpO1xcclxcbiAgICAgICAgICBuZXh0UHJldiA9ICRpdGVtcy5lcShuZXh0KS5wcmV2QWxsKCkuZXEoMCkuZGF0YSgnaW5kZXgnKTtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIHByZXZJbmRleCA9ICR0aGlzLmRhdGEoJ3ByZXZJbmRleCcpO1xcclxcblxcclxcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzOCkge1xcclxcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIGluZGV4LS07XFxyXFxuICAgICAgICAgIGlmIChpbmRleCAhPSBuZXh0UHJldiAmJiBpbmRleCA+IHByZXYpIGluZGV4ID0gcHJldjtcXHJcXG4gICAgICAgICAgaWYgKGluZGV4IDwgZmlyc3QpIGluZGV4ID0gZmlyc3Q7XFxyXFxuICAgICAgICAgIGlmIChpbmRleCA9PSBwcmV2SW5kZXgpIGluZGV4ID0gbGFzdDtcXHJcXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDQwKSB7XFxyXFxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgaW5kZXgrKztcXHJcXG4gICAgICAgICAgaWYgKGluZGV4ID09IC0xKSBpbmRleCA9IDA7XFxyXFxuICAgICAgICAgIGlmIChpbmRleCAhPSBuZXh0UHJldiAmJiBpbmRleCA8IG5leHQpIGluZGV4ID0gbmV4dDtcXHJcXG4gICAgICAgICAgaWYgKGluZGV4ID4gbGFzdCkgaW5kZXggPSBsYXN0O1xcclxcbiAgICAgICAgICBpZiAoaW5kZXggPT0gcHJldkluZGV4KSBpbmRleCA9IGZpcnN0O1xcclxcbiAgICAgICAgfVxcclxcblxcclxcbiAgICAgICAgJHRoaXMuZGF0YSgncHJldkluZGV4JywgaW5kZXgpO1xcclxcblxcclxcbiAgICAgICAgaWYgKCF0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkge1xcclxcbiAgICAgICAgICAkaXRlbXMuZXEoaW5kZXgpLmNoaWxkcmVuKCdhJykuZm9jdXMoKTtcXHJcXG4gICAgICAgIH0gZWxzZSB7XFxyXFxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgICAgaWYgKCEkdGhpcy5oYXNDbGFzcygnZHJvcGRvd24tdG9nZ2xlJykpIHtcXHJcXG4gICAgICAgICAgICAkaXRlbXMucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLmVxKGluZGV4KS5hZGRDbGFzcygnYWN0aXZlJykuY2hpbGRyZW4oJ2EnKS5mb2N1cygpO1xcclxcbiAgICAgICAgICAgICR0aGlzLmZvY3VzKCk7XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICB9IGVsc2UgaWYgKCEkdGhpcy5pcygnaW5wdXQnKSkge1xcclxcbiAgICAgICAgdmFyIGtleUluZGV4ID0gW10sXFxyXFxuICAgICAgICAgICAgY291bnQsXFxyXFxuICAgICAgICAgICAgcHJldktleTtcXHJcXG5cXHJcXG4gICAgICAgICRpdGVtcy5lYWNoKGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XFxyXFxuICAgICAgICAgICAgaWYgKCQudHJpbSgkKHRoaXMpLmNoaWxkcmVuKCdhJykudGV4dCgpLnRvTG93ZXJDYXNlKCkpLnN1YnN0cmluZygwLCAxKSA9PSBrZXlDb2RlTWFwW2Uua2V5Q29kZV0pIHtcXHJcXG4gICAgICAgICAgICAgIGtleUluZGV4LnB1c2goJCh0aGlzKS5pbmRleCgpKTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH0pO1xcclxcblxcclxcbiAgICAgICAgY291bnQgPSAkKGRvY3VtZW50KS5kYXRhKCdrZXljb3VudCcpO1xcclxcbiAgICAgICAgY291bnQrKztcXHJcXG4gICAgICAgICQoZG9jdW1lbnQpLmRhdGEoJ2tleWNvdW50JywgY291bnQpO1xcclxcblxcclxcbiAgICAgICAgcHJldktleSA9ICQudHJpbSgkKCc6Zm9jdXMnKS50ZXh0KCkudG9Mb3dlckNhc2UoKSkuc3Vic3RyaW5nKDAsIDEpO1xcclxcblxcclxcbiAgICAgICAgaWYgKHByZXZLZXkgIT0ga2V5Q29kZU1hcFtlLmtleUNvZGVdKSB7XFxyXFxuICAgICAgICAgIGNvdW50ID0gMTtcXHJcXG4gICAgICAgICAgJChkb2N1bWVudCkuZGF0YSgna2V5Y291bnQnLCBjb3VudCk7XFxyXFxuICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IGtleUluZGV4Lmxlbmd0aCkge1xcclxcbiAgICAgICAgICAkKGRvY3VtZW50KS5kYXRhKCdrZXljb3VudCcsIDApO1xcclxcbiAgICAgICAgICBpZiAoY291bnQgPiBrZXlJbmRleC5sZW5ndGgpIGNvdW50ID0gMTtcXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgICRpdGVtcy5lcShrZXlJbmRleFtjb3VudCAtIDFdKS5jaGlsZHJlbignYScpLmZvY3VzKCk7XFxyXFxuICAgICAgfVxcclxcblxcclxcbiAgICAgIC8vIFNlbGVjdCBmb2N1c2VkIG9wdGlvbiBpZiBcXFwiRW50ZXJcXFwiLCBcXFwiU3BhY2ViYXJcXFwiIG9yIFxcXCJUYWJcXFwiICh3aGVuIHNlbGVjdE9uVGFiIGlzIHRydWUpIGFyZSBwcmVzc2VkIGluc2lkZSB0aGUgbWVudS5cXHJcXG4gICAgICBpZiAoKC8oMTN8MzIpLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpIHx8ICgvKF45JCkvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgdGhhdC5vcHRpb25zLnNlbGVjdE9uVGFiKSkgJiYgaXNBY3RpdmUpIHtcXHJcXG4gICAgICAgIGlmICghLygzMikvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkpIGUucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgIGlmICghdGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcXHJcXG4gICAgICAgICAgdmFyIGVsZW0gPSAkKCc6Zm9jdXMnKTtcXHJcXG4gICAgICAgICAgZWxlbS5jbGljaygpO1xcclxcbiAgICAgICAgICAvLyBCcmluZyBiYWNrIGZvY3VzIGZvciBtdWx0aXNlbGVjdHNcXHJcXG4gICAgICAgICAgZWxlbS5mb2N1cygpO1xcclxcbiAgICAgICAgICAvLyBQcmV2ZW50IHNjcmVlbiBmcm9tIHNjcm9sbGluZyBpZiB0aGUgdXNlciBoaXQgdGhlIHNwYWNlYmFyXFxyXFxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcXHJcXG4gICAgICAgICAgLy8gRml4ZXMgc3BhY2ViYXIgc2VsZWN0aW9uIG9mIGRyb3Bkb3duIGl0ZW1zIGluIEZGICYgSUVcXHJcXG4gICAgICAgICAgJChkb2N1bWVudCkuZGF0YSgnc3BhY2VTZWxlY3QnLCB0cnVlKTtcXHJcXG4gICAgICAgIH0gZWxzZSBpZiAoIS8oMzIpLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpKSB7XFxyXFxuICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuYWN0aXZlIGEnKS5jbGljaygpO1xcclxcbiAgICAgICAgICAkdGhpcy5mb2N1cygpO1xcclxcbiAgICAgICAgfVxcclxcbiAgICAgICAgJChkb2N1bWVudCkuZGF0YSgna2V5Y291bnQnLCAwKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgaWYgKCgvKF45JHwyNykvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgaXNBY3RpdmUgJiYgKHRoYXQubXVsdGlwbGUgfHwgdGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpKSB8fCAoLygyNykvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgIWlzQWN0aXZlKSkge1xcclxcbiAgICAgICAgdGhhdC4kbWVudS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnb3BlbicpO1xcclxcbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIpIHRoYXQuJG5ld0VsZW1lbnQucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcXHJcXG4gICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpO1xcclxcbiAgICAgIH1cXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgbW9iaWxlOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnbW9iaWxlLWRldmljZScpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICByZWZyZXNoOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kbGlzID0gbnVsbDtcXHJcXG4gICAgICB0aGlzLmxpT2JqID0ge307XFxyXFxuICAgICAgdGhpcy5yZWxvYWRMaSgpO1xcclxcbiAgICAgIHRoaXMucmVuZGVyKCk7XFxyXFxuICAgICAgdGhpcy5jaGVja0Rpc2FibGVkKCk7XFxyXFxuICAgICAgdGhpcy5saUhlaWdodCh0cnVlKTtcXHJcXG4gICAgICB0aGlzLnNldFN0eWxlKCk7XFxyXFxuICAgICAgdGhpcy5zZXRXaWR0aCgpO1xcclxcbiAgICAgIGlmICh0aGlzLiRsaXMpIHRoaXMuJHNlYXJjaGJveC50cmlnZ2VyKCdwcm9wZXJ0eWNoYW5nZScpO1xcclxcblxcclxcbiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcigncmVmcmVzaGVkLmJzLnNlbGVjdCcpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBoaWRlOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kbmV3RWxlbWVudC5oaWRlKCk7XFxyXFxuICAgIH0sXFxyXFxuXFxyXFxuICAgIHNob3c6IGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgICB0aGlzLiRuZXdFbGVtZW50LnNob3coKTtcXHJcXG4gICAgfSxcXHJcXG5cXHJcXG4gICAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmUoKTtcXHJcXG4gICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZSgpO1xcclxcbiAgICB9LFxcclxcblxcclxcbiAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdGhpcy4kbmV3RWxlbWVudC5iZWZvcmUodGhpcy4kZWxlbWVudCkucmVtb3ZlKCk7XFxyXFxuXFxyXFxuICAgICAgaWYgKHRoaXMuJGJzQ29udGFpbmVyKSB7XFxyXFxuICAgICAgICB0aGlzLiRic0NvbnRhaW5lci5yZW1vdmUoKTtcXHJcXG4gICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgdGhpcy4kbWVudS5yZW1vdmUoKTtcXHJcXG4gICAgICB9XFxyXFxuXFxyXFxuICAgICAgdGhpcy4kZWxlbWVudFxcclxcbiAgICAgICAgLm9mZignLmJzLnNlbGVjdCcpXFxyXFxuICAgICAgICAucmVtb3ZlRGF0YSgnc2VsZWN0cGlja2VyJylcXHJcXG4gICAgICAgIC5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbiBzZWxlY3RwaWNrZXInKTtcXHJcXG4gICAgfVxcclxcbiAgfTtcXHJcXG5cXHJcXG4gIC8vIFNFTEVDVFBJQ0tFUiBQTFVHSU4gREVGSU5JVElPTlxcclxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxyXFxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uLCBldmVudCkge1xcclxcbiAgICAvLyBnZXQgdGhlIGFyZ3Mgb2YgdGhlIG91dGVyIGZ1bmN0aW9uLi5cXHJcXG4gICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XFxyXFxuICAgIC8vIFRoZSBhcmd1bWVudHMgb2YgdGhlIGZ1bmN0aW9uIGFyZSBleHBsaWNpdGx5IHJlLWRlZmluZWQgZnJvbSB0aGUgYXJndW1lbnQgbGlzdCwgYmVjYXVzZSB0aGUgc2hpZnQgY2F1c2VzIHRoZW1cXHJcXG4gICAgLy8gdG8gZ2V0IGxvc3QvY29ycnVwdGVkIGluIGFuZHJvaWQgMi4zIGFuZCBJRTkgIzcxNSAjNzc1XFxyXFxuICAgIHZhciBfb3B0aW9uID0gb3B0aW9uLFxcclxcbiAgICAgICAgX2V2ZW50ID0gZXZlbnQ7XFxyXFxuICAgIFtdLnNoaWZ0LmFwcGx5KGFyZ3MpO1xcclxcblxcclxcbiAgICB2YXIgdmFsdWU7XFxyXFxuICAgIHZhciBjaGFpbiA9IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XFxyXFxuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcXHJcXG4gICAgICBpZiAoJHRoaXMuaXMoJ3NlbGVjdCcpKSB7XFxyXFxuICAgICAgICB2YXIgZGF0YSA9ICR0aGlzLmRhdGEoJ3NlbGVjdHBpY2tlcicpLFxcclxcbiAgICAgICAgICAgIG9wdGlvbnMgPSB0eXBlb2YgX29wdGlvbiA9PSAnb2JqZWN0JyAmJiBfb3B0aW9uO1xcclxcblxcclxcbiAgICAgICAgaWYgKCFkYXRhKSB7XFxyXFxuICAgICAgICAgIHZhciBjb25maWcgPSAkLmV4dGVuZCh7fSwgU2VsZWN0cGlja2VyLkRFRkFVTFRTLCAkLmZuLnNlbGVjdHBpY2tlci5kZWZhdWx0cyB8fCB7fSwgJHRoaXMuZGF0YSgpLCBvcHRpb25zKTtcXHJcXG4gICAgICAgICAgY29uZmlnLnRlbXBsYXRlID0gJC5leHRlbmQoe30sIFNlbGVjdHBpY2tlci5ERUZBVUxUUy50ZW1wbGF0ZSwgKCQuZm4uc2VsZWN0cGlja2VyLmRlZmF1bHRzID8gJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMudGVtcGxhdGUgOiB7fSksICR0aGlzLmRhdGEoKS50ZW1wbGF0ZSwgb3B0aW9ucy50ZW1wbGF0ZSk7XFxyXFxuICAgICAgICAgICR0aGlzLmRhdGEoJ3NlbGVjdHBpY2tlcicsIChkYXRhID0gbmV3IFNlbGVjdHBpY2tlcih0aGlzLCBjb25maWcsIF9ldmVudCkpKTtcXHJcXG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucykge1xcclxcbiAgICAgICAgICBmb3IgKHZhciBpIGluIG9wdGlvbnMpIHtcXHJcXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShpKSkge1xcclxcbiAgICAgICAgICAgICAgZGF0YS5vcHRpb25zW2ldID0gb3B0aW9uc1tpXTtcXHJcXG4gICAgICAgICAgICB9XFxyXFxuICAgICAgICAgIH1cXHJcXG4gICAgICAgIH1cXHJcXG5cXHJcXG4gICAgICAgIGlmICh0eXBlb2YgX29wdGlvbiA9PSAnc3RyaW5nJykge1xcclxcbiAgICAgICAgICBpZiAoZGF0YVtfb3B0aW9uXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XFxyXFxuICAgICAgICAgICAgdmFsdWUgPSBkYXRhW19vcHRpb25dLmFwcGx5KGRhdGEsIGFyZ3MpO1xcclxcbiAgICAgICAgICB9IGVsc2Uge1xcclxcbiAgICAgICAgICAgIHZhbHVlID0gZGF0YS5vcHRpb25zW19vcHRpb25dO1xcclxcbiAgICAgICAgICB9XFxyXFxuICAgICAgICB9XFxyXFxuICAgICAgfVxcclxcbiAgICB9KTtcXHJcXG5cXHJcXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcXHJcXG4gICAgICAvL25vaW5zcGVjdGlvbiBKU1VudXNlZEFzc2lnbm1lbnRcXHJcXG4gICAgICByZXR1cm4gdmFsdWU7XFxyXFxuICAgIH0gZWxzZSB7XFxyXFxuICAgICAgcmV0dXJuIGNoYWluO1xcclxcbiAgICB9XFxyXFxuICB9XFxyXFxuXFxyXFxuICB2YXIgb2xkID0gJC5mbi5zZWxlY3RwaWNrZXI7XFxyXFxuICAkLmZuLnNlbGVjdHBpY2tlciA9IFBsdWdpbjtcXHJcXG4gICQuZm4uc2VsZWN0cGlja2VyLkNvbnN0cnVjdG9yID0gU2VsZWN0cGlja2VyO1xcclxcblxcclxcbiAgLy8gU0VMRUNUUElDS0VSIE5PIENPTkZMSUNUXFxyXFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT1cXHJcXG4gICQuZm4uc2VsZWN0cGlja2VyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XFxyXFxuICAgICQuZm4uc2VsZWN0cGlja2VyID0gb2xkO1xcclxcbiAgICByZXR1cm4gdGhpcztcXHJcXG4gIH07XFxyXFxuXFxyXFxuICAkKGRvY3VtZW50KVxcclxcbiAgICAgIC5kYXRhKCdrZXljb3VudCcsIDApXFxyXFxuICAgICAgLm9uKCdrZXlkb3duLmJzLnNlbGVjdCcsICcuYm9vdHN0cmFwLXNlbGVjdCBbZGF0YS10b2dnbGU9ZHJvcGRvd25dLCAuYm9vdHN0cmFwLXNlbGVjdCBbcm9sZT1cXFwibGlzdGJveFxcXCJdLCAuYnMtc2VhcmNoYm94IGlucHV0JywgU2VsZWN0cGlja2VyLnByb3RvdHlwZS5rZXlkb3duKVxcclxcbiAgICAgIC5vbignZm9jdXNpbi5tb2RhbCcsICcuYm9vdHN0cmFwLXNlbGVjdCBbZGF0YS10b2dnbGU9ZHJvcGRvd25dLCAuYm9vdHN0cmFwLXNlbGVjdCBbcm9sZT1cXFwibGlzdGJveFxcXCJdLCAuYnMtc2VhcmNoYm94IGlucHV0JywgZnVuY3Rpb24gKGUpIHtcXHJcXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XFxyXFxuICAgICAgfSk7XFxyXFxuXFxyXFxuICAvLyBTRUxFQ1RQSUNLRVIgREFUQS1BUElcXHJcXG4gIC8vID09PT09PT09PT09PT09PT09PT09PVxcclxcbiAgJCh3aW5kb3cpLm9uKCdsb2FkLmJzLnNlbGVjdC5kYXRhLWFwaScsIGZ1bmN0aW9uICgpIHtcXHJcXG4gICAgJCgnLnNlbGVjdHBpY2tlcicpLmVhY2goZnVuY3Rpb24gKCkge1xcclxcbiAgICAgIHZhciAkc2VsZWN0cGlja2VyID0gJCh0aGlzKTtcXHJcXG4gICAgICBQbHVnaW4uY2FsbCgkc2VsZWN0cGlja2VyLCAkc2VsZWN0cGlja2VyLmRhdGEoKSk7XFxyXFxuICAgIH0pXFxyXFxuICB9KTtcXHJcXG59KShqUXVlcnkpO1xcclxcblxcblxcbn0pKTtcXG5cIlxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3Jhdy1sb2FkZXIhLi9+L3NvdXJjZS1tYXAtbG9hZGVyIS4vfi9ib290c3RyYXAtc2VsZWN0L2Rpc3QvanMvYm9vdHN0cmFwLXNlbGVjdC5qc1xuICoqIG1vZHVsZSBpZCA9IDg0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJpbXBvcnQge1dQQXR0YWNobWVudEZvcm1JbnB1dH0gZnJvbSBcIi4uL3dwL2Zvcm0vaW5wdXRzL1dQQXR0YWNobWVudEZvcm1JbnB1dFwiO1xualF1ZXJ5KCBkb2N1bWVudCApLnJlYWR5KCBmdW5jdGlvbiAoKVxue1xuXHRqUXVlcnkoIFwiLndwYXR0YWNobWVudGZvcm1pbnB1dFwiICkuZWFjaCggZnVuY3Rpb24gKClcblx0e1xuXHRcdG5ldyBXUEF0dGFjaG1lbnRGb3JtSW5wdXQoIGpRdWVyeSggdGhpcyApLCBqUXVlcnkoIHRoaXMgKS5kYXRhKCkgKTtcblx0fSApO1xuLy9cdGpRdWVyeSggXCIud3BhdHRhY2htZW50Zm9ybWlucHV0IC5idG4tcmVtb3ZlXCIgKS5jbGljayggZnVuY3Rpb24gKCBlIClcbi8vXHR7XG4vL1x0XHRlLnByZXZlbnREZWZhdWx0KCk7XG4vL1x0XHR2YXIgJGVsID0gJCggdGhpcyApO1xuLy9cdFx0JGVsLmNsb3Nlc3QoIFwiLmxpc3QtZ3JvdXAtaXRlbVwiICkucmVtb3ZlKCk7XG4vL1xuLy9cdFx0bmV3IFdQQXR0YWNobWVudEZvcm1JbnB1dCggJCggJCggdGhpcyApLmRhdGEoIFwidGFyZ2V0XCIgKSApLCBcInJlbmRlclwiICk7XG4vL1x0fSApO1xuLy9cdGpRdWVyeSggXCIud3BhdHRhY2htZW50Zm9ybWlucHV0IC5idG4tYWRkXCIgKS5jbGljayggZnVuY3Rpb24gKCBlIClcbi8vXHR7XG4vL1x0XHRuZXcgV1BBdHRhY2htZW50Rm9ybUlucHV0KCAkKCAkKCB0aGlzICkuZGF0YSggXCJ0YXJnZXRcIiApICksIFwib3BlblwiICk7XG4vL1x0fSApO1xufSApO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3RzYy9wbHVnaW5zL2pRdWVyeVdQQXR0YWNobWVudEZvcm1JbnB1dC50c1xuICoqLyIsImV4cG9ydCBjbGFzcyBXUEF0dGFjaG1lbnRGb3JtSW5wdXRcbntcblx0cHVibGljICRlbDogSlF1ZXJ5O1xuXHRwdWJsaWMgb3B0aW9uczogSVdQQXR0YWNobWVudEZvcm1JbnB1dE9wdGlvbnMgPSB7XG5cdFx0bWF4OiAgICAgICAtMSxcblx0XHR0aXRsZTogICAgIFwiXCIsXG5cdFx0YnV0dG9uVGV4dDpcIlwiLFxuXHRcdHR5cGU6ICAgICAgbnVsbCxcblx0XHRmcmFtZTogICAgIFwic2VsZWN0XCJcblx0fTtcblx0cHVibGljIHdwTWVkaWE6IGFueTtcblx0cHVibGljIHRlbXBsYXRlOiBhbnk7XG5cblx0Y29uc3RydWN0b3IoICRlbDogSlF1ZXJ5LCBvcHRpb25zOiBPYmplY3QgKVxuXHR7XG5cdFx0dGhpcy4kZWwgICAgICA9ICRlbDtcblx0XHQvLyBNb2RlbFxuXHRcdHRoaXMub3B0aW9ucyAgPSBqUXVlcnkuZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zLCBvcHRpb25zICk7XG5cdFx0Ly8gVmlld1xuXHRcdHRoaXMudGVtcGxhdGUgPSBfLnRlbXBsYXRlKCB0aGlzLiRlbC5maW5kKCBcInRleHRhcmVhLnVuZGVyc2NvcmUtdGVtcGxhdGVcIiApLnZhbCgpICk7XG5cdFx0dGhpcy53cE1lZGlhICA9IHdwLm1lZGlhKCB7XG5cdFx0XHR0aXRsZTogICB0aGlzLm9wdGlvbnMudGl0bGUsXG5cdFx0XHRtdWx0aXBsZTp0aGlzLm9wdGlvbnMubWF4IDwgMCB8fCB0aGlzLm9wdGlvbnMubWF4ID4gMSA/IHRydWUgOiBmYWxzZSxcblx0XHRcdGxpYnJhcnk6IHRoaXMub3B0aW9ucy50eXBlID8ge3R5cGU6dGhpcy5vcHRpb25zLnR5cGV9IDogdW5kZWZpbmVkLFxuXHRcdFx0YnV0dG9uOiAge3RleHQ6dGhpcy5vcHRpb25zLmJ1dHRvblRleHR9LFxuXHRcdFx0ZnJhbWU6ICAgdGhpcy5vcHRpb25zLmZyYW1lXG5cdFx0fSApO1xuXHRcdC8vIENvbnRyb2xsZXJcblx0XHR0aGlzLndwTWVkaWEub24oIFwic2VsZWN0XCIsICgpID0+IHRoaXMub25XUE1lZGlhU2VsZWN0KCkgKTtcblx0XHR0aGlzLiRlbC5vbiggXCJjbGlja1wiLCBcIi5idG4tYWRkXCIsICgpID0+IHRoaXMub3BlbigpICk7XG5cdFx0dGhpcy4kZWwub24oIFwiY2xpY2tcIiwgXCIuYnRuLXJlbW92ZVwiLCAoIGUgKSA9PiB0aGlzLm9uUmVtb3ZlQ2xpY2soIGUgKSApO1xuXG5cdFx0dGhpcy5yZW5kZXIoKTtcblx0fVxuXG5cdHB1YmxpYyByZW5kZXIoKVxuXHR7XG5cdFx0aWYoIHRoaXMuY291bnQgPj0gdGhpcy5vcHRpb25zLm1heCAmJiB0aGlzLm9wdGlvbnMubWF4ID49IDAgKSB0aGlzLiRlbC5maW5kKCBcIi5idG4tYWRkXCIgKS5wcm9wKCBcImRpc2FibGVkXCIsIFwiZGlzYWJsZWRcIiApO1xuXHRcdGVsc2UgdGhpcy4kZWwuZmluZCggXCIuYnRuLWFkZFwiICkucHJvcCggXCJkaXNhYmxlZFwiLCBudWxsICk7XG5cdH1cblxuXHRwdWJsaWMgb3BlbigpXG5cdHtcblx0XHR0aGlzLndwTWVkaWEub3BlbigpO1xuXHR9O1xuXG5cdHB1YmxpYyBhZGQoIGF0dGFjaG1lbnRNb2RlbDogV1BNZWRpYUF0dGFjaG1lbnRNb2RlbCApXG5cdHtcblx0XHR2YXIgX190aGlzICAgICAgICAgID0gdGhpcztcblx0XHRhdHRhY2htZW50TW9kZWwuc3JjID0gYXR0YWNobWVudE1vZGVsLmljb247XG5cdFx0aWYoICFhdHRhY2htZW50TW9kZWwud2lkdGggKSBhdHRhY2htZW50TW9kZWwud2lkdGggPSBcIlwiO1xuXHRcdGlmKCAhYXR0YWNobWVudE1vZGVsLmhlaWdodCApIGF0dGFjaG1lbnRNb2RlbC5oZWlnaHQgPSBcIlwiO1xuXHRcdGlmKCBhdHRhY2htZW50TW9kZWwuc2l6ZXMgKVxuXHRcdHtcblx0XHRcdGlmKCBhdHRhY2htZW50TW9kZWwuc2l6ZXMudGh1bWJuYWlsICYmIGF0dGFjaG1lbnRNb2RlbC5zaXplcy50aHVtYm5haWwudXJsIClcblx0XHRcdHtcblx0XHRcdFx0YXR0YWNobWVudE1vZGVsLnNyYyA9IGF0dGFjaG1lbnRNb2RlbC5zaXplcy50aHVtYm5haWwudXJsO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiggYXR0YWNobWVudE1vZGVsLnNpemVzLmZ1bGwgJiYgYXR0YWNobWVudE1vZGVsLnNpemVzLmZ1bGwudXJsIClcblx0XHRcdHtcblx0XHRcdFx0YXR0YWNobWVudE1vZGVsLnNyYyA9IGF0dGFjaG1lbnRNb2RlbC5zaXplcy5mdWxsLnVybDtcblx0XHRcdH1cblx0XHR9XG5cdFx0dmFyICRlbCA9IGpRdWVyeSggdGhpcy50ZW1wbGF0ZSggYXR0YWNobWVudE1vZGVsICkgKTtcblx0XHR0aGlzLiRlbC5maW5kKCBcIi5saXN0LWdyb3VwXCIgKS5hcHBlbmQoICRlbCApO1xuXHR9O1xuXG5cdC8qIFNFVCBBTkQgR0VUICovXG5cdHB1YmxpYyBnZXQgY291bnQoKVxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuJGVsLmZpbmQoIFwiLmxpc3QtZ3JvdXAtaXRlbVwiICkubGVuZ3RoO1xuXHR9XG5cblx0LyogRVZFTlQgSEFORExFUlMgKi9cblx0cHJpdmF0ZSBvbldQTWVkaWFTZWxlY3QoKVxuXHR7XG5cdFx0dmFyIHNlbGVjdGlvbiA9IHRoaXMud3BNZWRpYS5zdGF0ZSgpLmdldCggJ3NlbGVjdGlvbicgKTtcblx0XHR2YXIgX190aGlzICAgID0gdGhpcztcblx0XHRzZWxlY3Rpb24uZWFjaCggZnVuY3Rpb24oIGF0dGFjaG1lbnQgKVxuXHRcdHtcblx0XHRcdGlmKCBfX3RoaXMub3B0aW9ucy5tYXggPCAwIHx8IF9fdGhpcy5jb3VudCA8IF9fdGhpcy5vcHRpb25zLm1heCApXG5cdFx0XHR7XG5cdFx0XHRcdF9fdGhpcy5hZGQoIGF0dGFjaG1lbnQudG9KU09OKCkgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHR0aGlzLnJlbmRlcigpO1xuXHR9O1xuXG5cdHByaXZhdGUgb25SZW1vdmVDbGljayggZSApXG5cdHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0dmFyICRlbCA9IGpRdWVyeSggZS5jdXJyZW50VGFyZ2V0ICk7XG5cdFx0JGVsLmNsb3Nlc3QoIFwiLmxpc3QtZ3JvdXAtaXRlbVwiICkucmVtb3ZlKCk7XG5cdFx0dGhpcy5yZW5kZXIoKTtcblx0fVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElXUEF0dGFjaG1lbnRGb3JtSW5wdXRPcHRpb25zXG57XG5cdG1heDogbnVtYmVyO1xuXHR0aXRsZTogc3RyaW5nO1xuXHRidXR0b25UZXh0OiBzdHJpbmc7XG5cdHR5cGU6IHN0cmluZztcblx0ZnJhbWU6IHN0cmluZztcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy90c2Mvd3AvZm9ybS9pbnB1dHMvV1BBdHRhY2htZW50Rm9ybUlucHV0LnRzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==