define("com/tutomvc/core/model/Model",[],function(){function e(t){var n=this,r,i=[];this.registerProxy=function(e){return e.initializeFacadefacadeKey(n.getFacadefacadeKey()),i[e.getName()]=e,e.onRegister(),e},this.retrieveProxy=function(e){return i[e]},this.getFacadefacadeKey=function(){return r},function(t){r=t,e.instanceMap[r]=n}(t)}return e.instanceMap=[],e.getInstance=function(t){return t?e.instanceMap[t]?e.instanceMap[t]:new e(t):console.log("Model::getInstance - no facadeKey")},e}),define("com/tutomvc/core/controller/event/EventDispatcher",[],function(){function e(){var e=this,t=[];this.dispatchEvent=function(e){if(t[e.getName()])for(var n in t[e.getName()]){var r=t[e.getName()][n];r(e)}},this.getEventMap=function(){return t},this.addEventListener=function(e,n){return t[e]||(t[e]=[]),t[e].push(n),!0},this.removeEventListener=function(e,n){if(t[e])for(var r in t[e]){var i=t[e.getName()][r];i==n&&(t[e.getName()][r]=null,delete t[e.getName()][r])}return!0}}return e.extend=function(t){return t.prototype=new e,t.prototype.constructor=t,t},e}),define("com/tutomvc/core/view/View",["com/tutomvc/core/controller/event/EventDispatcher"],function(e){function t(e){var n=this,r=e,i=[],s=[];this.registerMediator=function(e,t){return s[t.getName()]=e,t.initializeFacadeKey(n.getFacadeKey()),i[t.getName()]=t,t.onRegister(),t},this.retrieveMediator=function(e){return i[e]},this.retrieveViewComponent=function(e){return s[e]},this.getFacadeKey=function(){return r},function(e){r=e,t.instanceMap[r]=n}(e)}function n(e){return t.getInstance(e)}return n.instanceMap=t.instanceMap=[],n.getInstance=t.getInstance=function(n){return n?t.instanceMap[n]?t.instanceMap[n]:(t.prototype=new e,t.prototype.constructor=t,new t(n)):console.log("View::getInstance - no facadeKey")},n}),define("com/tutomvc/core/controller/Controller",["com/tutomvc/core/view/View"],function(e){function t(n){var r=this,i,s=[],o;this.executeCommand=function(e){if(s[e.getName()]){var t=new(s[e.getName()]);t.initializeFacadeKey(r.getFacadeKey()),t.execute(e)}},this.registerCommand=function(e,t){s[e]=t,o.addEventListener(e,r.executeCommand)},this.getFacadeKey=function(){return i},function(n){i=n,o=e.getInstance(i),t.instanceMap[i]=r}(n)}return t.instanceMap=[],t.getInstance=function(e){return e?t.instanceMap[e]?t.instanceMap[e]:new t(e):console.log("Controller::getInstance - no facadeKey")},t}),define("com/tutomvc/core/controller/event/Event",[],function(){function e(e,t){var n=e,r=t;this.setName=function(e){n=e},this.getName=function(){return n},this.setBody=function(e){r=e},this.getBody=function(){return r}}return e}),define("com/tutomvc/core/facade/Facade",["com/tutomvc/core/model/Model","com/tutomvc/core/view/View","com/tutomvc/core/controller/Controller","com/tutomvc/core/controller/event/Event"],function(e,t,n,r){function i(s){var o=this,u;this.model,this.view,this.controller;var a=function(e){if(!e)return console.log("Facade::error(need key)");u=e,i.instanceMap[e]=o,f(),l(),c()},f=function(){o.model=e.getInstance(o.getKey())},l=function(){o.controller=n.getInstance(o.getKey())},c=function(){o.view=t.getInstance(o.getKey())};this.dispatch=function(e,t){o.view.dispatchEvent(new r(e,t))},this.getKey=function(){return u},this.onRegister=function(){console.log("Facade")},a(s)}return i.instanceMap=[],i.getInstance=function(e){return e?i.instanceMap[e]?i.instanceMap[e]:new i(e):console.log("Facade::getInstance - no key")},i.extend=function(e,t){return e.prototype=new i(t),e.prototype.constructor=e,e},i}),define("com/tutomvc/wpadmin/Constants",[],function(){return{FACADE_KEY:"com/tutomvc/wpadmin",STARTUP:"startup"}}),define("com/tutomvc/core/CoreClass",["com/tutomvc/core/facade/Facade"],function(e){function t(){var t=this,n;this.initializeFacadeKey=function(e){return n=e,n},this.getFacadeKey=function(){return n},this.getFacade=function(){return e.getInstance(n)},this.onRegister=function(){}}return t}),define("com/tutomvc/core/controller/command/Command",["com/tutomvc/core/CoreClass"],function(e){function t(){this.execute=function(e){}}return t.extend=function(n){return t.prototype=new e,t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n},t}),define("com/tutomvc/wpadmin/view/MainViewComponent",["com/tutomvc/core/controller/event/EventDispatcher","jquery"],function(e,t){function n(){var e=this;(function(){})()}return e.extend(n)}),define("com/tutomvc/core/view/mediator/Mediator",["com/tutomvc/core/CoreClass","com/tutomvc/core/controller/event/Event"],function(e,t){function n(e){var n=this,r=e,i;this.dispatch=function(e,r){n.getFacade().view.dispatchEvent(new t(e,r))},this.addEventListener=function(e,t){n.getFacade().view.addEventListener(e,t)},this.getViewComponent=function(){return n.getFacade().view.retrieveViewComponent(n.getName())},this.getName=function(){return r},this.onRegister=function(){}}return n.extend=function(t,r){return n.prototype=new e,n.prototype.constructor=n,t.prototype=new n(r),t.prototype.constructor=t,t},n}),define("base64",[],function(){function e(){this.buffer=[]}function n(e){this._input=e,this._index=-1,this._buffer=[]}function r(e){this._input=e,this._index=-1,this._buffer=[]}e.prototype.append=function(t){return this.buffer.push(t),this},e.prototype.toString=function i(){return this.buffer.join("")};var t={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var r=new e,i=new n(t);while(i.moveNext()){var s=i.current;i.moveNext();var o=i.current;i.moveNext();var u=i.current,a=s>>2,f=(s&3)<<4|o>>4,l=(o&15)<<2|u>>6,c=u&63;isNaN(o)?l=c=64:isNaN(u)&&(c=64),r.append(this.codex.charAt(a)+this.codex.charAt(f)+this.codex.charAt(l)+this.codex.charAt(c))}return r.toString()},decode:function(t){var n=new e,i=new r(t);while(i.moveNext()){var s=i.current;if(s<128)n.append(String.fromCharCode(s));else if(s>191&&s<224){i.moveNext();var o=i.current;n.append(String.fromCharCode((s&31)<<6|o&63))}else{i.moveNext();var o=i.current;i.moveNext();var u=i.current;n.append(String.fromCharCode((s&15)<<12|(o&63)<<6|u&63))}}return n.toString()}};return n.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var e=this._input.charCodeAt(++this._index);return e==13&&this._input.charCodeAt(this._index+1)==10&&(e=10,this._index+=2),e<128?this.current=e:e>127&&e<2048?(this.current=e>>6|192,this._buffer.push(e&63|128)):(this.current=e>>12|224,this._buffer.push(e>>6&63|128),this._buffer.push(e&63|128)),!0}},r.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var e=t.codex.indexOf(this._input.charAt(++this._index)),n=t.codex.indexOf(this._input.charAt(++this._index)),r=t.codex.indexOf(this._input.charAt(++this._index)),i=t.codex.indexOf(this._input.charAt(++this._index)),s=e<<2|n>>4,o=(n&15)<<4|r>>2,u=(r&3)<<6|i;return this.current=s,r!=64&&this._buffer.push(o),i!=64&&this._buffer.push(u),!0}},t}),define("com/tutomvc/component/form/input/Input",["jquery","com/tutomvc/core/controller/event/EventDispatcher"],function(e,t){function n(){var t=this,n,r=function(){i()},i=function(){t.setElement(e("<input type='hidden' />"))};this.reset=function(){t.setValue(null)},this.setElement=function(t){n=e(t)},this.getElement=function(){return n},this.setValue=function(e){n.val(e?e:"")},this.getValue=function(){return n.val()},this.setName=function(e){n.attr("name",e?e:"")},this.getName=function(){return n.attr("name")},this.setID=function(e){n.attr("id",e?e:"")},this.getID=function(){return n.attr("id")},this.setType=function(e){n.attr("type",e)},this.getType=function(){return n.attr("type")},r()}return t.extend(n)}),define("com/tutomvc/component/model/Model",["jquery"],function(e){function t(){var t=this,n,r=[],i=function(){};this.empty=function(){for(var e in r){var t=r[e];t=null,delete r[e]}return!0},this.addProxy=function(e){return e.getName()||e.setName(r.length),e.getName()?r[e.getName()]=e:r.push(e),e},this.getProxy=function(e){for(var t in r){var n=r[t];if(t==e)return n}return null},this.getElement=function(){var t=e("<div class='Model'></div>");for(var n in r){var i=r[n];t.append(i.getElement())}return t},this.getProxyByValue=function(e){for(var n in r){var i=t.getProxy(n);if(i.getVOByValue(e))return i}return null},this.getMap=function(){return r},i()}return t}),define("com/tutomvc/component/form/input/Selector",["jquery","com/tutomvc/core/controller/event/EventDispatcher","com/tutomvc/component/form/input/Input","com/tutomvc/component/model/Model"],function(e,t,n,r){function i(){var t=this;this.model;var i,s,o=function(){t.setElement(e("<div></div>")),s=new n,t.model=new r,t.reset()};this.reset=function(){t.getElement().html(""),t.getElement().append(s.getElement());var e=t.model.getElement();t.getElement().append(e),t.getElement().addClass("Selector")},this.setID=function(e){s.setID(e)},this.getID=function(){return s.getID()},this.setElement=function(e){i=e},this.getElement=function(){return i},this.setValue=function(e){s.setValue(e)},this.getValue=function(){return s.getValue()},this.setName=function(e){s.setName(e)},this.getName=function(){return s.getName()},this.getInput=function(){return s},o()}return i.extend=function(e){return e.prototype=new i,e.prototype.constructor=e,e},t.extend(i)}),define("com/tutomvc/component/button/Button",["jquery","com/tutomvc/core/controller/event/EventDispatcher"],function(e,t){function n(t){var n=this;this.element=e('<div class="Button"></div>'),this.symbol=e("<div class='Symbol'></div>"),this.element.append(n.symbol),this.label=e("<span class='Label'></span>"),this.element.append(n.label),this.setLabel=function(e){n.label.html(e)},this.getLabel=function(){return n.label.html()},this.getElement=function(){return n.element},n.setLabel(t)}return t.extend(n)}),define("com/tutomvc/component/form/input/SingleSelector",["jquery","com/tutomvc/component/form/input/Selector","com/tutomvc/component/button/Button","com/tutomvc/core/controller/event/Event"],function(e,t,n,r){function i(){var t=this,i=this.constructor.prototype;this.autoUpdateLabel=!0,this.button;var s="",o=!1,u=function(){e(document).mouseup(f),t.reset()};this.reset=function(){i.reset(),t.button=new n,t.button.setLabel(s),t.button.getElement().on("click",t.toggle),t.getElement().append(t.button.getElement()),t.getElement().find(".ValueObject").each(function(){e(this).addClass("Button"),e(this).append("<div class='Symbol'></div>"),e(this).off("click"),e(this).on("click",l),e(this).attr("dataValue")==t.getValue()?e(this).addClass("Selected"):e(this).addClass("Deselected")}),t.getElement().off("mouseup"),t.getElement().on("mouseup",a),t.getElement().find(".Model .Proxy").off("mouseup"),t.getElement().find(".Model .Proxy").on("mouseup",a),t.getElement().find(".Model").append("<div class='Symbol'></div>"),t.getElement().find(".Model").off("mouseup"),t.getElement().find(".Model").on("mouseup",f),t.getElement().addClass("SingleSelector"),t.collapse()},this.select=function(e,n){t.setLabel(e),t.setValue(n)},this.toggle=function(){o?t.collapse():t.expand()},this.expand=function(){t.getElement().removeClass("Collapsed"),t.getElement().addClass("Expanded"),o=!0,t.dispatchEvent(new r("expand"))},this.collapse=function(){t.getElement().addClass("Collapsed"),t.getElement().removeClass("Expanded"),o=!1,t.dispatchEvent(new r("collapse"))},this.isExpanded=function(){return o},this.setValue=function(n){i.setValue(n),t.getElement().find("div.ValueObject").each(function(){e(this).removeClass("Deselected"),e(this).removeClass("Selected"),e(this).attr("dataValue")==n?e(this).addClass("Selected"):e(this).addClass("Deselected")})},this.setLabel=function(e){s=e,t.autoUpdateLabel&&t.button.setLabel(e)},this.getLabel=function(){if(t.button)return t.button.getLabel()};var a=function(e){e.stopPropagation()},f=function(e){t.collapse()},l=function(n){n.preventDefault();var i=e(n.currentTarget).attr("dataValue");if(t.getValue()!=i){var s=e(n.currentTarget).attr("dataName");t.select(s,i),t.dispatchEvent(new r("change",t.getValue()))}t.collapse()};u()}return i.extend=function(e){return e.prototype=new i,e.prototype.constructor=e,e},t.extend(i)}),define("com/tutomvc/component/model/vo/ValueObject",["jquery"],function(e){function t(t,n){var r=this,i=n?n:t,s=t;this.setValue=function(e){i=e},this.getValue=function(){return i},this.setName=function(e){s=e},this.getName=function(){return s},this.getElement=function(){var t=e('<div class="ValueObject"></div>');return t.append("<span class='Name'>"+r.getName()+"</div>"),t.attr("dataValue",r.getValue()),t.attr("dataName",r.getName()),t}}return t}),define("com/tutomvc/component/model/proxy/Proxy",["jquery","com/tutomvc/component/model/vo/ValueObject"],function(e,t){function n(n){var r=this,i,s=[],o=function(e){i=e};this.empty=function(){for(var e in s){var t=s[e];t=null,delete s[e]}return!0},this.addVO=function(e,n){var r=new t(e,n);u(r,r.getValue())};var u=function(e,t){t?s[t]=e:s.push(e)};this.has=function(e){return s[e]!=null},this.get=function(e){return s[e]},this.getVOByValue=function(e){for(var t in r.getMap()){var n=r.get(t);if(n.getValue()==e)return n}return null},this.remove=function(e){s[e]=null,delete s[e]},this.getElement=function(){var t=e("<div class='Proxy'></div>");r.getName()&&t.append("<div class='Name'><span>"+r.getName()+"</span></div>");var n=e("<div class='Map'></div>");for(var i in s){var o=s[i],u=o.getElement();u.attr("dataProxyName",r.getName()),n.append(u)}return t.append(n),t},this.getMap=function(){return s},this.setName=function(e){i=e},this.getName=function(){return i},this.getLength=function(){return s.length},o(n)}return n}),define("com/tutomvc/wpadmin/view/meta/components/field/input/text/TextInput",["com/tutomvc/component/form/input/Input","jquery"],function(e,t){function n(e){var t=this,n=this.constructor.prototype,r=e?e:"",i=function(){s()},s=function(){t.setType("text"),t.setValue(r)};i()}return function(t){return n.prototype=new e,n.prototype.constructor=n,new n(t)}}),define("com/tutomvc/wpadmin/view/meta/components/field/input/text/TextareaWYSIWYGInput",["com/tutomvc/component/form/input/Input","jquery"],function(e,t){function n(e,n,r){var i=this,s=this.constructor.prototype,o=e?e:"",u,a=n?n:"",f=r?r:"",l,c=function(){h()},h=function(){i.setElement(t("<div></div>")),p()},p=function(){f.quicktags=!1;var e={action:"tutomvc/ajax/render/wp_editor",nonce:Tuto.nonce,content:o,id:a,settings:f};t.ajax({type:"post",dataType:"html",url:Tuto.ajaxURL,data:e,success:d,error:v})};this.setID=function(e){return!1},this.getID=function(){return a},this.setValue=function(e){typeof e=="string"||e instanceof String||(e=""),l?l.setContent(e?e:""):o=e},this.setName=function(e){u=e,l&&t("#"+a).attr("name",e)};var d=function(e){i.getElement().append(t(e)),tinyMCE.execCommand("mceAddControl",!1,a),l=tinyMCE.get(a),t(l.getBody()).on("blur",g),t("#wp-"+a+"-wrap").on("click",m),i.setValue(o),wpActiveEditor=null,t("#"+a).attr("name",u)},v=function(e){console.log(e)},m=function(e){wpActiveEditor=a},g=function(e){wpActiveEditor=null};c()}return function(t,r,i){return n.prototype=new e,n.prototype.constructor=n,new n(t,r,i)}}),define("com/tutomvc/wpadmin/view/meta/components/field/input/attachment/AttachmentItem",["com/tutomvc/core/controller/event/EventDispatcher","com/tutomvc/component/form/input/Input","jquery","com/tutomvc/core/controller/event/Event"],function(e,t,n,r){function i(e,i,s,o,u){var a=this,f=e,l=i,c=s,h=o,p=u,d;this.input;var v,m=function(){g()},g=function(){d=n("<div class='AttachmentItem'></div>"),a.input=new t,a.input.setValue(f),d.append(a.input.getElement()),c?d.append("<a href='"+p+"'><img src='"+c+"' /></a>"):h&&d.append("<a href='"+p+"'><img src='"+h+"' class='Icon' /></a>"),l&&d.append("<div class='AttachmentTitle'><span>"+l+"</span></div>"),v=new Button,v.getElement().addClass("RemoveButton"),v.getElement().addClass("HiddenElement"),v.getElement().on("click",w),d.append(v.getElement()),d.on("mouseover",y),d.on("mouseout",b)};this.getElement=function(){return d};var y=function(){v.getElement().removeClass("HiddenElement")},b=function(){v.getElement().addClass("HiddenElement")},w=function(){d.remove(),a.dispatchEvent(new r("remove"))};m()}return e.extend(i)}),define("com/tutomvc/wpadmin/view/components/SortableComponent",["com/tutomvc/core/controller/event/EventDispatcher","jquery"],function(e,t){function n(e,r){var i=this,s=t(e),o=r,u,a,f,l=function(){t(window).on("mouseup",m),t(window).on("mousemove",d),i.update()},c=function(){f=t(u.get(0).outerHTML),f.attr("id",""),f.html(""),f.addClass(n.CLASS_DUMMY),f.css("position",a.position),f.css("opacity",a.opacity),f.css("width",a.width),f.css("height",a.height),f.css("top",a.top),f.css("left",a.left),f.css("z-index",a.z),f.css("margin",a.margin),f.css("border","2px dashed #ebebeb"),u.after(f),u.css("width",u.width()+"px"),u.css("height",u.outerHeight()+"px"),u.css("opacity",.5),u.css("z-index",99),u.css("position","fixed"),u.css("pointer-events","none")},h=function(){f&&(f.before(u),f.remove(),f=undefined)};this.update=function(){if(!r)return;s.children().each(function(){if(!t(this).hasClass(n.CLASS_ELEMENT)){if(!t(this).find(r).addClass(n.CLASS_HANDLE).length){if(!t(this).is(r))return;t(this).addClass(n.CLASS_HANDLE)}t(this).on("mousedown",p),t(this).on("mouseover",v),t(this).addClass(n.CLASS_ELEMENT)}})},this.getElement=function(){return s};var p=function(e){!u&&(t(e.target).hasClass(n.CLASS_HANDLE)||t(e.currentTarget).hasClass(n.CLASS_HANDLE)||!r)&&(u=t(e.currentTarget),a={width:u.css("width"),height:u.css("height"),position:u.css("position"),opacity:u.css("opacity"),top:u.css("top"),left:u.css("left"),margin:u.css("margin"),z:u.css("z-index"),offsetX:e.offsetX,offsetY:e.offsetY,index:u.index(),style:u.attr("style"),transform:u.css("transform"),pointerEvents:u.css("pointer-events")})},d=function(e){u&&(f||c(),u.css("top",e.clientY-a.offsetY),u.css("left",e.clientX-a.offsetX),window.getSelection().removeAllRanges())},v=function(e){u&&(f.index()<t(e.currentTarget).index()?t(e.currentTarget).after(f):t(e.currentTarget).before(f))},m=function(e){u&&(h(),u.css("position",a.position),u.css("opacity",a.opacity),u.css("width",a.width),u.css("height",a.height),u.css("top",a.top),u.css("left",a.left),u.css("z-index",a.z),u.css("pointer-events",a.pointerEvents),u.css("transform",a.transform),u.attr("style",a.style),u=undefined)};(function(){l()})()}return n.CLASS_ELEMENT="SortableElement",n.CLASS_HANDLE="SortableHandle",n.CLASS_DUMMY="SortableDummy",e.extend(n)}),define("com/tutomvc/wpadmin/view/meta/components/field/input/attachment/AttachmentList",["com/tutomvc/component/form/input/Input","com/tutomvc/component/button/Button","jquery","com/tutomvc/wpadmin/view/meta/components/field/input/attachment/AttachmentItem","com/tutomvc/wpadmin/view/components/SortableComponent"],function(e,t,n,r,i){function s(e){var s=this,o=n.extend({},{title:"",maxCardinality:-1,filter:[],buttonTitle:"Select"},e),u="",a,f,l,c,h,p=function(){d(),v()},d=function(){a=n("<div class='AttachmentList cf'></div>"),f=new i(a,".AttachmentItem"),l=n("<div class='HiddenElement'></div>"),a.append(a),c=new t,c.getElement().addClass("AddButton"),c.getElement().on("click",b),c.getElement().on("dragover",g),c.getElement().on("drop",y),a.append(c.getElement()),s.setElement(a),h=wp.media({title:o.title?o.title:"",multiple:o.maxCardinality<0||o.maxCardinality>1?!0:!1,library:{type:o.filter?o.filter:""},button:{text:o.buttonTitle?o.buttonTitle:"Select"},frame:"select"}),h.on("select",w)},v=function(){o.hasOwnProperty("maxCardinality")?a.find(".AttachmentItem").length>=o.maxCardinality&&o.maxCardinality>=0?c.getElement().addClass("HiddenElement"):c.getElement().removeClass("HiddenElement"):c.getElement().removeClass("HiddenElement")},m=function(e,t,n,i,s){if(o.hasOwnProperty("maxCardinality")&&a.find(".AttachmentItem").length>=o.maxCardinality&&o.maxCardinality>=0)return!1;var l=new r(e,t,n,i,s);return l.input.setName(u+"[]"),l.addEventListener("remove",v),c.getElement().before(l.getElement()),v(),f.update(),!0};this.setValue=function(e){if(!e)a.find(".AttachmentItem").each(function(){n(this).remove()});else for(var t in e){var r=e[t];m(r.id,r.title,r.thumbnailURL,r.iconURL,r.editURL)}v()},this.setName=function(e){u=e,a.find("input").each(function(){n(this).attr("name",u+"[]")})},this.getName=function(){return u};var g=function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},y=function(e){e.stopPropagation(),e.preventDefault();var t=e.originalEvent.dataTransfer.files;console.log(t)},b=function(e){h.open()},w=function(){var e=h.state().get("selection");e.each(function(e){if(!m(e.id,e.attributes.filename,e.attributes.sizes?e.attributes.sizes.thumbnail.url:null,e.attributes.icon,e.attributes.editLink))return})};p()}return function(t){return s.prototype=new e,s.prototype.constructor=s,new s(t)}}),define("com/tutomvc/wpadmin/view/meta/components/field/input/MetaFieldInput",["com/tutomvc/component/form/input/SingleSelector","com/tutomvc/component/model/proxy/Proxy","com/tutomvc/wpadmin/view/meta/components/field/input/text/TextInput","com/tutomvc/wpadmin/view/meta/components/field/input/text/TextareaWYSIWYGInput","com/tutomvc/wpadmin/view/meta/components/field/input/attachment/AttachmentList"],function(e,t,n,r,i){return function(s){var o;switch(s.type.name){case"textarea_wysiwyg":o=new r(s.value,s.id,s.type.settings);break;case"attachment":o=new i(s.type.settings),o.setName(s.name),o.setValue(s.value);break;case"selector_single":o=new e,o.setLabel(s.title);var u=new t;for(var a in s.type.settings.options)u.addVO(s.type.settings.options[a],a),a==s.value&&(o.setLabel(s.type.settings.options[a]),o.setValue(s.value));o.model.addProxy(u),o.reset();break;default:o=new n(s.value)}return o&&o.setName(s.name),o}}),define("com/tutomvc/wpadmin/view/meta/components/field/MetaField",["com/tutomvc/core/controller/event/EventDispatcher","com/tutomvc/core/controller/event/Event","base64","com/tutomvc/wpadmin/view/meta/components/field/input/MetaFieldInput"],function(e,t,n,r){function i(e,i){var s=this,o=e,u,a,f=i,l,c,h=function(){a=JSON.parse(decodeURIComponent(f.find(".JSON").html()));if(typeof a.value=="string"||a.value instanceof String)a.value=n.decode(a.value);a.id=u=a.name+"_"+o,p()},p=function(){l=f.find("label"),l.attr("for",u),c=new r(a),c&&(c.setID(u),c.addEventListener("change",s.change),f.append(c.getElement()));switch(a.type.name){case"selector_single":l.remove()}};this.reset=function(){c&&c.setValue(null)},this.change=function(){if(!c)return;var e=new t("change",{metaFieldName:a.name,value:c.getValue()});s.dispatchEvent(e)},this.metaBoxChange=function(e,t,n){for(var r in a.conditions){var i=a.conditions[r];i.metaBoxName==e&&i.metaFieldName==t&&(i.value==n?i.onElse&&s[i.onMatch]():i.onElse&&s[i.onElse]())}},this.show=function(){f.removeClass("HiddenElement")},this.hide=function(){f.addClass("HiddenElement")},this.getElement=function(){return f},this.getLabelElement=function(){return l},this.getName=function(){return a.name},this.setKey=function(e){a.key=e,c&&c.setName(a.key)},this.getKey=function(){return a.key};var d=function(e){};h()}return e.extend(i)}),define("com/tutomvc/wpadmin/view/meta/components/MetaBox",["com/tutomvc/core/controller/event/EventDispatcher","com/tutomvc/core/controller/event/Event","jquery","com/tutomvc/wpadmin/view/meta/components/field/MetaField"],function(e,t,n,r){function i(e,i){var s=this,o,u,a,f=e,l=i,c,h,p=function(){u=l.attr("data-meta-box-name"),o=parseInt(l.attr("data-cardinality-id")),d()},d=function(){a=[],l.find(".MetaField").each(function(){var e=new r(u+"_"+s.getID(),n(this));e.addEventListener("change",m),a.push(e)}),c=l.find("div.title span.Label"),h=l.find(".RemoveMetaBoxButton"),h.on("click",v)};this.reset=function(){n(a).each(function(){this.reset()})},this.change=function(){n(a).each(function(){this.change()})},this.setLabel=function(e){c.html(e)},this.setCardinalityID=function(e){o=e,s.setLabel("No. "+(o+1)),n(a).each(function(){this.setKey(u+"_"+o+"_"+this.getName())})},this.getCardinalityID=function(){return o},this.getElement=function(){return l},this.getID=function(){return f};var v=function(e){e.preventDefault(),s.dispatchEvent(new t("remove",{id:s.getID()}))},m=function(e){n(a).each(function(){this.metaBoxChange(u,e.getBody().metaFieldName,e.getBody().value)}),s.dispatchEvent(e)};p()}return e.extend(i)}),define("com/tutomvc/wpadmin/view/meta/components/MetaBoxProxy",["com/tutomvc/core/controller/event/EventDispatcher","jquery","com/tutomvc/wpadmin/view/meta/components/MetaBox","com/tutomvc/wpadmin/view/components/SortableComponent"],function(e,t,n,r){function i(e){var r=this,i,s,o,u,a=0,f=0,l,c=!1,h=t(e),p,d,v,m,g,y=function(){i=t.extend({},{conditions:[]},JSON.parse(decodeURIComponent(h.find(".MetaBoxAttributes").html()))),l={},s=h.attr("data-post-id"),o=h.attr("data-meta-box-name"),u=parseInt(h.attr("data-max-cardinality")),b()},b=function(){p=h.find(".MetaBoxProxy"),v=h.find("input#"+o),p.find(".MetaBox").each(function(){T(t(this))}),m=h.find(".AddMetaBoxButton"),m.on("click",k),g=h.find(".MetaBoxDummy").html(),h.find(".MetaBoxDummy").remove(),w()},w=function(){var e=0;for(var t in l){var n=l[t];n.setCardinalityID(e),e++}a=e,v.val(a),E()},E=function(){m&&(S()?m.addClass("HiddenElement"):m.removeClass("HiddenElement"))},S=function(){return a>=u&&u>=0};this.change=function(){for(var e in l){var t=l[e];t.change()}};var x=function(){return L(g);var e},T=function(e,r){var i=C(),s=new n(i,t(e));return s.addEventListener("remove",A),s.addEventListener("change",M),l[i]=s,r&&p.append(s.getElement()),w(),s},N=function(e){var t=l[e];t&&(t.getElement().remove(),delete l[e]),w()};this.metaBoxChange=function(e,t,n){for(var s in i.conditions){var o=i.conditions[s];o.metaBoxName==e&&o.metaFieldName==t&&(o.value==n?o.onElse&&r[o.onMatch]():o.onElse&&r[o.onElse]())}},this.show=function(){h.removeClass("HiddenElement")},this.hide=function(){h.addClass("HiddenElement")};var C=function(){return f++};this.getMetaBoxName=function(){return o};var k=function(e){e.preventDefault(),S()||T(t(g),!0).change()},L=function(e){T(t(e),!0).change()},A=function(e){var t=e.getBody().id;N(t)},O=function(e){console.log(e)},M=function(e){r.metaBoxChange(o,e.getBody().metaFieldName,e.getBody().value),e.getBody().metaBoxName=o,r.dispatchEvent(e)};y()}return e.extend(i)}),define("com/tutomvc/wpadmin/view/meta/MetaBoxModelViewComponent",["com/tutomvc/core/controller/event/EventDispatcher","jquery","com/tutomvc/wpadmin/view/meta/components/MetaBoxProxy"],function(e,t,n){function r(){var e=this,r=[],i=function(){t("div.MetaBoxModel").each(function(){var e=new n(t(this));e.addEventListener("change",s),r.push(e)}),t(r).each(function(){this.change()})},s=function(e){t(r).each(function(){this.getMetaBoxName()!=e.getBody().metaBoxName&&this.metaBoxChange(e.getBody().metaBoxName,e.getBody().metaFieldName,e.getBody().value)})};i()}return e.extend(r)}),define("com/tutomvc/wpadmin/view/meta/MetaBoxModelMediator",["com/tutomvc/core/view/mediator/Mediator"],function(e){function t(){var e=this;this.onRegister=function(){}}return t.NAME="MetaBoxModelMediator",e.extend(t,t.NAME)}),define("com/tutomvc/wpadmin/view/page/SettingsPageMediator",["com/tutomvc/core/view/mediator/Mediator","jquery","com/tutomvc/wpadmin/view/meta/components/field/MetaField"],function(e,t,n){function r(){var e=this;this.onRegister=function(){e.getViewComponent().find(".SettingsField").each(function(){var e=new n("",t(this)),r=e.getLabelElement().find(".description");t(this).append("<p class='description'>"+r.html()+"</p>")})}}return r.NAME="SettingsPageMediator",e.extend(r,r.NAME)}),define("com/tutomvc/component/form/input/MultiSelector",["jquery","com/tutomvc/component/form/input/SingleSelector","com/tutomvc/component/model/Model","com/tutomvc/component/model/proxy/Proxy","com/tutomvc/core/controller/event/Event"],function(e,t,n,r,i){function s(){var t=this,s=this.constructor.prototype,o;this.autoUpdateLabel=!1;var u=function(){t.reset()};this.reset=function(){s.reset(),o=new n,t.getElement().find(".ValueObject").each(function(){e(this).off("click"),e(this).on("click",a)}),t.getElement().addClass("MultiSelector")},this.select=function(e,n,r){t.addValue(e,n,r);var i="",s=0;for(var u in o.getMap()){var a=o.getProxy(u);for(var f in a.getMap())s>0&&(i+=","),i+=a.get(f).getValue(),s++}t.getInput().getElement().attr("value",i),t.getElement().attr("dataValue",i)},this.addValue=function(n,i,s){var u=o.getProxy(n);return u||(u=new r(n)),u.has(s)?u.remove(s):u.addVO(i,s),t.getElement().find("div.ValueObject").each(function(){e(this).attr("dataProxyName")==u.getName()&&(e(this).removeClass("Deselected"),e(this).removeClass("Selected"),u.has(e(this).attr("dataValue"))?e(this).addClass("Selected"):e(this).addClass("Deselected"))}),o.addProxy(u),u},this.getFilteredModel=function(){return o},this.setLabel=function(e){t.button.setLabel(e)};var a=function(n){n.preventDefault(),t.select(e(n.currentTarget).attr("dataProxyName"),e(n.currentTarget).attr("dataName"),e(n.currentTarget).attr("dataValue")),t.dispatchEvent(new i("change",t.getValue()))};u()}return s.extend=function(e){return e.prototype=new s,e.prototype.constructor=e,e},t.extend(s)}),define("com/tutomvc/component/form/input/TagSelector",["jquery","com/tutomvc/component/form/input/MultiSelector","com/tutomvc/core/controller/event/Event"],function(e,t,n){function r(){var t=this,r=this.constructor.prototype,i,s,o=!1;this.freeTagEnabled=!0;var u=function(){t.reset()},a=function(){s.find(".ValueObject").remove();for(var e in t.getFilteredModel().getMap())for(var n in t.getFilteredModel().getProxy(e).getMap()){var r=t.getFilteredModel().getProxy(e).getMap()[n].getElement();r.addClass("Button"),r.attr("dataProxyName",e),r.append("<div class='Symbol'></div>"),r.off("click"),r.on("click",h),i.before(r)}s.find(".ValueObject").length!=0&&t.button.label.addClass("HiddenElement"),t.isExpanded()&&t.getElement().find(".Model").css("top",t.getElement().height()+"px")};this.resetFilter=function(){o=!0,i.val(""),t.filter(null),o=!1},this.reset=function(){r.reset(),s=e("<div class='Tags'></div>"),i=e("<input type='text' autocomplete='off' />"),i.addClass("TextBox"),i.on("input",p),i.on("focus",l),i.on("focusout",c),i.on("keyup",d),s.append(i),t.button.element.addClass("clearfix"),t.button.element.addClass("filterButton"),t.button.getElement().append(s),t.button.getElement().off("click"),t.button.getElement().on("click",f),t.getElement().find(".ValueObject").each(function(){e(this).off("click"),e(this).on("click",h)}),t.getElement().addClass("TagSelector")},this.select=function(e,t,n){r.select(e,t,n),a()},this.customSelect=function(){if(!t.freeTagEnabled)return;i.val()&&i.val().length&&!t.getFilteredModel().getProxyByValue(i.val())?(t.select("",i.val(),i.val()),i.val(""),t.filter(null),t.dispatchEvent(new n("change",t.getValue()))):i.val("")},this.filter=function(n){var r=t.getElement().find(".Model"),i=0;n&&(n=n.toLowerCase()),r.find(".Proxy").each(function(){var t=e(this);t.removeClass("HiddenElement");var r=!1;t.find(".ValueObject").each(function(){var t=e(this);t.removeClass("HiddenElement"),t.find(".Name").html(t.attr("dataName"));var s=t.attr("dataName").toLowerCase(),o=t.attr("dataValue");if(!n||s.indexOf(n)>-1||o.indexOf(n)>-1){r=!0,i++;var u=s.indexOf(n);if(u>=0){var a=t.attr("dataName"),a=a.substring(0,u)+"<span class='Highlight'>"+a.substring(u,u+n.length)+"</span>"+a.substring(u+n.length);t.find(".Name").html(a)}}else n&&n.length>0&&t.addClass("HiddenElement")}),!r&&n&&n.length>0&&t.addClass("HiddenElement")}),i>0&&!t.isExpanded()?t.expand():i==0&&t.isExpanded()&&t.collapse()},t.expand=function(){t.getElement().find(".Model").css("top",t.getElement().height()+"px"),r.expand()},t.collapse=function(){r.collapse()},t.focus=function(){f()},this.setLabel=function(e){t.button.setLabel(e)};var f=function(e){i.is(":focus")||i.focus(),t.isExpanded()||t.expand()},l=function(e){if(o)return;t.isExpanded()||t.expand(),t.getElement().addClass("Focus"),t.button.label.addClass("HiddenElement")},c=function(e){if(o)return;t.getElement().removeClass("Focus"),s.find(".ValueObject").length==0&&t.button.label.removeClass("HiddenElement")},h=function(r){r.preventDefault(),t.select(e(r.currentTarget).attr("dataProxyName"),e(r.currentTarget).attr("dataName"),e(r.currentTarget).attr("dataValue")),t.dispatchEvent(new n("change",t.getValue())),i.val(""),t.filter(null),i.focus()},p=function(e){if(o)return;t.filter(i.val())},d=function(e){if(o)return;e.keyCode==13?t.customSelect():e.keyCode==27&&(i.val(""),t.filter(""),i.blur(),t.collapse())};u()}return t.extend(r)}),define("com/tutomvc/wpadmin/view/page/tutomvc/TutoMVCLogsMediator",["com/tutomvc/core/view/mediator/Mediator","jquery","com/tutomvc/component/form/input/TagSelector","com/tutomvc/component/model/proxy/Proxy"],function(e,t,n,r){function i(){var e=this,i,s=0,o,u=[],a,f;this.onRegister=function(){i=JSON.parse(e.getViewComponent().attr("data-provider")),l()};var l=function(){f=e.getViewComponent().find(".Logs"),o=new n(t("<div></div>")),o.freeTagEnabled=!1,a=new r;for(var u in i)s++,a.addVO(u,i[u]);o.model.addProxy(a),o.reset(),o.setLabel(s+" logs"),o.addEventListener("change",p),e.getViewComponent().prepend(o.getElement())},c=function(){t(o.getFilteredModel().getMap()).each(function(){var e=this,n=e.getMap();f.find(".Log").each(function(){e.getVOByValue(t(this).attr("data-key"))||t(this).remove()});for(var r in n)f.find(".Log[data-key='"+r+"']").length||h(n[r].getName(),r)})},h=function(e,n){var r={action:"tutomvc/ajax/render/log",nonce:Tuto.nonce,file:n,title:e};t.ajax({type:"post",dataType:"html",url:Tuto.ajaxURL,data:r,success:function(e){var r=t(e).addClass("Log").attr("data-key",n);f.prepend(r)},error:d})},p=function(e){u=e.getBody(),c()},d=function(e){console.log(e)}}return i.VIEW_COMPONENT_NAME="logsViewComponent",e.extend(i,i.NAME)}),define("com/tutomvc/wpadmin/view/MainMediator",["com/tutomvc/core/view/mediator/Mediator","jquery","com/tutomvc/wpadmin/view/meta/MetaBoxModelViewComponent","com/tutomvc/wpadmin/view/meta/MetaBoxModelMediator","com/tutomvc/wpadmin/view/page/SettingsPageMediator","com/tutomvc/wpadmin/view/page/tutomvc/TutoMVCLogsMediator"],function(e,t,n,r,i,s){function o(){var e=this;this.onRegister=function(){e.getFacade().view.registerMediator(new n,new r),e.getFacade().view.registerMediator(t("body"),new i),t("#"+s.VIEW_COMPONENT_NAME).length&&e.getFacade().view.registerMediator(t("#"+s.VIEW_COMPONENT_NAME),new s)}}return o.NAME="MainMediator",e.extend(o,o.NAME)}),define("com/tutomvc/wpadmin/controller/commands/StartUpCommand",["jquery","com/tutomvc/core/controller/command/Command","com/tutomvc/wpadmin/view/MainViewComponent","com/tutomvc/wpadmin/view/MainMediator"],function(e,t,n,r){function i(){var t=this,n=function(){},i=function(){},s=function(){t.getFacade().view.registerMediator(e("body"),new r)};this.execute=function(e){n(),i(),s()}}return t.extend(i)}),require.config({baseUrl:Tuto.baseURL+"/src/js/",paths:{jquery:"../../libs/js/jquery-2.0.3.min",base64:"com/tutomvc/wpadmin/modules/base64"},map:{"com/tutomvc/wpadmin/modules/jquery":{jquery:"jquery"},"*":{jquery:"com/tutomvc/wpadmin/modules/jquery"}}}),require(["jquery","com/tutomvc/core/facade/Facade","com/tutomvc/wpadmin/Constants","com/tutomvc/wpadmin/controller/commands/StartUpCommand"],function(e,t,n,r){return e(document).ready(function(){function e(){var e=this,t=function(){},i=function(){},s=function(){e.controller.registerCommand(n.STARTUP,r)};(function(){t(),i(),s(),e.dispatch(n.STARTUP,{})})()}return e.prototype=t.getInstance(n.FACADE_KEY),e.prototype.constructor=e,new e})}),define("com/tutomvc/wpadmin/MainWPAdmin.config",function(){});